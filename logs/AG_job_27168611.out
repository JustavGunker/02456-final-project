Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 2., 2., 5.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/800 | Train Loss: 3.5271
 Avg Train Loss: 3.5271 | Seg Loss: 0.7015 | Recon Loss: 0.0197
  Val mIoU: 0.5250 (Best: 0.0000)
  [Class IoU]  C1: 0.7288 | C2: 0.7285 | C3: 0.1178
  --> New Best Model Saved!
Epoch 2/800 | Train Loss: 3.0364
 Avg Train Loss: 3.0364 | Seg Loss: 0.6051 | Recon Loss: 0.0107
  Val mIoU: 0.4843 (Best: 0.5250)
  [Class IoU]  C1: 0.6257 | C2: 0.7409 | C3: 0.0864
Epoch 3/800 | Train Loss: 2.8149
 Avg Train Loss: 2.8149 | Seg Loss: 0.5612 | Recon Loss: 0.0088
  Val mIoU: 0.5443 (Best: 0.5250)
  [Class IoU]  C1: 0.8553 | C2: 0.7294 | C3: 0.0482
  --> New Best Model Saved!
Epoch 4/800 | Train Loss: 2.6429
 Avg Train Loss: 2.6429 | Seg Loss: 0.5270 | Recon Loss: 0.0079
  Val mIoU: 0.5092 (Best: 0.5443)
  [Class IoU]  C1: 0.8735 | C2: 0.6255 | C3: 0.0287
Epoch 5/800 | Train Loss: 2.5534
 Avg Train Loss: 2.5534 | Seg Loss: 0.5091 | Recon Loss: 0.0078
  Val mIoU: 0.5433 (Best: 0.5443)
  [Class IoU]  C1: 0.8871 | C2: 0.6842 | C3: 0.0586
Epoch 6/800 | Train Loss: 2.4562
 Avg Train Loss: 2.4562 | Seg Loss: 0.4898 | Recon Loss: 0.0073
  Val mIoU: 0.5826 (Best: 0.5443)
  [Class IoU]  C1: 0.8495 | C2: 0.7299 | C3: 0.1683
  --> New Best Model Saved!
Epoch 7/800 | Train Loss: 2.4010
 Avg Train Loss: 2.4010 | Seg Loss: 0.4787 | Recon Loss: 0.0073
  Val mIoU: 0.5342 (Best: 0.5826)
  [Class IoU]  C1: 0.9016 | C2: 0.6116 | C3: 0.0894
Epoch 8/800 | Train Loss: 2.3557
 Avg Train Loss: 2.3557 | Seg Loss: 0.4697 | Recon Loss: 0.0070
  Val mIoU: 0.6101 (Best: 0.5826)
  [Class IoU]  C1: 0.8737 | C2: 0.7647 | C3: 0.1920
  --> New Best Model Saved!
Epoch 9/800 | Train Loss: 2.3004
 Avg Train Loss: 2.3004 | Seg Loss: 0.4587 | Recon Loss: 0.0068
  Val mIoU: 0.6272 (Best: 0.6101)
  [Class IoU]  C1: 0.8870 | C2: 0.7831 | C3: 0.2115
  --> New Best Model Saved!
Epoch 10/800 | Train Loss: 2.2340
 Avg Train Loss: 2.2340 | Seg Loss: 0.4454 | Recon Loss: 0.0068
  Val mIoU: 0.4907 (Best: 0.6272)
  [Class IoU]  C1: 0.5878 | C2: 0.7515 | C3: 0.1327
Epoch 11/800 | Train Loss: 2.2103
 Avg Train Loss: 2.2103 | Seg Loss: 0.4407 | Recon Loss: 0.0066
  Val mIoU: 0.5768 (Best: 0.6272)
  [Class IoU]  C1: 0.8917 | C2: 0.7306 | C3: 0.1079
Epoch 12/800 | Train Loss: 2.1603
 Avg Train Loss: 2.1603 | Seg Loss: 0.4308 | Recon Loss: 0.0063
  Val mIoU: 0.6535 (Best: 0.6272)
  [Class IoU]  C1: 0.9194 | C2: 0.7666 | C3: 0.2746
  --> New Best Model Saved!
Epoch 13/800 | Train Loss: 2.1076
 Avg Train Loss: 2.1076 | Seg Loss: 0.4203 | Recon Loss: 0.0064
  Val mIoU: 0.5276 (Best: 0.6535)
  [Class IoU]  C1: 0.6578 | C2: 0.7031 | C3: 0.2220
Epoch 14/800 | Train Loss: 2.0887
 Avg Train Loss: 2.0887 | Seg Loss: 0.4165 | Recon Loss: 0.0062
  Val mIoU: 0.6336 (Best: 0.6535)
  [Class IoU]  C1: 0.9181 | C2: 0.7704 | C3: 0.2123
Epoch 15/800 | Train Loss: 2.0615
 Avg Train Loss: 2.0615 | Seg Loss: 0.4110 | Recon Loss: 0.0064
  Val mIoU: 0.7430 (Best: 0.6535)
  [Class IoU]  C1: 0.8943 | C2: 0.8184 | C3: 0.5164
  --> New Best Model Saved!
Epoch 16/800 | Train Loss: 2.0351
 Avg Train Loss: 2.0351 | Seg Loss: 0.4058 | Recon Loss: 0.0061
  Val mIoU: 0.4987 (Best: 0.7430)
  [Class IoU]  C1: 0.6409 | C2: 0.5764 | C3: 0.2788
Epoch 17/800 | Train Loss: 2.0064
 Avg Train Loss: 2.0064 | Seg Loss: 0.4000 | Recon Loss: 0.0062
  Val mIoU: 0.3115 (Best: 0.7430)
  [Class IoU]  C1: 0.4006 | C2: 0.3406 | C3: 0.1933
Epoch 18/800 | Train Loss: 2.0108
 Avg Train Loss: 2.0108 | Seg Loss: 0.4009 | Recon Loss: 0.0062
  Val mIoU: 0.3053 (Best: 0.7430)
  [Class IoU]  C1: 0.1868 | C2: 0.4662 | C3: 0.2627
Epoch 19/800 | Train Loss: 1.9393
 Avg Train Loss: 1.9393 | Seg Loss: 0.3867 | Recon Loss: 0.0060
  Val mIoU: 0.3155 (Best: 0.7430)
  [Class IoU]  C1: 0.1611 | C2: 0.6256 | C3: 0.1598
Epoch 20/800 | Train Loss: 1.9814
 Avg Train Loss: 1.9814 | Seg Loss: 0.3951 | Recon Loss: 0.0059
  Val mIoU: 0.3998 (Best: 0.7430)
  [Class IoU]  C1: 0.2358 | C2: 0.6882 | C3: 0.2752
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/curve_0020_predictions.png
Epoch 21/800 | Train Loss: 1.9439
 Avg Train Loss: 1.9439 | Seg Loss: 0.3877 | Recon Loss: 0.0057
  Val mIoU: 0.3782 (Best: 0.7430)
  [Class IoU]  C1: 0.2239 | C2: 0.7001 | C3: 0.2107
Epoch 22/800 | Train Loss: 1.9192
 Avg Train Loss: 1.9192 | Seg Loss: 0.3827 | Recon Loss: 0.0058
  Val mIoU: 0.4182 (Best: 0.7430)
  [Class IoU]  C1: 0.2427 | C2: 0.6905 | C3: 0.3214
Epoch 23/800 | Train Loss: 1.8982
 Avg Train Loss: 1.8982 | Seg Loss: 0.3785 | Recon Loss: 0.0059
  Val mIoU: 0.3282 (Best: 0.7430)
  [Class IoU]  C1: 0.2694 | C2: 0.4773 | C3: 0.2380
Epoch 24/800 | Train Loss: 1.9056
 Avg Train Loss: 1.9056 | Seg Loss: 0.3800 | Recon Loss: 0.0057
  Val mIoU: 0.4165 (Best: 0.7430)
  [Class IoU]  C1: 0.1531 | C2: 0.5785 | C3: 0.5179
Epoch 25/800 | Train Loss: 1.8807
 Avg Train Loss: 1.8807 | Seg Loss: 0.3750 | Recon Loss: 0.0057
  Val mIoU: 0.2018 (Best: 0.7430)
  [Class IoU]  C1: 0.2521 | C2: 0.1915 | C3: 0.1620
Epoch 26/800 | Train Loss: 1.8505
 Avg Train Loss: 1.8505 | Seg Loss: 0.3689 | Recon Loss: 0.0057
  Val mIoU: 0.4641 (Best: 0.7430)
  [Class IoU]  C1: 0.2612 | C2: 0.7819 | C3: 0.3492
Epoch 27/800 | Train Loss: 1.8307
 Avg Train Loss: 1.8307 | Seg Loss: 0.3650 | Recon Loss: 0.0057
  Val mIoU: 0.5071 (Best: 0.7430)
  [Class IoU]  C1: 0.3133 | C2: 0.7789 | C3: 0.4291
Epoch 28/800 | Train Loss: 1.8634
 Avg Train Loss: 1.8634 | Seg Loss: 0.3716 | Recon Loss: 0.0055
  Val mIoU: 0.3512 (Best: 0.7430)
  [Class IoU]  C1: 0.3709 | C2: 0.5168 | C3: 0.1659
Epoch 29/800 | Train Loss: 1.8156
 Avg Train Loss: 1.8156 | Seg Loss: 0.3620 | Recon Loss: 0.0056
  Val mIoU: 0.4670 (Best: 0.7430)
  [Class IoU]  C1: 0.2914 | C2: 0.7021 | C3: 0.4075
Epoch 30/800 | Train Loss: 1.8715
 Avg Train Loss: 1.8715 | Seg Loss: 0.3732 | Recon Loss: 0.0056
  Val mIoU: 0.3225 (Best: 0.7430)
  [Class IoU]  C1: 0.2861 | C2: 0.4823 | C3: 0.1990
Epoch 31/800 | Train Loss: 1.8003
 Avg Train Loss: 1.8003 | Seg Loss: 0.3590 | Recon Loss: 0.0055
  Val mIoU: 0.2561 (Best: 0.7430)
  [Class IoU]  C1: 0.2959 | C2: 0.2981 | C3: 0.1745
Epoch 32/800 | Train Loss: 1.7927
 Avg Train Loss: 1.7927 | Seg Loss: 0.3574 | Recon Loss: 0.0056
  Val mIoU: 0.3361 (Best: 0.7430)
  [Class IoU]  C1: 0.2846 | C2: 0.4848 | C3: 0.2391
Epoch 33/800 | Train Loss: 1.7599
 Avg Train Loss: 1.7599 | Seg Loss: 0.3509 | Recon Loss: 0.0053
  Val mIoU: 0.3125 (Best: 0.7430)
  [Class IoU]  C1: 0.2519 | C2: 0.4633 | C3: 0.2224
Epoch 34/800 | Train Loss: 1.7970
 Avg Train Loss: 1.7970 | Seg Loss: 0.3583 | Recon Loss: 0.0054
  Val mIoU: 0.3476 (Best: 0.7430)
  [Class IoU]  C1: 0.2098 | C2: 0.5555 | C3: 0.2775
Epoch 35/800 | Train Loss: 1.8053
 Avg Train Loss: 1.8053 | Seg Loss: 0.3600 | Recon Loss: 0.0053
  Val mIoU: 0.4691 (Best: 0.7430)
  [Class IoU]  C1: 0.2690 | C2: 0.7215 | C3: 0.4168
Epoch 36/800 | Train Loss: 1.8094
 Avg Train Loss: 1.8094 | Seg Loss: 0.3608 | Recon Loss: 0.0054
  Val mIoU: 0.2705 (Best: 0.7430)
  [Class IoU]  C1: 0.2542 | C2: 0.3572 | C3: 0.2002
Epoch 37/800 | Train Loss: 1.7978
 Avg Train Loss: 1.7978 | Seg Loss: 0.3585 | Recon Loss: 0.0054
  Val mIoU: 0.2862 (Best: 0.7430)
  [Class IoU]  C1: 0.2678 | C2: 0.3868 | C3: 0.2041
Epoch 38/800 | Train Loss: 1.7467
 Avg Train Loss: 1.7467 | Seg Loss: 0.3483 | Recon Loss: 0.0053
  Val mIoU: 0.3342 (Best: 0.7430)
  [Class IoU]  C1: 0.2426 | C2: 0.5154 | C3: 0.2446
Epoch 39/800 | Train Loss: 1.8143
 Avg Train Loss: 1.8143 | Seg Loss: 0.3618 | Recon Loss: 0.0054
  Val mIoU: 0.3676 (Best: 0.7430)
  [Class IoU]  C1: 0.2528 | C2: 0.5725 | C3: 0.2776

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27168611: <AG_job> in cluster <dcc> Exited

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Tue Nov 25 13:34:25 2025
Job was executed on host(s) <8*n-62-18-9>, in queue <gpua100>, as user <s214776> in cluster <dcc> at Tue Nov 25 17:33:37 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Tue Nov 25 17:33:37 2025
Terminated at Tue Nov 25 18:06:36 2025
Results reported at Tue Nov 25 18:06:36 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpua100           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

TERM_OWNER: job killed by owner.
Exited with exit code 130.

Resource usage summary:

    CPU time :                                   5063.09 sec.
    Max Memory :                                 2132 MB
    Average Memory :                             1795.37 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               522156.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                77
    Run time :                                   1980 sec.
    Turnaround time :                            16331 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27168611.err> for stderr output of this job.

