Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 3.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/800 | Train Loss: 3.5137
 Avg Train Loss: 3.5137 | Seg Loss: 0.6979 | Recon Loss: 0.0244
  Val mIoU: 0.5490 (Best: 0.0000)
  [Class IoU]  C1: 0.7751 | C2: 0.7073 | C3: 0.1645
  --> New Best Model Saved!
Epoch 2/800 | Train Loss: 2.9317
 Avg Train Loss: 2.9317 | Seg Loss: 0.5835 | Recon Loss: 0.0144
  Val mIoU: 0.6171 (Best: 0.5490)
  [Class IoU]  C1: 0.7429 | C2: 0.7627 | C3: 0.3456
  --> New Best Model Saved!
Epoch 3/800 | Train Loss: 2.7641
 Avg Train Loss: 2.7641 | Seg Loss: 0.5506 | Recon Loss: 0.0109
  Val mIoU: 0.6528 (Best: 0.6171)
  [Class IoU]  C1: 0.8875 | C2: 0.7497 | C3: 0.3213
  --> New Best Model Saved!
Epoch 4/800 | Train Loss: 2.6068
 Avg Train Loss: 2.6068 | Seg Loss: 0.5195 | Recon Loss: 0.0093
  Val mIoU: 0.5989 (Best: 0.6528)
  [Class IoU]  C1: 0.9064 | C2: 0.7426 | C3: 0.1477
Epoch 5/800 | Train Loss: 2.5045
 Avg Train Loss: 2.5045 | Seg Loss: 0.4992 | Recon Loss: 0.0084
  Val mIoU: 0.6790 (Best: 0.6528)
  [Class IoU]  C1: 0.9102 | C2: 0.7812 | C3: 0.3454
  --> New Best Model Saved!
Epoch 6/800 | Train Loss: 2.4085
 Avg Train Loss: 2.4085 | Seg Loss: 0.4801 | Recon Loss: 0.0080
  Val mIoU: 0.7085 (Best: 0.6790)
  [Class IoU]  C1: 0.9215 | C2: 0.7939 | C3: 0.4102
  --> New Best Model Saved!
Epoch 7/800 | Train Loss: 2.3498
 Avg Train Loss: 2.3498 | Seg Loss: 0.4685 | Recon Loss: 0.0076
  Val mIoU: 0.7044 (Best: 0.7085)
  [Class IoU]  C1: 0.8733 | C2: 0.7989 | C3: 0.4411
Epoch 8/800 | Train Loss: 2.3139
 Avg Train Loss: 2.3139 | Seg Loss: 0.4614 | Recon Loss: 0.0070
  Val mIoU: 0.7046 (Best: 0.7085)
  [Class IoU]  C1: 0.7869 | C2: 0.8121 | C3: 0.5149
Epoch 9/800 | Train Loss: 2.2337
 Avg Train Loss: 2.2337 | Seg Loss: 0.4454 | Recon Loss: 0.0067
  Val mIoU: 0.7684 (Best: 0.7085)
  [Class IoU]  C1: 0.9197 | C2: 0.8138 | C3: 0.5719
  --> New Best Model Saved!
Epoch 10/800 | Train Loss: 2.2172
 Avg Train Loss: 2.2172 | Seg Loss: 0.4421 | Recon Loss: 0.0068
  Val mIoU: 0.7413 (Best: 0.7684)
  [Class IoU]  C1: 0.8772 | C2: 0.7990 | C3: 0.5479
Epoch 11/800 | Train Loss: 2.1563
 Avg Train Loss: 2.1563 | Seg Loss: 0.4299 | Recon Loss: 0.0068
  Val mIoU: 0.7486 (Best: 0.7684)
  [Class IoU]  C1: 0.8970 | C2: 0.8082 | C3: 0.5406
Epoch 12/800 | Train Loss: 2.1457
 Avg Train Loss: 2.1457 | Seg Loss: 0.4279 | Recon Loss: 0.0062
  Val mIoU: 0.6975 (Best: 0.7684)
  [Class IoU]  C1: 0.9267 | C2: 0.7947 | C3: 0.3711
Epoch 13/800 | Train Loss: 2.1097
 Avg Train Loss: 2.1097 | Seg Loss: 0.4207 | Recon Loss: 0.0063
  Val mIoU: 0.7355 (Best: 0.7684)
  [Class IoU]  C1: 0.9269 | C2: 0.8012 | C3: 0.4785
Epoch 14/800 | Train Loss: 2.0536
 Avg Train Loss: 2.0536 | Seg Loss: 0.4095 | Recon Loss: 0.0063
  Val mIoU: 0.7211 (Best: 0.7684)
  [Class IoU]  C1: 0.9185 | C2: 0.7742 | C3: 0.4707
Epoch 15/800 | Train Loss: 2.0393
 Avg Train Loss: 2.0393 | Seg Loss: 0.4067 | Recon Loss: 0.0060
  Val mIoU: 0.4435 (Best: 0.7684)
  [Class IoU]  C1: 0.8683 | C2: 0.2800 | C3: 0.1823
Epoch 16/800 | Train Loss: 1.9822
 Avg Train Loss: 1.9822 | Seg Loss: 0.3952 | Recon Loss: 0.0061
  Val mIoU: 0.7310 (Best: 0.7684)
  [Class IoU]  C1: 0.9253 | C2: 0.8025 | C3: 0.4654
Epoch 17/800 | Train Loss: 1.9642
 Avg Train Loss: 1.9642 | Seg Loss: 0.3917 | Recon Loss: 0.0059
  Val mIoU: 0.4248 (Best: 0.7684)
  [Class IoU]  C1: 0.8247 | C2: 0.2630 | C3: 0.1868
Epoch 18/800 | Train Loss: 1.9742
 Avg Train Loss: 1.9742 | Seg Loss: 0.3936 | Recon Loss: 0.0061
  Val mIoU: 0.5365 (Best: 0.7684)
  [Class IoU]  C1: 0.9225 | C2: 0.4539 | C3: 0.2332
Epoch 19/800 | Train Loss: 1.9738
 Avg Train Loss: 1.9738 | Seg Loss: 0.3936 | Recon Loss: 0.0059
  Val mIoU: 0.5218 (Best: 0.7684)
  [Class IoU]  C1: 0.9016 | C2: 0.4351 | C3: 0.2286
Epoch 20/800 | Train Loss: 1.9683
 Avg Train Loss: 1.9683 | Seg Loss: 0.3925 | Recon Loss: 0.0058
  Val mIoU: 0.6707 (Best: 0.7684)
  [Class IoU]  C1: 0.9242 | C2: 0.6902 | C3: 0.3977
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/curve_0020_predictions.png
Epoch 21/800 | Train Loss: 1.9486
 Avg Train Loss: 1.9486 | Seg Loss: 0.3886 | Recon Loss: 0.0057
  Val mIoU: 0.5154 (Best: 0.7684)
  [Class IoU]  C1: 0.9202 | C2: 0.4090 | C3: 0.2169
Epoch 22/800 | Train Loss: 1.9168
 Avg Train Loss: 1.9168 | Seg Loss: 0.3822 | Recon Loss: 0.0057
  Val mIoU: 0.5385 (Best: 0.7684)
  [Class IoU]  C1: 0.9249 | C2: 0.4477 | C3: 0.2428
Epoch 23/800 | Train Loss: 1.8499
 Avg Train Loss: 1.8499 | Seg Loss: 0.3689 | Recon Loss: 0.0056
  Val mIoU: 0.5264 (Best: 0.7684)
  [Class IoU]  C1: 0.9201 | C2: 0.4264 | C3: 0.2327
Epoch 24/800 | Train Loss: 1.8614
 Avg Train Loss: 1.8614 | Seg Loss: 0.3711 | Recon Loss: 0.0057
  Val mIoU: 0.7220 (Best: 0.7684)
  [Class IoU]  C1: 0.9277 | C2: 0.8010 | C3: 0.4373
Epoch 25/800 | Train Loss: 1.8570
 Avg Train Loss: 1.8570 | Seg Loss: 0.3703 | Recon Loss: 0.0055
  Val mIoU: 0.3305 (Best: 0.7684)
  [Class IoU]  C1: 0.6562 | C2: 0.1746 | C3: 0.1606
Epoch 26/800 | Train Loss: 1.8730
 Avg Train Loss: 1.8730 | Seg Loss: 0.3735 | Recon Loss: 0.0055
  Val mIoU: 0.5886 (Best: 0.7684)
  [Class IoU]  C1: 0.8628 | C2: 0.6300 | C3: 0.2731
Epoch 27/800 | Train Loss: 1.8287
 Avg Train Loss: 1.8287 | Seg Loss: 0.3646 | Recon Loss: 0.0056
  Val mIoU: 0.3036 (Best: 0.7684)
  [Class IoU]  C1: 0.6068 | C2: 0.1391 | C3: 0.1650
Epoch 28/800 | Train Loss: 1.8690
 Avg Train Loss: 1.8690 | Seg Loss: 0.3726 | Recon Loss: 0.0058
  Val mIoU: 0.6899 (Best: 0.7684)
  [Class IoU]  C1: 0.8220 | C2: 0.7872 | C3: 0.4606
Epoch 29/800 | Train Loss: 1.7898
 Avg Train Loss: 1.7898 | Seg Loss: 0.3569 | Recon Loss: 0.0055
  Val mIoU: 0.7023 (Best: 0.7684)
  [Class IoU]  C1: 0.9242 | C2: 0.7963 | C3: 0.3863
Epoch 30/800 | Train Loss: 1.8146
 Avg Train Loss: 1.8146 | Seg Loss: 0.3618 | Recon Loss: 0.0055
  Val mIoU: 0.4503 (Best: 0.7684)
  [Class IoU]  C1: 0.9199 | C2: 0.2363 | C3: 0.1946
Epoch 31/800 | Train Loss: 1.7894
 Avg Train Loss: 1.7894 | Seg Loss: 0.3568 | Recon Loss: 0.0055
  Val mIoU: 0.4827 (Best: 0.7684)
  [Class IoU]  C1: 0.9136 | C2: 0.3314 | C3: 0.2030
Epoch 32/800 | Train Loss: 1.7588
 Avg Train Loss: 1.7588 | Seg Loss: 0.3507 | Recon Loss: 0.0053
  Val mIoU: 0.4372 (Best: 0.7684)
  [Class IoU]  C1: 0.8203 | C2: 0.3000 | C3: 0.1911
Epoch 33/800 | Train Loss: 1.7570
 Avg Train Loss: 1.7570 | Seg Loss: 0.3503 | Recon Loss: 0.0053
  Val mIoU: 0.4620 (Best: 0.7684)
  [Class IoU]  C1: 0.8797 | C2: 0.3076 | C3: 0.1987
Epoch 34/800 | Train Loss: 1.7358
 Avg Train Loss: 1.7358 | Seg Loss: 0.3461 | Recon Loss: 0.0053
  Val mIoU: 0.4063 (Best: 0.7684)
  [Class IoU]  C1: 0.9224 | C2: 0.1344 | C3: 0.1619
Epoch 35/800 | Train Loss: 1.7565
 Avg Train Loss: 1.7565 | Seg Loss: 0.3502 | Recon Loss: 0.0053
  Val mIoU: 0.4679 (Best: 0.7684)
  [Class IoU]  C1: 0.9190 | C2: 0.2902 | C3: 0.1944
Epoch 36/800 | Train Loss: 1.7559
 Avg Train Loss: 1.7559 | Seg Loss: 0.3501 | Recon Loss: 0.0054
  Val mIoU: 0.3465 (Best: 0.7684)
  [Class IoU]  C1: 0.7744 | C2: 0.1168 | C3: 0.1484
Epoch 37/800 | Train Loss: 1.7383
 Avg Train Loss: 1.7383 | Seg Loss: 0.3466 | Recon Loss: 0.0052
  Val mIoU: 0.4359 (Best: 0.7684)
  [Class IoU]  C1: 0.9053 | C2: 0.2267 | C3: 0.1758
Epoch 38/800 | Train Loss: 1.7178
 Avg Train Loss: 1.7178 | Seg Loss: 0.3425 | Recon Loss: 0.0052
  Val mIoU: 0.3587 (Best: 0.7684)
  [Class IoU]  C1: 0.7699 | C2: 0.1467 | C3: 0.1594
Epoch 39/800 | Train Loss: 1.7590
 Avg Train Loss: 1.7590 | Seg Loss: 0.3507 | Recon Loss: 0.0053
  Val mIoU: 0.2794 (Best: 0.7684)
  [Class IoU]  C1: 0.4726 | C2: 0.1957 | C3: 0.1700
Epoch 40/800 | Train Loss: 1.7242
 Avg Train Loss: 1.7242 | Seg Loss: 0.3438 | Recon Loss: 0.0053
  Val mIoU: 0.4016 (Best: 0.7684)
  [Class IoU]  C1: 0.8122 | C2: 0.2162 | C3: 0.1763
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/curve_0040_predictions.png
Epoch 41/800 | Train Loss: 1.7413
 Avg Train Loss: 1.7413 | Seg Loss: 0.3472 | Recon Loss: 0.0055
  Val mIoU: 0.4214 (Best: 0.7684)
  [Class IoU]  C1: 0.8830 | C2: 0.2107 | C3: 0.1704
Epoch 42/800 | Train Loss: 1.6884
 Avg Train Loss: 1.6884 | Seg Loss: 0.3366 | Recon Loss: 0.0055
  Val mIoU: 0.4199 (Best: 0.7684)
  [Class IoU]  C1: 0.8952 | C2: 0.1900 | C3: 0.1746
Epoch 43/800 | Train Loss: 1.7424
 Avg Train Loss: 1.7424 | Seg Loss: 0.3474 | Recon Loss: 0.0051
  Val mIoU: 0.2591 (Best: 0.7684)
  [Class IoU]  C1: 0.5033 | C2: 0.1288 | C3: 0.1452
Epoch 44/800 | Train Loss: 1.7312
 Avg Train Loss: 1.7312 | Seg Loss: 0.3452 | Recon Loss: 0.0051
  Val mIoU: 0.3110 (Best: 0.7684)
  [Class IoU]  C1: 0.6754 | C2: 0.1057 | C3: 0.1520
Epoch 45/800 | Train Loss: 1.7060
 Avg Train Loss: 1.7060 | Seg Loss: 0.3402 | Recon Loss: 0.0052
  Val mIoU: 0.4804 (Best: 0.7684)
  [Class IoU]  C1: 0.9219 | C2: 0.3058 | C3: 0.2134
Epoch 46/800 | Train Loss: 1.7115
 Avg Train Loss: 1.7115 | Seg Loss: 0.3413 | Recon Loss: 0.0052
  Val mIoU: 0.4013 (Best: 0.7684)
  [Class IoU]  C1: 0.8796 | C2: 0.1589 | C3: 0.1655
Epoch 47/800 | Train Loss: 1.7165
 Avg Train Loss: 1.7165 | Seg Loss: 0.3422 | Recon Loss: 0.0053
  Val mIoU: 0.3241 (Best: 0.7684)
  [Class IoU]  C1: 0.6369 | C2: 0.1695 | C3: 0.1658
Epoch 48/800 | Train Loss: 1.7320
 Avg Train Loss: 1.7320 | Seg Loss: 0.3454 | Recon Loss: 0.0052
  Val mIoU: 0.4036 (Best: 0.7684)
  [Class IoU]  C1: 0.8643 | C2: 0.1731 | C3: 0.1735
Epoch 49/800 | Train Loss: 1.7127
 Avg Train Loss: 1.7127 | Seg Loss: 0.3415 | Recon Loss: 0.0052
  Val mIoU: 0.4556 (Best: 0.7684)
  [Class IoU]  C1: 0.9037 | C2: 0.2652 | C3: 0.1978
Epoch 50/800 | Train Loss: 1.6758
 Avg Train Loss: 1.6758 | Seg Loss: 0.3341 | Recon Loss: 0.0051
  Val mIoU: 0.3677 (Best: 0.7684)
  [Class IoU]  C1: 0.7971 | C2: 0.1407 | C3: 0.1653
Epoch 51/800 | Train Loss: 1.6979
 Avg Train Loss: 1.6979 | Seg Loss: 0.3385 | Recon Loss: 0.0053
  Val mIoU: 0.3443 (Best: 0.7684)
  [Class IoU]  C1: 0.7341 | C2: 0.1323 | C3: 0.1665
Epoch 52/800 | Train Loss: 1.7220
 Avg Train Loss: 1.7220 | Seg Loss: 0.3434 | Recon Loss: 0.0051
  Val mIoU: 0.4067 (Best: 0.7684)
  [Class IoU]  C1: 0.8641 | C2: 0.1797 | C3: 0.1763
Epoch 53/800 | Train Loss: 1.7140
 Avg Train Loss: 1.7140 | Seg Loss: 0.3418 | Recon Loss: 0.0052
  Val mIoU: 0.4483 (Best: 0.7684)
  [Class IoU]  C1: 0.8909 | C2: 0.2617 | C3: 0.1923
Epoch 54/800 | Train Loss: 1.6815
 Avg Train Loss: 1.6815 | Seg Loss: 0.3353 | Recon Loss: 0.0051
  Val mIoU: 0.3032 (Best: 0.7684)
  [Class IoU]  C1: 0.6221 | C2: 0.1293 | C3: 0.1581
Epoch 55/800 | Train Loss: 1.6494
 Avg Train Loss: 1.6494 | Seg Loss: 0.3288 | Recon Loss: 0.0052
  Val mIoU: 0.3972 (Best: 0.7684)
  [Class IoU]  C1: 0.7756 | C2: 0.2294 | C3: 0.1866

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27176348: <AG_job> in cluster <dcc> Exited

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Tue Nov 25 18:06:23 2025
Job was executed on host(s) <8*n-62-18-9>, in queue <gpua100>, as user <s214776> in cluster <dcc> at Tue Nov 25 18:07:08 2025
</zhome/d2/4/167803> was used as the home directory.
</dtu/blackhole/1b/167803/tiff_data> was used as the working directory.
Started at Tue Nov 25 18:07:08 2025
Terminated at Tue Nov 25 18:52:37 2025
Results reported at Tue Nov 25 18:52:37 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpua100           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

TERM_OWNER: job killed by owner.
Exited with exit code 130.

Resource usage summary:

    CPU time :                                   6990.35 sec.
    Max Memory :                                 2219 MB
    Average Memory :                             1857.74 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               522069.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                40
    Run time :                                   2734 sec.
    Turnaround time :                            2774 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27176348.err> for stderr output of this job.

