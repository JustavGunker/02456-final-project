Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([0.5000, 1.5000, 1.0000, 4.0000], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Loaders Ready ---
Train Batches: 59
Val Batches: 16
--- Starting Training ---
Epoch 1/400 | Train Loss: 67.5652
 Avg Train Loss: 67.5652 | Seg Loss: 0.6754 | Recon Loss: 0.0292
  Val mIoU: 0.4521 (Best: 0.0000)
  [Class IoU] C0: 0.4522249766218123 | C1: 0.3974 | C2: 0.6764 | C3: 0.2822
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 73.2899
 Avg Train Loss: 73.2899 | Seg Loss: 0.5554 | Recon Loss: 0.0191
  Val mIoU: 0.5083 (Best: 0.4521)
  [Class IoU] C0: 0.5443958985865904 | C1: 0.8395 | C2: 0.5379 | C3: 0.1116
  --> New Best Model Saved!
Epoch 3/400 | Train Loss: 58.0023
 Avg Train Loss: 58.0023 | Seg Loss: 0.5171 | Recon Loss: 0.0141
  Val mIoU: 0.4214 (Best: 0.5083)
  [Class IoU] C0: 0.4125375548960646 | C1: 0.8733 | C2: 0.2720 | C3: 0.1278
Epoch 4/400 | Train Loss: 54.7475
 Avg Train Loss: 54.7475 | Seg Loss: 0.4946 | Recon Loss: 0.0117
  Val mIoU: 0.4523 (Best: 0.5083)
  [Class IoU] C0: 0.45514630489733326 | C1: 0.8772 | C2: 0.3736 | C3: 0.1031
Epoch 5/400 | Train Loss: 51.1984
 Avg Train Loss: 51.1984 | Seg Loss: 0.4674 | Recon Loss: 0.0100
  Val mIoU: 0.5270 (Best: 0.5083)
  [Class IoU] C0: 0.5352816712557666 | C1: 0.8847 | C2: 0.5177 | C3: 0.1703
  --> New Best Model Saved!
Epoch 6/400 | Train Loss: 49.4495
 Avg Train Loss: 49.4495 | Seg Loss: 0.4559 | Recon Loss: 0.0090
  Val mIoU: 0.5413 (Best: 0.5270)
  [Class IoU] C0: 0.5851980568957912 | C1: 0.8830 | C2: 0.5857 | C3: 0.1111
  --> New Best Model Saved!
Epoch 7/400 | Train Loss: 48.1343
 Avg Train Loss: 48.1343 | Seg Loss: 0.4473 | Recon Loss: 0.0087
  Val mIoU: 0.5485 (Best: 0.5413)
  [Class IoU] C0: 0.5927262986407384 | C1: 0.9008 | C2: 0.5943 | C3: 0.1063
  --> New Best Model Saved!
Epoch 8/400 | Train Loss: 46.5241
 Avg Train Loss: 46.5241 | Seg Loss: 0.4364 | Recon Loss: 0.0083
  Val mIoU: 0.6170 (Best: 0.5485)
  [Class IoU] C0: 0.7171262389276302 | C1: 0.9172 | C2: 0.7157 | C3: 0.1182
  --> New Best Model Saved!
Epoch 9/400 | Train Loss: 44.2011
 Avg Train Loss: 44.2011 | Seg Loss: 0.4157 | Recon Loss: 0.0081
  Val mIoU: 0.4870 (Best: 0.6170)
  [Class IoU] C0: 0.49573115266285833 | C1: 0.9188 | C2: 0.4468 | C3: 0.0869
Epoch 10/400 | Train Loss: 43.6617
 Avg Train Loss: 43.6617 | Seg Loss: 0.4140 | Recon Loss: 0.0079
  Val mIoU: 0.5189 (Best: 0.6170)
  [Class IoU] C0: 0.5236158034019551 | C1: 0.9249 | C2: 0.4965 | C3: 0.1304
Epoch 11/400 | Train Loss: 42.7489
 Avg Train Loss: 42.7489 | Seg Loss: 0.4085 | Recon Loss: 0.0077
  Val mIoU: 0.5124 (Best: 0.6170)
  [Class IoU] C0: 0.5228709020689871 | C1: 0.9145 | C2: 0.4978 | C3: 0.1144
Epoch 12/400 | Train Loss: 41.6263
 Avg Train Loss: 41.6263 | Seg Loss: 0.3990 | Recon Loss: 0.0071
  Val mIoU: 0.4868 (Best: 0.6170)
  [Class IoU] C0: 0.49124267460133336 | C1: 0.9130 | C2: 0.4439 | C3: 0.0990
Epoch 13/400 | Train Loss: 41.3748
 Avg Train Loss: 41.3748 | Seg Loss: 0.3982 | Recon Loss: 0.0073
  Val mIoU: 0.4587 (Best: 0.6170)
  [Class IoU] C0: 0.4506238212892303 | C1: 0.9260 | C2: 0.3619 | C3: 0.0964
Epoch 14/400 | Train Loss: 40.2936
 Avg Train Loss: 40.2936 | Seg Loss: 0.3892 | Recon Loss: 0.0071
  Val mIoU: 0.4799 (Best: 0.6170)
  [Class IoU] C0: 0.4680979474329043 | C1: 0.9236 | C2: 0.3952 | C3: 0.1328
Epoch 15/400 | Train Loss: 39.9509
 Avg Train Loss: 39.9509 | Seg Loss: 0.3878 | Recon Loss: 0.0070
  Val mIoU: 0.5213 (Best: 0.6170)
  [Class IoU] C0: 0.5316368300381273 | C1: 0.9274 | C2: 0.5084 | C3: 0.1177
Epoch 16/400 | Train Loss: 39.1424
 Avg Train Loss: 39.1424 | Seg Loss: 0.3813 | Recon Loss: 0.0072
  Val mIoU: 0.5624 (Best: 0.6170)
  [Class IoU] C0: 0.5891737241490119 | C1: 0.8879 | C2: 0.5909 | C3: 0.1817
Epoch 17/400 | Train Loss: 39.1143
 Avg Train Loss: 39.1143 | Seg Loss: 0.3817 | Recon Loss: 0.0070
  Val mIoU: 0.5931 (Best: 0.6170)
  [Class IoU] C0: 0.6639094336672916 | C1: 0.9266 | C2: 0.6655 | C3: 0.1165
Epoch 18/400 | Train Loss: 38.0250
 Avg Train Loss: 38.0250 | Seg Loss: 0.3720 | Recon Loss: 0.0068
  Val mIoU: 0.5577 (Best: 0.6170)
  [Class IoU] C0: 0.5730750115239034 | C1: 0.9255 | C2: 0.5706 | C3: 0.1617
Epoch 19/400 | Train Loss: 38.2136
 Avg Train Loss: 38.2136 | Seg Loss: 0.3749 | Recon Loss: 0.0068
  Val mIoU: 0.6186 (Best: 0.6170)
  [Class IoU] C0: 0.6737235354991873 | C1: 0.9115 | C2: 0.6807 | C3: 0.2086
  --> New Best Model Saved!
Epoch 20/400 | Train Loss: 37.3415
 Avg Train Loss: 37.3415 | Seg Loss: 0.3678 | Recon Loss: 0.0066
  Val mIoU: 0.6523 (Best: 0.6186)
  [Class IoU] C0: 0.6772561431745865 | C1: 0.9238 | C2: 0.6956 | C3: 0.3126
  --> New Best Model Saved!
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 37.1408
 Avg Train Loss: 37.1408 | Seg Loss: 0.3675 | Recon Loss: 0.0067
  Val mIoU: 0.5707 (Best: 0.6523)
  [Class IoU] C0: 0.6097967189787754 | C1: 0.9078 | C2: 0.6089 | C3: 0.1564
Epoch 22/400 | Train Loss: 36.6317
 Avg Train Loss: 36.6317 | Seg Loss: 0.3622 | Recon Loss: 0.0065
  Val mIoU: 0.6186 (Best: 0.6523)
  [Class IoU] C0: 0.6872530933598084 | C1: 0.9085 | C2: 0.6935 | C3: 0.1851
Epoch 23/400 | Train Loss: 37.0254
 Avg Train Loss: 37.0254 | Seg Loss: 0.3672 | Recon Loss: 0.0064
  Val mIoU: 0.6187 (Best: 0.6523)
  [Class IoU] C0: 0.7118489769572932 | C1: 0.7086 | C2: 0.7709 | C3: 0.2833
Epoch 24/400 | Train Loss: 35.8635
 Avg Train Loss: 35.8635 | Seg Loss: 0.3565 | Recon Loss: 0.0064
  Val mIoU: 0.6437 (Best: 0.6523)
  [Class IoU] C0: 0.741288025491038 | C1: 0.9191 | C2: 0.7385 | C3: 0.1761
Epoch 25/400 | Train Loss: 35.6629
 Avg Train Loss: 35.6629 | Seg Loss: 0.3550 | Recon Loss: 0.0065
  Val mIoU: 0.6558 (Best: 0.6523)
  [Class IoU] C0: 0.7270243139089505 | C1: 0.9267 | C2: 0.7322 | C3: 0.2374
  --> New Best Model Saved!
Epoch 26/400 | Train Loss: 36.1133
 Avg Train Loss: 36.1133 | Seg Loss: 0.3603 | Recon Loss: 0.0061
  Val mIoU: 0.6495 (Best: 0.6558)
  [Class IoU] C0: 0.7747200027881155 | C1: 0.9193 | C2: 0.7571 | C3: 0.1467
Epoch 27/400 | Train Loss: 35.5049
 Avg Train Loss: 35.5049 | Seg Loss: 0.3541 | Recon Loss: 0.0063
  Val mIoU: 0.5335 (Best: 0.6558)
  [Class IoU] C0: 0.637510938296099 | C1: 0.5961 | C2: 0.7398 | C3: 0.1607
Epoch 28/400 | Train Loss: 34.9961
 Avg Train Loss: 34.9961 | Seg Loss: 0.3493 | Recon Loss: 0.0063
  Val mIoU: 0.6401 (Best: 0.6558)
  [Class IoU] C0: 0.7589361197956072 | C1: 0.8939 | C2: 0.7530 | C3: 0.1546
Epoch 29/400 | Train Loss: 34.7101
 Avg Train Loss: 34.7101 | Seg Loss: 0.3464 | Recon Loss: 0.0061
  Val mIoU: 0.6605 (Best: 0.6558)
  [Class IoU] C0: 0.7796091565642512 | C1: 0.9189 | C2: 0.7636 | C3: 0.1800
  --> New Best Model Saved!
Epoch 30/400 | Train Loss: 34.6059
 Avg Train Loss: 34.6059 | Seg Loss: 0.3456 | Recon Loss: 0.0060
  Val mIoU: 0.5796 (Best: 0.6605)
  [Class IoU] C0: 0.6637766630472823 | C1: 0.8470 | C2: 0.6790 | C3: 0.1285
Epoch 31/400 | Train Loss: 34.8172
 Avg Train Loss: 34.8172 | Seg Loss: 0.3477 | Recon Loss: 0.0059
  Val mIoU: 0.4421 (Best: 0.6605)
  [Class IoU] C0: 0.42920811722683344 | C1: 0.3433 | C2: 0.7594 | C3: 0.2364
Epoch 32/400 | Train Loss: 35.0273
 Avg Train Loss: 35.0273 | Seg Loss: 0.3498 | Recon Loss: 0.0061
  Val mIoU: 0.6297 (Best: 0.6605)
  [Class IoU] C0: 0.7404782258147553 | C1: 0.9003 | C2: 0.7342 | C3: 0.1439
Epoch 33/400 | Train Loss: 34.3269
 Avg Train Loss: 34.3269 | Seg Loss: 0.3431 | Recon Loss: 0.0060
  Val mIoU: 0.6030 (Best: 0.6605)
  [Class IoU] C0: 0.7249278047476624 | C1: 0.7144 | C2: 0.7714 | C3: 0.2013
Epoch 34/400 | Train Loss: 34.0876
 Avg Train Loss: 34.0876 | Seg Loss: 0.3406 | Recon Loss: 0.0058
  Val mIoU: 0.5981 (Best: 0.6605)
  [Class IoU] C0: 0.6954787043778545 | C1: 0.7720 | C2: 0.7293 | C3: 0.1955
Epoch 35/400 | Train Loss: 33.8498
 Avg Train Loss: 33.8498 | Seg Loss: 0.3383 | Recon Loss: 0.0059
  Val mIoU: 0.6280 (Best: 0.6605)
  [Class IoU] C0: 0.6619305145086747 | C1: 0.5802 | C2: 0.8051 | C3: 0.4649
Epoch 36/400 | Train Loss: 33.7749
 Avg Train Loss: 33.7749 | Seg Loss: 0.3375 | Recon Loss: 0.0058
  Val mIoU: 0.6342 (Best: 0.6605)
  [Class IoU] C0: 0.7198662654398282 | C1: 0.7212 | C2: 0.7767 | C3: 0.3191
Epoch 37/400 | Train Loss: 33.4209
 Avg Train Loss: 33.4209 | Seg Loss: 0.3340 | Recon Loss: 0.0057
  Val mIoU: 0.6771 (Best: 0.6605)
  [Class IoU] C0: 0.7890535210508105 | C1: 0.8777 | C2: 0.7867 | C3: 0.2549
  --> New Best Model Saved!
Epoch 38/400 | Train Loss: 33.3748
 Avg Train Loss: 33.3748 | Seg Loss: 0.3336 | Recon Loss: 0.0057
  Val mIoU: 0.6789 (Best: 0.6771)
  [Class IoU] C0: 0.7789944350656558 | C1: 0.8900 | C2: 0.7765 | C3: 0.2702
  --> New Best Model Saved!
Epoch 39/400 | Train Loss: 33.8034
 Avg Train Loss: 33.8034 | Seg Loss: 0.3378 | Recon Loss: 0.0055
  Val mIoU: 0.6219 (Best: 0.6789)
  [Class IoU] C0: 0.6809383801592023 | C1: 0.9258 | C2: 0.6851 | C3: 0.1959
Epoch 40/400 | Train Loss: 33.9232
 Avg Train Loss: 33.9232 | Seg Loss: 0.3390 | Recon Loss: 0.0056
  Val mIoU: 0.6969 (Best: 0.6789)
  [Class IoU] C0: 0.7880490635718913 | C1: 0.9238 | C2: 0.7830 | C3: 0.2929
  --> New Best Model Saved!
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 33.4411
 Avg Train Loss: 33.4411 | Seg Loss: 0.3343 | Recon Loss: 0.0053
  Val mIoU: 0.7524 (Best: 0.6969)
  [Class IoU] C0: 0.8048020978133116 | C1: 0.9024 | C2: 0.8196 | C3: 0.4828
  --> New Best Model Saved!
Epoch 42/400 | Train Loss: 34.1526
 Avg Train Loss: 34.1526 | Seg Loss: 0.3413 | Recon Loss: 0.0056
  Val mIoU: 0.6507 (Best: 0.7524)
  [Class IoU] C0: 0.7444466260445335 | C1: 0.8612 | C2: 0.7512 | C3: 0.2458
Epoch 43/400 | Train Loss: 33.0134
 Avg Train Loss: 33.0134 | Seg Loss: 0.3300 | Recon Loss: 0.0056
  Val mIoU: 0.7295 (Best: 0.7524)
  [Class IoU] C0: 0.7866801066979977 | C1: 0.9084 | C2: 0.7955 | C3: 0.4273
Epoch 44/400 | Train Loss: 33.4093
 Avg Train Loss: 33.4093 | Seg Loss: 0.3338 | Recon Loss: 0.0055
  Val mIoU: 0.7066 (Best: 0.7524)
  [Class IoU] C0: 0.7874839083108294 | C1: 0.9118 | C2: 0.7852 | C3: 0.3420
Epoch 45/400 | Train Loss: 33.7652
 Avg Train Loss: 33.7652 | Seg Loss: 0.3374 | Recon Loss: 0.0055
  Val mIoU: 0.6600 (Best: 0.7524)
  [Class IoU] C0: 0.7579374949579255 | C1: 0.7854 | C2: 0.7878 | C3: 0.3089
Epoch 46/400 | Train Loss: 33.0364
 Avg Train Loss: 33.0364 | Seg Loss: 0.3301 | Recon Loss: 0.0055
  Val mIoU: 0.6553 (Best: 0.7524)
  [Class IoU] C0: 0.7627952919860103 | C1: 0.8715 | C2: 0.7607 | C3: 0.2263
Epoch 47/400 | Train Loss: 33.1319
 Avg Train Loss: 33.1319 | Seg Loss: 0.3311 | Recon Loss: 0.0055
  Val mIoU: 0.6961 (Best: 0.7524)
  [Class IoU] C0: 0.7859152169812961 | C1: 0.9254 | C2: 0.7805 | C3: 0.2927
Epoch 48/400 | Train Loss: 32.8095
 Avg Train Loss: 32.8095 | Seg Loss: 0.3278 | Recon Loss: 0.0053
  Val mIoU: 0.4937 (Best: 0.7524)
  [Class IoU] C0: 0.5754846384593926 | C1: 0.4675 | C2: 0.7763 | C3: 0.1555
Epoch 49/400 | Train Loss: 32.6922
 Avg Train Loss: 32.6922 | Seg Loss: 0.3268 | Recon Loss: 0.0056
  Val mIoU: 0.7066 (Best: 0.7524)
  [Class IoU] C0: 0.7973160904592951 | C1: 0.9193 | C2: 0.7899 | C3: 0.3198
Epoch 50/400 | Train Loss: 32.7174
 Avg Train Loss: 32.7174 | Seg Loss: 0.3270 | Recon Loss: 0.0053
  Val mIoU: 0.7139 (Best: 0.7524)
  [Class IoU] C0: 0.8012552632797049 | C1: 0.9217 | C2: 0.7978 | C3: 0.3348
Epoch 51/400 | Train Loss: 32.5597
 Avg Train Loss: 32.5597 | Seg Loss: 0.3255 | Recon Loss: 0.0053
  Val mIoU: 0.7241 (Best: 0.7524)
  [Class IoU] C0: 0.7720704203395059 | C1: 0.9188 | C2: 0.7845 | C3: 0.4211
Epoch 52/400 | Train Loss: 32.7783
 Avg Train Loss: 32.7783 | Seg Loss: 0.3276 | Recon Loss: 0.0052
  Val mIoU: 0.6953 (Best: 0.7524)
  [Class IoU] C0: 0.7879887001613253 | C1: 0.9148 | C2: 0.7885 | C3: 0.2899
Epoch 53/400 | Train Loss: 32.7506
 Avg Train Loss: 32.7506 | Seg Loss: 0.3274 | Recon Loss: 0.0054
  Val mIoU: 0.6940 (Best: 0.7524)
  [Class IoU] C0: 0.776049625888892 | C1: 0.9244 | C2: 0.7743 | C3: 0.3014
Epoch 54/400 | Train Loss: 32.6139
 Avg Train Loss: 32.6139 | Seg Loss: 0.3260 | Recon Loss: 0.0053
  Val mIoU: 0.6776 (Best: 0.7524)
  [Class IoU] C0: 0.6852647321254481 | C1: 0.9256 | C2: 0.7099 | C3: 0.3896
Epoch 55/400 | Train Loss: 32.2012
 Avg Train Loss: 32.2012 | Seg Loss: 0.3219 | Recon Loss: 0.0051
  Val mIoU: 0.7342 (Best: 0.7524)
  [Class IoU] C0: 0.7597609641606414 | C1: 0.9220 | C2: 0.7835 | C3: 0.4715
Epoch 56/400 | Train Loss: 31.7914
 Avg Train Loss: 31.7914 | Seg Loss: 0.3178 | Recon Loss: 0.0051
  Val mIoU: 0.6737 (Best: 0.7524)
  [Class IoU] C0: 0.7384717110701366 | C1: 0.9045 | C2: 0.7519 | C3: 0.2998
Epoch 57/400 | Train Loss: 32.1046
 Avg Train Loss: 32.1046 | Seg Loss: 0.3209 | Recon Loss: 0.0053
  Val mIoU: 0.6882 (Best: 0.7524)
  [Class IoU] C0: 0.7610872417102901 | C1: 0.9245 | C2: 0.7637 | C3: 0.3035
Epoch 58/400 | Train Loss: 31.9026
 Avg Train Loss: 31.9026 | Seg Loss: 0.3189 | Recon Loss: 0.0051
  Val mIoU: 0.7444 (Best: 0.7524)
  [Class IoU] C0: 0.8027519928363334 | C1: 0.9233 | C2: 0.8127 | C3: 0.4389
Epoch 59/400 | Train Loss: 32.9120
 Avg Train Loss: 32.9120 | Seg Loss: 0.3290 | Recon Loss: 0.0050
  Val mIoU: 0.7375 (Best: 0.7524)
  [Class IoU] C0: 0.8124254817748869 | C1: 0.9215 | C2: 0.8134 | C3: 0.4028
Epoch 60/400 | Train Loss: 32.4561
 Avg Train Loss: 32.4561 | Seg Loss: 0.3245 | Recon Loss: 0.0052
  Val mIoU: 0.7111 (Best: 0.7524)
  [Class IoU] C0: 0.7731418456689312 | C1: 0.8211 | C2: 0.8096 | C3: 0.4406
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 32.2206
 Avg Train Loss: 32.2206 | Seg Loss: 0.3221 | Recon Loss: 0.0051
  Val mIoU: 0.7781 (Best: 0.7524)
  [Class IoU] C0: 0.8042607875144526 | C1: 0.9273 | C2: 0.8235 | C3: 0.5573
  --> New Best Model Saved!
Epoch 62/400 | Train Loss: 32.2385
 Avg Train Loss: 32.2385 | Seg Loss: 0.3223 | Recon Loss: 0.0051
  Val mIoU: 0.7588 (Best: 0.7781)
  [Class IoU] C0: 0.8108008582896162 | C1: 0.9191 | C2: 0.8239 | C3: 0.4814
Epoch 63/400 | Train Loss: 31.9885
 Avg Train Loss: 31.9885 | Seg Loss: 0.3198 | Recon Loss: 0.0050
  Val mIoU: 0.7633 (Best: 0.7781)
  [Class IoU] C0: 0.8063627984270562 | C1: 0.9235 | C2: 0.8243 | C3: 0.4992
Epoch 64/400 | Train Loss: 32.0038
 Avg Train Loss: 32.0038 | Seg Loss: 0.3199 | Recon Loss: 0.0051
  Val mIoU: 0.7141 (Best: 0.7781)
  [Class IoU] C0: 0.7773209066144728 | C1: 0.9270 | C2: 0.7810 | C3: 0.3709
Epoch 65/400 | Train Loss: 32.2843
 Avg Train Loss: 32.2843 | Seg Loss: 0.3227 | Recon Loss: 0.0051
  Val mIoU: 0.6864 (Best: 0.7781)
  [Class IoU] C0: 0.7942095912278119 | C1: 0.9203 | C2: 0.7815 | C3: 0.2498
Epoch 66/400 | Train Loss: 32.2072
 Avg Train Loss: 32.2072 | Seg Loss: 0.3220 | Recon Loss: 0.0049
  Val mIoU: 0.5256 (Best: 0.7781)
  [Class IoU] C0: 0.6060774667054705 | C1: 0.3941 | C2: 0.7149 | C3: 0.3873
Epoch 67/400 | Train Loss: 31.7415
 Avg Train Loss: 31.7415 | Seg Loss: 0.3173 | Recon Loss: 0.0050
  Val mIoU: 0.4832 (Best: 0.7781)
  [Class IoU] C0: 0.5029783111554162 | C1: 0.3307 | C2: 0.7063 | C3: 0.3929
Epoch 68/400 | Train Loss: 31.9303
 Avg Train Loss: 31.9303 | Seg Loss: 0.3192 | Recon Loss: 0.0050
  Val mIoU: 0.5631 (Best: 0.7781)
  [Class IoU] C0: 0.654899604631657 | C1: 0.6304 | C2: 0.7429 | C3: 0.2244
Epoch 69/400 | Train Loss: 32.0625
 Avg Train Loss: 32.0625 | Seg Loss: 0.3205 | Recon Loss: 0.0048
  Val mIoU: 0.5596 (Best: 0.7781)
  [Class IoU] C0: 0.5303066152127907 | C1: 0.4155 | C2: 0.8157 | C3: 0.4768
Epoch 70/400 | Train Loss: 32.1848
 Avg Train Loss: 32.1848 | Seg Loss: 0.3217 | Recon Loss: 0.0051
  Val mIoU: 0.7258 (Best: 0.7781)
  [Class IoU] C0: 0.7719041727853858 | C1: 0.9234 | C2: 0.7835 | C3: 0.4243
Epoch 71/400 | Train Loss: 31.6235
 Avg Train Loss: 31.6235 | Seg Loss: 0.3161 | Recon Loss: 0.0048
  Val mIoU: 0.7192 (Best: 0.7781)
  [Class IoU] C0: 0.7951592110379759 | C1: 0.9076 | C2: 0.7968 | C3: 0.3773
Epoch 72/400 | Train Loss: 31.9636
 Avg Train Loss: 31.9636 | Seg Loss: 0.3195 | Recon Loss: 0.0049
  Val mIoU: 0.6484 (Best: 0.7781)
  [Class IoU] C0: 0.776551942740566 | C1: 0.8190 | C2: 0.7869 | C3: 0.2111
Epoch 73/400 | Train Loss: 31.6333
 Avg Train Loss: 31.6333 | Seg Loss: 0.3162 | Recon Loss: 0.0049
  Val mIoU: 0.7534 (Best: 0.7781)
  [Class IoU] C0: 0.808240590703133 | C1: 0.9155 | C2: 0.8200 | C3: 0.4699
Epoch 74/400 | Train Loss: 31.6758
 Avg Train Loss: 31.6758 | Seg Loss: 0.3167 | Recon Loss: 0.0048
  Val mIoU: 0.6562 (Best: 0.7781)
  [Class IoU] C0: 0.7451192849871465 | C1: 0.7272 | C2: 0.8063 | C3: 0.3461
Epoch 75/400 | Train Loss: 31.5960
 Avg Train Loss: 31.5960 | Seg Loss: 0.3159 | Recon Loss: 0.0049
  Val mIoU: 0.6909 (Best: 0.7781)
  [Class IoU] C0: 0.7930833250508524 | C1: 0.9234 | C2: 0.7830 | C3: 0.2641
Epoch 76/400 | Train Loss: 31.8416
 Avg Train Loss: 31.8416 | Seg Loss: 0.3183 | Recon Loss: 0.0048
  Val mIoU: 0.7069 (Best: 0.7781)
  [Class IoU] C0: 0.8082714440007914 | C1: 0.9224 | C2: 0.7973 | C3: 0.2996
Epoch 77/400 | Train Loss: 32.3578
 Avg Train Loss: 32.3578 | Seg Loss: 0.3235 | Recon Loss: 0.0048
  Val mIoU: 0.7070 (Best: 0.7781)
  [Class IoU] C0: 0.7602083087509984 | C1: 0.7572 | C2: 0.7662 | C3: 0.5445
Epoch 78/400 | Train Loss: 31.5036
 Avg Train Loss: 31.5036 | Seg Loss: 0.3150 | Recon Loss: 0.0046
  Val mIoU: 0.6700 (Best: 0.7781)
  [Class IoU] C0: 0.7764024205255544 | C1: 0.8596 | C2: 0.7782 | C3: 0.2658
Epoch 79/400 | Train Loss: 31.2786
 Avg Train Loss: 31.2786 | Seg Loss: 0.3127 | Recon Loss: 0.0048
  Val mIoU: 0.6772 (Best: 0.7781)
  [Class IoU] C0: 0.787805856226631 | C1: 0.8997 | C2: 0.7771 | C3: 0.2443
Epoch 80/400 | Train Loss: 31.2790
 Avg Train Loss: 31.2790 | Seg Loss: 0.3127 | Recon Loss: 0.0046
  Val mIoU: 0.6988 (Best: 0.7781)
  [Class IoU] C0: 0.799289142794177 | C1: 0.9194 | C2: 0.7889 | C3: 0.2877
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 31.3260
 Avg Train Loss: 31.3260 | Seg Loss: 0.3132 | Recon Loss: 0.0049
  Val mIoU: 0.5825 (Best: 0.7781)
  [Class IoU] C0: 0.6607320905947598 | C1: 0.5756 | C2: 0.8003 | C3: 0.2934
Epoch 82/400 | Train Loss: 31.3384
 Avg Train Loss: 31.3384 | Seg Loss: 0.3133 | Recon Loss: 0.0048
  Val mIoU: 0.6281 (Best: 0.7781)
  [Class IoU] C0: 0.6142614256360476 | C1: 0.5179 | C2: 0.8306 | C3: 0.5496
Epoch 83/400 | Train Loss: 30.9461
 Avg Train Loss: 30.9461 | Seg Loss: 0.3094 | Recon Loss: 0.0048
  Val mIoU: 0.7567 (Best: 0.7781)
  [Class IoU] C0: 0.8099411553445758 | C1: 0.9056 | C2: 0.8227 | C3: 0.4886
Epoch 84/400 | Train Loss: 31.9022
 Avg Train Loss: 31.9022 | Seg Loss: 0.3189 | Recon Loss: 0.0048
  Val mIoU: 0.5030 (Best: 0.7781)
  [Class IoU] C0: 0.5159887285997917 | C1: 0.4138 | C2: 0.7989 | C3: 0.2834
Epoch 85/400 | Train Loss: 31.3423
 Avg Train Loss: 31.3423 | Seg Loss: 0.3134 | Recon Loss: 0.0046
  Val mIoU: 0.5938 (Best: 0.7781)
  [Class IoU] C0: 0.5895561040866089 | C1: 0.4827 | C2: 0.8231 | C3: 0.4799
Epoch 86/400 | Train Loss: 31.0927
 Avg Train Loss: 31.0927 | Seg Loss: 0.3109 | Recon Loss: 0.0047
  Val mIoU: 0.7540 (Best: 0.7781)
  [Class IoU] C0: 0.8027720636894129 | C1: 0.9124 | C2: 0.8232 | C3: 0.4778
Epoch 87/400 | Train Loss: 30.9599
 Avg Train Loss: 30.9599 | Seg Loss: 0.3095 | Recon Loss: 0.0047
  Val mIoU: 0.7227 (Best: 0.7781)
  [Class IoU] C0: 0.8094131559996449 | C1: 0.9219 | C2: 0.8055 | C3: 0.3539
Epoch 88/400 | Train Loss: 31.4108
 Avg Train Loss: 31.4108 | Seg Loss: 0.3141 | Recon Loss: 0.0047
  Val mIoU: 0.6547 (Best: 0.7781)
  [Class IoU] C0: 0.7559188383740941 | C1: 0.8081 | C2: 0.7767 | C3: 0.2780
Epoch 89/400 | Train Loss: 31.0518
 Avg Train Loss: 31.0518 | Seg Loss: 0.3105 | Recon Loss: 0.0046
  Val mIoU: 0.7318 (Best: 0.7781)
  [Class IoU] C0: 0.8011818226986048 | C1: 0.9061 | C2: 0.8153 | C3: 0.4044
Epoch 90/400 | Train Loss: 31.4805
 Avg Train Loss: 31.4805 | Seg Loss: 0.3147 | Recon Loss: 0.0048
  Val mIoU: 0.7644 (Best: 0.7781)
  [Class IoU] C0: 0.8035980711257311 | C1: 0.9135 | C2: 0.8252 | C3: 0.5154
Epoch 91/400 | Train Loss: 30.6973
 Avg Train Loss: 30.6973 | Seg Loss: 0.3069 | Recon Loss: 0.0047
  Val mIoU: 0.7383 (Best: 0.7781)
  [Class IoU] C0: 0.8062808247185487 | C1: 0.9137 | C2: 0.8169 | C3: 0.4161
Epoch 92/400 | Train Loss: 31.1292
 Avg Train Loss: 31.1292 | Seg Loss: 0.3112 | Recon Loss: 0.0046
  Val mIoU: 0.7089 (Best: 0.7781)
  [Class IoU] C0: 0.8080988484067079 | C1: 0.9201 | C2: 0.8026 | C3: 0.3050
Epoch 93/400 | Train Loss: 30.8849
 Avg Train Loss: 30.8849 | Seg Loss: 0.3088 | Recon Loss: 0.0046
  Val mIoU: 0.7256 (Best: 0.7781)
  [Class IoU] C0: 0.8064298234440903 | C1: 0.9224 | C2: 0.8042 | C3: 0.3694
Epoch 94/400 | Train Loss: 30.7861
 Avg Train Loss: 30.7861 | Seg Loss: 0.3078 | Recon Loss: 0.0045
  Val mIoU: 0.6974 (Best: 0.7781)
  [Class IoU] C0: 0.7933526915516186 | C1: 0.9156 | C2: 0.7899 | C3: 0.2908
Epoch 95/400 | Train Loss: 30.9826
 Avg Train Loss: 30.9826 | Seg Loss: 0.3098 | Recon Loss: 0.0044
  Val mIoU: 0.7344 (Best: 0.7781)
  [Class IoU] C0: 0.8148628368009595 | C1: 0.9240 | C2: 0.8155 | C3: 0.3833
Epoch 96/400 | Train Loss: 31.2279
 Avg Train Loss: 31.2279 | Seg Loss: 0.3122 | Recon Loss: 0.0047
  Val mIoU: 0.7599 (Best: 0.7781)
  [Class IoU] C0: 0.8093557562653572 | C1: 0.9120 | C2: 0.8238 | C3: 0.4944
Epoch 97/400 | Train Loss: 31.2082
 Avg Train Loss: 31.2082 | Seg Loss: 0.3120 | Recon Loss: 0.0047
  Val mIoU: 0.7469 (Best: 0.7781)
  [Class IoU] C0: 0.8075549006486421 | C1: 0.9192 | C2: 0.8172 | C3: 0.4436
Epoch 98/400 | Train Loss: 31.0782
 Avg Train Loss: 31.0782 | Seg Loss: 0.3107 | Recon Loss: 0.0045
  Val mIoU: 0.5113 (Best: 0.7781)
  [Class IoU] C0: 0.5075323291281197 | C1: 0.3983 | C2: 0.7981 | C3: 0.3413
Epoch 99/400 | Train Loss: 31.2476
 Avg Train Loss: 31.2476 | Seg Loss: 0.3124 | Recon Loss: 0.0045
  Val mIoU: 0.7319 (Best: 0.7781)
  [Class IoU] C0: 0.7897489938042923 | C1: 0.9225 | C2: 0.7959 | C3: 0.4194
Epoch 100/400 | Train Loss: 31.3432
 Avg Train Loss: 31.3432 | Seg Loss: 0.3134 | Recon Loss: 0.0045
  Val mIoU: 0.7057 (Best: 0.7781)
  [Class IoU] C0: 0.7841679292433379 | C1: 0.9181 | C2: 0.7872 | C3: 0.3334
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 30.3624
 Avg Train Loss: 30.3624 | Seg Loss: 0.3036 | Recon Loss: 0.0047
  Val mIoU: 0.7692 (Best: 0.7781)
  [Class IoU] C0: 0.800866962416909 | C1: 0.9172 | C2: 0.8226 | C3: 0.5359
Epoch 102/400 | Train Loss: 30.6952
 Avg Train Loss: 30.6952 | Seg Loss: 0.3069 | Recon Loss: 0.0046
  Val mIoU: 0.7719 (Best: 0.7781)
  [Class IoU] C0: 0.8045992772288766 | C1: 0.9236 | C2: 0.8295 | C3: 0.5301
Epoch 103/400 | Train Loss: 30.4888
 Avg Train Loss: 30.4888 | Seg Loss: 0.3048 | Recon Loss: 0.0046
  Val mIoU: 0.7485 (Best: 0.7781)
  [Class IoU] C0: 0.8100402894070016 | C1: 0.9227 | C2: 0.8203 | C3: 0.4407
Epoch 104/400 | Train Loss: 31.8032
 Avg Train Loss: 31.8032 | Seg Loss: 0.3180 | Recon Loss: 0.0046
  Val mIoU: 0.7541 (Best: 0.7781)
  [Class IoU] C0: 0.8050480960548543 | C1: 0.9234 | C2: 0.8174 | C3: 0.4706
Epoch 105/400 | Train Loss: 30.7256
 Avg Train Loss: 30.7256 | Seg Loss: 0.3072 | Recon Loss: 0.0045
  Val mIoU: 0.7869 (Best: 0.7781)
  [Class IoU] C0: 0.8094734448618858 | C1: 0.9233 | C2: 0.8399 | C3: 0.5749
  --> New Best Model Saved!
Epoch 106/400 | Train Loss: 30.4366
 Avg Train Loss: 30.4366 | Seg Loss: 0.3043 | Recon Loss: 0.0046
  Val mIoU: 0.7579 (Best: 0.7869)
  [Class IoU] C0: 0.7933426226424004 | C1: 0.9201 | C2: 0.8120 | C3: 0.5061
Epoch 107/400 | Train Loss: 30.4414
 Avg Train Loss: 30.4414 | Seg Loss: 0.3044 | Recon Loss: 0.0045
  Val mIoU: 0.7272 (Best: 0.7869)
  [Class IoU] C0: 0.7952787510075571 | C1: 0.9236 | C2: 0.7991 | C3: 0.3907
Epoch 108/400 | Train Loss: 31.1790
 Avg Train Loss: 31.1790 | Seg Loss: 0.3117 | Recon Loss: 0.0046
  Val mIoU: 0.7754 (Best: 0.7869)
  [Class IoU] C0: 0.8036361205212931 | C1: 0.8977 | C2: 0.8318 | C3: 0.5685
Epoch 109/400 | Train Loss: 30.9319
 Avg Train Loss: 30.9319 | Seg Loss: 0.3093 | Recon Loss: 0.0045
  Val mIoU: 0.7745 (Best: 0.7869)
  [Class IoU] C0: 0.7982370906494394 | C1: 0.9248 | C2: 0.8227 | C3: 0.5523
Epoch 110/400 | Train Loss: 30.8713
 Avg Train Loss: 30.8713 | Seg Loss: 0.3087 | Recon Loss: 0.0045
  Val mIoU: 0.7826 (Best: 0.7869)
  [Class IoU] C0: 0.8061226922475125 | C1: 0.9094 | C2: 0.8346 | C3: 0.5805
Epoch 111/400 | Train Loss: 31.0386
 Avg Train Loss: 31.0386 | Seg Loss: 0.3103 | Recon Loss: 0.0044
  Val mIoU: 0.7563 (Best: 0.7869)
  [Class IoU] C0: 0.8062165748146801 | C1: 0.9198 | C2: 0.8186 | C3: 0.4804
Epoch 112/400 | Train Loss: 30.3867
 Avg Train Loss: 30.3867 | Seg Loss: 0.3038 | Recon Loss: 0.0045
  Val mIoU: 0.7620 (Best: 0.7869)
  [Class IoU] C0: 0.8023090579412014 | C1: 0.9240 | C2: 0.8183 | C3: 0.5032
Epoch 113/400 | Train Loss: 30.7959
 Avg Train Loss: 30.7959 | Seg Loss: 0.3079 | Recon Loss: 0.0046
  Val mIoU: 0.7722 (Best: 0.7869)
  [Class IoU] C0: 0.8141752799191389 | C1: 0.9240 | C2: 0.8316 | C3: 0.5191
Epoch 114/400 | Train Loss: 30.8362
 Avg Train Loss: 30.8362 | Seg Loss: 0.3083 | Recon Loss: 0.0045
  Val mIoU: 0.7687 (Best: 0.7869)
  [Class IoU] C0: 0.8073240503113599 | C1: 0.9013 | C2: 0.8341 | C3: 0.5322
Epoch 115/400 | Train Loss: 30.7207
 Avg Train Loss: 30.7207 | Seg Loss: 0.3072 | Recon Loss: 0.0046
  Val mIoU: 0.7221 (Best: 0.7869)
  [Class IoU] C0: 0.8079747798028757 | C1: 0.9235 | C2: 0.8097 | C3: 0.3473
Epoch 116/400 | Train Loss: 30.9964
 Avg Train Loss: 30.9964 | Seg Loss: 0.3099 | Recon Loss: 0.0046
  Val mIoU: 0.7510 (Best: 0.7869)
  [Class IoU] C0: 0.7960838652319784 | C1: 0.9170 | C2: 0.8240 | C3: 0.4670
Epoch 117/400 | Train Loss: 29.7790
 Avg Train Loss: 29.7790 | Seg Loss: 0.2977 | Recon Loss: 0.0045
  Val mIoU: 0.7712 (Best: 0.7869)
  [Class IoU] C0: 0.8098732968294402 | C1: 0.9233 | C2: 0.8333 | C3: 0.5182
Epoch 118/400 | Train Loss: 31.0215
 Avg Train Loss: 31.0215 | Seg Loss: 0.3102 | Recon Loss: 0.0044
  Val mIoU: 0.7581 (Best: 0.7869)
  [Class IoU] C0: 0.8014537709180192 | C1: 0.9154 | C2: 0.8218 | C3: 0.4937
Epoch 119/400 | Train Loss: 30.3864
 Avg Train Loss: 30.3864 | Seg Loss: 0.3038 | Recon Loss: 0.0046
  Val mIoU: 0.7653 (Best: 0.7869)
  [Class IoU] C0: 0.8088612787043483 | C1: 0.9247 | C2: 0.8238 | C3: 0.5037
Epoch 120/400 | Train Loss: 30.5451
 Avg Train Loss: 30.5451 | Seg Loss: 0.3054 | Recon Loss: 0.0046
  Val mIoU: 0.7940 (Best: 0.7869)
  [Class IoU] C0: 0.8135190950272078 | C1: 0.9244 | C2: 0.8449 | C3: 0.5933
  --> New Best Model Saved!
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 30.6059
 Avg Train Loss: 30.6059 | Seg Loss: 0.3060 | Recon Loss: 0.0045
  Val mIoU: 0.7486 (Best: 0.7940)
  [Class IoU] C0: 0.8010206386361595 | C1: 0.9219 | C2: 0.8121 | C3: 0.4596
Epoch 122/400 | Train Loss: 30.2245
 Avg Train Loss: 30.2245 | Seg Loss: 0.3022 | Recon Loss: 0.0045
  Val mIoU: 0.7827 (Best: 0.7940)
  [Class IoU] C0: 0.8123903399037857 | C1: 0.9162 | C2: 0.8407 | C3: 0.5615
Epoch 123/400 | Train Loss: 30.7315
 Avg Train Loss: 30.7315 | Seg Loss: 0.3073 | Recon Loss: 0.0044
  Val mIoU: 0.7785 (Best: 0.7940)
  [Class IoU] C0: 0.8115840667353568 | C1: 0.9204 | C2: 0.8349 | C3: 0.5472
Epoch 124/400 | Train Loss: 30.8721
 Avg Train Loss: 30.8721 | Seg Loss: 0.3087 | Recon Loss: 0.0045
  Val mIoU: 0.7010 (Best: 0.7940)
  [Class IoU] C0: 0.7205055835907676 | C1: 0.6682 | C2: 0.8373 | C3: 0.5779
Epoch 125/400 | Train Loss: 30.4422
 Avg Train Loss: 30.4422 | Seg Loss: 0.3044 | Recon Loss: 0.0046
  Val mIoU: 0.7669 (Best: 0.7940)
  [Class IoU] C0: 0.8027222102862118 | C1: 0.8821 | C2: 0.8366 | C3: 0.5461
Epoch 126/400 | Train Loss: 30.0115
 Avg Train Loss: 30.0115 | Seg Loss: 0.3001 | Recon Loss: 0.0045
  Val mIoU: 0.7950 (Best: 0.7940)
  [Class IoU] C0: 0.8110377385993437 | C1: 0.9250 | C2: 0.8430 | C3: 0.6008
  --> New Best Model Saved!
Epoch 127/400 | Train Loss: 30.4527
 Avg Train Loss: 30.4527 | Seg Loss: 0.3045 | Recon Loss: 0.0045
  Val mIoU: 0.7405 (Best: 0.7950)
  [Class IoU] C0: 0.7965295564188078 | C1: 0.8895 | C2: 0.8230 | C3: 0.4527
Epoch 128/400 | Train Loss: 30.6068
 Avg Train Loss: 30.6068 | Seg Loss: 0.3060 | Recon Loss: 0.0045
  Val mIoU: 0.7870 (Best: 0.7950)
  [Class IoU] C0: 0.8097008855442712 | C1: 0.9179 | C2: 0.8432 | C3: 0.5773
Epoch 129/400 | Train Loss: 30.3102
 Avg Train Loss: 30.3102 | Seg Loss: 0.3031 | Recon Loss: 0.0045
  Val mIoU: 0.7644 (Best: 0.7950)
  [Class IoU] C0: 0.8045198936179254 | C1: 0.8997 | C2: 0.8303 | C3: 0.5231
Epoch 130/400 | Train Loss: 30.5789
 Avg Train Loss: 30.5789 | Seg Loss: 0.3057 | Recon Loss: 0.0047
  Val mIoU: 0.7827 (Best: 0.7950)
  [Class IoU] C0: 0.8029366888403483 | C1: 0.8908 | C2: 0.8445 | C3: 0.5924
Epoch 131/400 | Train Loss: 30.6366
 Avg Train Loss: 30.6366 | Seg Loss: 0.3063 | Recon Loss: 0.0044
  Val mIoU: 0.7631 (Best: 0.7950)
  [Class IoU] C0: 0.8032948238525516 | C1: 0.8994 | C2: 0.8278 | C3: 0.5218
Epoch 132/400 | Train Loss: 30.5016
 Avg Train Loss: 30.5016 | Seg Loss: 0.3050 | Recon Loss: 0.0046
  Val mIoU: 0.7823 (Best: 0.7950)
  [Class IoU] C0: 0.7976861611025725 | C1: 0.9177 | C2: 0.8404 | C3: 0.5733
Epoch 133/400 | Train Loss: 30.4539
 Avg Train Loss: 30.4539 | Seg Loss: 0.3045 | Recon Loss: 0.0044
  Val mIoU: 0.7617 (Best: 0.7950)
  [Class IoU] C0: 0.7871098750519805 | C1: 0.8318 | C2: 0.8408 | C3: 0.5872
Epoch 134/400 | Train Loss: 30.3680
 Avg Train Loss: 30.3680 | Seg Loss: 0.3036 | Recon Loss: 0.0045
  Val mIoU: 0.7826 (Best: 0.7950)
  [Class IoU] C0: 0.8056520895650743 | C1: 0.9047 | C2: 0.8424 | C3: 0.5777
Epoch 135/400 | Train Loss: 30.5804
 Avg Train Loss: 30.5804 | Seg Loss: 0.3058 | Recon Loss: 0.0046
  Val mIoU: 0.7359 (Best: 0.7950)
  [Class IoU] C0: 0.7485835593882095 | C1: 0.7500 | C2: 0.8435 | C3: 0.6016
Epoch 136/400 | Train Loss: 30.9116
 Avg Train Loss: 30.9116 | Seg Loss: 0.3091 | Recon Loss: 0.0046
  Val mIoU: 0.7736 (Best: 0.7950)
  [Class IoU] C0: 0.8085707332981606 | C1: 0.9144 | C2: 0.8357 | C3: 0.5356
Epoch 137/400 | Train Loss: 30.3848
 Avg Train Loss: 30.3848 | Seg Loss: 0.3038 | Recon Loss: 0.0045
  Val mIoU: 0.7955 (Best: 0.7950)
  [Class IoU] C0: 0.8164998808399865 | C1: 0.9222 | C2: 0.8443 | C3: 0.5990
  --> New Best Model Saved!
Epoch 138/400 | Train Loss: 30.3949
 Avg Train Loss: 30.3949 | Seg Loss: 0.3039 | Recon Loss: 0.0044
  Val mIoU: 0.7686 (Best: 0.7955)
  [Class IoU] C0: 0.7988787023970491 | C1: 0.8903 | C2: 0.8362 | C3: 0.5489
Epoch 139/400 | Train Loss: 30.7379
 Avg Train Loss: 30.7379 | Seg Loss: 0.3073 | Recon Loss: 0.0045
  Val mIoU: 0.7803 (Best: 0.7955)
  [Class IoU] C0: 0.8084019668821414 | C1: 0.9213 | C2: 0.8367 | C3: 0.5549
Epoch 140/400 | Train Loss: 29.9997
 Avg Train Loss: 29.9997 | Seg Loss: 0.2999 | Recon Loss: 0.0045
  Val mIoU: 0.7934 (Best: 0.7955)
  [Class IoU] C0: 0.8139234090656298 | C1: 0.9245 | C2: 0.8443 | C3: 0.5909
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 30.1273
 Avg Train Loss: 30.1273 | Seg Loss: 0.3012 | Recon Loss: 0.0045
  Val mIoU: 0.7684 (Best: 0.7955)
  [Class IoU] C0: 0.810420459947586 | C1: 0.9232 | C2: 0.8279 | C3: 0.5122
Epoch 142/400 | Train Loss: 30.4533
 Avg Train Loss: 30.4533 | Seg Loss: 0.3045 | Recon Loss: 0.0046
  Val mIoU: 0.7695 (Best: 0.7955)
  [Class IoU] C0: 0.8108417037218076 | C1: 0.9206 | C2: 0.8315 | C3: 0.5152
Epoch 143/400 | Train Loss: 30.8876
 Avg Train Loss: 30.8876 | Seg Loss: 0.3088 | Recon Loss: 0.0045
  Val mIoU: 0.7843 (Best: 0.7955)
  [Class IoU] C0: 0.7847348127934614 | C1: 0.8926 | C2: 0.8429 | C3: 0.6170
Epoch 144/400 | Train Loss: 30.6318
 Avg Train Loss: 30.6318 | Seg Loss: 0.3063 | Recon Loss: 0.0044
  Val mIoU: 0.4843 (Best: 0.7955)
  [Class IoU] C0: 0.27199355742003034 | C1: 0.3100 | C2: 0.8163 | C3: 0.5388
Epoch 145/400 | Train Loss: 31.0008
 Avg Train Loss: 31.0008 | Seg Loss: 0.3100 | Recon Loss: 0.0045
  Val mIoU: 0.7614 (Best: 0.7955)
  [Class IoU] C0: 0.8073283078868899 | C1: 0.9175 | C2: 0.8269 | C3: 0.4937
Epoch 146/400 | Train Loss: 30.9199
 Avg Train Loss: 30.9199 | Seg Loss: 0.3091 | Recon Loss: 0.0045
  Val mIoU: 0.7519 (Best: 0.7955)
  [Class IoU] C0: 0.8086730478150119 | C1: 0.9251 | C2: 0.8195 | C3: 0.4545
Epoch 147/400 | Train Loss: 29.7863
 Avg Train Loss: 29.7863 | Seg Loss: 0.2978 | Recon Loss: 0.0045
  Val mIoU: 0.7644 (Best: 0.7955)
  [Class IoU] C0: 0.8082941255194028 | C1: 0.9178 | C2: 0.8304 | C3: 0.5010
Epoch 148/400 | Train Loss: 29.8749
 Avg Train Loss: 29.8749 | Seg Loss: 0.2987 | Recon Loss: 0.0044
  Val mIoU: 0.7586 (Best: 0.7955)
  [Class IoU] C0: 0.771138199015063 | C1: 0.9154 | C2: 0.8045 | C3: 0.5434
Epoch 149/400 | Train Loss: 30.4031
 Avg Train Loss: 30.4031 | Seg Loss: 0.3040 | Recon Loss: 0.0045
  Val mIoU: 0.7216 (Best: 0.7955)
  [Class IoU] C0: 0.7441386818767204 | C1: 0.7071 | C2: 0.8359 | C3: 0.5993
Epoch 150/400 | Train Loss: 30.0660
 Avg Train Loss: 30.0660 | Seg Loss: 0.3006 | Recon Loss: 0.0044
  Val mIoU: 0.7894 (Best: 0.7955)
  [Class IoU] C0: 0.8090011499713036 | C1: 0.9091 | C2: 0.8438 | C3: 0.5955
Epoch 151/400 | Train Loss: 30.4058
 Avg Train Loss: 30.4058 | Seg Loss: 0.3040 | Recon Loss: 0.0044
  Val mIoU: 0.7530 (Best: 0.7955)
  [Class IoU] C0: 0.8037714306959768 | C1: 0.9067 | C2: 0.8238 | C3: 0.4776
Epoch 152/400 | Train Loss: 30.4390
 Avg Train Loss: 30.4390 | Seg Loss: 0.3043 | Recon Loss: 0.0044
  Val mIoU: 0.7935 (Best: 0.7955)
  [Class IoU] C0: 0.8143339110377105 | C1: 0.9211 | C2: 0.8452 | C3: 0.5932
Epoch 153/400 | Train Loss: 30.2283
 Avg Train Loss: 30.2283 | Seg Loss: 0.3022 | Recon Loss: 0.0044
  Val mIoU: 0.7973 (Best: 0.7955)
  [Class IoU] C0: 0.812372037788544 | C1: 0.9208 | C2: 0.8480 | C3: 0.6078
  --> New Best Model Saved!
Epoch 154/400 | Train Loss: 30.1953
 Avg Train Loss: 30.1953 | Seg Loss: 0.3019 | Recon Loss: 0.0044
  Val mIoU: 0.7293 (Best: 0.7973)
  [Class IoU] C0: 0.7542931710734044 | C1: 0.7564 | C2: 0.8304 | C3: 0.5761
Epoch 155/400 | Train Loss: 30.1520
 Avg Train Loss: 30.1520 | Seg Loss: 0.3015 | Recon Loss: 0.0045
  Val mIoU: 0.7573 (Best: 0.7973)
  [Class IoU] C0: 0.7819209915213012 | C1: 0.8197 | C2: 0.8429 | C3: 0.5846
Epoch 156/400 | Train Loss: 30.2823
 Avg Train Loss: 30.2823 | Seg Loss: 0.3028 | Recon Loss: 0.0045
  Val mIoU: 0.7813 (Best: 0.7973)
  [Class IoU] C0: 0.8007465779021141 | C1: 0.8853 | C2: 0.8452 | C3: 0.5942
Epoch 157/400 | Train Loss: 30.0930
 Avg Train Loss: 30.0930 | Seg Loss: 0.3009 | Recon Loss: 0.0045
  Val mIoU: 0.7896 (Best: 0.7973)
  [Class IoU] C0: 0.8067392650021464 | C1: 0.9147 | C2: 0.8451 | C3: 0.5920
Epoch 158/400 | Train Loss: 30.0434
 Avg Train Loss: 30.0434 | Seg Loss: 0.3004 | Recon Loss: 0.0043
  Val mIoU: 0.7671 (Best: 0.7973)
  [Class IoU] C0: 0.7736805615348544 | C1: 0.8682 | C2: 0.8379 | C3: 0.5886
Epoch 159/400 | Train Loss: 29.9790
 Avg Train Loss: 29.9790 | Seg Loss: 0.2997 | Recon Loss: 0.0044
  Val mIoU: 0.5715 (Best: 0.7973)
  [Class IoU] C0: 0.5194792433534992 | C1: 0.4552 | C2: 0.8158 | C3: 0.4957
Epoch 160/400 | Train Loss: 30.7363
 Avg Train Loss: 30.7363 | Seg Loss: 0.3073 | Recon Loss: 0.0044
  Val mIoU: 0.7184 (Best: 0.7973)
  [Class IoU] C0: 0.728047075370657 | C1: 0.7157 | C2: 0.8383 | C3: 0.5916
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 29.9236
 Avg Train Loss: 29.9236 | Seg Loss: 0.2992 | Recon Loss: 0.0045
  Val mIoU: 0.7769 (Best: 0.7973)
  [Class IoU] C0: 0.8086838920013524 | C1: 0.9194 | C2: 0.8335 | C3: 0.5460
Epoch 162/400 | Train Loss: 30.0717
 Avg Train Loss: 30.0717 | Seg Loss: 0.3007 | Recon Loss: 0.0045
  Val mIoU: 0.7775 (Best: 0.7973)
  [Class IoU] C0: 0.8090447744571675 | C1: 0.9099 | C2: 0.8354 | C3: 0.5556
Epoch 163/400 | Train Loss: 30.4427
 Avg Train Loss: 30.4427 | Seg Loss: 0.3044 | Recon Loss: 0.0046
  Val mIoU: 0.7579 (Best: 0.7973)
  [Class IoU] C0: 0.7689640395011427 | C1: 0.8156 | C2: 0.8415 | C3: 0.6056
Epoch 164/400 | Train Loss: 29.8044
 Avg Train Loss: 29.8044 | Seg Loss: 0.2980 | Recon Loss: 0.0044
  Val mIoU: 0.7931 (Best: 0.7973)
  [Class IoU] C0: 0.8068641820184965 | C1: 0.9137 | C2: 0.8443 | C3: 0.6076
Epoch 165/400 | Train Loss: 30.3964
 Avg Train Loss: 30.3964 | Seg Loss: 0.3039 | Recon Loss: 0.0045
  Val mIoU: 0.7704 (Best: 0.7973)
  [Class IoU] C0: 0.8106172525318147 | C1: 0.9214 | C2: 0.8319 | C3: 0.5176
Epoch 166/400 | Train Loss: 29.8785
 Avg Train Loss: 29.8785 | Seg Loss: 0.2987 | Recon Loss: 0.0045
  Val mIoU: 0.7983 (Best: 0.7973)
  [Class IoU] C0: 0.8092761007578306 | C1: 0.9189 | C2: 0.8473 | C3: 0.6176
  --> New Best Model Saved!
Epoch 167/400 | Train Loss: 30.5411
 Avg Train Loss: 30.5411 | Seg Loss: 0.3054 | Recon Loss: 0.0045
  Val mIoU: 0.7850 (Best: 0.7983)
  [Class IoU] C0: 0.7985321882810643 | C1: 0.9214 | C2: 0.8253 | C3: 0.5947
Epoch 168/400 | Train Loss: 29.6464
 Avg Train Loss: 29.6464 | Seg Loss: 0.2964 | Recon Loss: 0.0043
  Val mIoU: 0.8016 (Best: 0.7983)
  [Class IoU] C0: 0.8142415167886539 | C1: 0.9222 | C2: 0.8508 | C3: 0.6190
  --> New Best Model Saved!
Epoch 169/400 | Train Loss: 30.2132
 Avg Train Loss: 30.2132 | Seg Loss: 0.3021 | Recon Loss: 0.0045
  Val mIoU: 0.7746 (Best: 0.8016)
  [Class IoU] C0: 0.8085706748733471 | C1: 0.9058 | C2: 0.8345 | C3: 0.5493
Epoch 170/400 | Train Loss: 30.4231
 Avg Train Loss: 30.4231 | Seg Loss: 0.3042 | Recon Loss: 0.0045
  Val mIoU: 0.7938 (Best: 0.8016)
  [Class IoU] C0: 0.8097664323520818 | C1: 0.9186 | C2: 0.8479 | C3: 0.5990
Epoch 171/400 | Train Loss: 29.8111
 Avg Train Loss: 29.8111 | Seg Loss: 0.2981 | Recon Loss: 0.0044
  Val mIoU: 0.7610 (Best: 0.8016)
  [Class IoU] C0: 0.8017565575718555 | C1: 0.9044 | C2: 0.8312 | C3: 0.5068
Epoch 172/400 | Train Loss: 31.0656
 Avg Train Loss: 31.0656 | Seg Loss: 0.3106 | Recon Loss: 0.0045
  Val mIoU: 0.8055 (Best: 0.8016)
  [Class IoU] C0: 0.81392899480346 | C1: 0.9218 | C2: 0.8536 | C3: 0.6327
  --> New Best Model Saved!
Epoch 173/400 | Train Loss: 30.3201
 Avg Train Loss: 30.3201 | Seg Loss: 0.3032 | Recon Loss: 0.0046
  Val mIoU: 0.7758 (Best: 0.8055)
  [Class IoU] C0: 0.809772670802923 | C1: 0.9183 | C2: 0.8368 | C3: 0.5382
Epoch 174/400 | Train Loss: 30.6062
 Avg Train Loss: 30.6062 | Seg Loss: 0.3060 | Recon Loss: 0.0044
  Val mIoU: 0.7380 (Best: 0.8055)
  [Class IoU] C0: 0.7444561738430152 | C1: 0.7457 | C2: 0.8474 | C3: 0.6143
Epoch 175/400 | Train Loss: 30.1253
 Avg Train Loss: 30.1253 | Seg Loss: 0.3012 | Recon Loss: 0.0045
  Val mIoU: 0.7944 (Best: 0.8055)
  [Class IoU] C0: 0.8106264453901065 | C1: 0.9205 | C2: 0.8428 | C3: 0.6035
Epoch 176/400 | Train Loss: 29.3422
 Avg Train Loss: 29.3422 | Seg Loss: 0.2934 | Recon Loss: 0.0044
  Val mIoU: 0.7797 (Best: 0.8055)
  [Class IoU] C0: 0.8156100012923 | C1: 0.9228 | C2: 0.8358 | C3: 0.5444
Epoch 177/400 | Train Loss: 30.2498
 Avg Train Loss: 30.2498 | Seg Loss: 0.3025 | Recon Loss: 0.0044
  Val mIoU: 0.7943 (Best: 0.8055)
  [Class IoU] C0: 0.7979185333036456 | C1: 0.9105 | C2: 0.8489 | C3: 0.6199
Epoch 178/400 | Train Loss: 30.4449
 Avg Train Loss: 30.4449 | Seg Loss: 0.3044 | Recon Loss: 0.0044
  Val mIoU: 0.7989 (Best: 0.8055)
  [Class IoU] C0: 0.8045171070813277 | C1: 0.9168 | C2: 0.8517 | C3: 0.6227
Epoch 179/400 | Train Loss: 30.5943
 Avg Train Loss: 30.5943 | Seg Loss: 0.3059 | Recon Loss: 0.0045
  Val mIoU: 0.7981 (Best: 0.8055)
  [Class IoU] C0: 0.811138773575532 | C1: 0.9131 | C2: 0.8452 | C3: 0.6229
Epoch 180/400 | Train Loss: 30.5746
 Avg Train Loss: 30.5746 | Seg Loss: 0.3057 | Recon Loss: 0.0044
  Val mIoU: 0.7925 (Best: 0.8055)
  [Class IoU] C0: 0.8080934476401882 | C1: 0.9216 | C2: 0.8418 | C3: 0.5986
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 29.7742
 Avg Train Loss: 29.7742 | Seg Loss: 0.2977 | Recon Loss: 0.0045
  Val mIoU: 0.7668 (Best: 0.8055)
  [Class IoU] C0: 0.782707955977928 | C1: 0.8489 | C2: 0.8489 | C3: 0.5867
Epoch 182/400 | Train Loss: 30.0759
 Avg Train Loss: 30.0759 | Seg Loss: 0.3007 | Recon Loss: 0.0045
  Val mIoU: 0.7697 (Best: 0.8055)
  [Class IoU] C0: 0.7906654691777577 | C1: 0.8570 | C2: 0.8374 | C3: 0.5938
Epoch 183/400 | Train Loss: 29.7661
 Avg Train Loss: 29.7661 | Seg Loss: 0.2976 | Recon Loss: 0.0046
  Val mIoU: 0.7771 (Best: 0.8055)
  [Class IoU] C0: 0.8005073057126184 | C1: 0.9082 | C2: 0.8311 | C3: 0.5684
Epoch 184/400 | Train Loss: 30.1141
 Avg Train Loss: 30.1141 | Seg Loss: 0.3011 | Recon Loss: 0.0045
  Val mIoU: 0.7242 (Best: 0.8055)
  [Class IoU] C0: 0.7398465074246124 | C1: 0.7202 | C2: 0.8451 | C3: 0.5917
Epoch 185/400 | Train Loss: 29.7422
 Avg Train Loss: 29.7422 | Seg Loss: 0.2974 | Recon Loss: 0.0044
  Val mIoU: 0.7953 (Best: 0.8055)
  [Class IoU] C0: 0.8135809850479635 | C1: 0.9154 | C2: 0.8510 | C3: 0.6013
Epoch 186/400 | Train Loss: 30.0220
 Avg Train Loss: 30.0220 | Seg Loss: 0.3002 | Recon Loss: 0.0045
  Val mIoU: 0.7858 (Best: 0.8055)
  [Class IoU] C0: 0.8120184730197328 | C1: 0.9139 | C2: 0.8468 | C3: 0.5705
Epoch 187/400 | Train Loss: 30.4911
 Avg Train Loss: 30.4911 | Seg Loss: 0.3049 | Recon Loss: 0.0044
  Val mIoU: 0.7817 (Best: 0.8055)
  [Class IoU] C0: 0.8047479790223929 | C1: 0.9239 | C2: 0.8300 | C3: 0.5682
Epoch 188/400 | Train Loss: 29.9868
 Avg Train Loss: 29.9868 | Seg Loss: 0.2998 | Recon Loss: 0.0044
  Val mIoU: 0.7767 (Best: 0.8055)
  [Class IoU] C0: 0.8086188567651438 | C1: 0.9235 | C2: 0.8301 | C3: 0.5445
Epoch 189/400 | Train Loss: 29.7856
 Avg Train Loss: 29.7856 | Seg Loss: 0.2978 | Recon Loss: 0.0043
  Val mIoU: 0.7574 (Best: 0.8055)
  [Class IoU] C0: 0.7799631209817786 | C1: 0.8098 | C2: 0.8458 | C3: 0.5942
Epoch 190/400 | Train Loss: 29.1917
 Avg Train Loss: 29.1917 | Seg Loss: 0.2919 | Recon Loss: 0.0044
  Val mIoU: 0.7938 (Best: 0.8055)
  [Class IoU] C0: 0.8125420266041856 | C1: 0.9227 | C2: 0.8415 | C3: 0.5982
Epoch 191/400 | Train Loss: 30.7757
 Avg Train Loss: 30.7757 | Seg Loss: 0.3077 | Recon Loss: 0.0046
  Val mIoU: 0.7785 (Best: 0.8055)
  [Class IoU] C0: 0.814261619844243 | C1: 0.9189 | C2: 0.8365 | C3: 0.5444
Epoch 192/400 | Train Loss: 30.2257
 Avg Train Loss: 30.2257 | Seg Loss: 0.3022 | Recon Loss: 0.0044
  Val mIoU: 0.7858 (Best: 0.8055)
  [Class IoU] C0: 0.8095365027969076 | C1: 0.9222 | C2: 0.8369 | C3: 0.5747
Epoch 193/400 | Train Loss: 28.7942
 Avg Train Loss: 28.7942 | Seg Loss: 0.2879 | Recon Loss: 0.0045
  Val mIoU: 0.8116 (Best: 0.8055)
  [Class IoU] C0: 0.818018102646987 | C1: 0.9239 | C2: 0.8578 | C3: 0.6466
  --> New Best Model Saved!
Epoch 194/400 | Train Loss: 29.7213
 Avg Train Loss: 29.7213 | Seg Loss: 0.2972 | Recon Loss: 0.0045
  Val mIoU: 0.8037 (Best: 0.8116)
  [Class IoU] C0: 0.8239648323070611 | C1: 0.9236 | C2: 0.8539 | C3: 0.6132
Epoch 195/400 | Train Loss: 29.9061
 Avg Train Loss: 29.9061 | Seg Loss: 0.2990 | Recon Loss: 0.0043
  Val mIoU: 0.7728 (Best: 0.8116)
  [Class IoU] C0: 0.813048478885225 | C1: 0.9241 | C2: 0.8296 | C3: 0.5246
Epoch 196/400 | Train Loss: 29.9619
 Avg Train Loss: 29.9619 | Seg Loss: 0.2996 | Recon Loss: 0.0045
  Val mIoU: 0.7951 (Best: 0.8116)
  [Class IoU] C0: 0.8204619769872559 | C1: 0.9229 | C2: 0.8479 | C3: 0.5890
Epoch 197/400 | Train Loss: 29.7234
 Avg Train Loss: 29.7234 | Seg Loss: 0.2972 | Recon Loss: 0.0045
  Val mIoU: 0.7875 (Best: 0.8116)
  [Class IoU] C0: 0.8180871561485188 | C1: 0.9205 | C2: 0.8392 | C3: 0.5723
Epoch 198/400 | Train Loss: 30.7111
 Avg Train Loss: 30.7111 | Seg Loss: 0.3071 | Recon Loss: 0.0044
  Val mIoU: 0.8092 (Best: 0.8116)
  [Class IoU] C0: 0.8151863099678227 | C1: 0.9238 | C2: 0.8561 | C3: 0.6418
Epoch 199/400 | Train Loss: 30.1325
 Avg Train Loss: 30.1325 | Seg Loss: 0.3013 | Recon Loss: 0.0044
  Val mIoU: 0.8003 (Best: 0.8116)
  [Class IoU] C0: 0.815099119118837 | C1: 0.9233 | C2: 0.8494 | C3: 0.6133
Epoch 200/400 | Train Loss: 30.0917
 Avg Train Loss: 30.0917 | Seg Loss: 0.3009 | Recon Loss: 0.0045
  Val mIoU: 0.8068 (Best: 0.8116)
  [Class IoU] C0: 0.8193969098464207 | C1: 0.9224 | C2: 0.8553 | C3: 0.6303
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 29.6604
 Avg Train Loss: 29.6604 | Seg Loss: 0.2966 | Recon Loss: 0.0044
  Val mIoU: 0.8022 (Best: 0.8116)
  [Class IoU] C0: 0.8170520083579529 | C1: 0.9180 | C2: 0.8543 | C3: 0.6193
Epoch 202/400 | Train Loss: 29.5973
 Avg Train Loss: 29.5973 | Seg Loss: 0.2959 | Recon Loss: 0.0045
  Val mIoU: 0.7984 (Best: 0.8116)
  [Class IoU] C0: 0.8192099665304002 | C1: 0.9221 | C2: 0.8515 | C3: 0.6008
Epoch 203/400 | Train Loss: 29.7344
 Avg Train Loss: 29.7344 | Seg Loss: 0.2973 | Recon Loss: 0.0045
  Val mIoU: 0.7684 (Best: 0.8116)
  [Class IoU] C0: 0.8131291730502114 | C1: 0.9144 | C2: 0.8300 | C3: 0.5160
Epoch 204/400 | Train Loss: 29.7787
 Avg Train Loss: 29.7787 | Seg Loss: 0.2977 | Recon Loss: 0.0043
  Val mIoU: 0.7771 (Best: 0.8116)
  [Class IoU] C0: 0.8074095046581476 | C1: 0.9199 | C2: 0.8414 | C3: 0.5399
Epoch 205/400 | Train Loss: 30.2353
 Avg Train Loss: 30.2353 | Seg Loss: 0.3023 | Recon Loss: 0.0045
  Val mIoU: 0.7841 (Best: 0.8116)
  [Class IoU] C0: 0.8129237057691256 | C1: 0.9149 | C2: 0.8438 | C3: 0.5646
Epoch 206/400 | Train Loss: 29.7397
 Avg Train Loss: 29.7397 | Seg Loss: 0.2973 | Recon Loss: 0.0045
  Val mIoU: 0.7855 (Best: 0.8116)
  [Class IoU] C0: 0.8151115348990483 | C1: 0.9199 | C2: 0.8438 | C3: 0.5630
Epoch 207/400 | Train Loss: 30.3057
 Avg Train Loss: 30.3057 | Seg Loss: 0.3030 | Recon Loss: 0.0044
  Val mIoU: 0.7674 (Best: 0.8116)
  [Class IoU] C0: 0.7960819629556509 | C1: 0.9213 | C2: 0.8209 | C3: 0.5316
Epoch 208/400 | Train Loss: 29.7537
 Avg Train Loss: 29.7537 | Seg Loss: 0.2975 | Recon Loss: 0.0044
  Val mIoU: 0.7777 (Best: 0.8116)
  [Class IoU] C0: 0.8137667678604082 | C1: 0.9211 | C2: 0.8360 | C3: 0.5400
Epoch 209/400 | Train Loss: 29.2760
 Avg Train Loss: 29.2760 | Seg Loss: 0.2927 | Recon Loss: 0.0044
  Val mIoU: 0.7876 (Best: 0.8116)
  [Class IoU] C0: 0.8125995508093404 | C1: 0.9145 | C2: 0.8408 | C3: 0.5825
Epoch 210/400 | Train Loss: 30.3201
 Avg Train Loss: 30.3201 | Seg Loss: 0.3032 | Recon Loss: 0.0044
  Val mIoU: 0.7905 (Best: 0.8116)
  [Class IoU] C0: 0.8135998591233209 | C1: 0.9117 | C2: 0.8464 | C3: 0.5904
Epoch 211/400 | Train Loss: 29.7700
 Avg Train Loss: 29.7700 | Seg Loss: 0.2977 | Recon Loss: 0.0045
  Val mIoU: 0.7968 (Best: 0.8116)
  [Class IoU] C0: 0.8092917448253734 | C1: 0.9142 | C2: 0.8503 | C3: 0.6133
Epoch 212/400 | Train Loss: 29.9443
 Avg Train Loss: 29.9443 | Seg Loss: 0.2994 | Recon Loss: 0.0046
  Val mIoU: 0.7905 (Best: 0.8116)
  [Class IoU] C0: 0.811585609887952 | C1: 0.9086 | C2: 0.8440 | C3: 0.5977
Epoch 213/400 | Train Loss: 30.0963
 Avg Train Loss: 30.0963 | Seg Loss: 0.3009 | Recon Loss: 0.0044
  Val mIoU: 0.7833 (Best: 0.8116)
  [Class IoU] C0: 0.8041361983062875 | C1: 0.8930 | C2: 0.8425 | C3: 0.5936
Epoch 214/400 | Train Loss: 29.7768
 Avg Train Loss: 29.7768 | Seg Loss: 0.2977 | Recon Loss: 0.0044
  Val mIoU: 0.7915 (Best: 0.8116)
  [Class IoU] C0: 0.8132442795237235 | C1: 0.9224 | C2: 0.8472 | C3: 0.5830
Epoch 215/400 | Train Loss: 29.7596
 Avg Train Loss: 29.7596 | Seg Loss: 0.2975 | Recon Loss: 0.0045
  Val mIoU: 0.7722 (Best: 0.8116)
  [Class IoU] C0: 0.8156046999946901 | C1: 0.9207 | C2: 0.8340 | C3: 0.5183
Epoch 216/400 | Train Loss: 30.1074
 Avg Train Loss: 30.1074 | Seg Loss: 0.3010 | Recon Loss: 0.0045
  Val mIoU: 0.7828 (Best: 0.8116)
  [Class IoU] C0: 0.8155833057668089 | C1: 0.9206 | C2: 0.8416 | C3: 0.5534
Epoch 217/400 | Train Loss: 30.3490
 Avg Train Loss: 30.3490 | Seg Loss: 0.3034 | Recon Loss: 0.0045
  Val mIoU: 0.7802 (Best: 0.8116)
  [Class IoU] C0: 0.8143661006968433 | C1: 0.9234 | C2: 0.8400 | C3: 0.5431
Epoch 218/400 | Train Loss: 29.6675
 Avg Train Loss: 29.6675 | Seg Loss: 0.2966 | Recon Loss: 0.0045
  Val mIoU: 0.7931 (Best: 0.8116)
  [Class IoU] C0: 0.8126836164816486 | C1: 0.9236 | C2: 0.8480 | C3: 0.5882
Epoch 219/400 | Train Loss: 29.9292
 Avg Train Loss: 29.9292 | Seg Loss: 0.2992 | Recon Loss: 0.0045
  Val mIoU: 0.7935 (Best: 0.8116)
  [Class IoU] C0: 0.8103780012774241 | C1: 0.9166 | C2: 0.8483 | C3: 0.5989
Epoch 220/400 | Train Loss: 29.6820
 Avg Train Loss: 29.6820 | Seg Loss: 0.2968 | Recon Loss: 0.0044
  Val mIoU: 0.5765 (Best: 0.8116)
  [Class IoU] C0: 0.4448699444233105 | C1: 0.4154 | C2: 0.8266 | C3: 0.6191
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 30.1373
 Avg Train Loss: 30.1373 | Seg Loss: 0.3013 | Recon Loss: 0.0044
  Val mIoU: 0.8067 (Best: 0.8116)
  [Class IoU] C0: 0.8236062785766478 | C1: 0.9228 | C2: 0.8553 | C3: 0.6253
Epoch 222/400 | Train Loss: 29.3420
 Avg Train Loss: 29.3420 | Seg Loss: 0.2934 | Recon Loss: 0.0044
  Val mIoU: 0.7735 (Best: 0.8116)
  [Class IoU] C0: 0.8131126867666622 | C1: 0.9169 | C2: 0.8372 | C3: 0.5268
Epoch 223/400 | Train Loss: 29.8689
 Avg Train Loss: 29.8689 | Seg Loss: 0.2986 | Recon Loss: 0.0044
  Val mIoU: 0.7955 (Best: 0.8116)
  [Class IoU] C0: 0.8023497071527927 | C1: 0.9104 | C2: 0.8525 | C3: 0.6166
Epoch 224/400 | Train Loss: 30.1775
 Avg Train Loss: 30.1775 | Seg Loss: 0.3017 | Recon Loss: 0.0044
  Val mIoU: 0.7664 (Best: 0.8116)
  [Class IoU] C0: 0.790016781134667 | C1: 0.8922 | C2: 0.8360 | C3: 0.5475
Epoch 225/400 | Train Loss: 30.1277
 Avg Train Loss: 30.1277 | Seg Loss: 0.3012 | Recon Loss: 0.0045
  Val mIoU: 0.7869 (Best: 0.8116)
  [Class IoU] C0: 0.8097938303334671 | C1: 0.9208 | C2: 0.8452 | C3: 0.5720
Epoch 226/400 | Train Loss: 29.4940
 Avg Train Loss: 29.4940 | Seg Loss: 0.2949 | Recon Loss: 0.0044
  Val mIoU: 0.7902 (Best: 0.8116)
  [Class IoU] C0: 0.784925587500807 | C1: 0.9059 | C2: 0.8508 | C3: 0.6192
Epoch 227/400 | Train Loss: 29.7928
 Avg Train Loss: 29.7928 | Seg Loss: 0.2979 | Recon Loss: 0.0044
  Val mIoU: 0.7976 (Best: 0.8116)
  [Class IoU] C0: 0.7943554224395702 | C1: 0.9186 | C2: 0.8542 | C3: 0.6231
Epoch 228/400 | Train Loss: 29.5166
 Avg Train Loss: 29.5166 | Seg Loss: 0.2951 | Recon Loss: 0.0043
  Val mIoU: 0.7871 (Best: 0.8116)
  [Class IoU] C0: 0.787966810456273 | C1: 0.8911 | C2: 0.8508 | C3: 0.6185
Epoch 229/400 | Train Loss: 29.7443
 Avg Train Loss: 29.7443 | Seg Loss: 0.2974 | Recon Loss: 0.0044
  Val mIoU: 0.7975 (Best: 0.8116)
  [Class IoU] C0: 0.8149834736080931 | C1: 0.9169 | C2: 0.8530 | C3: 0.6051
Epoch 230/400 | Train Loss: 29.9575
 Avg Train Loss: 29.9575 | Seg Loss: 0.2995 | Recon Loss: 0.0045
  Val mIoU: 0.7229 (Best: 0.8116)
  [Class IoU] C0: 0.7357199944230216 | C1: 0.7352 | C2: 0.8418 | C3: 0.5790
Epoch 231/400 | Train Loss: 30.2637
 Avg Train Loss: 30.2637 | Seg Loss: 0.3026 | Recon Loss: 0.0045
  Val mIoU: 0.7905 (Best: 0.8116)
  [Class IoU] C0: 0.8037276879612264 | C1: 0.9108 | C2: 0.8513 | C3: 0.5961
Epoch 232/400 | Train Loss: 30.1170
 Avg Train Loss: 30.1170 | Seg Loss: 0.3011 | Recon Loss: 0.0044
  Val mIoU: 0.6308 (Best: 0.8116)
  [Class IoU] C0: 0.5735957659283302 | C1: 0.5127 | C2: 0.8376 | C3: 0.5994
Epoch 233/400 | Train Loss: 29.8281
 Avg Train Loss: 29.8281 | Seg Loss: 0.2982 | Recon Loss: 0.0044
  Val mIoU: 0.7846 (Best: 0.8116)
  [Class IoU] C0: 0.8140711228102795 | C1: 0.9162 | C2: 0.8440 | C3: 0.5643
Epoch 234/400 | Train Loss: 29.5354
 Avg Train Loss: 29.5354 | Seg Loss: 0.2953 | Recon Loss: 0.0044
  Val mIoU: 0.7845 (Best: 0.8116)
  [Class IoU] C0: 0.7870235785381516 | C1: 0.9052 | C2: 0.8454 | C3: 0.6005
Epoch 235/400 | Train Loss: 30.7610
 Avg Train Loss: 30.7610 | Seg Loss: 0.3076 | Recon Loss: 0.0046
  Val mIoU: 0.7762 (Best: 0.8116)
  [Class IoU] C0: 0.8037665642507392 | C1: 0.9127 | C2: 0.8392 | C3: 0.5493
Epoch 236/400 | Train Loss: 29.8252
 Avg Train Loss: 29.8252 | Seg Loss: 0.2982 | Recon Loss: 0.0044
  Val mIoU: 0.7919 (Best: 0.8116)
  [Class IoU] C0: 0.7964344216306559 | C1: 0.9069 | C2: 0.8511 | C3: 0.6134
Epoch 237/400 | Train Loss: 30.2388
 Avg Train Loss: 30.2388 | Seg Loss: 0.3023 | Recon Loss: 0.0043
  Val mIoU: 0.7991 (Best: 0.8116)
  [Class IoU] C0: 0.8187129732458355 | C1: 0.9218 | C2: 0.8534 | C3: 0.6027
Epoch 238/400 | Train Loss: 29.5211
 Avg Train Loss: 29.5211 | Seg Loss: 0.2952 | Recon Loss: 0.0044
  Val mIoU: 0.7944 (Best: 0.8116)
  [Class IoU] C0: 0.81122391616736 | C1: 0.9207 | C2: 0.8513 | C3: 0.5941
Epoch 239/400 | Train Loss: 29.2647
 Avg Train Loss: 29.2647 | Seg Loss: 0.2926 | Recon Loss: 0.0044
  Val mIoU: 0.7916 (Best: 0.8116)
  [Class IoU] C0: 0.8133100624773398 | C1: 0.9160 | C2: 0.8507 | C3: 0.5863
Epoch 240/400 | Train Loss: 30.0779
 Avg Train Loss: 30.0779 | Seg Loss: 0.3007 | Recon Loss: 0.0043
  Val mIoU: 0.7875 (Best: 0.8116)
  [Class IoU] C0: 0.8037513343989352 | C1: 0.9175 | C2: 0.8465 | C3: 0.5823
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 29.6898
 Avg Train Loss: 29.6898 | Seg Loss: 0.2969 | Recon Loss: 0.0046
  Val mIoU: 0.7948 (Best: 0.8116)
  [Class IoU] C0: 0.796696693566133 | C1: 0.9040 | C2: 0.8539 | C3: 0.6245
Epoch 242/400 | Train Loss: 29.9761
 Avg Train Loss: 29.9761 | Seg Loss: 0.2997 | Recon Loss: 0.0045
  Val mIoU: 0.7729 (Best: 0.8116)
  [Class IoU] C0: 0.8154786178637254 | C1: 0.9199 | C2: 0.8374 | C3: 0.5187
Epoch 243/400 | Train Loss: 29.7218
 Avg Train Loss: 29.7218 | Seg Loss: 0.2972 | Recon Loss: 0.0044
  Val mIoU: 0.7879 (Best: 0.8116)
  [Class IoU] C0: 0.8114870593282889 | C1: 0.9107 | C2: 0.8453 | C3: 0.5842
Epoch 244/400 | Train Loss: 29.5992
 Avg Train Loss: 29.5992 | Seg Loss: 0.2959 | Recon Loss: 0.0045
  Val mIoU: 0.7883 (Best: 0.8116)
  [Class IoU] C0: 0.8114812079774756 | C1: 0.9101 | C2: 0.8476 | C3: 0.5839
Epoch 245/400 | Train Loss: 29.6312
 Avg Train Loss: 29.6312 | Seg Loss: 0.2963 | Recon Loss: 0.0044
  Val mIoU: 0.7896 (Best: 0.8116)
  [Class IoU] C0: 0.7917809665348126 | C1: 0.9168 | C2: 0.8451 | C3: 0.6047
Epoch 246/400 | Train Loss: 29.2194
 Avg Train Loss: 29.2194 | Seg Loss: 0.2922 | Recon Loss: 0.0043
  Val mIoU: 0.7703 (Best: 0.8116)
  [Class IoU] C0: 0.8101781742624365 | C1: 0.9107 | C2: 0.8372 | C3: 0.5232
Epoch 247/400 | Train Loss: 29.2159
 Avg Train Loss: 29.2159 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.7563 (Best: 0.8116)
  [Class IoU] C0: 0.7550503606487106 | C1: 0.8127 | C2: 0.8488 | C3: 0.6088
Epoch 248/400 | Train Loss: 29.8777
 Avg Train Loss: 29.8777 | Seg Loss: 0.2987 | Recon Loss: 0.0044
  Val mIoU: 0.7888 (Best: 0.8116)
  [Class IoU] C0: 0.8089287919518524 | C1: 0.9205 | C2: 0.8462 | C3: 0.5797
Epoch 249/400 | Train Loss: 29.4425
 Avg Train Loss: 29.4425 | Seg Loss: 0.2944 | Recon Loss: 0.0044
  Val mIoU: 0.7722 (Best: 0.8116)
  [Class IoU] C0: 0.8155860049559359 | C1: 0.9182 | C2: 0.8371 | C3: 0.5180
Epoch 250/400 | Train Loss: 30.1520
 Avg Train Loss: 30.1520 | Seg Loss: 0.3015 | Recon Loss: 0.0044
  Val mIoU: 0.7617 (Best: 0.8116)
  [Class IoU] C0: 0.7974503371519194 | C1: 0.8736 | C2: 0.8364 | C3: 0.5392
Epoch 251/400 | Train Loss: 29.8214
 Avg Train Loss: 29.8214 | Seg Loss: 0.2982 | Recon Loss: 0.0043
  Val mIoU: 0.8019 (Best: 0.8116)
  [Class IoU] C0: 0.8030802533464372 | C1: 0.9114 | C2: 0.8588 | C3: 0.6344
Epoch 252/400 | Train Loss: 29.8543
 Avg Train Loss: 29.8543 | Seg Loss: 0.2985 | Recon Loss: 0.0043
  Val mIoU: 0.7911 (Best: 0.8116)
  [Class IoU] C0: 0.8155613273311622 | C1: 0.9132 | C2: 0.8473 | C3: 0.5884
Epoch 253/400 | Train Loss: 29.5851
 Avg Train Loss: 29.5851 | Seg Loss: 0.2958 | Recon Loss: 0.0043
  Val mIoU: 0.7897 (Best: 0.8116)
  [Class IoU] C0: 0.819085022317533 | C1: 0.9175 | C2: 0.8454 | C3: 0.5767
Epoch 254/400 | Train Loss: 29.7384
 Avg Train Loss: 29.7384 | Seg Loss: 0.2973 | Recon Loss: 0.0044
  Val mIoU: 0.7844 (Best: 0.8116)
  [Class IoU] C0: 0.7978145568153052 | C1: 0.9054 | C2: 0.8440 | C3: 0.5902
Epoch 255/400 | Train Loss: 29.8516
 Avg Train Loss: 29.8516 | Seg Loss: 0.2985 | Recon Loss: 0.0044
  Val mIoU: 0.8012 (Best: 0.8116)
  [Class IoU] C0: 0.8108505491238585 | C1: 0.9123 | C2: 0.8568 | C3: 0.6251
Epoch 256/400 | Train Loss: 29.9519
 Avg Train Loss: 29.9519 | Seg Loss: 0.2995 | Recon Loss: 0.0043
  Val mIoU: 0.7990 (Best: 0.8116)
  [Class IoU] C0: 0.8167103931172717 | C1: 0.9154 | C2: 0.8525 | C3: 0.6113
Epoch 257/400 | Train Loss: 30.2943
 Avg Train Loss: 30.2943 | Seg Loss: 0.3029 | Recon Loss: 0.0044
  Val mIoU: 0.7945 (Best: 0.8116)
  [Class IoU] C0: 0.8059761889896669 | C1: 0.9124 | C2: 0.8517 | C3: 0.6077
Epoch 258/400 | Train Loss: 29.9266
 Avg Train Loss: 29.9266 | Seg Loss: 0.2992 | Recon Loss: 0.0044
  Val mIoU: 0.7883 (Best: 0.8116)
  [Class IoU] C0: 0.8178969418400573 | C1: 0.9150 | C2: 0.8454 | C3: 0.5751
Epoch 259/400 | Train Loss: 29.0285
 Avg Train Loss: 29.0285 | Seg Loss: 0.2902 | Recon Loss: 0.0044
  Val mIoU: 0.8018 (Best: 0.8116)
  [Class IoU] C0: 0.8147674704888698 | C1: 0.9147 | C2: 0.8561 | C3: 0.6217
Epoch 260/400 | Train Loss: 29.4026
 Avg Train Loss: 29.4026 | Seg Loss: 0.2940 | Recon Loss: 0.0043
  Val mIoU: 0.7870 (Best: 0.8116)
  [Class IoU] C0: 0.8033209294447078 | C1: 0.9131 | C2: 0.8451 | C3: 0.5867
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 30.1899
 Avg Train Loss: 30.1899 | Seg Loss: 0.3019 | Recon Loss: 0.0044
  Val mIoU: 0.7752 (Best: 0.8116)
  [Class IoU] C0: 0.7971505180363597 | C1: 0.9137 | C2: 0.8383 | C3: 0.5516
Epoch 262/400 | Train Loss: 29.7868
 Avg Train Loss: 29.7868 | Seg Loss: 0.2978 | Recon Loss: 0.0044
  Val mIoU: 0.7956 (Best: 0.8116)
  [Class IoU] C0: 0.8132636828445484 | C1: 0.9120 | C2: 0.8514 | C3: 0.6058
Epoch 263/400 | Train Loss: 29.2098
 Avg Train Loss: 29.2098 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.7757 (Best: 0.8116)
  [Class IoU] C0: 0.7978880269665335 | C1: 0.8902 | C2: 0.8414 | C3: 0.5734
Epoch 264/400 | Train Loss: 29.2282
 Avg Train Loss: 29.2282 | Seg Loss: 0.2922 | Recon Loss: 0.0046
  Val mIoU: 0.7846 (Best: 0.8116)
  [Class IoU] C0: 0.8199775840353789 | C1: 0.9157 | C2: 0.8436 | C3: 0.5593
Epoch 265/400 | Train Loss: 29.9592
 Avg Train Loss: 29.9592 | Seg Loss: 0.2995 | Recon Loss: 0.0044
  Val mIoU: 0.7969 (Best: 0.8116)
  [Class IoU] C0: 0.8110475228449487 | C1: 0.9133 | C2: 0.8527 | C3: 0.6106
Epoch 266/400 | Train Loss: 30.5645
 Avg Train Loss: 30.5645 | Seg Loss: 0.3056 | Recon Loss: 0.0044
  Val mIoU: 0.7948 (Best: 0.8116)
  [Class IoU] C0: 0.8166313536336431 | C1: 0.9191 | C2: 0.8480 | C3: 0.5954
Epoch 267/400 | Train Loss: 29.6407
 Avg Train Loss: 29.6407 | Seg Loss: 0.2964 | Recon Loss: 0.0044
  Val mIoU: 0.7925 (Best: 0.8116)
  [Class IoU] C0: 0.8151815807548836 | C1: 0.9169 | C2: 0.8483 | C3: 0.5895
Epoch 268/400 | Train Loss: 30.0375
 Avg Train Loss: 30.0375 | Seg Loss: 0.3003 | Recon Loss: 0.0045
  Val mIoU: 0.8014 (Best: 0.8116)
  [Class IoU] C0: 0.8129243706715599 | C1: 0.9138 | C2: 0.8568 | C3: 0.6220
Epoch 269/400 | Train Loss: 29.8223
 Avg Train Loss: 29.8223 | Seg Loss: 0.2982 | Recon Loss: 0.0043
  Val mIoU: 0.7997 (Best: 0.8116)
  [Class IoU] C0: 0.8108503356287684 | C1: 0.9082 | C2: 0.8554 | C3: 0.6243
Epoch 270/400 | Train Loss: 29.5009
 Avg Train Loss: 29.5009 | Seg Loss: 0.2950 | Recon Loss: 0.0045
  Val mIoU: 0.7038 (Best: 0.8116)
  [Class IoU] C0: 0.6974863127411405 | C1: 0.6516 | C2: 0.8479 | C3: 0.6182
Epoch 271/400 | Train Loss: 29.5995
 Avg Train Loss: 29.5995 | Seg Loss: 0.2959 | Recon Loss: 0.0044
  Val mIoU: 0.7762 (Best: 0.8116)
  [Class IoU] C0: 0.8124092778714699 | C1: 0.9165 | C2: 0.8392 | C3: 0.5368
Epoch 272/400 | Train Loss: 29.3210
 Avg Train Loss: 29.3210 | Seg Loss: 0.2932 | Recon Loss: 0.0044
  Val mIoU: 0.7944 (Best: 0.8116)
  [Class IoU] C0: 0.8017079322245342 | C1: 0.9081 | C2: 0.8529 | C3: 0.6148
Epoch 273/400 | Train Loss: 30.2380
 Avg Train Loss: 30.2380 | Seg Loss: 0.3023 | Recon Loss: 0.0044
  Val mIoU: 0.7773 (Best: 0.8116)
  [Class IoU] C0: 0.7922552239356613 | C1: 0.8975 | C2: 0.8421 | C3: 0.5774
Epoch 274/400 | Train Loss: 29.5889
 Avg Train Loss: 29.5889 | Seg Loss: 0.2958 | Recon Loss: 0.0043
  Val mIoU: 0.7919 (Best: 0.8116)
  [Class IoU] C0: 0.8020302870958848 | C1: 0.9068 | C2: 0.8498 | C3: 0.6089
Epoch 275/400 | Train Loss: 29.5626
 Avg Train Loss: 29.5626 | Seg Loss: 0.2956 | Recon Loss: 0.0044
  Val mIoU: 0.8007 (Best: 0.8116)
  [Class IoU] C0: 0.820166583637884 | C1: 0.9206 | C2: 0.8520 | C3: 0.6100
Epoch 276/400 | Train Loss: 29.4798
 Avg Train Loss: 29.4798 | Seg Loss: 0.2948 | Recon Loss: 0.0043
  Val mIoU: 0.7992 (Best: 0.8116)
  [Class IoU] C0: 0.8049347956896096 | C1: 0.9114 | C2: 0.8550 | C3: 0.6256
Epoch 277/400 | Train Loss: 29.7795
 Avg Train Loss: 29.7795 | Seg Loss: 0.2978 | Recon Loss: 0.0044
  Val mIoU: 0.7764 (Best: 0.8116)
  [Class IoU] C0: 0.8176000895736805 | C1: 0.9228 | C2: 0.8364 | C3: 0.5288
Epoch 278/400 | Train Loss: 30.0724
 Avg Train Loss: 30.0724 | Seg Loss: 0.3007 | Recon Loss: 0.0045
  Val mIoU: 0.7996 (Best: 0.8116)
  [Class IoU] C0: 0.8161572697101327 | C1: 0.9125 | C2: 0.8549 | C3: 0.6151
Epoch 279/400 | Train Loss: 29.6357
 Avg Train Loss: 29.6357 | Seg Loss: 0.2963 | Recon Loss: 0.0044
  Val mIoU: 0.8034 (Best: 0.8116)
  [Class IoU] C0: 0.8202567592691599 | C1: 0.9181 | C2: 0.8552 | C3: 0.6200
Epoch 280/400 | Train Loss: 29.0336
 Avg Train Loss: 29.0336 | Seg Loss: 0.2903 | Recon Loss: 0.0044
  Val mIoU: 0.8081 (Best: 0.8116)
  [Class IoU] C0: 0.814086313811915 | C1: 0.9132 | C2: 0.8607 | C3: 0.6443
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 30.1508
 Avg Train Loss: 30.1508 | Seg Loss: 0.3015 | Recon Loss: 0.0044
  Val mIoU: 0.7970 (Best: 0.8116)
  [Class IoU] C0: 0.8159314147567157 | C1: 0.9204 | C2: 0.8512 | C3: 0.6004
Epoch 282/400 | Train Loss: 29.3808
 Avg Train Loss: 29.3808 | Seg Loss: 0.2938 | Recon Loss: 0.0043
  Val mIoU: 0.7934 (Best: 0.8116)
  [Class IoU] C0: 0.8151643411231545 | C1: 0.9084 | C2: 0.8474 | C3: 0.6026
Epoch 283/400 | Train Loss: 29.7824
 Avg Train Loss: 29.7824 | Seg Loss: 0.2978 | Recon Loss: 0.0044
  Val mIoU: 0.7903 (Best: 0.8116)
  [Class IoU] C0: 0.8172751898996218 | C1: 0.9145 | C2: 0.8445 | C3: 0.5851
Epoch 284/400 | Train Loss: 29.8669
 Avg Train Loss: 29.8669 | Seg Loss: 0.2986 | Recon Loss: 0.0042
  Val mIoU: 0.7954 (Best: 0.8116)
  [Class IoU] C0: 0.8051211964383721 | C1: 0.9068 | C2: 0.8533 | C3: 0.6165
Epoch 285/400 | Train Loss: 29.6725
 Avg Train Loss: 29.6725 | Seg Loss: 0.2967 | Recon Loss: 0.0043
  Val mIoU: 0.8034 (Best: 0.8116)
  [Class IoU] C0: 0.8218363743491163 | C1: 0.9178 | C2: 0.8546 | C3: 0.6193
Epoch 286/400 | Train Loss: 30.5703
 Avg Train Loss: 30.5703 | Seg Loss: 0.3057 | Recon Loss: 0.0043
  Val mIoU: 0.7992 (Best: 0.8116)
  [Class IoU] C0: 0.8142308933953135 | C1: 0.9090 | C2: 0.8542 | C3: 0.6193
Epoch 287/400 | Train Loss: 30.0862
 Avg Train Loss: 30.0862 | Seg Loss: 0.3008 | Recon Loss: 0.0044
  Val mIoU: 0.7907 (Best: 0.8116)
  [Class IoU] C0: 0.7971468087630424 | C1: 0.9021 | C2: 0.8505 | C3: 0.6132
Epoch 288/400 | Train Loss: 29.8383
 Avg Train Loss: 29.8383 | Seg Loss: 0.2983 | Recon Loss: 0.0043
  Val mIoU: 0.8147 (Best: 0.8116)
  [Class IoU] C0: 0.8188359989478468 | C1: 0.9188 | C2: 0.8650 | C3: 0.6561
  --> New Best Model Saved!
Epoch 289/400 | Train Loss: 30.0697
 Avg Train Loss: 30.0697 | Seg Loss: 0.3007 | Recon Loss: 0.0045
  Val mIoU: 0.8053 (Best: 0.8147)
  [Class IoU] C0: 0.813139124327706 | C1: 0.9148 | C2: 0.8593 | C3: 0.6338
Epoch 290/400 | Train Loss: 30.1846
 Avg Train Loss: 30.1846 | Seg Loss: 0.3018 | Recon Loss: 0.0043
  Val mIoU: 0.8128 (Best: 0.8147)
  [Class IoU] C0: 0.8204227536693195 | C1: 0.9190 | C2: 0.8633 | C3: 0.6486
Epoch 291/400 | Train Loss: 29.8674
 Avg Train Loss: 29.8674 | Seg Loss: 0.2986 | Recon Loss: 0.0046
  Val mIoU: 0.7946 (Best: 0.8147)
  [Class IoU] C0: 0.7914593017544471 | C1: 0.8979 | C2: 0.8532 | C3: 0.6357
Epoch 292/400 | Train Loss: 29.4409
 Avg Train Loss: 29.4409 | Seg Loss: 0.2944 | Recon Loss: 0.0044
  Val mIoU: 0.8026 (Best: 0.8147)
  [Class IoU] C0: 0.80359630940058 | C1: 0.9162 | C2: 0.8564 | C3: 0.6341
Epoch 293/400 | Train Loss: 29.5587
 Avg Train Loss: 29.5587 | Seg Loss: 0.2955 | Recon Loss: 0.0043
  Val mIoU: 0.8078 (Best: 0.8147)
  [Class IoU] C0: 0.8101539415548672 | C1: 0.9194 | C2: 0.8591 | C3: 0.6426
Epoch 294/400 | Train Loss: 29.6374
 Avg Train Loss: 29.6374 | Seg Loss: 0.2963 | Recon Loss: 0.0043
  Val mIoU: 0.7931 (Best: 0.8147)
  [Class IoU] C0: 0.8112849597781304 | C1: 0.8965 | C2: 0.8536 | C3: 0.6110
Epoch 295/400 | Train Loss: 30.5684
 Avg Train Loss: 30.5684 | Seg Loss: 0.3056 | Recon Loss: 0.0043
  Val mIoU: 0.8011 (Best: 0.8147)
  [Class IoU] C0: 0.8081514701240435 | C1: 0.9082 | C2: 0.8575 | C3: 0.6305
Epoch 296/400 | Train Loss: 29.5714
 Avg Train Loss: 29.5714 | Seg Loss: 0.2957 | Recon Loss: 0.0044
  Val mIoU: 0.7878 (Best: 0.8147)
  [Class IoU] C0: 0.8076511057991291 | C1: 0.8904 | C2: 0.8515 | C3: 0.6018
Epoch 297/400 | Train Loss: 29.5854
 Avg Train Loss: 29.5854 | Seg Loss: 0.2958 | Recon Loss: 0.0044
  Val mIoU: 0.8034 (Best: 0.8147)
  [Class IoU] C0: 0.8192664485405314 | C1: 0.9165 | C2: 0.8552 | C3: 0.6227
Epoch 298/400 | Train Loss: 29.3372
 Avg Train Loss: 29.3372 | Seg Loss: 0.2933 | Recon Loss: 0.0044
  Val mIoU: 0.7496 (Best: 0.8147)
  [Class IoU] C0: 0.7491568400015914 | C1: 0.7740 | C2: 0.8532 | C3: 0.6221
Epoch 299/400 | Train Loss: 29.5775
 Avg Train Loss: 29.5775 | Seg Loss: 0.2957 | Recon Loss: 0.0044
  Val mIoU: 0.8019 (Best: 0.8147)
  [Class IoU] C0: 0.8122431028481899 | C1: 0.9139 | C2: 0.8555 | C3: 0.6261
Epoch 300/400 | Train Loss: 29.1331
 Avg Train Loss: 29.1331 | Seg Loss: 0.2913 | Recon Loss: 0.0043
  Val mIoU: 0.8041 (Best: 0.8147)
  [Class IoU] C0: 0.8172602714443655 | C1: 0.9129 | C2: 0.8567 | C3: 0.6294
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 29.9778
 Avg Train Loss: 29.9778 | Seg Loss: 0.2997 | Recon Loss: 0.0045
  Val mIoU: 0.8032 (Best: 0.8147)
  [Class IoU] C0: 0.8116259818277232 | C1: 0.9163 | C2: 0.8607 | C3: 0.6240
Epoch 302/400 | Train Loss: 29.4254
 Avg Train Loss: 29.4254 | Seg Loss: 0.2942 | Recon Loss: 0.0044
  Val mIoU: 0.8013 (Best: 0.8147)
  [Class IoU] C0: 0.809395847573327 | C1: 0.9175 | C2: 0.8562 | C3: 0.6219
Epoch 303/400 | Train Loss: 29.8193
 Avg Train Loss: 29.8193 | Seg Loss: 0.2981 | Recon Loss: 0.0044
  Val mIoU: 0.8012 (Best: 0.8147)
  [Class IoU] C0: 0.8078199584552191 | C1: 0.9142 | C2: 0.8579 | C3: 0.6249
Epoch 304/400 | Train Loss: 29.8262
 Avg Train Loss: 29.8262 | Seg Loss: 0.2982 | Recon Loss: 0.0042
  Val mIoU: 0.6902 (Best: 0.8147)
  [Class IoU] C0: 0.664209488304892 | C1: 0.6258 | C2: 0.8489 | C3: 0.6217
Epoch 305/400 | Train Loss: 29.8585
 Avg Train Loss: 29.8585 | Seg Loss: 0.2985 | Recon Loss: 0.0044
  Val mIoU: 0.7957 (Best: 0.8147)
  [Class IoU] C0: 0.8173943297247022 | C1: 0.9172 | C2: 0.8516 | C3: 0.5965
Epoch 306/400 | Train Loss: 29.3777
 Avg Train Loss: 29.3777 | Seg Loss: 0.2937 | Recon Loss: 0.0045
  Val mIoU: 0.8129 (Best: 0.8147)
  [Class IoU] C0: 0.8174448184040958 | C1: 0.9180 | C2: 0.8660 | C3: 0.6502
Epoch 307/400 | Train Loss: 29.8907
 Avg Train Loss: 29.8907 | Seg Loss: 0.2989 | Recon Loss: 0.0044
  Val mIoU: 0.8034 (Best: 0.8147)
  [Class IoU] C0: 0.8207883270190794 | C1: 0.9151 | C2: 0.8579 | C3: 0.6200
Epoch 308/400 | Train Loss: 29.8924
 Avg Train Loss: 29.8924 | Seg Loss: 0.2989 | Recon Loss: 0.0043
  Val mIoU: 0.8013 (Best: 0.8147)
  [Class IoU] C0: 0.8080143879387222 | C1: 0.9157 | C2: 0.8555 | C3: 0.6261
Epoch 309/400 | Train Loss: 29.4223
 Avg Train Loss: 29.4223 | Seg Loss: 0.2942 | Recon Loss: 0.0044
  Val mIoU: 0.7986 (Best: 0.8147)
  [Class IoU] C0: 0.8192630723799044 | C1: 0.9180 | C2: 0.8515 | C3: 0.6055
Epoch 310/400 | Train Loss: 29.8869
 Avg Train Loss: 29.8869 | Seg Loss: 0.2988 | Recon Loss: 0.0044
  Val mIoU: 0.8034 (Best: 0.8147)
  [Class IoU] C0: 0.8178467019393755 | C1: 0.9157 | C2: 0.8575 | C3: 0.6225
Epoch 311/400 | Train Loss: 29.6810
 Avg Train Loss: 29.6810 | Seg Loss: 0.2968 | Recon Loss: 0.0043
  Val mIoU: 0.8057 (Best: 0.8147)
  [Class IoU] C0: 0.8195988846297136 | C1: 0.9174 | C2: 0.8571 | C3: 0.6285
Epoch 312/400 | Train Loss: 29.4948
 Avg Train Loss: 29.4948 | Seg Loss: 0.2949 | Recon Loss: 0.0043
  Val mIoU: 0.8027 (Best: 0.8147)
  [Class IoU] C0: 0.8162289229398647 | C1: 0.9162 | C2: 0.8568 | C3: 0.6218
Epoch 313/400 | Train Loss: 30.3232
 Avg Train Loss: 30.3232 | Seg Loss: 0.3032 | Recon Loss: 0.0045
  Val mIoU: 0.7855 (Best: 0.8147)
  [Class IoU] C0: 0.7849924468154713 | C1: 0.8831 | C2: 0.8508 | C3: 0.6229
Epoch 314/400 | Train Loss: 29.1536
 Avg Train Loss: 29.1536 | Seg Loss: 0.2915 | Recon Loss: 0.0044
  Val mIoU: 0.8096 (Best: 0.8147)
  [Class IoU] C0: 0.8176571242901537 | C1: 0.9176 | C2: 0.8605 | C3: 0.6426
Epoch 315/400 | Train Loss: 29.8592
 Avg Train Loss: 29.8592 | Seg Loss: 0.2985 | Recon Loss: 0.0045
  Val mIoU: 0.8066 (Best: 0.8147)
  [Class IoU] C0: 0.8149830358623628 | C1: 0.9190 | C2: 0.8593 | C3: 0.6329
Epoch 316/400 | Train Loss: 29.4522
 Avg Train Loss: 29.4522 | Seg Loss: 0.2945 | Recon Loss: 0.0045
  Val mIoU: 0.7981 (Best: 0.8147)
  [Class IoU] C0: 0.8187200420024442 | C1: 0.9163 | C2: 0.8536 | C3: 0.6040
Epoch 317/400 | Train Loss: 29.3462
 Avg Train Loss: 29.3462 | Seg Loss: 0.2934 | Recon Loss: 0.0045
  Val mIoU: 0.7924 (Best: 0.8147)
  [Class IoU] C0: 0.7966395528679653 | C1: 0.8888 | C2: 0.8562 | C3: 0.6281
Epoch 318/400 | Train Loss: 30.0694
 Avg Train Loss: 30.0694 | Seg Loss: 0.3007 | Recon Loss: 0.0044
  Val mIoU: 0.8056 (Best: 0.8147)
  [Class IoU] C0: 0.8228561274306976 | C1: 0.9237 | C2: 0.8552 | C3: 0.6208
Epoch 319/400 | Train Loss: 29.8101
 Avg Train Loss: 29.8101 | Seg Loss: 0.2981 | Recon Loss: 0.0043
  Val mIoU: 0.7819 (Best: 0.8147)
  [Class IoU] C0: 0.7986696781878899 | C1: 0.9013 | C2: 0.8440 | C3: 0.5837
Epoch 320/400 | Train Loss: 29.2487
 Avg Train Loss: 29.2487 | Seg Loss: 0.2924 | Recon Loss: 0.0045
  Val mIoU: 0.8163 (Best: 0.8147)
  [Class IoU] C0: 0.8242244320032023 | C1: 0.9179 | C2: 0.8643 | C3: 0.6587
  --> New Best Model Saved!
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 29.3788
 Avg Train Loss: 29.3788 | Seg Loss: 0.2937 | Recon Loss: 0.0043
  Val mIoU: 0.7958 (Best: 0.8163)
  [Class IoU] C0: 0.8066478460466115 | C1: 0.9037 | C2: 0.8548 | C3: 0.6180
Epoch 322/400 | Train Loss: 29.7121
 Avg Train Loss: 29.7121 | Seg Loss: 0.2971 | Recon Loss: 0.0043
  Val mIoU: 0.8000 (Best: 0.8163)
  [Class IoU] C0: 0.8170522105825454 | C1: 0.9164 | C2: 0.8531 | C3: 0.6137
Epoch 323/400 | Train Loss: 30.0872
 Avg Train Loss: 30.0872 | Seg Loss: 0.3008 | Recon Loss: 0.0044
  Val mIoU: 0.8028 (Best: 0.8163)
  [Class IoU] C0: 0.8135543225452487 | C1: 0.9081 | C2: 0.8578 | C3: 0.6319
Epoch 324/400 | Train Loss: 29.7283
 Avg Train Loss: 29.7283 | Seg Loss: 0.2972 | Recon Loss: 0.0044
  Val mIoU: 0.7906 (Best: 0.8163)
  [Class IoU] C0: 0.7991486623086608 | C1: 0.8834 | C2: 0.8567 | C3: 0.6232
Epoch 325/400 | Train Loss: 29.3967
 Avg Train Loss: 29.3967 | Seg Loss: 0.2939 | Recon Loss: 0.0043
  Val mIoU: 0.8028 (Best: 0.8163)
  [Class IoU] C0: 0.8148209745674553 | C1: 0.9175 | C2: 0.8555 | C3: 0.6234
Epoch 326/400 | Train Loss: 29.4679
 Avg Train Loss: 29.4679 | Seg Loss: 0.2946 | Recon Loss: 0.0045
  Val mIoU: 0.7756 (Best: 0.8163)
  [Class IoU] C0: 0.7824197627418022 | C1: 0.8499 | C2: 0.8520 | C3: 0.6182
Epoch 327/400 | Train Loss: 30.3786
 Avg Train Loss: 30.3786 | Seg Loss: 0.3037 | Recon Loss: 0.0043
  Val mIoU: 0.7998 (Best: 0.8163)
  [Class IoU] C0: 0.8124227785692647 | C1: 0.9163 | C2: 0.8554 | C3: 0.6151
Epoch 328/400 | Train Loss: 29.3584
 Avg Train Loss: 29.3584 | Seg Loss: 0.2935 | Recon Loss: 0.0044
  Val mIoU: 0.7874 (Best: 0.8163)
  [Class IoU] C0: 0.7871072625343122 | C1: 0.8988 | C2: 0.8499 | C3: 0.6140
Epoch 329/400 | Train Loss: 29.3318
 Avg Train Loss: 29.3318 | Seg Loss: 0.2933 | Recon Loss: 0.0045
  Val mIoU: 0.8038 (Best: 0.8163)
  [Class IoU] C0: 0.8174270575347203 | C1: 0.9194 | C2: 0.8571 | C3: 0.6213
Epoch 330/400 | Train Loss: 29.2518
 Avg Train Loss: 29.2518 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.7956 (Best: 0.8163)
  [Class IoU] C0: 0.8057170466186284 | C1: 0.8956 | C2: 0.8594 | C3: 0.6218
Epoch 331/400 | Train Loss: 29.4803
 Avg Train Loss: 29.4803 | Seg Loss: 0.2948 | Recon Loss: 0.0043
  Val mIoU: 0.8009 (Best: 0.8163)
  [Class IoU] C0: 0.7992011687649595 | C1: 0.9107 | C2: 0.8582 | C3: 0.6354
Epoch 332/400 | Train Loss: 29.1226
 Avg Train Loss: 29.1226 | Seg Loss: 0.2912 | Recon Loss: 0.0044
  Val mIoU: 0.8003 (Best: 0.8163)
  [Class IoU] C0: 0.8098205245416988 | C1: 0.9203 | C2: 0.8556 | C3: 0.6157
Epoch 333/400 | Train Loss: 29.8189
 Avg Train Loss: 29.8189 | Seg Loss: 0.2981 | Recon Loss: 0.0044
  Val mIoU: 0.8001 (Best: 0.8163)
  [Class IoU] C0: 0.8217526104806915 | C1: 0.9189 | C2: 0.8516 | C3: 0.6079
Epoch 334/400 | Train Loss: 28.9466
 Avg Train Loss: 28.9466 | Seg Loss: 0.2894 | Recon Loss: 0.0043
  Val mIoU: 0.8027 (Best: 0.8163)
  [Class IoU] C0: 0.8180473167012098 | C1: 0.9193 | C2: 0.8556 | C3: 0.6180
Epoch 335/400 | Train Loss: 29.5230
 Avg Train Loss: 29.5230 | Seg Loss: 0.2952 | Recon Loss: 0.0043
  Val mIoU: 0.8117 (Best: 0.8163)
  [Class IoU] C0: 0.8215612651393316 | C1: 0.9173 | C2: 0.8615 | C3: 0.6463
Epoch 336/400 | Train Loss: 29.0692
 Avg Train Loss: 29.0692 | Seg Loss: 0.2906 | Recon Loss: 0.0044
  Val mIoU: 0.7951 (Best: 0.8163)
  [Class IoU] C0: 0.8138360489007337 | C1: 0.9184 | C2: 0.8516 | C3: 0.5966
Epoch 337/400 | Train Loss: 29.0023
 Avg Train Loss: 29.0023 | Seg Loss: 0.2900 | Recon Loss: 0.0044
  Val mIoU: 0.8126 (Best: 0.8163)
  [Class IoU] C0: 0.8232715044859983 | C1: 0.9176 | C2: 0.8630 | C3: 0.6464
Epoch 338/400 | Train Loss: 29.6277
 Avg Train Loss: 29.6277 | Seg Loss: 0.2962 | Recon Loss: 0.0043
  Val mIoU: 0.8023 (Best: 0.8163)
  [Class IoU] C0: 0.8140849629518965 | C1: 0.9149 | C2: 0.8573 | C3: 0.6229
Epoch 339/400 | Train Loss: 29.5918
 Avg Train Loss: 29.5918 | Seg Loss: 0.2959 | Recon Loss: 0.0043
  Val mIoU: 0.8069 (Best: 0.8163)
  [Class IoU] C0: 0.8218571501130362 | C1: 0.9195 | C2: 0.8580 | C3: 0.6281
Epoch 340/400 | Train Loss: 29.1831
 Avg Train Loss: 29.1831 | Seg Loss: 0.2918 | Recon Loss: 0.0044
  Val mIoU: 0.8017 (Best: 0.8163)
  [Class IoU] C0: 0.81456331461735 | C1: 0.9143 | C2: 0.8557 | C3: 0.6223
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 29.9796
 Avg Train Loss: 29.9796 | Seg Loss: 0.2998 | Recon Loss: 0.0044
  Val mIoU: 0.7949 (Best: 0.8163)
  [Class IoU] C0: 0.8038255986725384 | C1: 0.9085 | C2: 0.8530 | C3: 0.6141
Epoch 342/400 | Train Loss: 29.4433
 Avg Train Loss: 29.4433 | Seg Loss: 0.2944 | Recon Loss: 0.0044
  Val mIoU: 0.7988 (Best: 0.8163)
  [Class IoU] C0: 0.8187179945485039 | C1: 0.9214 | C2: 0.8523 | C3: 0.6030
Epoch 343/400 | Train Loss: 29.8810
 Avg Train Loss: 29.8810 | Seg Loss: 0.2988 | Recon Loss: 0.0044
  Val mIoU: 0.7903 (Best: 0.8163)
  [Class IoU] C0: 0.8186418746057111 | C1: 0.9157 | C2: 0.8473 | C3: 0.5796
Epoch 344/400 | Train Loss: 30.2862
 Avg Train Loss: 30.2862 | Seg Loss: 0.3028 | Recon Loss: 0.0045
  Val mIoU: 0.7886 (Best: 0.8163)
  [Class IoU] C0: 0.8088110247008452 | C1: 0.8923 | C2: 0.8498 | C3: 0.6036
Epoch 345/400 | Train Loss: 29.4541
 Avg Train Loss: 29.4541 | Seg Loss: 0.2945 | Recon Loss: 0.0043
  Val mIoU: 0.8118 (Best: 0.8163)
  [Class IoU] C0: 0.8133962382476333 | C1: 0.9188 | C2: 0.8630 | C3: 0.6521
Epoch 346/400 | Train Loss: 28.8205
 Avg Train Loss: 28.8205 | Seg Loss: 0.2882 | Recon Loss: 0.0044
  Val mIoU: 0.8001 (Best: 0.8163)
  [Class IoU] C0: 0.8017914752296829 | C1: 0.9116 | C2: 0.8597 | C3: 0.6273
Epoch 347/400 | Train Loss: 29.6160
 Avg Train Loss: 29.6160 | Seg Loss: 0.2961 | Recon Loss: 0.0044
  Val mIoU: 0.8001 (Best: 0.8163)
  [Class IoU] C0: 0.8150662597698445 | C1: 0.9150 | C2: 0.8561 | C3: 0.6144
Epoch 348/400 | Train Loss: 29.7025
 Avg Train Loss: 29.7025 | Seg Loss: 0.2970 | Recon Loss: 0.0045
  Val mIoU: 0.7516 (Best: 0.8163)
  [Class IoU] C0: 0.751771046803804 | C1: 0.7819 | C2: 0.8500 | C3: 0.6226
Epoch 349/400 | Train Loss: 30.4940
 Avg Train Loss: 30.4940 | Seg Loss: 0.3049 | Recon Loss: 0.0044
  Val mIoU: 0.7989 (Best: 0.8163)
  [Class IoU] C0: 0.8202915422960917 | C1: 0.9121 | C2: 0.8540 | C3: 0.6095
Epoch 350/400 | Train Loss: 30.2459
 Avg Train Loss: 30.2459 | Seg Loss: 0.3024 | Recon Loss: 0.0044
  Val mIoU: 0.7995 (Best: 0.8163)
  [Class IoU] C0: 0.8185461813902937 | C1: 0.9201 | C2: 0.8496 | C3: 0.6096
Epoch 351/400 | Train Loss: 29.2283
 Avg Train Loss: 29.2283 | Seg Loss: 0.2922 | Recon Loss: 0.0044
  Val mIoU: 0.7940 (Best: 0.8163)
  [Class IoU] C0: 0.8125409874099302 | C1: 0.9087 | C2: 0.8502 | C3: 0.6044
Epoch 352/400 | Train Loss: 29.2590
 Avg Train Loss: 29.2590 | Seg Loss: 0.2925 | Recon Loss: 0.0043
  Val mIoU: 0.7882 (Best: 0.8163)
  [Class IoU] C0: 0.7940143159057034 | C1: 0.9174 | C2: 0.8466 | C3: 0.5950
Epoch 353/400 | Train Loss: 29.5752
 Avg Train Loss: 29.5752 | Seg Loss: 0.2957 | Recon Loss: 0.0042
  Val mIoU: 0.7919 (Best: 0.8163)
  [Class IoU] C0: 0.8157891846843407 | C1: 0.9173 | C2: 0.8484 | C3: 0.5862
Epoch 354/400 | Train Loss: 29.6168
 Avg Train Loss: 29.6168 | Seg Loss: 0.2961 | Recon Loss: 0.0043
  Val mIoU: 0.8006 (Best: 0.8163)
  [Class IoU] C0: 0.8046265017586628 | C1: 0.9071 | C2: 0.8572 | C3: 0.6335
Epoch 355/400 | Train Loss: 30.0003
 Avg Train Loss: 30.0003 | Seg Loss: 0.3000 | Recon Loss: 0.0044
  Val mIoU: 0.7981 (Best: 0.8163)
  [Class IoU] C0: 0.817453725643592 | C1: 0.9089 | C2: 0.8552 | C3: 0.6110
Epoch 356/400 | Train Loss: 29.4983
 Avg Train Loss: 29.4983 | Seg Loss: 0.2949 | Recon Loss: 0.0043
  Val mIoU: 0.7987 (Best: 0.8163)
  [Class IoU] C0: 0.8066815940971098 | C1: 0.9183 | C2: 0.8543 | C3: 0.6157
Epoch 357/400 | Train Loss: 29.6931
 Avg Train Loss: 29.6931 | Seg Loss: 0.2969 | Recon Loss: 0.0042
  Val mIoU: 0.7959 (Best: 0.8163)
  [Class IoU] C0: 0.8179940877640185 | C1: 0.9088 | C2: 0.8508 | C3: 0.6060
Epoch 358/400 | Train Loss: 30.0638
 Avg Train Loss: 30.0638 | Seg Loss: 0.3006 | Recon Loss: 0.0043
  Val mIoU: 0.8059 (Best: 0.8163)
  [Class IoU] C0: 0.821901130625385 | C1: 0.9193 | C2: 0.8559 | C3: 0.6264
Epoch 359/400 | Train Loss: 29.5955
 Avg Train Loss: 29.5955 | Seg Loss: 0.2959 | Recon Loss: 0.0043
  Val mIoU: 0.7805 (Best: 0.8163)
  [Class IoU] C0: 0.807710752628257 | C1: 0.9105 | C2: 0.8426 | C3: 0.5612
Epoch 360/400 | Train Loss: 29.7515
 Avg Train Loss: 29.7515 | Seg Loss: 0.2975 | Recon Loss: 0.0044
  Val mIoU: 0.8031 (Best: 0.8163)
  [Class IoU] C0: 0.8161635351853215 | C1: 0.9164 | C2: 0.8577 | C3: 0.6223
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 29.9108
 Avg Train Loss: 29.9108 | Seg Loss: 0.2991 | Recon Loss: 0.0043
  Val mIoU: 0.7761 (Best: 0.8163)
  [Class IoU] C0: 0.8172856257114061 | C1: 0.9188 | C2: 0.8375 | C3: 0.5307
Epoch 362/400 | Train Loss: 28.9903
 Avg Train Loss: 28.9903 | Seg Loss: 0.2899 | Recon Loss: 0.0044
  Val mIoU: 0.7985 (Best: 0.8163)
  [Class IoU] C0: 0.8060954166170217 | C1: 0.9169 | C2: 0.8542 | C3: 0.6168
Epoch 363/400 | Train Loss: 30.1606
 Avg Train Loss: 30.1606 | Seg Loss: 0.3016 | Recon Loss: 0.0043
  Val mIoU: 0.7918 (Best: 0.8163)
  [Class IoU] C0: 0.8074165090074269 | C1: 0.9111 | C2: 0.8500 | C3: 0.5985
Epoch 364/400 | Train Loss: 29.2102
 Avg Train Loss: 29.2102 | Seg Loss: 0.2921 | Recon Loss: 0.0043
  Val mIoU: 0.8063 (Best: 0.8163)
  [Class IoU] C0: 0.8167835372355542 | C1: 0.9166 | C2: 0.8603 | C3: 0.6313
Epoch 365/400 | Train Loss: 29.4473
 Avg Train Loss: 29.4473 | Seg Loss: 0.2944 | Recon Loss: 0.0044
  Val mIoU: 0.7770 (Best: 0.8163)
  [Class IoU] C0: 0.8064426631543077 | C1: 0.9165 | C2: 0.8397 | C3: 0.5454
Epoch 366/400 | Train Loss: 29.7603
 Avg Train Loss: 29.7603 | Seg Loss: 0.2976 | Recon Loss: 0.0043
  Val mIoU: 0.8028 (Best: 0.8163)
  [Class IoU] C0: 0.8166774350765705 | C1: 0.9191 | C2: 0.8554 | C3: 0.6200
Epoch 367/400 | Train Loss: 28.6930
 Avg Train Loss: 28.6930 | Seg Loss: 0.2869 | Recon Loss: 0.0044
  Val mIoU: 0.7856 (Best: 0.8163)
  [Class IoU] C0: 0.8133499691182399 | C1: 0.9180 | C2: 0.8458 | C3: 0.5651
Epoch 368/400 | Train Loss: 29.7921
 Avg Train Loss: 29.7921 | Seg Loss: 0.2979 | Recon Loss: 0.0043
  Val mIoU: 0.8031 (Best: 0.8163)
  [Class IoU] C0: 0.8125487496816648 | C1: 0.9164 | C2: 0.8575 | C3: 0.6259
Epoch 369/400 | Train Loss: 30.0017
 Avg Train Loss: 30.0017 | Seg Loss: 0.3000 | Recon Loss: 0.0043
  Val mIoU: 0.7124 (Best: 0.8163)
  [Class IoU] C0: 0.7078371131316912 | C1: 0.6808 | C2: 0.8511 | C3: 0.6100
Epoch 370/400 | Train Loss: 29.5137
 Avg Train Loss: 29.5137 | Seg Loss: 0.2951 | Recon Loss: 0.0043
  Val mIoU: 0.7700 (Best: 0.8163)
  [Class IoU] C0: 0.773772344948573 | C1: 0.8250 | C2: 0.8514 | C3: 0.6299
Epoch 371/400 | Train Loss: 29.5316
 Avg Train Loss: 29.5316 | Seg Loss: 0.2953 | Recon Loss: 0.0045
  Val mIoU: 0.7971 (Best: 0.8163)
  [Class IoU] C0: 0.8058322169495223 | C1: 0.9102 | C2: 0.8543 | C3: 0.6181
Epoch 372/400 | Train Loss: 29.2346
 Avg Train Loss: 29.2346 | Seg Loss: 0.2923 | Recon Loss: 0.0044
  Val mIoU: 0.7999 (Best: 0.8163)
  [Class IoU] C0: 0.8137777684827157 | C1: 0.9174 | C2: 0.8546 | C3: 0.6137
Epoch 373/400 | Train Loss: 29.5596
 Avg Train Loss: 29.5596 | Seg Loss: 0.2956 | Recon Loss: 0.0044
  Val mIoU: 0.7585 (Best: 0.8163)
  [Class IoU] C0: 0.7566409466004198 | C1: 0.8064 | C2: 0.8513 | C3: 0.6196
Epoch 374/400 | Train Loss: 29.8925
 Avg Train Loss: 29.8925 | Seg Loss: 0.2989 | Recon Loss: 0.0044
  Val mIoU: 0.7998 (Best: 0.8163)
  [Class IoU] C0: 0.8168474665711282 | C1: 0.9211 | C2: 0.8489 | C3: 0.6123
Epoch 375/400 | Train Loss: 30.3104
 Avg Train Loss: 30.3104 | Seg Loss: 0.3031 | Recon Loss: 0.0044
  Val mIoU: 0.7955 (Best: 0.8163)
  [Class IoU] C0: 0.8175741003893182 | C1: 0.9169 | C2: 0.8509 | C3: 0.5964
Epoch 376/400 | Train Loss: 30.4733
 Avg Train Loss: 30.4733 | Seg Loss: 0.3047 | Recon Loss: 0.0043
  Val mIoU: 0.6327 (Best: 0.8163)
  [Class IoU] C0: 0.5740910982404405 | C1: 0.4962 | C2: 0.8453 | C3: 0.6153
Epoch 377/400 | Train Loss: 30.0753
 Avg Train Loss: 30.0753 | Seg Loss: 0.3007 | Recon Loss: 0.0044
  Val mIoU: 0.8072 (Best: 0.8163)
  [Class IoU] C0: 0.8177602391550057 | C1: 0.9188 | C2: 0.8587 | C3: 0.6335
Epoch 378/400 | Train Loss: 30.1576
 Avg Train Loss: 30.1576 | Seg Loss: 0.3015 | Recon Loss: 0.0044
  Val mIoU: 0.7821 (Best: 0.8163)
  [Class IoU] C0: 0.8160701256220265 | C1: 0.9204 | C2: 0.8411 | C3: 0.5508
Epoch 379/400 | Train Loss: 29.5232
 Avg Train Loss: 29.5232 | Seg Loss: 0.2952 | Recon Loss: 0.0044
  Val mIoU: 0.8025 (Best: 0.8163)
  [Class IoU] C0: 0.822080520696404 | C1: 0.9201 | C2: 0.8552 | C3: 0.6128
Epoch 380/400 | Train Loss: 29.2120
 Avg Train Loss: 29.2120 | Seg Loss: 0.2921 | Recon Loss: 0.0043
  Val mIoU: 0.8019 (Best: 0.8163)
  [Class IoU] C0: 0.8200214605304017 | C1: 0.9200 | C2: 0.8540 | C3: 0.6136
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 29.5609
 Avg Train Loss: 29.5609 | Seg Loss: 0.2956 | Recon Loss: 0.0043
  Val mIoU: 0.8004 (Best: 0.8163)
  [Class IoU] C0: 0.8142908590368073 | C1: 0.9142 | C2: 0.8556 | C3: 0.6176
Epoch 382/400 | Train Loss: 29.3246
 Avg Train Loss: 29.3246 | Seg Loss: 0.2932 | Recon Loss: 0.0045
  Val mIoU: 0.8071 (Best: 0.8163)
  [Class IoU] C0: 0.8161983887942802 | C1: 0.9174 | C2: 0.8591 | C3: 0.6358
Epoch 383/400 | Train Loss: 30.0738
 Avg Train Loss: 30.0738 | Seg Loss: 0.3007 | Recon Loss: 0.0044
  Val mIoU: 0.7931 (Best: 0.8163)
  [Class IoU] C0: 0.8075457015255112 | C1: 0.9162 | C2: 0.8494 | C3: 0.5994
Epoch 384/400 | Train Loss: 29.7792
 Avg Train Loss: 29.7792 | Seg Loss: 0.2977 | Recon Loss: 0.0044
  Val mIoU: 0.8067 (Best: 0.8163)
  [Class IoU] C0: 0.8187912801655138 | C1: 0.9169 | C2: 0.8598 | C3: 0.6315
Epoch 385/400 | Train Loss: 29.9665
 Avg Train Loss: 29.9665 | Seg Loss: 0.2996 | Recon Loss: 0.0043
  Val mIoU: 0.8017 (Best: 0.8163)
  [Class IoU] C0: 0.8096319313701554 | C1: 0.9131 | C2: 0.8574 | C3: 0.6268
Epoch 386/400 | Train Loss: 29.7911
 Avg Train Loss: 29.7911 | Seg Loss: 0.2979 | Recon Loss: 0.0044
  Val mIoU: 0.7083 (Best: 0.8163)
  [Class IoU] C0: 0.7029420519573625 | C1: 0.6645 | C2: 0.8486 | C3: 0.6170
Epoch 387/400 | Train Loss: 29.9881
 Avg Train Loss: 29.9881 | Seg Loss: 0.2998 | Recon Loss: 0.0043
  Val mIoU: 0.6894 (Best: 0.8163)
  [Class IoU] C0: 0.6600636580480342 | C1: 0.6257 | C2: 0.8460 | C3: 0.6259
Epoch 388/400 | Train Loss: 30.1644
 Avg Train Loss: 30.1644 | Seg Loss: 0.3016 | Recon Loss: 0.0042
  Val mIoU: 0.8132 (Best: 0.8163)
  [Class IoU] C0: 0.8205992289323402 | C1: 0.9178 | C2: 0.8646 | C3: 0.6498
Epoch 389/400 | Train Loss: 29.3820
 Avg Train Loss: 29.3820 | Seg Loss: 0.2938 | Recon Loss: 0.0043
  Val mIoU: 0.7895 (Best: 0.8163)
  [Class IoU] C0: 0.7881251476918573 | C1: 0.8858 | C2: 0.8562 | C3: 0.6277
Epoch 390/400 | Train Loss: 29.4338
 Avg Train Loss: 29.4338 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.7961 (Best: 0.8163)
  [Class IoU] C0: 0.8182147733553314 | C1: 0.9124 | C2: 0.8503 | C3: 0.6036
Epoch 391/400 | Train Loss: 29.2305
 Avg Train Loss: 29.2305 | Seg Loss: 0.2923 | Recon Loss: 0.0043
  Val mIoU: 0.8013 (Best: 0.8163)
  [Class IoU] C0: 0.8137739314126786 | C1: 0.9161 | C2: 0.8558 | C3: 0.6194
Epoch 392/400 | Train Loss: 29.8559
 Avg Train Loss: 29.8559 | Seg Loss: 0.2985 | Recon Loss: 0.0043
  Val mIoU: 0.8046 (Best: 0.8163)
  [Class IoU] C0: 0.8194083953704169 | C1: 0.9166 | C2: 0.8553 | C3: 0.6272
Epoch 393/400 | Train Loss: 29.5662
 Avg Train Loss: 29.5662 | Seg Loss: 0.2956 | Recon Loss: 0.0044
  Val mIoU: 0.8063 (Best: 0.8163)
  [Class IoU] C0: 0.8185984739030352 | C1: 0.9194 | C2: 0.8600 | C3: 0.6272
Epoch 394/400 | Train Loss: 30.2439
 Avg Train Loss: 30.2439 | Seg Loss: 0.3024 | Recon Loss: 0.0042
  Val mIoU: 0.6869 (Best: 0.8163)
  [Class IoU] C0: 0.6673148441261675 | C1: 0.6102 | C2: 0.8498 | C3: 0.6203
Epoch 395/400 | Train Loss: 29.7884
 Avg Train Loss: 29.7884 | Seg Loss: 0.2978 | Recon Loss: 0.0043
  Val mIoU: 0.7918 (Best: 0.8163)
  [Class IoU] C0: 0.7927811197782009 | C1: 0.8973 | C2: 0.8540 | C3: 0.6232
Epoch 396/400 | Train Loss: 30.0481
 Avg Train Loss: 30.0481 | Seg Loss: 0.3004 | Recon Loss: 0.0044
  Val mIoU: 0.7967 (Best: 0.8163)
  [Class IoU] C0: 0.8192126753759373 | C1: 0.9207 | C2: 0.8497 | C3: 0.5971
Epoch 397/400 | Train Loss: 29.4840
 Avg Train Loss: 29.4840 | Seg Loss: 0.2948 | Recon Loss: 0.0045
  Val mIoU: 0.8050 (Best: 0.8163)
  [Class IoU] C0: 0.8171553323145754 | C1: 0.9168 | C2: 0.8587 | C3: 0.6274
Epoch 398/400 | Train Loss: 29.6947
 Avg Train Loss: 29.6947 | Seg Loss: 0.2969 | Recon Loss: 0.0044
  Val mIoU: 0.7551 (Best: 0.8163)
  [Class IoU] C0: 0.759711847741284 | C1: 0.7886 | C2: 0.8519 | C3: 0.6201
Epoch 399/400 | Train Loss: 30.0003
 Avg Train Loss: 30.0003 | Seg Loss: 0.3000 | Recon Loss: 0.0043
  Val mIoU: 0.7996 (Best: 0.8163)
  [Class IoU] C0: 0.808463227245968 | C1: 0.9140 | C2: 0.8563 | C3: 0.6196
Epoch 400/400 | Train Loss: 29.5705
 Avg Train Loss: 29.5705 | Seg Loss: 0.2957 | Recon Loss: 0.0043
  Val mIoU: 0.8035 (Best: 0.8163)
  [Class IoU] C0: 0.814971088137834 | C1: 0.9175 | C2: 0.8569 | C3: 0.6247
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights and curves...
Best model saved /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Trained_models/VAE_val_best.pth
Final model saved /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Trained_models/VAE_val_final.pth
Done.
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27237068: <VAE_job_resnet> in cluster <dcc> Done

Job <VAE_job_resnet> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Mon Dec  1 15:00:37 2025
Job was executed on host(s) <8*n-62-13-14>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Mon Dec  1 18:03:35 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Mon Dec  1 18:03:35 2025
Terminated at Mon Dec  1 23:33:00 2025
Results reported at Mon Dec  1 23:33:00 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J VAE_job_resnet

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_%J.err
### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=16GB]"   # Request 16GB memory
#BSUB -W 15:00                # 4 hour runtime limit

### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."
# This is the full, correct path to your environment
source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

### --- Run Script ---
echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/VAE_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   95494.00 sec.
    Max Memory :                                 2585 MB
    Average Memory :                             2103.84 MB
    Total Requested Memory :                     131072.00 MB
    Delta Memory :                               128487.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                189
    Run time :                                   19776 sec.
    Turnaround time :                            30743 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_27237068.err> for stderr output of this job.

