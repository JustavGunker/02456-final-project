Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
--- Data Splits ---
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
Validation: [27, 28, 29, 30]
--- Loaders Ready ---
--- Starting Training ---
Epoch 1/800 | Train Loss: 3.7488
  Seg: 0.7403 | Recon: 0.0472
  Val mIoU: 0.6213 (Best: 0.0000)
  [Class IoU] C1: 0.8010 | C2: 0.7288 | C3: 0.3342
  --> New Best Model Saved!
Epoch 2/800 | Train Loss: 3.2412
  Seg: 0.6425 | Recon: 0.0288
  Val mIoU: 0.6845 (Best: 0.6213)
  [Class IoU] C1: 0.8273 | C2: 0.7640 | C3: 0.4622
  --> New Best Model Saved!
Epoch 3/800 | Train Loss: 2.9587
  Seg: 0.5886 | Recon: 0.0155
  Val mIoU: 0.7337 (Best: 0.6845)
  [Class IoU] C1: 0.8831 | C2: 0.7704 | C3: 0.5475
  --> New Best Model Saved!
Epoch 4/800 | Train Loss: 2.8568
  Seg: 0.5690 | Recon: 0.0120
  Val mIoU: 0.7391 (Best: 0.7337)
  [Class IoU] C1: 0.8671 | C2: 0.7951 | C3: 0.5552
  --> New Best Model Saved!
Epoch 5/800 | Train Loss: 2.7213
  Seg: 0.5421 | Recon: 0.0107
  Val mIoU: 0.7465 (Best: 0.7391)
  [Class IoU] C1: 0.8951 | C2: 0.7972 | C3: 0.5472
  --> New Best Model Saved!
Epoch 6/800 | Train Loss: 2.6672
  Seg: 0.5315 | Recon: 0.0095
  Val mIoU: 0.6253 (Best: 0.7465)
  [Class IoU] C1: 0.8961 | C2: 0.6160 | C3: 0.3637
  Patience count: 1/50
Epoch 7/800 | Train Loss: 2.5441
  Seg: 0.5070 | Recon: 0.0090
  Val mIoU: 0.5811 (Best: 0.7465)
  [Class IoU] C1: 0.8896 | C2: 0.5623 | C3: 0.2915
  Patience count: 2/50
Epoch 8/800 | Train Loss: 2.4679
  Seg: 0.4919 | Recon: 0.0085
  Val mIoU: 0.7296 (Best: 0.7465)
  [Class IoU] C1: 0.9179 | C2: 0.7645 | C3: 0.5064
  Patience count: 3/50
Epoch 9/800 | Train Loss: 2.4470
  Seg: 0.4877 | Recon: 0.0085
  Val mIoU: 0.7072 (Best: 0.7465)
  [Class IoU] C1: 0.9189 | C2: 0.7267 | C3: 0.4760
  Patience count: 4/50
Epoch 10/800 | Train Loss: 2.3779
  Seg: 0.4740 | Recon: 0.0082
  Val mIoU: 0.7398 (Best: 0.7465)
  [Class IoU] C1: 0.8933 | C2: 0.7949 | C3: 0.5312
  Patience count: 5/50
Epoch 11/800 | Train Loss: 2.3683
  Seg: 0.4721 | Recon: 0.0078
  Val mIoU: 0.7459 (Best: 0.7465)
  [Class IoU] C1: 0.8755 | C2: 0.8114 | C3: 0.5509
  Patience count: 6/50
Epoch 12/800 | Train Loss: 2.3102
  Seg: 0.4605 | Recon: 0.0077
  Val mIoU: 0.4707 (Best: 0.7465)
  [Class IoU] C1: 0.9090 | C2: 0.3096 | C3: 0.1935
  Patience count: 7/50
Epoch 13/800 | Train Loss: 2.2935
  Seg: 0.4572 | Recon: 0.0074
  Val mIoU: 0.5253 (Best: 0.7465)
  [Class IoU] C1: 0.9168 | C2: 0.4323 | C3: 0.2266
  Patience count: 8/50
Epoch 14/800 | Train Loss: 2.2388
  Seg: 0.4463 | Recon: 0.0074
  Val mIoU: 0.6685 (Best: 0.7465)
  [Class IoU] C1: 0.9178 | C2: 0.6874 | C3: 0.4002
  Patience count: 9/50
Epoch 15/800 | Train Loss: 2.2704
  Seg: 0.4526 | Recon: 0.0073
  Val mIoU: 0.7323 (Best: 0.7465)
  [Class IoU] C1: 0.9062 | C2: 0.7992 | C3: 0.4914
  Patience count: 10/50
Epoch 16/800 | Train Loss: 2.1973
  Seg: 0.4380 | Recon: 0.0072
  Val mIoU: 0.5004 (Best: 0.7465)
  [Class IoU] C1: 0.9202 | C2: 0.3711 | C3: 0.2100
  Patience count: 11/50
Epoch 17/800 | Train Loss: 2.1414
  Seg: 0.4269 | Recon: 0.0067
  Val mIoU: 0.4922 (Best: 0.7465)
  [Class IoU] C1: 0.9246 | C2: 0.3449 | C3: 0.2069
  Patience count: 12/50
Epoch 18/800 | Train Loss: 2.1425
  Seg: 0.4271 | Recon: 0.0072
  Val mIoU: 0.7094 (Best: 0.7465)
  [Class IoU] C1: 0.9208 | C2: 0.7989 | C3: 0.4086
  Patience count: 13/50
Epoch 19/800 | Train Loss: 2.1150
  Seg: 0.4216 | Recon: 0.0070
  Val mIoU: 0.6549 (Best: 0.7465)
  [Class IoU] C1: 0.9217 | C2: 0.6875 | C3: 0.3554
  Patience count: 14/50
Epoch 20/800 | Train Loss: 2.1303
  Seg: 0.4246 | Recon: 0.0071
  Val mIoU: 0.6615 (Best: 0.7465)
  [Class IoU] C1: 0.9224 | C2: 0.6904 | C3: 0.3718
  Patience count: 15/50
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_big_vali/AG_epoch_0020_predictions.png
Epoch 21/800 | Train Loss: 2.0909
  Seg: 0.4168 | Recon: 0.0068
  Val mIoU: 0.7216 (Best: 0.7465)
  [Class IoU] C1: 0.9238 | C2: 0.8121 | C3: 0.4288
  Patience count: 16/50
Epoch 22/800 | Train Loss: 2.0855
  Seg: 0.4157 | Recon: 0.0067
  Val mIoU: 0.5782 (Best: 0.7465)
  [Class IoU] C1: 0.9068 | C2: 0.5569 | C3: 0.2708
  Patience count: 17/50
Epoch 23/800 | Train Loss: 2.0483
  Seg: 0.4084 | Recon: 0.0065
  Val mIoU: 0.7567 (Best: 0.7465)
  [Class IoU] C1: 0.9153 | C2: 0.8201 | C3: 0.5347
  --> New Best Model Saved!
Epoch 24/800 | Train Loss: 2.0563
  Seg: 0.4099 | Recon: 0.0066
  Val mIoU: 0.7177 (Best: 0.7567)
  [Class IoU] C1: 0.9268 | C2: 0.8015 | C3: 0.4247
  Patience count: 1/50
Epoch 25/800 | Train Loss: 2.0470
  Seg: 0.4080 | Recon: 0.0068
  Val mIoU: 0.5424 (Best: 0.7567)
  [Class IoU] C1: 0.9267 | C2: 0.4646 | C3: 0.2360
  Patience count: 2/50
Epoch 26/800 | Train Loss: 2.0298
  Seg: 0.4046 | Recon: 0.0068
  Val mIoU: 0.5310 (Best: 0.7567)
  [Class IoU] C1: 0.9168 | C2: 0.4427 | C3: 0.2335
  Patience count: 3/50
Epoch 27/800 | Train Loss: 2.0443
  Seg: 0.4076 | Recon: 0.0064
  Val mIoU: 0.7546 (Best: 0.7567)
  [Class IoU] C1: 0.9251 | C2: 0.8200 | C3: 0.5187
  Patience count: 4/50
Epoch 28/800 | Train Loss: 2.0023
  Seg: 0.3992 | Recon: 0.0064
  Val mIoU: 0.7465 (Best: 0.7567)
  [Class IoU] C1: 0.9226 | C2: 0.7993 | C3: 0.5175
  Patience count: 5/50
Epoch 29/800 | Train Loss: 2.0142
  Seg: 0.4016 | Recon: 0.0063
  Val mIoU: 0.5388 (Best: 0.7567)
  [Class IoU] C1: 0.9272 | C2: 0.4592 | C3: 0.2299
  Patience count: 6/50
Epoch 30/800 | Train Loss: 1.9553
  Seg: 0.3899 | Recon: 0.0060
  Val mIoU: 0.6307 (Best: 0.7567)
  [Class IoU] C1: 0.9263 | C2: 0.6506 | C3: 0.3151
  Patience count: 7/50
Epoch 31/800 | Train Loss: 1.9790
  Seg: 0.3946 | Recon: 0.0063
  Val mIoU: 0.7049 (Best: 0.7567)
  [Class IoU] C1: 0.9231 | C2: 0.7904 | C3: 0.4013
  Patience count: 8/50
Epoch 32/800 | Train Loss: 1.9990
  Seg: 0.3986 | Recon: 0.0061
  Val mIoU: 0.5180 (Best: 0.7567)
  [Class IoU] C1: 0.9265 | C2: 0.4248 | C3: 0.2026
  Patience count: 9/50
Epoch 33/800 | Train Loss: 1.9556
  Seg: 0.3899 | Recon: 0.0059
  Val mIoU: 0.5875 (Best: 0.7567)
  [Class IoU] C1: 0.9122 | C2: 0.5778 | C3: 0.2726
  Patience count: 10/50
Epoch 34/800 | Train Loss: 1.9734
  Seg: 0.3935 | Recon: 0.0061
  Val mIoU: 0.6428 (Best: 0.7567)
  [Class IoU] C1: 0.9246 | C2: 0.6753 | C3: 0.3286
  Patience count: 11/50
Epoch 35/800 | Train Loss: 1.9406
  Seg: 0.3869 | Recon: 0.0059
  Val mIoU: 0.5866 (Best: 0.7567)
  [Class IoU] C1: 0.9234 | C2: 0.5621 | C3: 0.2744
  Patience count: 12/50
Epoch 36/800 | Train Loss: 1.9241
  Seg: 0.3836 | Recon: 0.0059
  Val mIoU: 0.7093 (Best: 0.7567)
  [Class IoU] C1: 0.9118 | C2: 0.7721 | C3: 0.4439
  Patience count: 13/50
Epoch 37/800 | Train Loss: 1.9148
  Seg: 0.3818 | Recon: 0.0060
  Val mIoU: 0.7059 (Best: 0.7567)
  [Class IoU] C1: 0.9274 | C2: 0.7623 | C3: 0.4279
  Patience count: 14/50
Epoch 38/800 | Train Loss: 1.9201
  Seg: 0.3828 | Recon: 0.0059
  Val mIoU: 0.7188 (Best: 0.7567)
  [Class IoU] C1: 0.9264 | C2: 0.8152 | C3: 0.4149
  Patience count: 15/50
Epoch 39/800 | Train Loss: 1.9211
  Seg: 0.3830 | Recon: 0.0059
  Val mIoU: 0.7740 (Best: 0.7567)
  [Class IoU] C1: 0.9288 | C2: 0.8346 | C3: 0.5586
  --> New Best Model Saved!
Epoch 40/800 | Train Loss: 1.9129
  Seg: 0.3814 | Recon: 0.0058
  Val mIoU: 0.7223 (Best: 0.7740)
  [Class IoU] C1: 0.9271 | C2: 0.7929 | C3: 0.4470
  Patience count: 1/50
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_big_vali/AG_epoch_0040_predictions.png
Epoch 41/800 | Train Loss: 1.9551
  Seg: 0.3899 | Recon: 0.0057
  Val mIoU: 0.7376 (Best: 0.7740)
  [Class IoU] C1: 0.9297 | C2: 0.8043 | C3: 0.4790
  Patience count: 2/50
Epoch 42/800 | Train Loss: 1.9243
  Seg: 0.3837 | Recon: 0.0057
  Val mIoU: 0.6273 (Best: 0.7740)
  [Class IoU] C1: 0.9241 | C2: 0.6477 | C3: 0.3099
  Patience count: 3/50
Epoch 43/800 | Train Loss: 1.8952
  Seg: 0.3779 | Recon: 0.0057
  Val mIoU: 0.5394 (Best: 0.7740)
  [Class IoU] C1: 0.9228 | C2: 0.4693 | C3: 0.2261
  Patience count: 4/50
Epoch 44/800 | Train Loss: 1.9021
  Seg: 0.3793 | Recon: 0.0058
  Val mIoU: 0.4480 (Best: 0.7740)
  [Class IoU] C1: 0.9146 | C2: 0.2671 | C3: 0.1623
  Patience count: 5/50
Epoch 45/800 | Train Loss: 1.8915
  Seg: 0.3772 | Recon: 0.0054
  Val mIoU: 0.7668 (Best: 0.7740)
  [Class IoU] C1: 0.9270 | C2: 0.8304 | C3: 0.5431
  Patience count: 6/50
Epoch 46/800 | Train Loss: 1.8717
  Seg: 0.3732 | Recon: 0.0056
  Val mIoU: 0.7865 (Best: 0.7740)
  [Class IoU] C1: 0.9298 | C2: 0.8390 | C3: 0.5909
  --> New Best Model Saved!
Epoch 47/800 | Train Loss: 1.8662
  Seg: 0.3721 | Recon: 0.0056
  Val mIoU: 0.6398 (Best: 0.7865)
  [Class IoU] C1: 0.9242 | C2: 0.6569 | C3: 0.3384
  Patience count: 1/50
Epoch 48/800 | Train Loss: 1.8561
  Seg: 0.3701 | Recon: 0.0056
  Val mIoU: 0.6177 (Best: 0.7865)
  [Class IoU] C1: 0.9277 | C2: 0.6180 | C3: 0.3074
  Patience count: 2/50
Epoch 49/800 | Train Loss: 1.8540
  Seg: 0.3697 | Recon: 0.0056
  Val mIoU: 0.7814 (Best: 0.7865)
  [Class IoU] C1: 0.9285 | C2: 0.8432 | C3: 0.5726
  Patience count: 3/50
Epoch 50/800 | Train Loss: 1.8866
  Seg: 0.3762 | Recon: 0.0054
  Val mIoU: 0.7810 (Best: 0.7865)
  [Class IoU] C1: 0.9263 | C2: 0.8408 | C3: 0.5759
  Patience count: 4/50
Epoch 51/800 | Train Loss: 1.8774
  Seg: 0.3744 | Recon: 0.0056
  Val mIoU: 0.6734 (Best: 0.7865)
  [Class IoU] C1: 0.9256 | C2: 0.7146 | C3: 0.3800
  Patience count: 5/50
Epoch 52/800 | Train Loss: 1.8776
  Seg: 0.3744 | Recon: 0.0055
  Val mIoU: 0.7293 (Best: 0.7865)
  [Class IoU] C1: 0.9275 | C2: 0.7846 | C3: 0.4759
  Patience count: 6/50
Epoch 53/800 | Train Loss: 1.8720
  Seg: 0.3733 | Recon: 0.0055
  Val mIoU: 0.7177 (Best: 0.7865)
  [Class IoU] C1: 0.9286 | C2: 0.7728 | C3: 0.4518
  Patience count: 7/50
Epoch 54/800 | Train Loss: 1.8226
  Seg: 0.3634 | Recon: 0.0057
  Val mIoU: 0.5447 (Best: 0.7865)
  [Class IoU] C1: 0.9243 | C2: 0.4740 | C3: 0.2357
  Patience count: 8/50
Epoch 55/800 | Train Loss: 1.8194
  Seg: 0.3628 | Recon: 0.0056
  Val mIoU: 0.7851 (Best: 0.7865)
  [Class IoU] C1: 0.9251 | C2: 0.8439 | C3: 0.5862
  Patience count: 9/50
Epoch 56/800 | Train Loss: 1.8544
  Seg: 0.3698 | Recon: 0.0053
  Val mIoU: 0.7063 (Best: 0.7865)
  [Class IoU] C1: 0.9229 | C2: 0.7617 | C3: 0.4343
  Patience count: 10/50
Epoch 57/800 | Train Loss: 1.8448
  Seg: 0.3678 | Recon: 0.0055
  Val mIoU: 0.6444 (Best: 0.7865)
  [Class IoU] C1: 0.9218 | C2: 0.6785 | C3: 0.3329
  Patience count: 11/50
Epoch 58/800 | Train Loss: 1.8087
  Seg: 0.3607 | Recon: 0.0053
  Val mIoU: 0.7274 (Best: 0.7865)
  [Class IoU] C1: 0.9244 | C2: 0.7907 | C3: 0.4671
  Patience count: 12/50
Epoch 59/800 | Train Loss: 1.8389
  Seg: 0.3667 | Recon: 0.0053
  Val mIoU: 0.6592 (Best: 0.7865)
  [Class IoU] C1: 0.9260 | C2: 0.7080 | C3: 0.3436
  Patience count: 13/50
Epoch 60/800 | Train Loss: 1.8360
  Seg: 0.3661 | Recon: 0.0053
  Val mIoU: 0.7567 (Best: 0.7865)
  [Class IoU] C1: 0.9252 | C2: 0.8387 | C3: 0.5063
  Patience count: 14/50
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_big_vali/AG_epoch_0060_predictions.png
Epoch 61/800 | Train Loss: 1.8026
  Seg: 0.3594 | Recon: 0.0055
  Val mIoU: 0.7697 (Best: 0.7865)
  [Class IoU] C1: 0.9097 | C2: 0.8380 | C3: 0.5614
  Patience count: 15/50
Epoch 62/800 | Train Loss: 1.7947
  Seg: 0.3579 | Recon: 0.0054
  Val mIoU: 0.7850 (Best: 0.7865)
  [Class IoU] C1: 0.9226 | C2: 0.8443 | C3: 0.5880
  Patience count: 16/50
Epoch 63/800 | Train Loss: 1.7977
  Seg: 0.3585 | Recon: 0.0054
  Val mIoU: 0.7176 (Best: 0.7865)
  [Class IoU] C1: 0.9271 | C2: 0.7789 | C3: 0.4469
  Patience count: 17/50
