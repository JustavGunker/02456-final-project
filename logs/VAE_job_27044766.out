Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
/zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Task03_Liver_rs
/zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Task03_Liver_rs
Found 28 image/label pairs.
--- success ---
Found 119 unlabeled images.
--- success ---
--- Training the VAE on Liver Data ---
Epoch 1/200 | Avg Train Loss: 1.4119 | KLD Beta: 0.0000
Epoch 2/200 | Avg Train Loss: 8994.0897 | KLD Beta: 0.0500
Epoch 3/200 | Avg Train Loss: 12618.1445 | KLD Beta: 0.1000
Epoch 4/200 | Avg Train Loss: 10646.8594 | KLD Beta: 0.1500
Epoch 5/200 | Avg Train Loss: 9085.2474 | KLD Beta: 0.2000
Epoch 6/200 | Avg Train Loss: 9058.7797 | KLD Beta: 0.2500
Epoch 7/200 | Avg Train Loss: 9395.3715 | KLD Beta: 0.3000
Epoch 8/200 | Avg Train Loss: 9200.8797 | KLD Beta: 0.3500
Epoch 9/200 | Avg Train Loss: 10395.8638 | KLD Beta: 0.4000
Epoch 10/200 | Avg Train Loss: 11212.1312 | KLD Beta: 0.4500
Epoch 11/200 | Avg Train Loss: 11225.3933 | KLD Beta: 0.5000
Epoch 12/200 | Avg Train Loss: 12530.2014 | KLD Beta: 0.5500
Epoch 13/200 | Avg Train Loss: 12688.9747 | KLD Beta: 0.6000
Epoch 14/200 | Avg Train Loss: 12818.4097 | KLD Beta: 0.6500
Epoch 15/200 | Avg Train Loss: 13110.2256 | KLD Beta: 0.7000
Epoch 16/200 | Avg Train Loss: 13856.8552 | KLD Beta: 0.7500
Epoch 17/200 | Avg Train Loss: 13601.2949 | KLD Beta: 0.8000
Epoch 18/200 | Avg Train Loss: 13971.4037 | KLD Beta: 0.8500
Epoch 19/200 | Avg Train Loss: 13976.5864 | KLD Beta: 0.9000
Epoch 20/200 | Avg Train Loss: 13531.3852 | KLD Beta: 0.9500
Epoch 21/200 | Avg Train Loss: 12150.7296 | KLD Beta: 1.0000
Epoch 22/200 | Avg Train Loss: 11724.6077 | KLD Beta: 1.0000
Epoch 23/200 | Avg Train Loss: 11990.8700 | KLD Beta: 1.0000
Epoch 24/200 | Avg Train Loss: 10460.2165 | KLD Beta: 1.0000
Epoch 25/200 | Avg Train Loss: 9787.9132 | KLD Beta: 1.0000
Epoch 26/200 | Avg Train Loss: 9660.9040 | KLD Beta: 1.0000
Epoch 27/200 | Avg Train Loss: 9087.3752 | KLD Beta: 1.0000
Epoch 28/200 | Avg Train Loss: 8719.0245 | KLD Beta: 1.0000
Epoch 29/200 | Avg Train Loss: 8709.0929 | KLD Beta: 1.0000
Epoch 30/200 | Avg Train Loss: 9182.4894 | KLD Beta: 1.0000
Epoch 31/200 | Avg Train Loss: 7557.7830 | KLD Beta: 1.0000
Epoch 32/200 | Avg Train Loss: 7793.8189 | KLD Beta: 1.0000
Epoch 33/200 | Avg Train Loss: 7568.9866 | KLD Beta: 1.0000
Epoch 34/200 | Avg Train Loss: 6798.1483 | KLD Beta: 1.0000
Epoch 35/200 | Avg Train Loss: 7042.7628 | KLD Beta: 1.0000
Epoch 36/200 | Avg Train Loss: 6270.1809 | KLD Beta: 1.0000
Epoch 37/200 | Avg Train Loss: 6215.8528 | KLD Beta: 1.0000
Epoch 38/200 | Avg Train Loss: 6103.5212 | KLD Beta: 1.0000
Epoch 39/200 | Avg Train Loss: 5660.1646 | KLD Beta: 1.0000
Epoch 40/200 | Avg Train Loss: 6008.7523 | KLD Beta: 1.0000
Epoch 41/200 | Avg Train Loss: 5643.2505 | KLD Beta: 1.0000
Epoch 42/200 | Avg Train Loss: 5149.4230 | KLD Beta: 1.0000
Epoch 43/200 | Avg Train Loss: 5095.3757 | KLD Beta: 1.0000
Epoch 44/200 | Avg Train Loss: 4987.7834 | KLD Beta: 1.0000
Epoch 45/200 | Avg Train Loss: 5026.6214 | KLD Beta: 1.0000
Epoch 46/200 | Avg Train Loss: 4637.2335 | KLD Beta: 1.0000
Epoch 47/200 | Avg Train Loss: 4745.0090 | KLD Beta: 1.0000
Epoch 48/200 | Avg Train Loss: 4681.8940 | KLD Beta: 1.0000
Epoch 49/200 | Avg Train Loss: 4398.5589 | KLD Beta: 1.0000
Epoch 50/200 | Avg Train Loss: 4415.7749 | KLD Beta: 1.0000
Epoch 51/200 | Avg Train Loss: 4173.6357 | KLD Beta: 1.0000
Epoch 52/200 | Avg Train Loss: 4421.5411 | KLD Beta: 1.0000
Epoch 53/200 | Avg Train Loss: 4062.6999 | KLD Beta: 1.0000
Epoch 54/200 | Avg Train Loss: 3776.0075 | KLD Beta: 1.0000
Epoch 55/200 | Avg Train Loss: 3886.3716 | KLD Beta: 1.0000
Epoch 56/200 | Avg Train Loss: 3699.7975 | KLD Beta: 1.0000
Epoch 57/200 | Avg Train Loss: 3707.0473 | KLD Beta: 1.0000
Epoch 58/200 | Avg Train Loss: 3638.1137 | KLD Beta: 1.0000
Epoch 59/200 | Avg Train Loss: 3503.3081 | KLD Beta: 1.0000
Epoch 60/200 | Avg Train Loss: 3189.1107 | KLD Beta: 1.0000
Epoch 61/200 | Avg Train Loss: 3230.0533 | KLD Beta: 1.0000
Epoch 62/200 | Avg Train Loss: 3419.4732 | KLD Beta: 1.0000
Epoch 63/200 | Avg Train Loss: 3121.6854 | KLD Beta: 1.0000
Epoch 64/200 | Avg Train Loss: 3403.5985 | KLD Beta: 1.0000
Epoch 65/200 | Avg Train Loss: 3280.2272 | KLD Beta: 1.0000
Epoch 66/200 | Avg Train Loss: 2932.5549 | KLD Beta: 1.0000
Epoch 67/200 | Avg Train Loss: 3008.4910 | KLD Beta: 1.0000
Epoch 68/200 | Avg Train Loss: 2800.8001 | KLD Beta: 1.0000
Epoch 69/200 | Avg Train Loss: 2767.7453 | KLD Beta: 1.0000
Epoch 70/200 | Avg Train Loss: 2795.6343 | KLD Beta: 1.0000
Epoch 71/200 | Avg Train Loss: 2506.7024 | KLD Beta: 1.0000
Epoch 72/200 | Avg Train Loss: 2806.0251 | KLD Beta: 1.0000
Epoch 73/200 | Avg Train Loss: 2761.8120 | KLD Beta: 1.0000
Epoch 74/200 | Avg Train Loss: 2585.5852 | KLD Beta: 1.0000
Epoch 75/200 | Avg Train Loss: 2453.4015 | KLD Beta: 1.0000
Epoch 76/200 | Avg Train Loss: 2346.2576 | KLD Beta: 1.0000
Epoch 77/200 | Avg Train Loss: 2356.6032 | KLD Beta: 1.0000
Epoch 78/200 | Avg Train Loss: 2464.2809 | KLD Beta: 1.0000
Epoch 79/200 | Avg Train Loss: 2329.4582 | KLD Beta: 1.0000
Epoch 80/200 | Avg Train Loss: 2762.0469 | KLD Beta: 1.0000
Epoch 81/200 | Avg Train Loss: 2392.7387 | KLD Beta: 1.0000
Epoch 82/200 | Avg Train Loss: 2315.9508 | KLD Beta: 1.0000
Epoch 83/200 | Avg Train Loss: 2372.9487 | KLD Beta: 1.0000
Epoch 84/200 | Avg Train Loss: 2408.6800 | KLD Beta: 1.0000
Epoch 85/200 | Avg Train Loss: 2079.3688 | KLD Beta: 1.0000
Epoch 86/200 | Avg Train Loss: 2055.7806 | KLD Beta: 1.0000
Epoch 87/200 | Avg Train Loss: 1850.4401 | KLD Beta: 1.0000
Epoch 88/200 | Avg Train Loss: 1956.6678 | KLD Beta: 1.0000
Epoch 89/200 | Avg Train Loss: 1952.5011 | KLD Beta: 1.0000
Epoch 90/200 | Avg Train Loss: 1793.6786 | KLD Beta: 1.0000
Epoch 91/200 | Avg Train Loss: 1840.2071 | KLD Beta: 1.0000
Epoch 92/200 | Avg Train Loss: 1921.0902 | KLD Beta: 1.0000
Epoch 93/200 | Avg Train Loss: 1793.3044 | KLD Beta: 1.0000
Epoch 94/200 | Avg Train Loss: 1806.0257 | KLD Beta: 1.0000
Epoch 95/200 | Avg Train Loss: 1805.4580 | KLD Beta: 1.0000
Epoch 96/200 | Avg Train Loss: 1886.8440 | KLD Beta: 1.0000
Epoch 97/200 | Avg Train Loss: 1870.3435 | KLD Beta: 1.0000
Epoch 98/200 | Avg Train Loss: 1764.8046 | KLD Beta: 1.0000
Epoch 99/200 | Avg Train Loss: 1576.7907 | KLD Beta: 1.0000
Epoch 100/200 | Avg Train Loss: 1649.2926 | KLD Beta: 1.0000
Epoch 101/200 | Avg Train Loss: 1507.0731 | KLD Beta: 1.0000
Epoch 102/200 | Avg Train Loss: 1450.1084 | KLD Beta: 1.0000
Epoch 103/200 | Avg Train Loss: 1532.8467 | KLD Beta: 1.0000
Epoch 104/200 | Avg Train Loss: 1419.6610 | KLD Beta: 1.0000
Epoch 105/200 | Avg Train Loss: 1377.5849 | KLD Beta: 1.0000
Epoch 106/200 | Avg Train Loss: 1479.4170 | KLD Beta: 1.0000
Epoch 107/200 | Avg Train Loss: 1292.0421 | KLD Beta: 1.0000
Epoch 108/200 | Avg Train Loss: 1380.5712 | KLD Beta: 1.0000
Epoch 109/200 | Avg Train Loss: 1315.8206 | KLD Beta: 1.0000
Epoch 110/200 | Avg Train Loss: 1365.2482 | KLD Beta: 1.0000
Epoch 111/200 | Avg Train Loss: 1235.2297 | KLD Beta: 1.0000
Epoch 112/200 | Avg Train Loss: 1408.0917 | KLD Beta: 1.0000
Epoch 113/200 | Avg Train Loss: 1357.2381 | KLD Beta: 1.0000
Epoch 114/200 | Avg Train Loss: 1315.8508 | KLD Beta: 1.0000
Epoch 115/200 | Avg Train Loss: 1314.8190 | KLD Beta: 1.0000
Epoch 116/200 | Avg Train Loss: 1220.2059 | KLD Beta: 1.0000
Epoch 117/200 | Avg Train Loss: 1325.4846 | KLD Beta: 1.0000
Epoch 118/200 | Avg Train Loss: 1158.8518 | KLD Beta: 1.0000
Epoch 119/200 | Avg Train Loss: 1176.4829 | KLD Beta: 1.0000
Epoch 120/200 | Avg Train Loss: 1085.0419 | KLD Beta: 1.0000
Epoch 121/200 | Avg Train Loss: 1069.1129 | KLD Beta: 1.0000
Epoch 122/200 | Avg Train Loss: 1128.3689 | KLD Beta: 1.0000
Epoch 123/200 | Avg Train Loss: 1165.1214 | KLD Beta: 1.0000
Epoch 124/200 | Avg Train Loss: 996.9224 | KLD Beta: 1.0000
Epoch 125/200 | Avg Train Loss: 1098.4383 | KLD Beta: 1.0000
Epoch 126/200 | Avg Train Loss: 1188.6472 | KLD Beta: 1.0000
Epoch 127/200 | Avg Train Loss: 1017.4547 | KLD Beta: 1.0000
Epoch 128/200 | Avg Train Loss: 905.4264 | KLD Beta: 1.0000
Epoch 129/200 | Avg Train Loss: 1038.8316 | KLD Beta: 1.0000
Epoch 130/200 | Avg Train Loss: 1037.5359 | KLD Beta: 1.0000
Epoch 131/200 | Avg Train Loss: 1097.7718 | KLD Beta: 1.0000
Epoch 132/200 | Avg Train Loss: 1020.8740 | KLD Beta: 1.0000
Epoch 133/200 | Avg Train Loss: 961.4028 | KLD Beta: 1.0000
Epoch 134/200 | Avg Train Loss: 848.7584 | KLD Beta: 1.0000
Epoch 135/200 | Avg Train Loss: 969.3688 | KLD Beta: 1.0000
Epoch 136/200 | Avg Train Loss: 866.6998 | KLD Beta: 1.0000
Epoch 137/200 | Avg Train Loss: 756.4629 | KLD Beta: 1.0000
Epoch 138/200 | Avg Train Loss: 811.2494 | KLD Beta: 1.0000
Epoch 139/200 | Avg Train Loss: 816.3663 | KLD Beta: 1.0000
Epoch 140/200 | Avg Train Loss: 917.2787 | KLD Beta: 1.0000
Epoch 141/200 | Avg Train Loss: 852.8976 | KLD Beta: 1.0000
Epoch 142/200 | Avg Train Loss: 865.8956 | KLD Beta: 1.0000
Epoch 143/200 | Avg Train Loss: 761.5797 | KLD Beta: 1.0000
Epoch 144/200 | Avg Train Loss: 702.2861 | KLD Beta: 1.0000
Epoch 145/200 | Avg Train Loss: 646.2832 | KLD Beta: 1.0000
Epoch 146/200 | Avg Train Loss: 822.6858 | KLD Beta: 1.0000
Epoch 147/200 | Avg Train Loss: 736.3845 | KLD Beta: 1.0000
Epoch 148/200 | Avg Train Loss: 753.8393 | KLD Beta: 1.0000
Epoch 149/200 | Avg Train Loss: 785.6907 | KLD Beta: 1.0000
Epoch 150/200 | Avg Train Loss: 627.5758 | KLD Beta: 1.0000
Epoch 151/200 | Avg Train Loss: 845.7669 | KLD Beta: 1.0000
Epoch 152/200 | Avg Train Loss: 652.0169 | KLD Beta: 1.0000
Epoch 153/200 | Avg Train Loss: 672.5079 | KLD Beta: 1.0000
Epoch 154/200 | Avg Train Loss: 656.5579 | KLD Beta: 1.0000
Epoch 155/200 | Avg Train Loss: 610.8014 | KLD Beta: 1.0000
Epoch 156/200 | Avg Train Loss: 605.3725 | KLD Beta: 1.0000
Epoch 157/200 | Avg Train Loss: 576.2575 | KLD Beta: 1.0000
Epoch 158/200 | Avg Train Loss: 529.7541 | KLD Beta: 1.0000
Epoch 159/200 | Avg Train Loss: 594.4138 | KLD Beta: 1.0000
Epoch 160/200 | Avg Train Loss: 527.7227 | KLD Beta: 1.0000
Epoch 161/200 | Avg Train Loss: 601.8075 | KLD Beta: 1.0000
Epoch 162/200 | Avg Train Loss: 551.0003 | KLD Beta: 1.0000
Epoch 163/200 | Avg Train Loss: 528.9125 | KLD Beta: 1.0000
Epoch 164/200 | Avg Train Loss: 498.4100 | KLD Beta: 1.0000
Epoch 165/200 | Avg Train Loss: 524.4114 | KLD Beta: 1.0000
Epoch 166/200 | Avg Train Loss: 479.8534 | KLD Beta: 1.0000
Epoch 167/200 | Avg Train Loss: 532.3188 | KLD Beta: 1.0000
Epoch 168/200 | Avg Train Loss: 486.6492 | KLD Beta: 1.0000
Epoch 169/200 | Avg Train Loss: 454.5158 | KLD Beta: 1.0000
Epoch 170/200 | Avg Train Loss: 466.7462 | KLD Beta: 1.0000
Epoch 171/200 | Avg Train Loss: 430.8144 | KLD Beta: 1.0000
Epoch 172/200 | Avg Train Loss: 466.3597 | KLD Beta: 1.0000
Epoch 173/200 | Avg Train Loss: 446.1146 | KLD Beta: 1.0000
Epoch 174/200 | Avg Train Loss: 473.4538 | KLD Beta: 1.0000
Epoch 175/200 | Avg Train Loss: 457.3904 | KLD Beta: 1.0000
Epoch 176/200 | Avg Train Loss: 420.4478 | KLD Beta: 1.0000
Epoch 177/200 | Avg Train Loss: 429.3832 | KLD Beta: 1.0000
Epoch 178/200 | Avg Train Loss: 389.7632 | KLD Beta: 1.0000
Epoch 179/200 | Avg Train Loss: 400.5808 | KLD Beta: 1.0000
Epoch 180/200 | Avg Train Loss: 428.4897 | KLD Beta: 1.0000
Epoch 181/200 | Avg Train Loss: 383.6930 | KLD Beta: 1.0000
Epoch 182/200 | Avg Train Loss: 401.2561 | KLD Beta: 1.0000
Epoch 183/200 | Avg Train Loss: 376.2743 | KLD Beta: 1.0000
Epoch 184/200 | Avg Train Loss: 345.1598 | KLD Beta: 1.0000
Epoch 185/200 | Avg Train Loss: 335.4246 | KLD Beta: 1.0000
Epoch 186/200 | Avg Train Loss: 385.2346 | KLD Beta: 1.0000
Epoch 187/200 | Avg Train Loss: 378.2548 | KLD Beta: 1.0000
Epoch 188/200 | Avg Train Loss: 347.0442 | KLD Beta: 1.0000
Epoch 189/200 | Avg Train Loss: 352.2513 | KLD Beta: 1.0000
Epoch 190/200 | Avg Train Loss: 348.2358 | KLD Beta: 1.0000
Epoch 191/200 | Avg Train Loss: 338.4422 | KLD Beta: 1.0000
Epoch 192/200 | Avg Train Loss: 387.0124 | KLD Beta: 1.0000
Epoch 193/200 | Avg Train Loss: 349.3061 | KLD Beta: 1.0000
Epoch 194/200 | Avg Train Loss: 317.5442 | KLD Beta: 1.0000
Epoch 195/200 | Avg Train Loss: 363.8416 | KLD Beta: 1.0000
Epoch 196/200 | Avg Train Loss: 325.5134 | KLD Beta: 1.0000
Epoch 197/200 | Avg Train Loss: 297.5070 | KLD Beta: 1.0000
Epoch 198/200 | Avg Train Loss: 290.5979 | KLD Beta: 1.0000
Epoch 199/200 | Avg Train Loss: 325.6411 | KLD Beta: 1.0000
Epoch 200/200 | Avg Train Loss: 313.3673 | KLD Beta: 1.0000
Training complete.
Saved trained model to /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Trained_models/vae_liver_model.pth
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27044766: <VAE_job> in cluster <dcc> Done

Job <VAE_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Sun Nov 16 15:39:58 2025
Job was executed on host(s) <4*n-62-13-18>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Sun Nov 16 15:39:58 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Sun Nov 16 15:39:58 2025
Terminated at Sun Nov 16 16:09:11 2025
Results reported at Sun Nov 16 16:09:11 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J VAE_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_%J.err
### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 4                    # Request 4 CPU cores
#BSUB -R "rusage[mem=16GB]"   # Request 16GB memory
#BSUB -W 04:00                # 4 hour runtime limit

### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."
# This is the full, correct path to your environment
source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

### --- Run Script ---
echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/VAE.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   1950.00 sec.
    Max Memory :                                 1432 MB
    Average Memory :                             1374.79 MB
    Total Requested Memory :                     65536.00 MB
    Delta Memory :                               64104.00 MB
    Max Swap :                                   -
    Max Processes :                              4
    Max Threads :                                10
    Run time :                                   1790 sec.
    Turnaround time :                            1753 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_27044766.err> for stderr output of this job.

