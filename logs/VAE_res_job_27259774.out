Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 3.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 40, 41, 42, 43]
--- Loaders Ready ---
Train Batches: 59
Val Batches: 16
--- Starting Training ---
Epoch 1/400 | Train Loss: 72.2859
 Avg Train Loss: 72.2859 | Seg Loss: 0.7225 | Recon Loss: 0.0364
  Val mIoU: 0.5949 (Best: 0.0000)
  [Class IoU] C0: 0.6860734222354458 | C1: 0.7363 | C2: 0.7238 | C3: 0.2332
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 81.7047
 Avg Train Loss: 81.7047 | Seg Loss: 0.5943 | Recon Loss: 0.0253
  Val mIoU: 0.6112 (Best: 0.5949)
  [Class IoU] C0: 0.718865393510624 | C1: 0.8295 | C2: 0.7460 | C3: 0.1503
  --> New Best Model Saved!
Epoch 3/400 | Train Loss: 63.1172
 Avg Train Loss: 63.1172 | Seg Loss: 0.5490 | Recon Loss: 0.0164
  Val mIoU: 0.6567 (Best: 0.6112)
  [Class IoU] C0: 0.7137039332990482 | C1: 0.7556 | C2: 0.7745 | C3: 0.3831
  --> New Best Model Saved!
Epoch 4/400 | Train Loss: 57.9616
 Avg Train Loss: 57.9616 | Seg Loss: 0.5190 | Recon Loss: 0.0127
  Val mIoU: 0.6223 (Best: 0.6567)
  [Class IoU] C0: 0.7082008885426887 | C1: 0.6815 | C2: 0.7721 | C3: 0.3276
Epoch 5/400 | Train Loss: 55.7187
 Avg Train Loss: 55.7187 | Seg Loss: 0.5073 | Recon Loss: 0.0109
  Val mIoU: 0.6367 (Best: 0.6567)
  [Class IoU] C0: 0.7235151474892143 | C1: 0.8503 | C2: 0.7644 | C3: 0.2087
Epoch 6/400 | Train Loss: 52.9474
 Avg Train Loss: 52.9474 | Seg Loss: 0.4897 | Recon Loss: 0.0102
  Val mIoU: 0.6721 (Best: 0.6567)
  [Class IoU] C0: 0.7330094060208827 | C1: 0.7784 | C2: 0.7896 | C3: 0.3874
  --> New Best Model Saved!
Epoch 7/400 | Train Loss: 50.5265
 Avg Train Loss: 50.5265 | Seg Loss: 0.4728 | Recon Loss: 0.0096
  Val mIoU: 0.7212 (Best: 0.6721)
  [Class IoU] C0: 0.7437088865065509 | C1: 0.8059 | C2: 0.7978 | C3: 0.5374
  --> New Best Model Saved!
Epoch 8/400 | Train Loss: 48.5619
 Avg Train Loss: 48.5619 | Seg Loss: 0.4609 | Recon Loss: 0.0089
  Val mIoU: 0.6277 (Best: 0.7212)
  [Class IoU] C0: 0.7630257443151847 | C1: 0.8792 | C2: 0.5740 | C3: 0.2946
Epoch 9/400 | Train Loss: 47.0001
 Avg Train Loss: 47.0001 | Seg Loss: 0.4513 | Recon Loss: 0.0089
  Val mIoU: 0.5609 (Best: 0.7212)
  [Class IoU] C0: 0.7771760664842302 | C1: 0.7869 | C2: 0.4438 | C3: 0.2359
Epoch 10/400 | Train Loss: 45.1173
 Avg Train Loss: 45.1173 | Seg Loss: 0.4385 | Recon Loss: 0.0086
  Val mIoU: 0.6821 (Best: 0.7212)
  [Class IoU] C0: 0.7109504915925176 | C1: 0.8626 | C2: 0.7800 | C3: 0.3750
Epoch 11/400 | Train Loss: 44.2269
 Avg Train Loss: 44.2269 | Seg Loss: 0.4348 | Recon Loss: 0.0086
  Val mIoU: 0.7086 (Best: 0.7212)
  [Class IoU] C0: 0.7213609947899264 | C1: 0.8480 | C2: 0.7717 | C3: 0.4933
Epoch 12/400 | Train Loss: 42.3122
 Avg Train Loss: 42.3122 | Seg Loss: 0.4193 | Recon Loss: 0.0083
  Val mIoU: 0.7400 (Best: 0.7212)
  [Class IoU] C0: 0.7729916696357545 | C1: 0.9108 | C2: 0.8036 | C3: 0.4727
  --> New Best Model Saved!
Epoch 13/400 | Train Loss: 41.6733
 Avg Train Loss: 41.6733 | Seg Loss: 0.4144 | Recon Loss: 0.0082
  Val mIoU: 0.7237 (Best: 0.7400)
  [Class IoU] C0: 0.7822507292198193 | C1: 0.9130 | C2: 0.7648 | C3: 0.4349
Epoch 14/400 | Train Loss: 41.2334
 Avg Train Loss: 41.2334 | Seg Loss: 0.4105 | Recon Loss: 0.0075
  Val mIoU: 0.7017 (Best: 0.7400)
  [Class IoU] C0: 0.765702415835402 | C1: 0.8794 | C2: 0.7903 | C3: 0.3712
Epoch 15/400 | Train Loss: 40.6704
 Avg Train Loss: 40.6704 | Seg Loss: 0.4049 | Recon Loss: 0.0077
  Val mIoU: 0.7287 (Best: 0.7400)
  [Class IoU] C0: 0.7787227645871266 | C1: 0.9125 | C2: 0.7975 | C3: 0.4260
Epoch 16/400 | Train Loss: 40.5009
 Avg Train Loss: 40.5009 | Seg Loss: 0.4040 | Recon Loss: 0.0075
  Val mIoU: 0.7423 (Best: 0.7400)
  [Class IoU] C0: 0.7738855935882925 | C1: 0.9126 | C2: 0.8013 | C3: 0.4816
  --> New Best Model Saved!
Epoch 17/400 | Train Loss: 39.6370
 Avg Train Loss: 39.6370 | Seg Loss: 0.3954 | Recon Loss: 0.0073
  Val mIoU: 0.7335 (Best: 0.7423)
  [Class IoU] C0: 0.7722334113084502 | C1: 0.9059 | C2: 0.7944 | C3: 0.4617
Epoch 18/400 | Train Loss: 39.1016
 Avg Train Loss: 39.1016 | Seg Loss: 0.3901 | Recon Loss: 0.0073
  Val mIoU: 0.6970 (Best: 0.7423)
  [Class IoU] C0: 0.7899373106950035 | C1: 0.9190 | C2: 0.7066 | C3: 0.3724
Epoch 19/400 | Train Loss: 38.3993
 Avg Train Loss: 38.3993 | Seg Loss: 0.3834 | Recon Loss: 0.0073
  Val mIoU: 0.7229 (Best: 0.7423)
  [Class IoU] C0: 0.7719249731850216 | C1: 0.9190 | C2: 0.7683 | C3: 0.4324
Epoch 20/400 | Train Loss: 38.9284
 Avg Train Loss: 38.9284 | Seg Loss: 0.3886 | Recon Loss: 0.0070
  Val mIoU: 0.6831 (Best: 0.7423)
  [Class IoU] C0: 0.7579481146912852 | C1: 0.9216 | C2: 0.7819 | C3: 0.2710
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 38.1994
 Avg Train Loss: 38.1994 | Seg Loss: 0.3815 | Recon Loss: 0.0072
  Val mIoU: 0.7535 (Best: 0.7423)
  [Class IoU] C0: 0.7981595237838698 | C1: 0.9181 | C2: 0.8079 | C3: 0.4899
  --> New Best Model Saved!
Epoch 22/400 | Train Loss: 37.8622
 Avg Train Loss: 37.8622 | Seg Loss: 0.3781 | Recon Loss: 0.0069
  Val mIoU: 0.7470 (Best: 0.7535)
  [Class IoU] C0: 0.7768701722590473 | C1: 0.9047 | C2: 0.8070 | C3: 0.4993
Epoch 23/400 | Train Loss: 37.0228
 Avg Train Loss: 37.0228 | Seg Loss: 0.3697 | Recon Loss: 0.0069
  Val mIoU: 0.7304 (Best: 0.7535)
  [Class IoU] C0: 0.7767057194310409 | C1: 0.8992 | C2: 0.7675 | C3: 0.4783
Epoch 24/400 | Train Loss: 37.3393
 Avg Train Loss: 37.3393 | Seg Loss: 0.3729 | Recon Loss: 0.0068
  Val mIoU: 0.7083 (Best: 0.7535)
  [Class IoU] C0: 0.784267117375026 | C1: 0.9233 | C2: 0.7952 | C3: 0.3304
Epoch 25/400 | Train Loss: 37.5347
 Avg Train Loss: 37.5347 | Seg Loss: 0.3748 | Recon Loss: 0.0067
  Val mIoU: 0.6970 (Best: 0.7535)
  [Class IoU] C0: 0.7346006452442959 | C1: 0.9183 | C2: 0.7840 | C3: 0.3512
Epoch 26/400 | Train Loss: 37.2366
 Avg Train Loss: 37.2366 | Seg Loss: 0.3719 | Recon Loss: 0.0065
  Val mIoU: 0.7437 (Best: 0.7535)
  [Class IoU] C0: 0.7650354978880176 | C1: 0.9223 | C2: 0.8063 | C3: 0.4811
Epoch 27/400 | Train Loss: 37.0153
 Avg Train Loss: 37.0153 | Seg Loss: 0.3698 | Recon Loss: 0.0065
  Val mIoU: 0.7506 (Best: 0.7535)
  [Class IoU] C0: 0.7711707626763398 | C1: 0.9235 | C2: 0.8019 | C3: 0.5058
Epoch 28/400 | Train Loss: 36.8326
 Avg Train Loss: 36.8326 | Seg Loss: 0.3680 | Recon Loss: 0.0065
  Val mIoU: 0.7195 (Best: 0.7535)
  [Class IoU] C0: 0.6938224842626811 | C1: 0.9187 | C2: 0.7795 | C3: 0.4859
Epoch 29/400 | Train Loss: 36.0545
 Avg Train Loss: 36.0545 | Seg Loss: 0.3602 | Recon Loss: 0.0063
  Val mIoU: 0.7430 (Best: 0.7535)
  [Class IoU] C0: 0.7627600711303482 | C1: 0.8963 | C2: 0.8072 | C3: 0.5055
Epoch 30/400 | Train Loss: 36.1346
 Avg Train Loss: 36.1346 | Seg Loss: 0.3610 | Recon Loss: 0.0064
  Val mIoU: 0.6990 (Best: 0.7535)
  [Class IoU] C0: 0.7591739858694794 | C1: 0.9234 | C2: 0.7182 | C3: 0.3953
Epoch 31/400 | Train Loss: 36.1186
 Avg Train Loss: 36.1186 | Seg Loss: 0.3608 | Recon Loss: 0.0064
  Val mIoU: 0.7605 (Best: 0.7535)
  [Class IoU] C0: 0.7767774642819572 | C1: 0.9173 | C2: 0.8136 | C3: 0.5343
  --> New Best Model Saved!
Epoch 32/400 | Train Loss: 35.6077
 Avg Train Loss: 35.6077 | Seg Loss: 0.3559 | Recon Loss: 0.0062
  Val mIoU: 0.7456 (Best: 0.7605)
  [Class IoU] C0: 0.7613039213368298 | C1: 0.9112 | C2: 0.7890 | C3: 0.5210
Epoch 33/400 | Train Loss: 34.8478
 Avg Train Loss: 34.8478 | Seg Loss: 0.3483 | Recon Loss: 0.0061
  Val mIoU: 0.7497 (Best: 0.7605)
  [Class IoU] C0: 0.7791028495900296 | C1: 0.9186 | C2: 0.8113 | C3: 0.4900
Epoch 34/400 | Train Loss: 35.9303
 Avg Train Loss: 35.9303 | Seg Loss: 0.3590 | Recon Loss: 0.0062
  Val mIoU: 0.7431 (Best: 0.7605)
  [Class IoU] C0: 0.7958973390596731 | C1: 0.9266 | C2: 0.8119 | C3: 0.4378
Epoch 35/400 | Train Loss: 35.3588
 Avg Train Loss: 35.3588 | Seg Loss: 0.3533 | Recon Loss: 0.0062
  Val mIoU: 0.7561 (Best: 0.7605)
  [Class IoU] C0: 0.7705397660048231 | C1: 0.9261 | C2: 0.7970 | C3: 0.5308
Epoch 36/400 | Train Loss: 34.7702
 Avg Train Loss: 34.7702 | Seg Loss: 0.3475 | Recon Loss: 0.0061
  Val mIoU: 0.7549 (Best: 0.7605)
  [Class IoU] C0: 0.7857861997045813 | C1: 0.9162 | C2: 0.8172 | C3: 0.5005
Epoch 37/400 | Train Loss: 35.4532
 Avg Train Loss: 35.4532 | Seg Loss: 0.3543 | Recon Loss: 0.0063
  Val mIoU: 0.7491 (Best: 0.7605)
  [Class IoU] C0: 0.7613037236208422 | C1: 0.9226 | C2: 0.8096 | C3: 0.5027
Epoch 38/400 | Train Loss: 35.0678
 Avg Train Loss: 35.0678 | Seg Loss: 0.3501 | Recon Loss: 0.0064
  Val mIoU: 0.7719 (Best: 0.7605)
  [Class IoU] C0: 0.7829365672457709 | C1: 0.9171 | C2: 0.8203 | C3: 0.5671
  --> New Best Model Saved!
Epoch 39/400 | Train Loss: 34.2004
 Avg Train Loss: 34.2004 | Seg Loss: 0.3417 | Recon Loss: 0.0060
  Val mIoU: 0.7670 (Best: 0.7719)
  [Class IoU] C0: 0.7877469366423848 | C1: 0.9115 | C2: 0.8158 | C3: 0.5531
Epoch 40/400 | Train Loss: 34.7482
 Avg Train Loss: 34.7482 | Seg Loss: 0.3473 | Recon Loss: 0.0059
  Val mIoU: 0.7706 (Best: 0.7719)
  [Class IoU] C0: 0.7761880083140904 | C1: 0.9227 | C2: 0.8185 | C3: 0.5652
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 33.1234
 Avg Train Loss: 33.1234 | Seg Loss: 0.3310 | Recon Loss: 0.0057
  Val mIoU: 0.7690 (Best: 0.7719)
  [Class IoU] C0: 0.7789033141604332 | C1: 0.9187 | C2: 0.8202 | C3: 0.5583
Epoch 42/400 | Train Loss: 34.3970
 Avg Train Loss: 34.3970 | Seg Loss: 0.3438 | Recon Loss: 0.0058
  Val mIoU: 0.7569 (Best: 0.7719)
  [Class IoU] C0: 0.7756718702828346 | C1: 0.9179 | C2: 0.8139 | C3: 0.5200
Epoch 43/400 | Train Loss: 33.6148
 Avg Train Loss: 33.6148 | Seg Loss: 0.3360 | Recon Loss: 0.0060
  Val mIoU: 0.6608 (Best: 0.7719)
  [Class IoU] C0: 0.7764965526608814 | C1: 0.9118 | C2: 0.6334 | C3: 0.3216
Epoch 44/400 | Train Loss: 34.3604
 Avg Train Loss: 34.3604 | Seg Loss: 0.3434 | Recon Loss: 0.0059
  Val mIoU: 0.7572 (Best: 0.7719)
  [Class IoU] C0: 0.7798010481152696 | C1: 0.9250 | C2: 0.8136 | C3: 0.5104
Epoch 45/400 | Train Loss: 34.5569
 Avg Train Loss: 34.5569 | Seg Loss: 0.3454 | Recon Loss: 0.0060
  Val mIoU: 0.7478 (Best: 0.7719)
  [Class IoU] C0: 0.7890016139566074 | C1: 0.9208 | C2: 0.7971 | C3: 0.4843
Epoch 46/400 | Train Loss: 33.2467
 Avg Train Loss: 33.2467 | Seg Loss: 0.3323 | Recon Loss: 0.0058
  Val mIoU: 0.6988 (Best: 0.7719)
  [Class IoU] C0: 0.8005471879375827 | C1: 0.9263 | C2: 0.6988 | C3: 0.3694
Epoch 47/400 | Train Loss: 33.5533
 Avg Train Loss: 33.5533 | Seg Loss: 0.3354 | Recon Loss: 0.0057
  Val mIoU: 0.7028 (Best: 0.7719)
  [Class IoU] C0: 0.7972799448912353 | C1: 0.9165 | C2: 0.7081 | C3: 0.3893
Epoch 48/400 | Train Loss: 33.9087
 Avg Train Loss: 33.9087 | Seg Loss: 0.3389 | Recon Loss: 0.0057
  Val mIoU: 0.7708 (Best: 0.7719)
  [Class IoU] C0: 0.7744510923447703 | C1: 0.9206 | C2: 0.8203 | C3: 0.5679
Epoch 49/400 | Train Loss: 32.7898
 Avg Train Loss: 32.7898 | Seg Loss: 0.3277 | Recon Loss: 0.0057
  Val mIoU: 0.7573 (Best: 0.7719)
  [Class IoU] C0: 0.7649428097717746 | C1: 0.9106 | C2: 0.8183 | C3: 0.5354
Epoch 50/400 | Train Loss: 32.8495
 Avg Train Loss: 32.8495 | Seg Loss: 0.3284 | Recon Loss: 0.0058
  Val mIoU: 0.7713 (Best: 0.7719)
  [Class IoU] C0: 0.7776965607970531 | C1: 0.9199 | C2: 0.8211 | C3: 0.5663
Epoch 51/400 | Train Loss: 33.2690
 Avg Train Loss: 33.2690 | Seg Loss: 0.3325 | Recon Loss: 0.0056
  Val mIoU: 0.7392 (Best: 0.7719)
  [Class IoU] C0: 0.7864119878564125 | C1: 0.8853 | C2: 0.7851 | C3: 0.4999
Epoch 52/400 | Train Loss: 32.7756
 Avg Train Loss: 32.7756 | Seg Loss: 0.3276 | Recon Loss: 0.0056
  Val mIoU: 0.7139 (Best: 0.7719)
  [Class IoU] C0: 0.8071253241663847 | C1: 0.9266 | C2: 0.7211 | C3: 0.4007
Epoch 53/400 | Train Loss: 32.9525
 Avg Train Loss: 32.9525 | Seg Loss: 0.3294 | Recon Loss: 0.0056
  Val mIoU: 0.7250 (Best: 0.7719)
  [Class IoU] C0: 0.7952973987654199 | C1: 0.9045 | C2: 0.7555 | C3: 0.4447
Epoch 54/400 | Train Loss: 33.1833
 Avg Train Loss: 33.1833 | Seg Loss: 0.3317 | Recon Loss: 0.0057
  Val mIoU: 0.7720 (Best: 0.7719)
  [Class IoU] C0: 0.7864957695409184 | C1: 0.9149 | C2: 0.8272 | C3: 0.5593
  --> New Best Model Saved!
Epoch 55/400 | Train Loss: 32.7192
 Avg Train Loss: 32.7192 | Seg Loss: 0.3271 | Recon Loss: 0.0056
  Val mIoU: 0.7692 (Best: 0.7720)
  [Class IoU] C0: 0.7808465821088671 | C1: 0.8994 | C2: 0.8254 | C3: 0.5709
Epoch 56/400 | Train Loss: 33.2666
 Avg Train Loss: 33.2666 | Seg Loss: 0.3325 | Recon Loss: 0.0054
  Val mIoU: 0.7597 (Best: 0.7720)
  [Class IoU] C0: 0.7928715529913923 | C1: 0.9163 | C2: 0.8207 | C3: 0.5087
Epoch 57/400 | Train Loss: 32.9106
 Avg Train Loss: 32.9106 | Seg Loss: 0.3290 | Recon Loss: 0.0055
  Val mIoU: 0.7586 (Best: 0.7720)
  [Class IoU] C0: 0.7982955890753747 | C1: 0.9253 | C2: 0.7997 | C3: 0.5112
Epoch 58/400 | Train Loss: 32.1579
 Avg Train Loss: 32.1579 | Seg Loss: 0.3214 | Recon Loss: 0.0057
  Val mIoU: 0.7588 (Best: 0.7720)
  [Class IoU] C0: 0.7085234337930245 | C1: 0.9157 | C2: 0.8052 | C3: 0.6058
Epoch 59/400 | Train Loss: 31.9872
 Avg Train Loss: 31.9872 | Seg Loss: 0.3198 | Recon Loss: 0.0052
  Val mIoU: 0.7776 (Best: 0.7720)
  [Class IoU] C0: 0.7769208717090353 | C1: 0.9027 | C2: 0.8326 | C3: 0.5982
  --> New Best Model Saved!
Epoch 60/400 | Train Loss: 32.8543
 Avg Train Loss: 32.8543 | Seg Loss: 0.3284 | Recon Loss: 0.0055
  Val mIoU: 0.7897 (Best: 0.7776)
  [Class IoU] C0: 0.8073374258058883 | C1: 0.9262 | C2: 0.8372 | C3: 0.5883
  --> New Best Model Saved!
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 32.2324
 Avg Train Loss: 32.2324 | Seg Loss: 0.3222 | Recon Loss: 0.0054
  Val mIoU: 0.7869 (Best: 0.7897)
  [Class IoU] C0: 0.7890683957828377 | C1: 0.9178 | C2: 0.8341 | C3: 0.6065
Epoch 62/400 | Train Loss: 32.6946
 Avg Train Loss: 32.6946 | Seg Loss: 0.3268 | Recon Loss: 0.0054
  Val mIoU: 0.7575 (Best: 0.7897)
  [Class IoU] C0: 0.7849534657973158 | C1: 0.9135 | C2: 0.8006 | C3: 0.5308
Epoch 63/400 | Train Loss: 33.5274
 Avg Train Loss: 33.5274 | Seg Loss: 0.3352 | Recon Loss: 0.0054
  Val mIoU: 0.7805 (Best: 0.7897)
  [Class IoU] C0: 0.7995897745420129 | C1: 0.9149 | C2: 0.8285 | C3: 0.5791
Epoch 64/400 | Train Loss: 31.5747
 Avg Train Loss: 31.5747 | Seg Loss: 0.3157 | Recon Loss: 0.0054
  Val mIoU: 0.7908 (Best: 0.7897)
  [Class IoU] C0: 0.7922685484998748 | C1: 0.9235 | C2: 0.8329 | C3: 0.6144
  --> New Best Model Saved!
Epoch 65/400 | Train Loss: 32.7168
 Avg Train Loss: 32.7168 | Seg Loss: 0.3271 | Recon Loss: 0.0053
  Val mIoU: 0.7638 (Best: 0.7908)
  [Class IoU] C0: 0.7697367072363066 | C1: 0.8775 | C2: 0.8199 | C3: 0.5882
Epoch 66/400 | Train Loss: 31.6250
 Avg Train Loss: 31.6250 | Seg Loss: 0.3162 | Recon Loss: 0.0053
  Val mIoU: 0.7372 (Best: 0.7908)
  [Class IoU] C0: 0.792967525010722 | C1: 0.9205 | C2: 0.7787 | C3: 0.4568
Epoch 67/400 | Train Loss: 31.1749
 Avg Train Loss: 31.1749 | Seg Loss: 0.3117 | Recon Loss: 0.0054
  Val mIoU: 0.6449 (Best: 0.7908)
  [Class IoU] C0: 0.8038277609106422 | C1: 0.9228 | C2: 0.5634 | C3: 0.2897
Epoch 68/400 | Train Loss: 32.1244
 Avg Train Loss: 32.1244 | Seg Loss: 0.3211 | Recon Loss: 0.0053
  Val mIoU: 0.6894 (Best: 0.7908)
  [Class IoU] C0: 0.8038997874674941 | C1: 0.9202 | C2: 0.6710 | C3: 0.3624
Epoch 69/400 | Train Loss: 32.4456
 Avg Train Loss: 32.4456 | Seg Loss: 0.3244 | Recon Loss: 0.0052
  Val mIoU: 0.7408 (Best: 0.7908)
  [Class IoU] C0: 0.804721575061376 | C1: 0.9268 | C2: 0.7700 | C3: 0.4616
Epoch 70/400 | Train Loss: 32.2018
 Avg Train Loss: 32.2018 | Seg Loss: 0.3219 | Recon Loss: 0.0052
  Val mIoU: 0.6901 (Best: 0.7908)
  [Class IoU] C0: 0.809200819465458 | C1: 0.9233 | C2: 0.6728 | C3: 0.3550
Epoch 71/400 | Train Loss: 31.5280
 Avg Train Loss: 31.5280 | Seg Loss: 0.3152 | Recon Loss: 0.0052
  Val mIoU: 0.7836 (Best: 0.7908)
  [Class IoU] C0: 0.8063785680663763 | C1: 0.9232 | C2: 0.8364 | C3: 0.5684
Epoch 72/400 | Train Loss: 32.1029
 Avg Train Loss: 32.1029 | Seg Loss: 0.3210 | Recon Loss: 0.0054
  Val mIoU: 0.7970 (Best: 0.7908)
  [Class IoU] C0: 0.8070597474687032 | C1: 0.9144 | C2: 0.8431 | C3: 0.6235
  --> New Best Model Saved!
Epoch 73/400 | Train Loss: 31.7270
 Avg Train Loss: 31.7270 | Seg Loss: 0.3172 | Recon Loss: 0.0053
  Val mIoU: 0.6439 (Best: 0.7970)
  [Class IoU] C0: 0.7918109037262171 | C1: 0.9061 | C2: 0.5819 | C3: 0.2959
Epoch 74/400 | Train Loss: 32.0656
 Avg Train Loss: 32.0656 | Seg Loss: 0.3206 | Recon Loss: 0.0052
  Val mIoU: 0.7850 (Best: 0.7970)
  [Class IoU] C0: 0.8096442348946504 | C1: 0.9098 | C2: 0.8327 | C3: 0.5879
Epoch 75/400 | Train Loss: 31.2853
 Avg Train Loss: 31.2853 | Seg Loss: 0.3128 | Recon Loss: 0.0051
  Val mIoU: 0.7755 (Best: 0.7970)
  [Class IoU] C0: 0.7561333078978675 | C1: 0.9016 | C2: 0.8284 | C3: 0.6160
Epoch 76/400 | Train Loss: 32.2901
 Avg Train Loss: 32.2901 | Seg Loss: 0.3228 | Recon Loss: 0.0053
  Val mIoU: 0.7789 (Best: 0.7970)
  [Class IoU] C0: 0.7292215486836785 | C1: 0.9261 | C2: 0.8218 | C3: 0.6387
Epoch 77/400 | Train Loss: 32.7059
 Avg Train Loss: 32.7059 | Seg Loss: 0.3270 | Recon Loss: 0.0054
  Val mIoU: 0.7963 (Best: 0.7970)
  [Class IoU] C0: 0.7682671252272625 | C1: 0.9169 | C2: 0.8416 | C3: 0.6586
Epoch 78/400 | Train Loss: 31.7836
 Avg Train Loss: 31.7836 | Seg Loss: 0.3178 | Recon Loss: 0.0049
  Val mIoU: 0.7543 (Best: 0.7970)
  [Class IoU] C0: 0.8165852435159684 | C1: 0.9237 | C2: 0.7887 | C3: 0.4880
Epoch 79/400 | Train Loss: 31.6350
 Avg Train Loss: 31.6350 | Seg Loss: 0.3163 | Recon Loss: 0.0050
  Val mIoU: 0.7957 (Best: 0.7970)
  [Class IoU] C0: 0.8193164783785526 | C1: 0.9253 | C2: 0.8442 | C3: 0.5940
Epoch 80/400 | Train Loss: 31.4244
 Avg Train Loss: 31.4244 | Seg Loss: 0.3142 | Recon Loss: 0.0051
  Val mIoU: 0.7943 (Best: 0.7970)
  [Class IoU] C0: 0.8089203503885811 | C1: 0.9193 | C2: 0.8437 | C3: 0.6052
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 30.9321
 Avg Train Loss: 30.9321 | Seg Loss: 0.3093 | Recon Loss: 0.0051
  Val mIoU: 0.7969 (Best: 0.7970)
  [Class IoU] C0: 0.8067438938542963 | C1: 0.9062 | C2: 0.8507 | C3: 0.6241
Epoch 82/400 | Train Loss: 31.6036
 Avg Train Loss: 31.6036 | Seg Loss: 0.3160 | Recon Loss: 0.0052
  Val mIoU: 0.5510 (Best: 0.7970)
  [Class IoU] C0: 0.7189175149232201 | C1: 0.8978 | C2: 0.3875 | C3: 0.1999
Epoch 83/400 | Train Loss: 31.6060
 Avg Train Loss: 31.6060 | Seg Loss: 0.3160 | Recon Loss: 0.0051
  Val mIoU: 0.6611 (Best: 0.7970)
  [Class IoU] C0: 0.7251120791103713 | C1: 0.9231 | C2: 0.6829 | C3: 0.3134
Epoch 84/400 | Train Loss: 31.0378
 Avg Train Loss: 31.0378 | Seg Loss: 0.3103 | Recon Loss: 0.0051
  Val mIoU: 0.7638 (Best: 0.7970)
  [Class IoU] C0: 0.8080278779936779 | C1: 0.9117 | C2: 0.8166 | C3: 0.5190
Epoch 85/400 | Train Loss: 31.6818
 Avg Train Loss: 31.6818 | Seg Loss: 0.3167 | Recon Loss: 0.0052
  Val mIoU: 0.7684 (Best: 0.7970)
  [Class IoU] C0: 0.7519605222393937 | C1: 0.8941 | C2: 0.8312 | C3: 0.5963
Epoch 86/400 | Train Loss: 31.1932
 Avg Train Loss: 31.1932 | Seg Loss: 0.3118 | Recon Loss: 0.0051
  Val mIoU: 0.7857 (Best: 0.7970)
  [Class IoU] C0: 0.7971251503766779 | C1: 0.9139 | C2: 0.8353 | C3: 0.5963
Epoch 87/400 | Train Loss: 30.5609
 Avg Train Loss: 30.5609 | Seg Loss: 0.3055 | Recon Loss: 0.0051
  Val mIoU: 0.7831 (Best: 0.7970)
  [Class IoU] C0: 0.8131678367445498 | C1: 0.9238 | C2: 0.8316 | C3: 0.5640
Epoch 88/400 | Train Loss: 31.2483
 Avg Train Loss: 31.2483 | Seg Loss: 0.3124 | Recon Loss: 0.0051
  Val mIoU: 0.7318 (Best: 0.7970)
  [Class IoU] C0: 0.7944156725149807 | C1: 0.9191 | C2: 0.7662 | C3: 0.4475
Epoch 89/400 | Train Loss: 31.1009
 Avg Train Loss: 31.1009 | Seg Loss: 0.3109 | Recon Loss: 0.0051
  Val mIoU: 0.7836 (Best: 0.7970)
  [Class IoU] C0: 0.8016033106441927 | C1: 0.9182 | C2: 0.8394 | C3: 0.5753
Epoch 90/400 | Train Loss: 31.3587
 Avg Train Loss: 31.3587 | Seg Loss: 0.3135 | Recon Loss: 0.0050
  Val mIoU: 0.7803 (Best: 0.7970)
  [Class IoU] C0: 0.7813542769191157 | C1: 0.9202 | C2: 0.8374 | C3: 0.5823
Epoch 91/400 | Train Loss: 31.2907
 Avg Train Loss: 31.2907 | Seg Loss: 0.3128 | Recon Loss: 0.0049
  Val mIoU: 0.7583 (Best: 0.7970)
  [Class IoU] C0: 0.7573177725578051 | C1: 0.8699 | C2: 0.8299 | C3: 0.5761
Epoch 92/400 | Train Loss: 30.4847
 Avg Train Loss: 30.4847 | Seg Loss: 0.3048 | Recon Loss: 0.0049
  Val mIoU: 0.7707 (Best: 0.7970)
  [Class IoU] C0: 0.809127985924449 | C1: 0.9159 | C2: 0.8218 | C3: 0.5360
Epoch 93/400 | Train Loss: 30.6941
 Avg Train Loss: 30.6941 | Seg Loss: 0.3069 | Recon Loss: 0.0048
  Val mIoU: 0.7509 (Best: 0.7970)
  [Class IoU] C0: 0.7808021609057727 | C1: 0.8290 | C2: 0.8311 | C3: 0.5627
Epoch 94/400 | Train Loss: 30.8569
 Avg Train Loss: 30.8569 | Seg Loss: 0.3085 | Recon Loss: 0.0047
  Val mIoU: 0.7853 (Best: 0.7970)
  [Class IoU] C0: 0.7865156365498795 | C1: 0.8758 | C2: 0.8522 | C3: 0.6268
Epoch 95/400 | Train Loss: 30.4472
 Avg Train Loss: 30.4472 | Seg Loss: 0.3044 | Recon Loss: 0.0047
  Val mIoU: 0.8044 (Best: 0.7970)
  [Class IoU] C0: 0.8177990763030294 | C1: 0.9227 | C2: 0.8562 | C3: 0.6208
  --> New Best Model Saved!
Epoch 96/400 | Train Loss: 30.5986
 Avg Train Loss: 30.5986 | Seg Loss: 0.3059 | Recon Loss: 0.0049
  Val mIoU: 0.7931 (Best: 0.8044)
  [Class IoU] C0: 0.8047438645766719 | C1: 0.9243 | C2: 0.8378 | C3: 0.6056
Epoch 97/400 | Train Loss: 30.9721
 Avg Train Loss: 30.9721 | Seg Loss: 0.3097 | Recon Loss: 0.0049
  Val mIoU: 0.7837 (Best: 0.8044)
  [Class IoU] C0: 0.8104801306403371 | C1: 0.9176 | C2: 0.8366 | C3: 0.5700
Epoch 98/400 | Train Loss: 30.0022
 Avg Train Loss: 30.0022 | Seg Loss: 0.3000 | Recon Loss: 0.0050
  Val mIoU: 0.7653 (Best: 0.8044)
  [Class IoU] C0: 0.8104971914411285 | C1: 0.9230 | C2: 0.8088 | C3: 0.5188
Epoch 99/400 | Train Loss: 30.3750
 Avg Train Loss: 30.3750 | Seg Loss: 0.3037 | Recon Loss: 0.0049
  Val mIoU: 0.7844 (Best: 0.8044)
  [Class IoU] C0: 0.7834789014593982 | C1: 0.9201 | C2: 0.8465 | C3: 0.5876
Epoch 100/400 | Train Loss: 30.6958
 Avg Train Loss: 30.6958 | Seg Loss: 0.3069 | Recon Loss: 0.0048
  Val mIoU: 0.7899 (Best: 0.8044)
  [Class IoU] C0: 0.7965610508967544 | C1: 0.8752 | C2: 0.8555 | C3: 0.6324
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 30.2715
 Avg Train Loss: 30.2715 | Seg Loss: 0.3027 | Recon Loss: 0.0048
  Val mIoU: 0.7799 (Best: 0.8044)
  [Class IoU] C0: 0.8059714409075049 | C1: 0.9179 | C2: 0.8368 | C3: 0.5591
Epoch 102/400 | Train Loss: 31.3953
 Avg Train Loss: 31.3953 | Seg Loss: 0.3139 | Recon Loss: 0.0048
  Val mIoU: 0.7617 (Best: 0.8044)
  [Class IoU] C0: 0.7946547620165628 | C1: 0.8887 | C2: 0.8204 | C3: 0.5429
Epoch 103/400 | Train Loss: 31.0900
 Avg Train Loss: 31.0900 | Seg Loss: 0.3108 | Recon Loss: 0.0047
  Val mIoU: 0.7879 (Best: 0.8044)
  [Class IoU] C0: 0.8166594169518909 | C1: 0.9256 | C2: 0.8405 | C3: 0.5687
Epoch 104/400 | Train Loss: 30.9415
 Avg Train Loss: 30.9415 | Seg Loss: 0.3094 | Recon Loss: 0.0048
  Val mIoU: 0.7779 (Best: 0.8044)
  [Class IoU] C0: 0.8138126705917044 | C1: 0.9259 | C2: 0.8284 | C3: 0.5435
Epoch 105/400 | Train Loss: 29.9258
 Avg Train Loss: 29.9258 | Seg Loss: 0.2992 | Recon Loss: 0.0048
  Val mIoU: 0.8050 (Best: 0.8044)
  [Class IoU] C0: 0.8117501933051561 | C1: 0.9123 | C2: 0.8517 | C3: 0.6443
  --> New Best Model Saved!
Epoch 106/400 | Train Loss: 29.9477
 Avg Train Loss: 29.9477 | Seg Loss: 0.2994 | Recon Loss: 0.0046
  Val mIoU: 0.7892 (Best: 0.8050)
  [Class IoU] C0: 0.8063665129232154 | C1: 0.9068 | C2: 0.8431 | C3: 0.6005
Epoch 107/400 | Train Loss: 30.2063
 Avg Train Loss: 30.2063 | Seg Loss: 0.3020 | Recon Loss: 0.0048
  Val mIoU: 0.7802 (Best: 0.8050)
  [Class IoU] C0: 0.7877089047392156 | C1: 0.9108 | C2: 0.8370 | C3: 0.5851
Epoch 108/400 | Train Loss: 29.6188
 Avg Train Loss: 29.6188 | Seg Loss: 0.2961 | Recon Loss: 0.0047
  Val mIoU: 0.7985 (Best: 0.8050)
  [Class IoU] C0: 0.7842616800356981 | C1: 0.9051 | C2: 0.8515 | C3: 0.6532
Epoch 109/400 | Train Loss: 30.0665
 Avg Train Loss: 30.0665 | Seg Loss: 0.3006 | Recon Loss: 0.0049
  Val mIoU: 0.7971 (Best: 0.8050)
  [Class IoU] C0: 0.8065732032742259 | C1: 0.9189 | C2: 0.8506 | C3: 0.6122
Epoch 110/400 | Train Loss: 30.5703
 Avg Train Loss: 30.5703 | Seg Loss: 0.3056 | Recon Loss: 0.0046
  Val mIoU: 0.7261 (Best: 0.8050)
  [Class IoU] C0: 0.788682979846505 | C1: 0.9211 | C2: 0.7582 | C3: 0.4365
Epoch 111/400 | Train Loss: 30.6852
 Avg Train Loss: 30.6852 | Seg Loss: 0.3068 | Recon Loss: 0.0046
  Val mIoU: 0.7939 (Best: 0.8050)
  [Class IoU] C0: 0.8136425199806473 | C1: 0.9190 | C2: 0.8464 | C3: 0.5965
Epoch 112/400 | Train Loss: 30.5753
 Avg Train Loss: 30.5753 | Seg Loss: 0.3057 | Recon Loss: 0.0047
  Val mIoU: 0.7836 (Best: 0.8050)
  [Class IoU] C0: 0.7956154364690708 | C1: 0.8817 | C2: 0.8472 | C3: 0.6099
Epoch 113/400 | Train Loss: 30.5842
 Avg Train Loss: 30.5842 | Seg Loss: 0.3058 | Recon Loss: 0.0046
  Val mIoU: 0.7738 (Best: 0.8050)
  [Class IoU] C0: 0.8036090572571687 | C1: 0.9102 | C2: 0.8294 | C3: 0.5520
Epoch 114/400 | Train Loss: 30.1601
 Avg Train Loss: 30.1601 | Seg Loss: 0.3015 | Recon Loss: 0.0048
  Val mIoU: 0.8050 (Best: 0.8050)
  [Class IoU] C0: 0.8131351600498292 | C1: 0.9215 | C2: 0.8574 | C3: 0.6278
Epoch 115/400 | Train Loss: 29.9248
 Avg Train Loss: 29.9248 | Seg Loss: 0.2992 | Recon Loss: 0.0047
  Val mIoU: 0.7776 (Best: 0.8050)
  [Class IoU] C0: 0.7888304531512104 | C1: 0.8888 | C2: 0.8365 | C3: 0.5962
Epoch 116/400 | Train Loss: 30.3281
 Avg Train Loss: 30.3281 | Seg Loss: 0.3032 | Recon Loss: 0.0046
  Val mIoU: 0.7993 (Best: 0.8050)
  [Class IoU] C0: 0.7860476742408907 | C1: 0.9174 | C2: 0.8542 | C3: 0.6396
Epoch 117/400 | Train Loss: 30.5258
 Avg Train Loss: 30.5258 | Seg Loss: 0.3052 | Recon Loss: 0.0046
  Val mIoU: 0.8095 (Best: 0.8050)
  [Class IoU] C0: 0.8104500843563351 | C1: 0.9234 | C2: 0.8598 | C3: 0.6443
  --> New Best Model Saved!
Epoch 118/400 | Train Loss: 30.0891
 Avg Train Loss: 30.0891 | Seg Loss: 0.3008 | Recon Loss: 0.0045
  Val mIoU: 0.8011 (Best: 0.8095)
  [Class IoU] C0: 0.8028449757321715 | C1: 0.9146 | C2: 0.8557 | C3: 0.6314
Epoch 119/400 | Train Loss: 29.9178
 Avg Train Loss: 29.9178 | Seg Loss: 0.2991 | Recon Loss: 0.0048
  Val mIoU: 0.7985 (Best: 0.8095)
  [Class IoU] C0: 0.8077153328597391 | C1: 0.9014 | C2: 0.8543 | C3: 0.6305
Epoch 120/400 | Train Loss: 29.5115
 Avg Train Loss: 29.5115 | Seg Loss: 0.2951 | Recon Loss: 0.0046
  Val mIoU: 0.7790 (Best: 0.8095)
  [Class IoU] C0: 0.8008495405541748 | C1: 0.9159 | C2: 0.8333 | C3: 0.5661
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 30.5365
 Avg Train Loss: 30.5365 | Seg Loss: 0.3053 | Recon Loss: 0.0046
  Val mIoU: 0.7795 (Best: 0.8095)
  [Class IoU] C0: 0.7920353102806565 | C1: 0.9141 | C2: 0.8367 | C3: 0.5752
Epoch 122/400 | Train Loss: 30.5730
 Avg Train Loss: 30.5730 | Seg Loss: 0.3057 | Recon Loss: 0.0045
  Val mIoU: 0.7641 (Best: 0.8095)
  [Class IoU] C0: 0.8046173679728472 | C1: 0.9113 | C2: 0.8144 | C3: 0.5263
Epoch 123/400 | Train Loss: 30.0353
 Avg Train Loss: 30.0353 | Seg Loss: 0.3003 | Recon Loss: 0.0047
  Val mIoU: 0.7853 (Best: 0.8095)
  [Class IoU] C0: 0.8029402734309018 | C1: 0.8987 | C2: 0.8446 | C3: 0.5948
Epoch 124/400 | Train Loss: 30.5927
 Avg Train Loss: 30.5927 | Seg Loss: 0.3059 | Recon Loss: 0.0045
  Val mIoU: 0.8149 (Best: 0.8095)
  [Class IoU] C0: 0.8096237990779734 | C1: 0.9163 | C2: 0.8641 | C3: 0.6696
  --> New Best Model Saved!
Epoch 125/400 | Train Loss: 29.8929
 Avg Train Loss: 29.8929 | Seg Loss: 0.2989 | Recon Loss: 0.0047
  Val mIoU: 0.7890 (Best: 0.8149)
  [Class IoU] C0: 0.7975787536487733 | C1: 0.9191 | C2: 0.8482 | C3: 0.5912
Epoch 126/400 | Train Loss: 29.6404
 Avg Train Loss: 29.6404 | Seg Loss: 0.2964 | Recon Loss: 0.0046
  Val mIoU: 0.7676 (Best: 0.8149)
  [Class IoU] C0: 0.8072320704109761 | C1: 0.9246 | C2: 0.8204 | C3: 0.5181
Epoch 127/400 | Train Loss: 29.7711
 Avg Train Loss: 29.7711 | Seg Loss: 0.2977 | Recon Loss: 0.0045
  Val mIoU: 0.7821 (Best: 0.8149)
  [Class IoU] C0: 0.8058302653034001 | C1: 0.9116 | C2: 0.8340 | C3: 0.5770
Epoch 128/400 | Train Loss: 29.6859
 Avg Train Loss: 29.6859 | Seg Loss: 0.2968 | Recon Loss: 0.0045
  Val mIoU: 0.7693 (Best: 0.8149)
  [Class IoU] C0: 0.8023258702348226 | C1: 0.9051 | C2: 0.8253 | C3: 0.5445
Epoch 129/400 | Train Loss: 29.9833
 Avg Train Loss: 29.9833 | Seg Loss: 0.2998 | Recon Loss: 0.0047
  Val mIoU: 0.7738 (Best: 0.8149)
  [Class IoU] C0: 0.796692548944667 | C1: 0.9166 | C2: 0.8150 | C3: 0.5670
Epoch 130/400 | Train Loss: 29.9207
 Avg Train Loss: 29.9207 | Seg Loss: 0.2992 | Recon Loss: 0.0047
  Val mIoU: 0.7710 (Best: 0.8149)
  [Class IoU] C0: 0.8032423610582466 | C1: 0.9084 | C2: 0.8243 | C3: 0.5481
Epoch 131/400 | Train Loss: 29.4236
 Avg Train Loss: 29.4236 | Seg Loss: 0.2942 | Recon Loss: 0.0045
  Val mIoU: 0.7637 (Best: 0.8149)
  [Class IoU] C0: 0.8042092676122663 | C1: 0.9058 | C2: 0.8155 | C3: 0.5294
Epoch 132/400 | Train Loss: 30.3443
 Avg Train Loss: 30.3443 | Seg Loss: 0.3034 | Recon Loss: 0.0047
  Val mIoU: 0.7432 (Best: 0.8149)
  [Class IoU] C0: 0.8007719791473774 | C1: 0.9093 | C2: 0.7846 | C3: 0.4782
Epoch 133/400 | Train Loss: 29.9192
 Avg Train Loss: 29.9192 | Seg Loss: 0.2991 | Recon Loss: 0.0046
  Val mIoU: 0.8054 (Best: 0.8149)
  [Class IoU] C0: 0.819440388477461 | C1: 0.9281 | C2: 0.8548 | C3: 0.6193
Epoch 134/400 | Train Loss: 30.1699
 Avg Train Loss: 30.1699 | Seg Loss: 0.3017 | Recon Loss: 0.0046
  Val mIoU: 0.7354 (Best: 0.8149)
  [Class IoU] C0: 0.804646615035832 | C1: 0.9225 | C2: 0.7742 | C3: 0.4401
Epoch 135/400 | Train Loss: 31.1892
 Avg Train Loss: 31.1892 | Seg Loss: 0.3118 | Recon Loss: 0.0045
  Val mIoU: 0.7226 (Best: 0.8149)
  [Class IoU] C0: 0.7736916936350443 | C1: 0.9203 | C2: 0.7837 | C3: 0.4126
Epoch 136/400 | Train Loss: 30.6219
 Avg Train Loss: 30.6219 | Seg Loss: 0.3062 | Recon Loss: 0.0045
  Val mIoU: 0.7903 (Best: 0.8149)
  [Class IoU] C0: 0.8103400175120341 | C1: 0.9192 | C2: 0.8442 | C3: 0.5875
Epoch 137/400 | Train Loss: 30.0686
 Avg Train Loss: 30.0686 | Seg Loss: 0.3006 | Recon Loss: 0.0045
  Val mIoU: 0.8008 (Best: 0.8149)
  [Class IoU] C0: 0.8088355869275039 | C1: 0.9161 | C2: 0.8574 | C3: 0.6208
Epoch 138/400 | Train Loss: 30.4422
 Avg Train Loss: 30.4422 | Seg Loss: 0.3044 | Recon Loss: 0.0044
  Val mIoU: 0.8042 (Best: 0.8149)
  [Class IoU] C0: 0.8055900327280372 | C1: 0.8964 | C2: 0.8628 | C3: 0.6521
Epoch 139/400 | Train Loss: 29.5142
 Avg Train Loss: 29.5142 | Seg Loss: 0.2951 | Recon Loss: 0.0046
  Val mIoU: 0.8008 (Best: 0.8149)
  [Class IoU] C0: 0.8064850201755109 | C1: 0.8877 | C2: 0.8594 | C3: 0.6495
Epoch 140/400 | Train Loss: 29.8526
 Avg Train Loss: 29.8526 | Seg Loss: 0.2985 | Recon Loss: 0.0045
  Val mIoU: 0.7715 (Best: 0.8149)
  [Class IoU] C0: 0.8093285109228149 | C1: 0.9208 | C2: 0.8261 | C3: 0.5298
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 30.0737
 Avg Train Loss: 30.0737 | Seg Loss: 0.3007 | Recon Loss: 0.0047
  Val mIoU: 0.8033 (Best: 0.8149)
  [Class IoU] C0: 0.806546040969129 | C1: 0.9248 | C2: 0.8636 | C3: 0.6184
Epoch 142/400 | Train Loss: 29.8008
 Avg Train Loss: 29.8008 | Seg Loss: 0.2980 | Recon Loss: 0.0045
  Val mIoU: 0.7543 (Best: 0.8149)
  [Class IoU] C0: 0.8030253106911054 | C1: 0.9148 | C2: 0.8071 | C3: 0.4925
Epoch 143/400 | Train Loss: 29.9771
 Avg Train Loss: 29.9771 | Seg Loss: 0.2997 | Recon Loss: 0.0044
  Val mIoU: 0.7556 (Best: 0.8149)
  [Class IoU] C0: 0.7827751313999665 | C1: 0.9216 | C2: 0.8214 | C3: 0.4967
Epoch 144/400 | Train Loss: 29.7811
 Avg Train Loss: 29.7811 | Seg Loss: 0.2978 | Recon Loss: 0.0046
  Val mIoU: 0.7910 (Best: 0.8149)
  [Class IoU] C0: 0.796456644316408 | C1: 0.8885 | C2: 0.8601 | C3: 0.6191
Epoch 145/400 | Train Loss: 30.2079
 Avg Train Loss: 30.2079 | Seg Loss: 0.3020 | Recon Loss: 0.0047
  Val mIoU: 0.8108 (Best: 0.8149)
  [Class IoU] C0: 0.8115393594791667 | C1: 0.9150 | C2: 0.8629 | C3: 0.6538
Epoch 146/400 | Train Loss: 29.1819
 Avg Train Loss: 29.1819 | Seg Loss: 0.2918 | Recon Loss: 0.0045
  Val mIoU: 0.8103 (Best: 0.8149)
  [Class IoU] C0: 0.8150041379330166 | C1: 0.9185 | C2: 0.8608 | C3: 0.6468
Epoch 147/400 | Train Loss: 30.0618
 Avg Train Loss: 30.0618 | Seg Loss: 0.3006 | Recon Loss: 0.0045
  Val mIoU: 0.8103 (Best: 0.8149)
  [Class IoU] C0: 0.807426798331913 | C1: 0.9173 | C2: 0.8657 | C3: 0.6510
Epoch 148/400 | Train Loss: 30.4374
 Avg Train Loss: 30.4374 | Seg Loss: 0.3043 | Recon Loss: 0.0044
  Val mIoU: 0.7949 (Best: 0.8149)
  [Class IoU] C0: 0.7982714330445517 | C1: 0.9205 | C2: 0.8542 | C3: 0.6065
Epoch 149/400 | Train Loss: 29.5207
 Avg Train Loss: 29.5207 | Seg Loss: 0.2952 | Recon Loss: 0.0046
  Val mIoU: 0.8016 (Best: 0.8149)
  [Class IoU] C0: 0.8026779721299333 | C1: 0.9258 | C2: 0.8591 | C3: 0.6188
Epoch 150/400 | Train Loss: 30.3084
 Avg Train Loss: 30.3084 | Seg Loss: 0.3030 | Recon Loss: 0.0045
  Val mIoU: 0.7940 (Best: 0.8149)
  [Class IoU] C0: 0.8105910038036 | C1: 0.9247 | C2: 0.8498 | C3: 0.5910
Epoch 151/400 | Train Loss: 29.5481
 Avg Train Loss: 29.5481 | Seg Loss: 0.2954 | Recon Loss: 0.0045
  Val mIoU: 0.8042 (Best: 0.8149)
  [Class IoU] C0: 0.8019155457256399 | C1: 0.9080 | C2: 0.8618 | C3: 0.6449
Epoch 152/400 | Train Loss: 28.7253
 Avg Train Loss: 28.7253 | Seg Loss: 0.2872 | Recon Loss: 0.0045
  Val mIoU: 0.7937 (Best: 0.8149)
  [Class IoU] C0: 0.8013496833782497 | C1: 0.9068 | C2: 0.8520 | C3: 0.6149
Epoch 153/400 | Train Loss: 29.9164
 Avg Train Loss: 29.9164 | Seg Loss: 0.2991 | Recon Loss: 0.0045
  Val mIoU: 0.8053 (Best: 0.8149)
  [Class IoU] C0: 0.8157988382444322 | C1: 0.9235 | C2: 0.8586 | C3: 0.6233
Epoch 154/400 | Train Loss: 30.0435
 Avg Train Loss: 30.0435 | Seg Loss: 0.3004 | Recon Loss: 0.0047
  Val mIoU: 0.7979 (Best: 0.8149)
  [Class IoU] C0: 0.8100723001394585 | C1: 0.9166 | C2: 0.8530 | C3: 0.6118
Epoch 155/400 | Train Loss: 29.7285
 Avg Train Loss: 29.7285 | Seg Loss: 0.2972 | Recon Loss: 0.0046
  Val mIoU: 0.7964 (Best: 0.8149)
  [Class IoU] C0: 0.8126716826954474 | C1: 0.9200 | C2: 0.8506 | C3: 0.6022
Epoch 156/400 | Train Loss: 29.4890
 Avg Train Loss: 29.4890 | Seg Loss: 0.2948 | Recon Loss: 0.0045
  Val mIoU: 0.8032 (Best: 0.8149)
  [Class IoU] C0: 0.8161094021409068 | C1: 0.9188 | C2: 0.8572 | C3: 0.6209
Epoch 157/400 | Train Loss: 30.1626
 Avg Train Loss: 30.1626 | Seg Loss: 0.3016 | Recon Loss: 0.0045
  Val mIoU: 0.7822 (Best: 0.8149)
  [Class IoU] C0: 0.8004111865450366 | C1: 0.8910 | C2: 0.8469 | C3: 0.5905
Epoch 158/400 | Train Loss: 29.7757
 Avg Train Loss: 29.7757 | Seg Loss: 0.2977 | Recon Loss: 0.0044
  Val mIoU: 0.7705 (Best: 0.8149)
  [Class IoU] C0: 0.812625656007613 | C1: 0.9243 | C2: 0.8170 | C3: 0.5283
Epoch 159/400 | Train Loss: 29.8196
 Avg Train Loss: 29.8196 | Seg Loss: 0.2981 | Recon Loss: 0.0044
  Val mIoU: 0.8018 (Best: 0.8149)
  [Class IoU] C0: 0.8130636017624876 | C1: 0.9191 | C2: 0.8562 | C3: 0.6188
Epoch 160/400 | Train Loss: 29.8146
 Avg Train Loss: 29.8146 | Seg Loss: 0.2981 | Recon Loss: 0.0045
  Val mIoU: 0.8010 (Best: 0.8149)
  [Class IoU] C0: 0.8099256589214658 | C1: 0.9065 | C2: 0.8542 | C3: 0.6334
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 30.1305
 Avg Train Loss: 30.1305 | Seg Loss: 0.3013 | Recon Loss: 0.0045
  Val mIoU: 0.8038 (Best: 0.8149)
  [Class IoU] C0: 0.8060329554455717 | C1: 0.8856 | C2: 0.8631 | C3: 0.6604
Epoch 162/400 | Train Loss: 29.4666
 Avg Train Loss: 29.4666 | Seg Loss: 0.2946 | Recon Loss: 0.0046
  Val mIoU: 0.7896 (Best: 0.8149)
  [Class IoU] C0: 0.8040968855484597 | C1: 0.9003 | C2: 0.8505 | C3: 0.6033
Epoch 163/400 | Train Loss: 29.6001
 Avg Train Loss: 29.6001 | Seg Loss: 0.2960 | Recon Loss: 0.0044
  Val mIoU: 0.7819 (Best: 0.8149)
  [Class IoU] C0: 0.8092900946038405 | C1: 0.9220 | C2: 0.8360 | C3: 0.5602
Epoch 164/400 | Train Loss: 29.4703
 Avg Train Loss: 29.4703 | Seg Loss: 0.2947 | Recon Loss: 0.0045
  Val mIoU: 0.7818 (Best: 0.8149)
  [Class IoU] C0: 0.8028040178648493 | C1: 0.9010 | C2: 0.8387 | C3: 0.5846
Epoch 165/400 | Train Loss: 29.5086
 Avg Train Loss: 29.5086 | Seg Loss: 0.2950 | Recon Loss: 0.0044
  Val mIoU: 0.7941 (Best: 0.8149)
  [Class IoU] C0: 0.8037348504824293 | C1: 0.8930 | C2: 0.8561 | C3: 0.6237
Epoch 166/400 | Train Loss: 29.3263
 Avg Train Loss: 29.3263 | Seg Loss: 0.2932 | Recon Loss: 0.0045
  Val mIoU: 0.7763 (Best: 0.8149)
  [Class IoU] C0: 0.8031451159874817 | C1: 0.9169 | C2: 0.8359 | C3: 0.5493
Epoch 167/400 | Train Loss: 30.0941
 Avg Train Loss: 30.0941 | Seg Loss: 0.3009 | Recon Loss: 0.0044
  Val mIoU: 0.7941 (Best: 0.8149)
  [Class IoU] C0: 0.7988749578889176 | C1: 0.8996 | C2: 0.8583 | C3: 0.6196
Epoch 168/400 | Train Loss: 29.3159
 Avg Train Loss: 29.3159 | Seg Loss: 0.2931 | Recon Loss: 0.0045
  Val mIoU: 0.8048 (Best: 0.8149)
  [Class IoU] C0: 0.8097623950156075 | C1: 0.9173 | C2: 0.8612 | C3: 0.6308
Epoch 169/400 | Train Loss: 30.6310
 Avg Train Loss: 30.6310 | Seg Loss: 0.3063 | Recon Loss: 0.0044
  Val mIoU: 0.7678 (Best: 0.8149)
  [Class IoU] C0: 0.8071857497045982 | C1: 0.9230 | C2: 0.8217 | C3: 0.5192
Epoch 170/400 | Train Loss: 29.7406
 Avg Train Loss: 29.7406 | Seg Loss: 0.2974 | Recon Loss: 0.0043
  Val mIoU: 0.7646 (Best: 0.8149)
  [Class IoU] C0: 0.8003248344351872 | C1: 0.9247 | C2: 0.8221 | C3: 0.5114
Epoch 171/400 | Train Loss: 29.0236
 Avg Train Loss: 29.0236 | Seg Loss: 0.2902 | Recon Loss: 0.0044
  Val mIoU: 0.8024 (Best: 0.8149)
  [Class IoU] C0: 0.8151382394480298 | C1: 0.9232 | C2: 0.8578 | C3: 0.6133
Epoch 172/400 | Train Loss: 29.6697
 Avg Train Loss: 29.6697 | Seg Loss: 0.2966 | Recon Loss: 0.0045
  Val mIoU: 0.7863 (Best: 0.8149)
  [Class IoU] C0: 0.7951875508673061 | C1: 0.8950 | C2: 0.8523 | C3: 0.6027
Epoch 173/400 | Train Loss: 30.1168
 Avg Train Loss: 30.1168 | Seg Loss: 0.3011 | Recon Loss: 0.0044
  Val mIoU: 0.7950 (Best: 0.8149)
  [Class IoU] C0: 0.812430113624561 | C1: 0.9215 | C2: 0.8519 | C3: 0.5941
Epoch 174/400 | Train Loss: 30.1413
 Avg Train Loss: 30.1413 | Seg Loss: 0.3014 | Recon Loss: 0.0044
  Val mIoU: 0.8052 (Best: 0.8149)
  [Class IoU] C0: 0.8119335068115798 | C1: 0.9152 | C2: 0.8604 | C3: 0.6333
Epoch 175/400 | Train Loss: 29.6311
 Avg Train Loss: 29.6311 | Seg Loss: 0.2963 | Recon Loss: 0.0044
  Val mIoU: 0.7851 (Best: 0.8149)
  [Class IoU] C0: 0.8139355344994212 | C1: 0.9235 | C2: 0.8381 | C3: 0.5648
Epoch 176/400 | Train Loss: 28.7843
 Avg Train Loss: 28.7843 | Seg Loss: 0.2878 | Recon Loss: 0.0045
  Val mIoU: 0.7766 (Best: 0.8149)
  [Class IoU] C0: 0.7912604833909692 | C1: 0.8740 | C2: 0.8483 | C3: 0.5927
Epoch 177/400 | Train Loss: 29.2641
 Avg Train Loss: 29.2641 | Seg Loss: 0.2926 | Recon Loss: 0.0044
  Val mIoU: 0.7830 (Best: 0.8149)
  [Class IoU] C0: 0.8125411709733593 | C1: 0.9238 | C2: 0.8371 | C3: 0.5584
Epoch 178/400 | Train Loss: 29.5546
 Avg Train Loss: 29.5546 | Seg Loss: 0.2955 | Recon Loss: 0.0044
  Val mIoU: 0.7893 (Best: 0.8149)
  [Class IoU] C0: 0.8087018291028525 | C1: 0.9144 | C2: 0.8463 | C3: 0.5879
Epoch 179/400 | Train Loss: 29.4124
 Avg Train Loss: 29.4124 | Seg Loss: 0.2941 | Recon Loss: 0.0045
  Val mIoU: 0.8187 (Best: 0.8149)
  [Class IoU] C0: 0.8169658779925913 | C1: 0.9165 | C2: 0.8686 | C3: 0.6725
  --> New Best Model Saved!
Epoch 180/400 | Train Loss: 29.8674
 Avg Train Loss: 29.8674 | Seg Loss: 0.2986 | Recon Loss: 0.0043
  Val mIoU: 0.8027 (Best: 0.8187)
  [Class IoU] C0: 0.8057571798941559 | C1: 0.9240 | C2: 0.8598 | C3: 0.6210
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 29.2551
 Avg Train Loss: 29.2551 | Seg Loss: 0.2925 | Recon Loss: 0.0043
  Val mIoU: 0.7928 (Best: 0.8187)
  [Class IoU] C0: 0.8083577942956052 | C1: 0.9168 | C2: 0.8528 | C3: 0.5933
Epoch 182/400 | Train Loss: 29.4595
 Avg Train Loss: 29.4595 | Seg Loss: 0.2946 | Recon Loss: 0.0043
  Val mIoU: 0.8019 (Best: 0.8187)
  [Class IoU] C0: 0.805056341263368 | C1: 0.9029 | C2: 0.8626 | C3: 0.6369
Epoch 183/400 | Train Loss: 29.2247
 Avg Train Loss: 29.2247 | Seg Loss: 0.2922 | Recon Loss: 0.0045
  Val mIoU: 0.8154 (Best: 0.8187)
  [Class IoU] C0: 0.812718414695383 | C1: 0.9054 | C2: 0.8683 | C3: 0.6750
Epoch 184/400 | Train Loss: 29.6491
 Avg Train Loss: 29.6491 | Seg Loss: 0.2964 | Recon Loss: 0.0044
  Val mIoU: 0.8087 (Best: 0.8187)
  [Class IoU] C0: 0.8117177703353656 | C1: 0.9202 | C2: 0.8648 | C3: 0.6379
Epoch 185/400 | Train Loss: 29.1553
 Avg Train Loss: 29.1553 | Seg Loss: 0.2915 | Recon Loss: 0.0043
  Val mIoU: 0.8074 (Best: 0.8187)
  [Class IoU] C0: 0.8113582279204972 | C1: 0.9050 | C2: 0.8621 | C3: 0.6509
Epoch 186/400 | Train Loss: 28.7607
 Avg Train Loss: 28.7607 | Seg Loss: 0.2876 | Recon Loss: 0.0043
  Val mIoU: 0.7875 (Best: 0.8187)
  [Class IoU] C0: 0.807442764370706 | C1: 0.9147 | C2: 0.8463 | C3: 0.5817
Epoch 187/400 | Train Loss: 29.2885
 Avg Train Loss: 29.2885 | Seg Loss: 0.2928 | Recon Loss: 0.0043
  Val mIoU: 0.8062 (Best: 0.8187)
  [Class IoU] C0: 0.8138830071654121 | C1: 0.9121 | C2: 0.8611 | C3: 0.6377
Epoch 188/400 | Train Loss: 29.8656
 Avg Train Loss: 29.8656 | Seg Loss: 0.2986 | Recon Loss: 0.0045
  Val mIoU: 0.8136 (Best: 0.8187)
  [Class IoU] C0: 0.813704505098922 | C1: 0.9041 | C2: 0.8674 | C3: 0.6693
Epoch 189/400 | Train Loss: 29.8181
 Avg Train Loss: 29.8181 | Seg Loss: 0.2981 | Recon Loss: 0.0044
  Val mIoU: 0.7992 (Best: 0.8187)
  [Class IoU] C0: 0.808559636838951 | C1: 0.9105 | C2: 0.8584 | C3: 0.6194
Epoch 190/400 | Train Loss: 29.8927
 Avg Train Loss: 29.8927 | Seg Loss: 0.2989 | Recon Loss: 0.0044
  Val mIoU: 0.8054 (Best: 0.8187)
  [Class IoU] C0: 0.8125632136929498 | C1: 0.9174 | C2: 0.8608 | C3: 0.6308
Epoch 191/400 | Train Loss: 29.1487
 Avg Train Loss: 29.1487 | Seg Loss: 0.2914 | Recon Loss: 0.0043
  Val mIoU: 0.7886 (Best: 0.8187)
  [Class IoU] C0: 0.8022569300949964 | C1: 0.8977 | C2: 0.8510 | C3: 0.6035
Epoch 192/400 | Train Loss: 29.8023
 Avg Train Loss: 29.8023 | Seg Loss: 0.2980 | Recon Loss: 0.0044
  Val mIoU: 0.8069 (Best: 0.8187)
  [Class IoU] C0: 0.8106918444215634 | C1: 0.9081 | C2: 0.8617 | C3: 0.6473
Epoch 193/400 | Train Loss: 29.7246
 Avg Train Loss: 29.7246 | Seg Loss: 0.2972 | Recon Loss: 0.0044
  Val mIoU: 0.7859 (Best: 0.8187)
  [Class IoU] C0: 0.8150940296437232 | C1: 0.9265 | C2: 0.8383 | C3: 0.5635
Epoch 194/400 | Train Loss: 29.5617
 Avg Train Loss: 29.5617 | Seg Loss: 0.2956 | Recon Loss: 0.0044
  Val mIoU: 0.7831 (Best: 0.8187)
  [Class IoU] C0: 0.8040585801767673 | C1: 0.9087 | C2: 0.8382 | C3: 0.5813
Epoch 195/400 | Train Loss: 29.1895
 Avg Train Loss: 29.1895 | Seg Loss: 0.2918 | Recon Loss: 0.0044
  Val mIoU: 0.7840 (Best: 0.8187)
  [Class IoU] C0: 0.8053305159986548 | C1: 0.9097 | C2: 0.8400 | C3: 0.5811
Epoch 196/400 | Train Loss: 28.6382
 Avg Train Loss: 28.6382 | Seg Loss: 0.2863 | Recon Loss: 0.0043
  Val mIoU: 0.7946 (Best: 0.8187)
  [Class IoU] C0: 0.8120728839411235 | C1: 0.9213 | C2: 0.8464 | C3: 0.5986
Epoch 197/400 | Train Loss: 29.8418
 Avg Train Loss: 29.8418 | Seg Loss: 0.2984 | Recon Loss: 0.0044
  Val mIoU: 0.8028 (Best: 0.8187)
  [Class IoU] C0: 0.8140838736057016 | C1: 0.9235 | C2: 0.8621 | C3: 0.6115
Epoch 198/400 | Train Loss: 29.6267
 Avg Train Loss: 29.6267 | Seg Loss: 0.2962 | Recon Loss: 0.0043
  Val mIoU: 0.8039 (Best: 0.8187)
  [Class IoU] C0: 0.8148066647126463 | C1: 0.9220 | C2: 0.8546 | C3: 0.6244
Epoch 199/400 | Train Loss: 29.5789
 Avg Train Loss: 29.5789 | Seg Loss: 0.2957 | Recon Loss: 0.0044
  Val mIoU: 0.7988 (Best: 0.8187)
  [Class IoU] C0: 0.8083688167368361 | C1: 0.9079 | C2: 0.8582 | C3: 0.6206
Epoch 200/400 | Train Loss: 29.2150
 Avg Train Loss: 29.2150 | Seg Loss: 0.2921 | Recon Loss: 0.0043
  Val mIoU: 0.8077 (Best: 0.8187)
  [Class IoU] C0: 0.8121851472794487 | C1: 0.9157 | C2: 0.8594 | C3: 0.6435
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 29.3155
 Avg Train Loss: 29.3155 | Seg Loss: 0.2931 | Recon Loss: 0.0043
  Val mIoU: 0.7960 (Best: 0.8187)
  [Class IoU] C0: 0.8034049770230739 | C1: 0.8960 | C2: 0.8547 | C3: 0.6300
Epoch 202/400 | Train Loss: 29.2189
 Avg Train Loss: 29.2189 | Seg Loss: 0.2921 | Recon Loss: 0.0042
  Val mIoU: 0.8019 (Best: 0.8187)
  [Class IoU] C0: 0.8077324081201896 | C1: 0.9046 | C2: 0.8621 | C3: 0.6332
Epoch 203/400 | Train Loss: 29.8333
 Avg Train Loss: 29.8333 | Seg Loss: 0.2983 | Recon Loss: 0.0045
  Val mIoU: 0.8058 (Best: 0.8187)
  [Class IoU] C0: 0.8128641036279897 | C1: 0.9229 | C2: 0.8570 | C3: 0.6305
Epoch 204/400 | Train Loss: 29.6239
 Avg Train Loss: 29.6239 | Seg Loss: 0.2962 | Recon Loss: 0.0043
  Val mIoU: 0.8070 (Best: 0.8187)
  [Class IoU] C0: 0.8096370117058795 | C1: 0.9066 | C2: 0.8619 | C3: 0.6498
Epoch 205/400 | Train Loss: 29.7053
 Avg Train Loss: 29.7053 | Seg Loss: 0.2970 | Recon Loss: 0.0044
  Val mIoU: 0.8101 (Best: 0.8187)
  [Class IoU] C0: 0.8129402528925075 | C1: 0.9209 | C2: 0.8636 | C3: 0.6429
Epoch 206/400 | Train Loss: 29.4052
 Avg Train Loss: 29.4052 | Seg Loss: 0.2940 | Recon Loss: 0.0044
  Val mIoU: 0.8106 (Best: 0.8187)
  [Class IoU] C0: 0.8123272705354049 | C1: 0.9117 | C2: 0.8675 | C3: 0.6507
Epoch 207/400 | Train Loss: 29.5197
 Avg Train Loss: 29.5197 | Seg Loss: 0.2952 | Recon Loss: 0.0043
  Val mIoU: 0.8101 (Best: 0.8187)
  [Class IoU] C0: 0.8118554864363766 | C1: 0.9161 | C2: 0.8614 | C3: 0.6510
Epoch 208/400 | Train Loss: 29.2783
 Avg Train Loss: 29.2783 | Seg Loss: 0.2927 | Recon Loss: 0.0045
  Val mIoU: 0.8086 (Best: 0.8187)
  [Class IoU] C0: 0.8149886381224287 | C1: 0.9186 | C2: 0.8636 | C3: 0.6371
Epoch 209/400 | Train Loss: 29.6080
 Avg Train Loss: 29.6080 | Seg Loss: 0.2960 | Recon Loss: 0.0043
  Val mIoU: 0.7941 (Best: 0.8187)
  [Class IoU] C0: 0.8053088821658405 | C1: 0.9059 | C2: 0.8538 | C3: 0.6111
Epoch 210/400 | Train Loss: 29.2020
 Avg Train Loss: 29.2020 | Seg Loss: 0.2920 | Recon Loss: 0.0044
  Val mIoU: 0.8051 (Best: 0.8187)
  [Class IoU] C0: 0.8087975162010637 | C1: 0.9034 | C2: 0.8647 | C3: 0.6435
Epoch 211/400 | Train Loss: 29.0647
 Avg Train Loss: 29.0647 | Seg Loss: 0.2906 | Recon Loss: 0.0043
  Val mIoU: 0.8041 (Best: 0.8187)
  [Class IoU] C0: 0.8121448478124971 | C1: 0.9164 | C2: 0.8617 | C3: 0.6264
Epoch 212/400 | Train Loss: 29.5760
 Avg Train Loss: 29.5760 | Seg Loss: 0.2957 | Recon Loss: 0.0044
  Val mIoU: 0.7956 (Best: 0.8187)
  [Class IoU] C0: 0.8089908615462669 | C1: 0.9136 | C2: 0.8535 | C3: 0.6061
Epoch 213/400 | Train Loss: 29.5415
 Avg Train Loss: 29.5415 | Seg Loss: 0.2954 | Recon Loss: 0.0044
  Val mIoU: 0.7872 (Best: 0.8187)
  [Class IoU] C0: 0.7967499837414387 | C1: 0.8865 | C2: 0.8573 | C3: 0.6082
Epoch 214/400 | Train Loss: 29.0852
 Avg Train Loss: 29.0852 | Seg Loss: 0.2908 | Recon Loss: 0.0044
  Val mIoU: 0.7991 (Best: 0.8187)
  [Class IoU] C0: 0.8096711956204448 | C1: 0.9123 | C2: 0.8588 | C3: 0.6158
Epoch 215/400 | Train Loss: 29.1591
 Avg Train Loss: 29.1591 | Seg Loss: 0.2915 | Recon Loss: 0.0045
  Val mIoU: 0.7818 (Best: 0.8187)
  [Class IoU] C0: 0.8065583876922603 | C1: 0.9139 | C2: 0.8421 | C3: 0.5647
Epoch 216/400 | Train Loss: 29.2355
 Avg Train Loss: 29.2355 | Seg Loss: 0.2923 | Recon Loss: 0.0042
  Val mIoU: 0.7984 (Best: 0.8187)
  [Class IoU] C0: 0.8071918053909439 | C1: 0.9098 | C2: 0.8596 | C3: 0.6170
Epoch 217/400 | Train Loss: 29.5124
 Avg Train Loss: 29.5124 | Seg Loss: 0.2951 | Recon Loss: 0.0044
  Val mIoU: 0.7999 (Best: 0.8187)
  [Class IoU] C0: 0.8086790173547068 | C1: 0.9072 | C2: 0.8609 | C3: 0.6230
Epoch 218/400 | Train Loss: 28.6012
 Avg Train Loss: 28.6012 | Seg Loss: 0.2860 | Recon Loss: 0.0044
  Val mIoU: 0.8076 (Best: 0.8187)
  [Class IoU] C0: 0.8162588954538453 | C1: 0.9219 | C2: 0.8641 | C3: 0.6282
Epoch 219/400 | Train Loss: 29.1495
 Avg Train Loss: 29.1495 | Seg Loss: 0.2914 | Recon Loss: 0.0045
  Val mIoU: 0.7991 (Best: 0.8187)
  [Class IoU] C0: 0.8106191535870267 | C1: 0.9136 | C2: 0.8567 | C3: 0.6156
Epoch 220/400 | Train Loss: 29.1819
 Avg Train Loss: 29.1819 | Seg Loss: 0.2918 | Recon Loss: 0.0045
  Val mIoU: 0.8111 (Best: 0.8187)
  [Class IoU] C0: 0.8178223498813808 | C1: 0.9215 | C2: 0.8658 | C3: 0.6394
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 28.9042
 Avg Train Loss: 28.9042 | Seg Loss: 0.2890 | Recon Loss: 0.0044
  Val mIoU: 0.7992 (Best: 0.8187)
  [Class IoU] C0: 0.8088701317433019 | C1: 0.9100 | C2: 0.8602 | C3: 0.6176
Epoch 222/400 | Train Loss: 28.7581
 Avg Train Loss: 28.7581 | Seg Loss: 0.2875 | Recon Loss: 0.0043
  Val mIoU: 0.8139 (Best: 0.8187)
  [Class IoU] C0: 0.8199627964901512 | C1: 0.9251 | C2: 0.8682 | C3: 0.6423
Epoch 223/400 | Train Loss: 29.7279
 Avg Train Loss: 29.7279 | Seg Loss: 0.2972 | Recon Loss: 0.0043
  Val mIoU: 0.7903 (Best: 0.8187)
  [Class IoU] C0: 0.7977464349493094 | C1: 0.8830 | C2: 0.8610 | C3: 0.6195
Epoch 224/400 | Train Loss: 30.0473
 Avg Train Loss: 30.0473 | Seg Loss: 0.3004 | Recon Loss: 0.0042
  Val mIoU: 0.7899 (Best: 0.8187)
  [Class IoU] C0: 0.8152214790027819 | C1: 0.9250 | C2: 0.8458 | C3: 0.5735
Epoch 225/400 | Train Loss: 29.4208
 Avg Train Loss: 29.4208 | Seg Loss: 0.2942 | Recon Loss: 0.0043
  Val mIoU: 0.8100 (Best: 0.8187)
  [Class IoU] C0: 0.8141550987652952 | C1: 0.9120 | C2: 0.8685 | C3: 0.6454
Epoch 226/400 | Train Loss: 28.8204
 Avg Train Loss: 28.8204 | Seg Loss: 0.2882 | Recon Loss: 0.0043
  Val mIoU: 0.7913 (Best: 0.8187)
  [Class IoU] C0: 0.802198305163665 | C1: 0.8968 | C2: 0.8584 | C3: 0.6078
Epoch 227/400 | Train Loss: 28.9399
 Avg Train Loss: 28.9399 | Seg Loss: 0.2894 | Recon Loss: 0.0043
  Val mIoU: 0.7841 (Best: 0.8187)
  [Class IoU] C0: 0.8024049573000852 | C1: 0.8973 | C2: 0.8493 | C3: 0.5874
Epoch 228/400 | Train Loss: 29.2773
 Avg Train Loss: 29.2773 | Seg Loss: 0.2927 | Recon Loss: 0.0044
  Val mIoU: 0.7937 (Best: 0.8187)
  [Class IoU] C0: 0.8169394883570569 | C1: 0.9249 | C2: 0.8493 | C3: 0.5836
Epoch 229/400 | Train Loss: 29.9165
 Avg Train Loss: 29.9165 | Seg Loss: 0.2991 | Recon Loss: 0.0043
  Val mIoU: 0.8012 (Best: 0.8187)
  [Class IoU] C0: 0.8125148239730015 | C1: 0.9238 | C2: 0.8520 | C3: 0.6166
Epoch 230/400 | Train Loss: 29.4131
 Avg Train Loss: 29.4131 | Seg Loss: 0.2941 | Recon Loss: 0.0043
  Val mIoU: 0.7952 (Best: 0.8187)
  [Class IoU] C0: 0.8107586701097275 | C1: 0.9187 | C2: 0.8550 | C3: 0.5966
Epoch 231/400 | Train Loss: 28.8076
 Avg Train Loss: 28.8076 | Seg Loss: 0.2880 | Recon Loss: 0.0043
  Val mIoU: 0.7980 (Best: 0.8187)
  [Class IoU] C0: 0.8048784310098235 | C1: 0.8965 | C2: 0.8575 | C3: 0.6332
Epoch 232/400 | Train Loss: 28.9848
 Avg Train Loss: 28.9848 | Seg Loss: 0.2898 | Recon Loss: 0.0044
  Val mIoU: 0.7904 (Best: 0.8187)
  [Class IoU] C0: 0.8057740895280856 | C1: 0.9077 | C2: 0.8492 | C3: 0.5988
Epoch 233/400 | Train Loss: 29.0955
 Avg Train Loss: 29.0955 | Seg Loss: 0.2909 | Recon Loss: 0.0043
  Val mIoU: 0.8096 (Best: 0.8187)
  [Class IoU] C0: 0.8118293856913674 | C1: 0.9075 | C2: 0.8646 | C3: 0.6545
Epoch 234/400 | Train Loss: 29.9781
 Avg Train Loss: 29.9781 | Seg Loss: 0.2997 | Recon Loss: 0.0044
  Val mIoU: 0.7971 (Best: 0.8187)
  [Class IoU] C0: 0.8172870263124652 | C1: 0.9247 | C2: 0.8534 | C3: 0.5931
Epoch 235/400 | Train Loss: 29.5280
 Avg Train Loss: 29.5280 | Seg Loss: 0.2952 | Recon Loss: 0.0043
  Val mIoU: 0.7973 (Best: 0.8187)
  [Class IoU] C0: 0.8132217666370098 | C1: 0.9221 | C2: 0.8569 | C3: 0.5970
Epoch 236/400 | Train Loss: 29.6512
 Avg Train Loss: 29.6512 | Seg Loss: 0.2965 | Recon Loss: 0.0044
  Val mIoU: 0.8030 (Best: 0.8187)
  [Class IoU] C0: 0.808897549668839 | C1: 0.9080 | C2: 0.8633 | C3: 0.6317
Epoch 237/400 | Train Loss: 29.1223
 Avg Train Loss: 29.1223 | Seg Loss: 0.2912 | Recon Loss: 0.0043
  Val mIoU: 0.8049 (Best: 0.8187)
  [Class IoU] C0: 0.8141033603737295 | C1: 0.9154 | C2: 0.8634 | C3: 0.6265
Epoch 238/400 | Train Loss: 29.2815
 Avg Train Loss: 29.2815 | Seg Loss: 0.2928 | Recon Loss: 0.0044
  Val mIoU: 0.8011 (Best: 0.8187)
  [Class IoU] C0: 0.8132416553762662 | C1: 0.9170 | C2: 0.8583 | C3: 0.6158
Epoch 239/400 | Train Loss: 29.2299
 Avg Train Loss: 29.2299 | Seg Loss: 0.2923 | Recon Loss: 0.0043
  Val mIoU: 0.8087 (Best: 0.8187)
  [Class IoU] C0: 0.8104842490794351 | C1: 0.8989 | C2: 0.8665 | C3: 0.6590
Epoch 240/400 | Train Loss: 29.0256
 Avg Train Loss: 29.0256 | Seg Loss: 0.2902 | Recon Loss: 0.0042
  Val mIoU: 0.7966 (Best: 0.8187)
  [Class IoU] C0: 0.8065740970935911 | C1: 0.9022 | C2: 0.8576 | C3: 0.6200
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 29.3684
 Avg Train Loss: 29.3684 | Seg Loss: 0.2936 | Recon Loss: 0.0045
  Val mIoU: 0.8041 (Best: 0.8187)
  [Class IoU] C0: 0.8135781714809339 | C1: 0.9175 | C2: 0.8568 | C3: 0.6285
Epoch 242/400 | Train Loss: 29.4913
 Avg Train Loss: 29.4913 | Seg Loss: 0.2949 | Recon Loss: 0.0043
  Val mIoU: 0.8029 (Best: 0.8187)
  [Class IoU] C0: 0.8123016569875636 | C1: 0.9131 | C2: 0.8596 | C3: 0.6268
Epoch 243/400 | Train Loss: 29.1048
 Avg Train Loss: 29.1048 | Seg Loss: 0.2910 | Recon Loss: 0.0044
  Val mIoU: 0.8018 (Best: 0.8187)
  [Class IoU] C0: 0.8130480537910725 | C1: 0.9198 | C2: 0.8597 | C3: 0.6147
Epoch 244/400 | Train Loss: 29.4144
 Avg Train Loss: 29.4144 | Seg Loss: 0.2941 | Recon Loss: 0.0045
  Val mIoU: 0.8023 (Best: 0.8187)
  [Class IoU] C0: 0.812220592165068 | C1: 0.9167 | C2: 0.8612 | C3: 0.6191
Epoch 245/400 | Train Loss: 29.5607
 Avg Train Loss: 29.5607 | Seg Loss: 0.2956 | Recon Loss: 0.0042
  Val mIoU: 0.7967 (Best: 0.8187)
  [Class IoU] C0: 0.8145628352177294 | C1: 0.9240 | C2: 0.8537 | C3: 0.5945
Epoch 246/400 | Train Loss: 29.1757
 Avg Train Loss: 29.1757 | Seg Loss: 0.2917 | Recon Loss: 0.0043
  Val mIoU: 0.8001 (Best: 0.8187)
  [Class IoU] C0: 0.8103162744245805 | C1: 0.9103 | C2: 0.8597 | C3: 0.6200
Epoch 247/400 | Train Loss: 29.7202
 Avg Train Loss: 29.7202 | Seg Loss: 0.2972 | Recon Loss: 0.0042
  Val mIoU: 0.7847 (Best: 0.8187)
  [Class IoU] C0: 0.8098551686803103 | C1: 0.9200 | C2: 0.8454 | C3: 0.5636
Epoch 248/400 | Train Loss: 29.4335
 Avg Train Loss: 29.4335 | Seg Loss: 0.2943 | Recon Loss: 0.0045
  Val mIoU: 0.7895 (Best: 0.8187)
  [Class IoU] C0: 0.8055470640323518 | C1: 0.9006 | C2: 0.8522 | C3: 0.5994
Epoch 249/400 | Train Loss: 29.5200
 Avg Train Loss: 29.5200 | Seg Loss: 0.2952 | Recon Loss: 0.0042
  Val mIoU: 0.7926 (Best: 0.8187)
  [Class IoU] C0: 0.8078290889245503 | C1: 0.9122 | C2: 0.8553 | C3: 0.5949
Epoch 250/400 | Train Loss: 30.0775
 Avg Train Loss: 30.0775 | Seg Loss: 0.3007 | Recon Loss: 0.0043
  Val mIoU: 0.8020 (Best: 0.8187)
  [Class IoU] C0: 0.8113163289102576 | C1: 0.9143 | C2: 0.8559 | C3: 0.6266
Epoch 251/400 | Train Loss: 29.5907
 Avg Train Loss: 29.5907 | Seg Loss: 0.2959 | Recon Loss: 0.0043
  Val mIoU: 0.7891 (Best: 0.8187)
  [Class IoU] C0: 0.8038596856491178 | C1: 0.8967 | C2: 0.8526 | C3: 0.6033
Epoch 252/400 | Train Loss: 29.6599
 Avg Train Loss: 29.6599 | Seg Loss: 0.2966 | Recon Loss: 0.0043
  Val mIoU: 0.7858 (Best: 0.8187)
  [Class IoU] C0: 0.8055308136192634 | C1: 0.9095 | C2: 0.8424 | C3: 0.5857
Epoch 253/400 | Train Loss: 29.8249
 Avg Train Loss: 29.8249 | Seg Loss: 0.2982 | Recon Loss: 0.0044
  Val mIoU: 0.7836 (Best: 0.8187)
  [Class IoU] C0: 0.810254840219258 | C1: 0.9216 | C2: 0.8429 | C3: 0.5595
Epoch 254/400 | Train Loss: 29.6758
 Avg Train Loss: 29.6758 | Seg Loss: 0.2967 | Recon Loss: 0.0042
  Val mIoU: 0.7868 (Best: 0.8187)
  [Class IoU] C0: 0.8021916077987042 | C1: 0.8889 | C2: 0.8526 | C3: 0.6035
Epoch 255/400 | Train Loss: 29.1227
 Avg Train Loss: 29.1227 | Seg Loss: 0.2912 | Recon Loss: 0.0044
  Val mIoU: 0.7951 (Best: 0.8187)
  [Class IoU] C0: 0.8089190429195301 | C1: 0.9070 | C2: 0.8562 | C3: 0.6083
Epoch 256/400 | Train Loss: 29.4207
 Avg Train Loss: 29.4207 | Seg Loss: 0.2942 | Recon Loss: 0.0043
  Val mIoU: 0.8074 (Best: 0.8187)
  [Class IoU] C0: 0.8131984884102219 | C1: 0.9132 | C2: 0.8659 | C3: 0.6374
Epoch 257/400 | Train Loss: 29.1235
 Avg Train Loss: 29.1235 | Seg Loss: 0.2912 | Recon Loss: 0.0043
  Val mIoU: 0.8038 (Best: 0.8187)
  [Class IoU] C0: 0.8090031779235257 | C1: 0.9096 | C2: 0.8596 | C3: 0.6371
Epoch 258/400 | Train Loss: 28.9192
 Avg Train Loss: 28.9192 | Seg Loss: 0.2891 | Recon Loss: 0.0042
  Val mIoU: 0.8036 (Best: 0.8187)
  [Class IoU] C0: 0.8107196567050301 | C1: 0.9039 | C2: 0.8603 | C3: 0.6394
Epoch 259/400 | Train Loss: 29.2740
 Avg Train Loss: 29.2740 | Seg Loss: 0.2927 | Recon Loss: 0.0044
  Val mIoU: 0.7928 (Best: 0.8187)
  [Class IoU] C0: 0.8112498343680975 | C1: 0.9173 | C2: 0.8493 | C3: 0.5933
Epoch 260/400 | Train Loss: 29.1935
 Avg Train Loss: 29.1935 | Seg Loss: 0.2919 | Recon Loss: 0.0043
  Val mIoU: 0.7917 (Best: 0.8187)
  [Class IoU] C0: 0.8047904727774128 | C1: 0.8933 | C2: 0.8564 | C3: 0.6122
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 29.8759
 Avg Train Loss: 29.8759 | Seg Loss: 0.2987 | Recon Loss: 0.0044
  Val mIoU: 0.8042 (Best: 0.8187)
  [Class IoU] C0: 0.8154290402524997 | C1: 0.9236 | C2: 0.8613 | C3: 0.6163
Epoch 262/400 | Train Loss: 29.2831
 Avg Train Loss: 29.2831 | Seg Loss: 0.2928 | Recon Loss: 0.0043
  Val mIoU: 0.7917 (Best: 0.8187)
  [Class IoU] C0: 0.8142692501954799 | C1: 0.9234 | C2: 0.8496 | C3: 0.5796
Epoch 263/400 | Train Loss: 29.3072
 Avg Train Loss: 29.3072 | Seg Loss: 0.2930 | Recon Loss: 0.0043
  Val mIoU: 0.7975 (Best: 0.8187)
  [Class IoU] C0: 0.8136301123991113 | C1: 0.9238 | C2: 0.8539 | C3: 0.5988
Epoch 264/400 | Train Loss: 29.0763
 Avg Train Loss: 29.0763 | Seg Loss: 0.2907 | Recon Loss: 0.0044
  Val mIoU: 0.7924 (Best: 0.8187)
  [Class IoU] C0: 0.8067467540491366 | C1: 0.9061 | C2: 0.8552 | C3: 0.6014
Epoch 265/400 | Train Loss: 29.1558
 Avg Train Loss: 29.1558 | Seg Loss: 0.2915 | Recon Loss: 0.0044
  Val mIoU: 0.7849 (Best: 0.8187)
  [Class IoU] C0: 0.7988184915295012 | C1: 0.8730 | C2: 0.8553 | C3: 0.6125
Epoch 266/400 | Train Loss: 29.0003
 Avg Train Loss: 29.0003 | Seg Loss: 0.2900 | Recon Loss: 0.0046
  Val mIoU: 0.7988 (Best: 0.8187)
  [Class IoU] C0: 0.8070915855828907 | C1: 0.8981 | C2: 0.8588 | C3: 0.6311
Epoch 267/400 | Train Loss: 29.8323
 Avg Train Loss: 29.8323 | Seg Loss: 0.2983 | Recon Loss: 0.0044
  Val mIoU: 0.7960 (Best: 0.8187)
  [Class IoU] C0: 0.8062640236312089 | C1: 0.8980 | C2: 0.8596 | C3: 0.6201
Epoch 268/400 | Train Loss: 29.7371
 Avg Train Loss: 29.7371 | Seg Loss: 0.2973 | Recon Loss: 0.0043
  Val mIoU: 0.7878 (Best: 0.8187)
  [Class IoU] C0: 0.8055829938091796 | C1: 0.9055 | C2: 0.8505 | C3: 0.5897
Epoch 269/400 | Train Loss: 28.8788
 Avg Train Loss: 28.8788 | Seg Loss: 0.2887 | Recon Loss: 0.0042
  Val mIoU: 0.7938 (Best: 0.8187)
  [Class IoU] C0: 0.8081705650939622 | C1: 0.9108 | C2: 0.8530 | C3: 0.6034
Epoch 270/400 | Train Loss: 29.7945
 Avg Train Loss: 29.7945 | Seg Loss: 0.2979 | Recon Loss: 0.0043
  Val mIoU: 0.7836 (Best: 0.8187)
  [Class IoU] C0: 0.8068176914154974 | C1: 0.9106 | C2: 0.8430 | C3: 0.5739
Epoch 271/400 | Train Loss: 29.8566
 Avg Train Loss: 29.8566 | Seg Loss: 0.2985 | Recon Loss: 0.0043
  Val mIoU: 0.7925 (Best: 0.8187)
  [Class IoU] C0: 0.8041064672638601 | C1: 0.9096 | C2: 0.8486 | C3: 0.6077
Epoch 272/400 | Train Loss: 28.8700
 Avg Train Loss: 28.8700 | Seg Loss: 0.2887 | Recon Loss: 0.0042
  Val mIoU: 0.7921 (Best: 0.8187)
  [Class IoU] C0: 0.8050421705722856 | C1: 0.9011 | C2: 0.8533 | C3: 0.6088
Epoch 273/400 | Train Loss: 28.7254
 Avg Train Loss: 28.7254 | Seg Loss: 0.2872 | Recon Loss: 0.0044
  Val mIoU: 0.7981 (Best: 0.8187)
  [Class IoU] C0: 0.8049214985781374 | C1: 0.8889 | C2: 0.8604 | C3: 0.6383
Epoch 274/400 | Train Loss: 29.2079
 Avg Train Loss: 29.2079 | Seg Loss: 0.2920 | Recon Loss: 0.0043
  Val mIoU: 0.7725 (Best: 0.8187)
  [Class IoU] C0: 0.8078447319374075 | C1: 0.9203 | C2: 0.8250 | C3: 0.5367
Epoch 275/400 | Train Loss: 29.3018
 Avg Train Loss: 29.3018 | Seg Loss: 0.2930 | Recon Loss: 0.0042
  Val mIoU: 0.7798 (Best: 0.8187)
  [Class IoU] C0: 0.800706769274696 | C1: 0.8922 | C2: 0.8459 | C3: 0.5805
Epoch 276/400 | Train Loss: 29.9273
 Avg Train Loss: 29.9273 | Seg Loss: 0.2992 | Recon Loss: 0.0043
  Val mIoU: 0.7750 (Best: 0.8187)
  [Class IoU] C0: 0.7991640780788761 | C1: 0.8874 | C2: 0.8412 | C3: 0.5725
Epoch 277/400 | Train Loss: 29.2151
 Avg Train Loss: 29.2151 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.7962 (Best: 0.8187)
  [Class IoU] C0: 0.8155675140417725 | C1: 0.9236 | C2: 0.8537 | C3: 0.5919
Epoch 278/400 | Train Loss: 28.7818
 Avg Train Loss: 28.7818 | Seg Loss: 0.2878 | Recon Loss: 0.0043
  Val mIoU: 0.8047 (Best: 0.8187)
  [Class IoU] C0: 0.8112064274370547 | C1: 0.9094 | C2: 0.8623 | C3: 0.6359
Epoch 279/400 | Train Loss: 29.0816
 Avg Train Loss: 29.0816 | Seg Loss: 0.2908 | Recon Loss: 0.0043
  Val mIoU: 0.7978 (Best: 0.8187)
  [Class IoU] C0: 0.8073220763504808 | C1: 0.9036 | C2: 0.8615 | C3: 0.6187
Epoch 280/400 | Train Loss: 29.8529
 Avg Train Loss: 29.8529 | Seg Loss: 0.2985 | Recon Loss: 0.0043
  Val mIoU: 0.7857 (Best: 0.8187)
  [Class IoU] C0: 0.8068189124981625 | C1: 0.9111 | C2: 0.8474 | C3: 0.5774
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 28.8257
 Avg Train Loss: 28.8257 | Seg Loss: 0.2882 | Recon Loss: 0.0043
  Val mIoU: 0.7983 (Best: 0.8187)
  [Class IoU] C0: 0.8093037306934655 | C1: 0.9111 | C2: 0.8580 | C3: 0.6148
Epoch 282/400 | Train Loss: 28.8752
 Avg Train Loss: 28.8752 | Seg Loss: 0.2887 | Recon Loss: 0.0043
  Val mIoU: 0.7903 (Best: 0.8187)
  [Class IoU] C0: 0.8138843843762219 | C1: 0.9232 | C2: 0.8468 | C3: 0.5773
Epoch 283/400 | Train Loss: 29.4034
 Avg Train Loss: 29.4034 | Seg Loss: 0.2940 | Recon Loss: 0.0042
  Val mIoU: 0.7930 (Best: 0.8187)
  [Class IoU] C0: 0.8138575232552568 | C1: 0.9237 | C2: 0.8495 | C3: 0.5851
Epoch 284/400 | Train Loss: 29.8895
 Avg Train Loss: 29.8895 | Seg Loss: 0.2989 | Recon Loss: 0.0042
  Val mIoU: 0.7883 (Best: 0.8187)
  [Class IoU] C0: 0.7971860455544729 | C1: 0.8643 | C2: 0.8561 | C3: 0.6356
Epoch 285/400 | Train Loss: 29.5674
 Avg Train Loss: 29.5674 | Seg Loss: 0.2956 | Recon Loss: 0.0042
  Val mIoU: 0.8054 (Best: 0.8187)
  [Class IoU] C0: 0.8120806774512009 | C1: 0.9164 | C2: 0.8654 | C3: 0.6276
Epoch 286/400 | Train Loss: 29.0782
 Avg Train Loss: 29.0782 | Seg Loss: 0.2907 | Recon Loss: 0.0045
  Val mIoU: 0.7944 (Best: 0.8187)
  [Class IoU] C0: 0.802411570788839 | C1: 0.8827 | C2: 0.8604 | C3: 0.6322
Epoch 287/400 | Train Loss: 29.0759
 Avg Train Loss: 29.0759 | Seg Loss: 0.2907 | Recon Loss: 0.0044
  Val mIoU: 0.7928 (Best: 0.8187)
  [Class IoU] C0: 0.8051974243629545 | C1: 0.8981 | C2: 0.8531 | C3: 0.6147
Epoch 288/400 | Train Loss: 29.0332
 Avg Train Loss: 29.0332 | Seg Loss: 0.2903 | Recon Loss: 0.0043
  Val mIoU: 0.7801 (Best: 0.8187)
  [Class IoU] C0: 0.8037490849357974 | C1: 0.9113 | C2: 0.8423 | C3: 0.5631
Epoch 289/400 | Train Loss: 28.7712
 Avg Train Loss: 28.7712 | Seg Loss: 0.2877 | Recon Loss: 0.0043
  Val mIoU: 0.7979 (Best: 0.8187)
  [Class IoU] C0: 0.8060365913164456 | C1: 0.8977 | C2: 0.8592 | C3: 0.6285
Epoch 290/400 | Train Loss: 29.2197
 Avg Train Loss: 29.2197 | Seg Loss: 0.2922 | Recon Loss: 0.0044
  Val mIoU: 0.7994 (Best: 0.8187)
  [Class IoU] C0: 0.8102568245673212 | C1: 0.9148 | C2: 0.8573 | C3: 0.6151
Epoch 291/400 | Train Loss: 29.1018
 Avg Train Loss: 29.1018 | Seg Loss: 0.2910 | Recon Loss: 0.0043
  Val mIoU: 0.7984 (Best: 0.8187)
  [Class IoU] C0: 0.8048987338576591 | C1: 0.8960 | C2: 0.8583 | C3: 0.6345
Epoch 292/400 | Train Loss: 29.2699
 Avg Train Loss: 29.2699 | Seg Loss: 0.2927 | Recon Loss: 0.0043
  Val mIoU: 0.7837 (Best: 0.8187)
  [Class IoU] C0: 0.793636650366721 | C1: 0.8535 | C2: 0.8578 | C3: 0.6299
Epoch 293/400 | Train Loss: 29.3974
 Avg Train Loss: 29.3974 | Seg Loss: 0.2939 | Recon Loss: 0.0042
  Val mIoU: 0.8128 (Best: 0.8187)
  [Class IoU] C0: 0.815851893140044 | C1: 0.9121 | C2: 0.8695 | C3: 0.6537
Epoch 294/400 | Train Loss: 29.2340
 Avg Train Loss: 29.2340 | Seg Loss: 0.2923 | Recon Loss: 0.0042
  Val mIoU: 0.7889 (Best: 0.8187)
  [Class IoU] C0: 0.8064112347474237 | C1: 0.9079 | C2: 0.8512 | C3: 0.5902
Epoch 295/400 | Train Loss: 28.8116
 Avg Train Loss: 28.8116 | Seg Loss: 0.2881 | Recon Loss: 0.0042
  Val mIoU: 0.8036 (Best: 0.8187)
  [Class IoU] C0: 0.8067395280255911 | C1: 0.8956 | C2: 0.8642 | C3: 0.6479
Epoch 296/400 | Train Loss: 29.9378
 Avg Train Loss: 29.9378 | Seg Loss: 0.2993 | Recon Loss: 0.0044
  Val mIoU: 0.8031 (Best: 0.8187)
  [Class IoU] C0: 0.8094018831471053 | C1: 0.9069 | C2: 0.8614 | C3: 0.6346
Epoch 297/400 | Train Loss: 30.0600
 Avg Train Loss: 30.0600 | Seg Loss: 0.3006 | Recon Loss: 0.0042
  Val mIoU: 0.7997 (Best: 0.8187)
  [Class IoU] C0: 0.8075588255730466 | C1: 0.9108 | C2: 0.8583 | C3: 0.6223
Epoch 298/400 | Train Loss: 29.8861
 Avg Train Loss: 29.8861 | Seg Loss: 0.2988 | Recon Loss: 0.0043
  Val mIoU: 0.8020 (Best: 0.8187)
  [Class IoU] C0: 0.8104727333429973 | C1: 0.9138 | C2: 0.8623 | C3: 0.6216
Epoch 299/400 | Train Loss: 29.6325
 Avg Train Loss: 29.6325 | Seg Loss: 0.2963 | Recon Loss: 0.0044
  Val mIoU: 0.7966 (Best: 0.8187)
  [Class IoU] C0: 0.8069245319053944 | C1: 0.9016 | C2: 0.8578 | C3: 0.6200
Epoch 300/400 | Train Loss: 29.5819
 Avg Train Loss: 29.5819 | Seg Loss: 0.2958 | Recon Loss: 0.0045
  Val mIoU: 0.7927 (Best: 0.8187)
  [Class IoU] C0: 0.809700821415126 | C1: 0.9170 | C2: 0.8552 | C3: 0.5890
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 28.7405
 Avg Train Loss: 28.7405 | Seg Loss: 0.2874 | Recon Loss: 0.0043
  Val mIoU: 0.7941 (Best: 0.8187)
  [Class IoU] C0: 0.8113178566534329 | C1: 0.9175 | C2: 0.8512 | C3: 0.5965
Epoch 302/400 | Train Loss: 29.5916
 Avg Train Loss: 29.5916 | Seg Loss: 0.2959 | Recon Loss: 0.0043
  Val mIoU: 0.8099 (Best: 0.8187)
  [Class IoU] C0: 0.8155070354094337 | C1: 0.9192 | C2: 0.8640 | C3: 0.6408
Epoch 303/400 | Train Loss: 28.8495
 Avg Train Loss: 28.8495 | Seg Loss: 0.2885 | Recon Loss: 0.0043
  Val mIoU: 0.7965 (Best: 0.8187)
  [Class IoU] C0: 0.8085469670688086 | C1: 0.9115 | C2: 0.8556 | C3: 0.6104
Epoch 304/400 | Train Loss: 28.9021
 Avg Train Loss: 28.9021 | Seg Loss: 0.2890 | Recon Loss: 0.0043
  Val mIoU: 0.7965 (Best: 0.8187)
  [Class IoU] C0: 0.8074121132228128 | C1: 0.9067 | C2: 0.8544 | C3: 0.6176
Epoch 305/400 | Train Loss: 28.5955
 Avg Train Loss: 28.5955 | Seg Loss: 0.2859 | Recon Loss: 0.0041
  Val mIoU: 0.7954 (Best: 0.8187)
  [Class IoU] C0: 0.8064842963882426 | C1: 0.9062 | C2: 0.8574 | C3: 0.6114
Epoch 306/400 | Train Loss: 29.8832
 Avg Train Loss: 29.8832 | Seg Loss: 0.2988 | Recon Loss: 0.0043
  Val mIoU: 0.8035 (Best: 0.8187)
  [Class IoU] C0: 0.8118076664617321 | C1: 0.9170 | C2: 0.8634 | C3: 0.6216
Epoch 307/400 | Train Loss: 29.2759
 Avg Train Loss: 29.2759 | Seg Loss: 0.2927 | Recon Loss: 0.0043
  Val mIoU: 0.8105 (Best: 0.8187)
  [Class IoU] C0: 0.8122413425115882 | C1: 0.9114 | C2: 0.8613 | C3: 0.6569
Epoch 308/400 | Train Loss: 29.7653
 Avg Train Loss: 29.7653 | Seg Loss: 0.2976 | Recon Loss: 0.0045
  Val mIoU: 0.7928 (Best: 0.8187)
  [Class IoU] C0: 0.8126472208578209 | C1: 0.9224 | C2: 0.8541 | C3: 0.5819
Epoch 309/400 | Train Loss: 28.9660
 Avg Train Loss: 28.9660 | Seg Loss: 0.2896 | Recon Loss: 0.0044
  Val mIoU: 0.7947 (Best: 0.8187)
  [Class IoU] C0: 0.8129781872570914 | C1: 0.9233 | C2: 0.8540 | C3: 0.5887
Epoch 310/400 | Train Loss: 29.5454
 Avg Train Loss: 29.5454 | Seg Loss: 0.2954 | Recon Loss: 0.0042
  Val mIoU: 0.8040 (Best: 0.8187)
  [Class IoU] C0: 0.8089009978422316 | C1: 0.9069 | C2: 0.8636 | C3: 0.6366
Epoch 311/400 | Train Loss: 29.6197
 Avg Train Loss: 29.6197 | Seg Loss: 0.2962 | Recon Loss: 0.0043
  Val mIoU: 0.8028 (Best: 0.8187)
  [Class IoU] C0: 0.8121387196242017 | C1: 0.9183 | C2: 0.8618 | C3: 0.6192
Epoch 312/400 | Train Loss: 29.2095
 Avg Train Loss: 29.2095 | Seg Loss: 0.2921 | Recon Loss: 0.0042
  Val mIoU: 0.8094 (Best: 0.8187)
  [Class IoU] C0: 0.8118852405241888 | C1: 0.9098 | C2: 0.8676 | C3: 0.6481
Epoch 313/400 | Train Loss: 29.5520
 Avg Train Loss: 29.5520 | Seg Loss: 0.2955 | Recon Loss: 0.0044
  Val mIoU: 0.7977 (Best: 0.8187)
  [Class IoU] C0: 0.8033387144391767 | C1: 0.8886 | C2: 0.8635 | C3: 0.6353
Epoch 314/400 | Train Loss: 29.3244
 Avg Train Loss: 29.3244 | Seg Loss: 0.2932 | Recon Loss: 0.0043
  Val mIoU: 0.8023 (Best: 0.8187)
  [Class IoU] C0: 0.8109315170379898 | C1: 0.9131 | C2: 0.8610 | C3: 0.6240
Epoch 315/400 | Train Loss: 29.4642
 Avg Train Loss: 29.4642 | Seg Loss: 0.2946 | Recon Loss: 0.0044
  Val mIoU: 0.8010 (Best: 0.8187)
  [Class IoU] C0: 0.8085918486148743 | C1: 0.9073 | C2: 0.8586 | C3: 0.6296
Epoch 316/400 | Train Loss: 29.8127
 Avg Train Loss: 29.8127 | Seg Loss: 0.2981 | Recon Loss: 0.0041
  Val mIoU: 0.7987 (Best: 0.8187)
  [Class IoU] C0: 0.8145631780313612 | C1: 0.9222 | C2: 0.8555 | C3: 0.6024
Epoch 317/400 | Train Loss: 28.8421
 Avg Train Loss: 28.8421 | Seg Loss: 0.2884 | Recon Loss: 0.0043
  Val mIoU: 0.8138 (Best: 0.8187)
  [Class IoU] C0: 0.8160562104603868 | C1: 0.9161 | C2: 0.8689 | C3: 0.6540
Epoch 318/400 | Train Loss: 29.7843
 Avg Train Loss: 29.7843 | Seg Loss: 0.2978 | Recon Loss: 0.0043
  Val mIoU: 0.7801 (Best: 0.8187)
  [Class IoU] C0: 0.7951722484987376 | C1: 0.8679 | C2: 0.8512 | C3: 0.6062
Epoch 319/400 | Train Loss: 29.1742
 Avg Train Loss: 29.1742 | Seg Loss: 0.2917 | Recon Loss: 0.0045
  Val mIoU: 0.7815 (Best: 0.8187)
  [Class IoU] C0: 0.8001721489568422 | C1: 0.9157 | C2: 0.8469 | C3: 0.5634
Epoch 320/400 | Train Loss: 29.1585
 Avg Train Loss: 29.1585 | Seg Loss: 0.2915 | Recon Loss: 0.0043
  Val mIoU: 0.8089 (Best: 0.8187)
  [Class IoU] C0: 0.817140246442577 | C1: 0.9224 | C2: 0.8641 | C3: 0.6321
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 29.4169
 Avg Train Loss: 29.4169 | Seg Loss: 0.2941 | Recon Loss: 0.0044
  Val mIoU: 0.8014 (Best: 0.8187)
  [Class IoU] C0: 0.8094380545637238 | C1: 0.9093 | C2: 0.8603 | C3: 0.6263
Epoch 322/400 | Train Loss: 29.6521
 Avg Train Loss: 29.6521 | Seg Loss: 0.2965 | Recon Loss: 0.0043
  Val mIoU: 0.7983 (Best: 0.8187)
  [Class IoU] C0: 0.8074474022573862 | C1: 0.9004 | C2: 0.8582 | C3: 0.6270
Epoch 323/400 | Train Loss: 30.1249
 Avg Train Loss: 30.1249 | Seg Loss: 0.3012 | Recon Loss: 0.0043
  Val mIoU: 0.8037 (Best: 0.8187)
  [Class IoU] C0: 0.8106467753618223 | C1: 0.9072 | C2: 0.8609 | C3: 0.6359
Epoch 324/400 | Train Loss: 30.3143
 Avg Train Loss: 30.3143 | Seg Loss: 0.3031 | Recon Loss: 0.0044
  Val mIoU: 0.8075 (Best: 0.8187)
  [Class IoU] C0: 0.8121526451664395 | C1: 0.9076 | C2: 0.8655 | C3: 0.6447
Epoch 325/400 | Train Loss: 29.8409
 Avg Train Loss: 29.8409 | Seg Loss: 0.2984 | Recon Loss: 0.0044
  Val mIoU: 0.7894 (Best: 0.8187)
  [Class IoU] C0: 0.8036412626959144 | C1: 0.9073 | C2: 0.8540 | C3: 0.5926
Epoch 326/400 | Train Loss: 29.4385
 Avg Train Loss: 29.4385 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.8049 (Best: 0.8187)
  [Class IoU] C0: 0.8103828480960218 | C1: 0.9034 | C2: 0.8645 | C3: 0.6412
Epoch 327/400 | Train Loss: 29.6401
 Avg Train Loss: 29.6401 | Seg Loss: 0.2964 | Recon Loss: 0.0043
  Val mIoU: 0.7758 (Best: 0.8187)
  [Class IoU] C0: 0.810475262983595 | C1: 0.9238 | C2: 0.8346 | C3: 0.5342
Epoch 328/400 | Train Loss: 29.2911
 Avg Train Loss: 29.2911 | Seg Loss: 0.2929 | Recon Loss: 0.0043
  Val mIoU: 0.8052 (Best: 0.8187)
  [Class IoU] C0: 0.8125046607629554 | C1: 0.9157 | C2: 0.8620 | C3: 0.6306
Epoch 329/400 | Train Loss: 30.1514
 Avg Train Loss: 30.1514 | Seg Loss: 0.3015 | Recon Loss: 0.0041
  Val mIoU: 0.7983 (Best: 0.8187)
  [Class IoU] C0: 0.8101995338957662 | C1: 0.9144 | C2: 0.8603 | C3: 0.6083
Epoch 330/400 | Train Loss: 29.2610
 Avg Train Loss: 29.2610 | Seg Loss: 0.2926 | Recon Loss: 0.0042
  Val mIoU: 0.7999 (Best: 0.8187)
  [Class IoU] C0: 0.8128925844804658 | C1: 0.9164 | C2: 0.8584 | C3: 0.6118
Epoch 331/400 | Train Loss: 29.2161
 Avg Train Loss: 29.2161 | Seg Loss: 0.2921 | Recon Loss: 0.0043
  Val mIoU: 0.7938 (Best: 0.8187)
  [Class IoU] C0: 0.8084055549222856 | C1: 0.9080 | C2: 0.8555 | C3: 0.6032
Epoch 332/400 | Train Loss: 29.0741
 Avg Train Loss: 29.0741 | Seg Loss: 0.2907 | Recon Loss: 0.0045
  Val mIoU: 0.8025 (Best: 0.8187)
  [Class IoU] C0: 0.8107111514338685 | C1: 0.9141 | C2: 0.8628 | C3: 0.6225
Epoch 333/400 | Train Loss: 29.8758
 Avg Train Loss: 29.8758 | Seg Loss: 0.2987 | Recon Loss: 0.0044
  Val mIoU: 0.8009 (Best: 0.8187)
  [Class IoU] C0: 0.8120020095893449 | C1: 0.9128 | C2: 0.8594 | C3: 0.6192
Epoch 334/400 | Train Loss: 29.7730
 Avg Train Loss: 29.7730 | Seg Loss: 0.2977 | Recon Loss: 0.0043
  Val mIoU: 0.8123 (Best: 0.8187)
  [Class IoU] C0: 0.8133141925912645 | C1: 0.9099 | C2: 0.8676 | C3: 0.6584
Epoch 335/400 | Train Loss: 29.3265
 Avg Train Loss: 29.3265 | Seg Loss: 0.2932 | Recon Loss: 0.0042
  Val mIoU: 0.7870 (Best: 0.8187)
  [Class IoU] C0: 0.8103802832528898 | C1: 0.9204 | C2: 0.8459 | C3: 0.5712
Epoch 336/400 | Train Loss: 28.9916
 Avg Train Loss: 28.9916 | Seg Loss: 0.2899 | Recon Loss: 0.0043
  Val mIoU: 0.7875 (Best: 0.8187)
  [Class IoU] C0: 0.7997341107342022 | C1: 0.8721 | C2: 0.8558 | C3: 0.6223
Epoch 337/400 | Train Loss: 28.8816
 Avg Train Loss: 28.8816 | Seg Loss: 0.2888 | Recon Loss: 0.0043
  Val mIoU: 0.7988 (Best: 0.8187)
  [Class IoU] C0: 0.8133957762652406 | C1: 0.9211 | C2: 0.8548 | C3: 0.6059
Epoch 338/400 | Train Loss: 29.7119
 Avg Train Loss: 29.7119 | Seg Loss: 0.2971 | Recon Loss: 0.0045
  Val mIoU: 0.7947 (Best: 0.8187)
  [Class IoU] C0: 0.812722215673496 | C1: 0.9227 | C2: 0.8552 | C3: 0.5883
Epoch 339/400 | Train Loss: 28.5529
 Avg Train Loss: 28.5529 | Seg Loss: 0.2855 | Recon Loss: 0.0044
  Val mIoU: 0.7991 (Best: 0.8187)
  [Class IoU] C0: 0.8047269571846681 | C1: 0.8922 | C2: 0.8619 | C3: 0.6376
Epoch 340/400 | Train Loss: 28.6385
 Avg Train Loss: 28.6385 | Seg Loss: 0.2863 | Recon Loss: 0.0044
  Val mIoU: 0.7965 (Best: 0.8187)
  [Class IoU] C0: 0.8121871986794418 | C1: 0.9191 | C2: 0.8555 | C3: 0.5993
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 29.5815
 Avg Train Loss: 29.5815 | Seg Loss: 0.2958 | Recon Loss: 0.0043
  Val mIoU: 0.7923 (Best: 0.8187)
  [Class IoU] C0: 0.8030829294922636 | C1: 0.9021 | C2: 0.8564 | C3: 0.6074
Epoch 342/400 | Train Loss: 29.5639
 Avg Train Loss: 29.5639 | Seg Loss: 0.2956 | Recon Loss: 0.0043
  Val mIoU: 0.7997 (Best: 0.8187)
  [Class IoU] C0: 0.8061020641669546 | C1: 0.9061 | C2: 0.8566 | C3: 0.6299
Epoch 343/400 | Train Loss: 29.2258
 Avg Train Loss: 29.2258 | Seg Loss: 0.2922 | Recon Loss: 0.0042
  Val mIoU: 0.8003 (Best: 0.8187)
  [Class IoU] C0: 0.8107888601823174 | C1: 0.9104 | C2: 0.8597 | C3: 0.6204
Epoch 344/400 | Train Loss: 29.7522
 Avg Train Loss: 29.7522 | Seg Loss: 0.2975 | Recon Loss: 0.0044
  Val mIoU: 0.7878 (Best: 0.8187)
  [Class IoU] C0: 0.8028030926750984 | C1: 0.9085 | C2: 0.8528 | C3: 0.5872
Epoch 345/400 | Train Loss: 29.5782
 Avg Train Loss: 29.5782 | Seg Loss: 0.2957 | Recon Loss: 0.0043
  Val mIoU: 0.8014 (Best: 0.8187)
  [Class IoU] C0: 0.8070300792732596 | C1: 0.9033 | C2: 0.8631 | C3: 0.6322
Epoch 346/400 | Train Loss: 29.5867
 Avg Train Loss: 29.5867 | Seg Loss: 0.2958 | Recon Loss: 0.0043
  Val mIoU: 0.7988 (Best: 0.8187)
  [Class IoU] C0: 0.8079785135920139 | C1: 0.9078 | C2: 0.8567 | C3: 0.6225
Epoch 347/400 | Train Loss: 28.8617
 Avg Train Loss: 28.8617 | Seg Loss: 0.2886 | Recon Loss: 0.0044
  Val mIoU: 0.7904 (Best: 0.8187)
  [Class IoU] C0: 0.8076781088135107 | C1: 0.9144 | C2: 0.8530 | C3: 0.5867
Epoch 348/400 | Train Loss: 29.3081
 Avg Train Loss: 29.3081 | Seg Loss: 0.2930 | Recon Loss: 0.0043
  Val mIoU: 0.7997 (Best: 0.8187)
  [Class IoU] C0: 0.8084092314197011 | C1: 0.9065 | C2: 0.8579 | C3: 0.6262
Epoch 349/400 | Train Loss: 29.1365
 Avg Train Loss: 29.1365 | Seg Loss: 0.2913 | Recon Loss: 0.0044
  Val mIoU: 0.7901 (Best: 0.8187)
  [Class IoU] C0: 0.8153222813528576 | C1: 0.9258 | C2: 0.8477 | C3: 0.5714
Epoch 350/400 | Train Loss: 29.2278
 Avg Train Loss: 29.2278 | Seg Loss: 0.2922 | Recon Loss: 0.0043
  Val mIoU: 0.8002 (Best: 0.8187)
  [Class IoU] C0: 0.8100932304986299 | C1: 0.9147 | C2: 0.8591 | C3: 0.6169
Epoch 351/400 | Train Loss: 29.7868
 Avg Train Loss: 29.7868 | Seg Loss: 0.2978 | Recon Loss: 0.0045
  Val mIoU: 0.7708 (Best: 0.8187)
  [Class IoU] C0: 0.8082722162266437 | C1: 0.9208 | C2: 0.8279 | C3: 0.5262
Epoch 352/400 | Train Loss: 29.3267
 Avg Train Loss: 29.3267 | Seg Loss: 0.2932 | Recon Loss: 0.0044
  Val mIoU: 0.7847 (Best: 0.8187)
  [Class IoU] C0: 0.8022621416097425 | C1: 0.8898 | C2: 0.8469 | C3: 0.5996
Epoch 353/400 | Train Loss: 29.0254
 Avg Train Loss: 29.0254 | Seg Loss: 0.2902 | Recon Loss: 0.0043
  Val mIoU: 0.8017 (Best: 0.8187)
  [Class IoU] C0: 0.8100876382854068 | C1: 0.9103 | C2: 0.8574 | C3: 0.6290
Epoch 354/400 | Train Loss: 29.5533
 Avg Train Loss: 29.5533 | Seg Loss: 0.2955 | Recon Loss: 0.0043
  Val mIoU: 0.8060 (Best: 0.8187)
  [Class IoU] C0: 0.8166957654114599 | C1: 0.9225 | C2: 0.8643 | C3: 0.6207
Epoch 355/400 | Train Loss: 29.1671
 Avg Train Loss: 29.1671 | Seg Loss: 0.2916 | Recon Loss: 0.0042
  Val mIoU: 0.8053 (Best: 0.8187)
  [Class IoU] C0: 0.8137404047244364 | C1: 0.9193 | C2: 0.8646 | C3: 0.6237
Epoch 356/400 | Train Loss: 28.7926
 Avg Train Loss: 28.7926 | Seg Loss: 0.2879 | Recon Loss: 0.0044
  Val mIoU: 0.7968 (Best: 0.8187)
  [Class IoU] C0: 0.8110747061201705 | C1: 0.9140 | C2: 0.8530 | C3: 0.6091
Epoch 357/400 | Train Loss: 29.1738
 Avg Train Loss: 29.1738 | Seg Loss: 0.2917 | Recon Loss: 0.0044
  Val mIoU: 0.8137 (Best: 0.8187)
  [Class IoU] C0: 0.8139903965921395 | C1: 0.9106 | C2: 0.8704 | C3: 0.6599
Epoch 358/400 | Train Loss: 29.9021
 Avg Train Loss: 29.9021 | Seg Loss: 0.2990 | Recon Loss: 0.0042
  Val mIoU: 0.7828 (Best: 0.8187)
  [Class IoU] C0: 0.807980834512557 | C1: 0.9150 | C2: 0.8444 | C3: 0.5639
Epoch 359/400 | Train Loss: 29.5849
 Avg Train Loss: 29.5849 | Seg Loss: 0.2958 | Recon Loss: 0.0042
  Val mIoU: 0.8073 (Best: 0.8187)
  [Class IoU] C0: 0.81640256588094 | C1: 0.9196 | C2: 0.8639 | C3: 0.6295
Epoch 360/400 | Train Loss: 29.5774
 Avg Train Loss: 29.5774 | Seg Loss: 0.2957 | Recon Loss: 0.0043
  Val mIoU: 0.7888 (Best: 0.8187)
  [Class IoU] C0: 0.8084375170692231 | C1: 0.9146 | C2: 0.8485 | C3: 0.5837
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 29.4189
 Avg Train Loss: 29.4189 | Seg Loss: 0.2941 | Recon Loss: 0.0042
  Val mIoU: 0.7845 (Best: 0.8187)
  [Class IoU] C0: 0.8081255118468695 | C1: 0.9141 | C2: 0.8438 | C3: 0.5720
Epoch 362/400 | Train Loss: 28.6081
 Avg Train Loss: 28.6081 | Seg Loss: 0.2860 | Recon Loss: 0.0041
  Val mIoU: 0.7984 (Best: 0.8187)
  [Class IoU] C0: 0.8063506981234426 | C1: 0.9001 | C2: 0.8589 | C3: 0.6282
Epoch 363/400 | Train Loss: 29.6745
 Avg Train Loss: 29.6745 | Seg Loss: 0.2967 | Recon Loss: 0.0044
  Val mIoU: 0.8013 (Best: 0.8187)
  [Class IoU] C0: 0.809595655581686 | C1: 0.9095 | C2: 0.8610 | C3: 0.6250
Epoch 364/400 | Train Loss: 29.4215
 Avg Train Loss: 29.4215 | Seg Loss: 0.2942 | Recon Loss: 0.0043
  Val mIoU: 0.7970 (Best: 0.8187)
  [Class IoU] C0: 0.8109953034480754 | C1: 0.9154 | C2: 0.8574 | C3: 0.6040
Epoch 365/400 | Train Loss: 29.7185
 Avg Train Loss: 29.7185 | Seg Loss: 0.2971 | Recon Loss: 0.0043
  Val mIoU: 0.8014 (Best: 0.8187)
  [Class IoU] C0: 0.806092106951247 | C1: 0.8914 | C2: 0.8643 | C3: 0.6441
Epoch 366/400 | Train Loss: 29.3372
 Avg Train Loss: 29.3372 | Seg Loss: 0.2933 | Recon Loss: 0.0043
  Val mIoU: 0.8081 (Best: 0.8187)
  [Class IoU] C0: 0.8139704896224377 | C1: 0.9218 | C2: 0.8673 | C3: 0.6294
Epoch 367/400 | Train Loss: 29.5493
 Avg Train Loss: 29.5493 | Seg Loss: 0.2954 | Recon Loss: 0.0045
  Val mIoU: 0.8056 (Best: 0.8187)
  [Class IoU] C0: 0.8126107898056868 | C1: 0.9131 | C2: 0.8644 | C3: 0.6323
Epoch 368/400 | Train Loss: 28.7484
 Avg Train Loss: 28.7484 | Seg Loss: 0.2874 | Recon Loss: 0.0043
  Val mIoU: 0.7878 (Best: 0.8187)
  [Class IoU] C0: 0.7989398085197152 | C1: 0.8786 | C2: 0.8554 | C3: 0.6181
Epoch 369/400 | Train Loss: 29.1863
 Avg Train Loss: 29.1863 | Seg Loss: 0.2918 | Recon Loss: 0.0042
  Val mIoU: 0.8042 (Best: 0.8187)
  [Class IoU] C0: 0.8171906806159627 | C1: 0.9247 | C2: 0.8615 | C3: 0.6133
Epoch 370/400 | Train Loss: 29.7912
 Avg Train Loss: 29.7912 | Seg Loss: 0.2979 | Recon Loss: 0.0045
  Val mIoU: 0.7908 (Best: 0.8187)
  [Class IoU] C0: 0.8036262930549576 | C1: 0.8909 | C2: 0.8542 | C3: 0.6145
Epoch 371/400 | Train Loss: 28.6858
 Avg Train Loss: 28.6858 | Seg Loss: 0.2868 | Recon Loss: 0.0044
  Val mIoU: 0.8011 (Best: 0.8187)
  [Class IoU] C0: 0.8082179092987534 | C1: 0.9062 | C2: 0.8620 | C3: 0.6278
Epoch 372/400 | Train Loss: 28.8164
 Avg Train Loss: 28.8164 | Seg Loss: 0.2881 | Recon Loss: 0.0043
  Val mIoU: 0.7945 (Best: 0.8187)
  [Class IoU] C0: 0.8095735160161803 | C1: 0.9188 | C2: 0.8559 | C3: 0.5936
Epoch 373/400 | Train Loss: 29.6536
 Avg Train Loss: 29.6536 | Seg Loss: 0.2965 | Recon Loss: 0.0042
  Val mIoU: 0.8016 (Best: 0.8187)
  [Class IoU] C0: 0.8071811865849432 | C1: 0.9011 | C2: 0.8615 | C3: 0.6366
Epoch 374/400 | Train Loss: 29.0356
 Avg Train Loss: 29.0356 | Seg Loss: 0.2903 | Recon Loss: 0.0044
  Val mIoU: 0.8102 (Best: 0.8187)
  [Class IoU] C0: 0.8141741952228606 | C1: 0.9133 | C2: 0.8674 | C3: 0.6460
Epoch 375/400 | Train Loss: 28.9303
 Avg Train Loss: 28.9303 | Seg Loss: 0.2893 | Recon Loss: 0.0044
  Val mIoU: 0.7970 (Best: 0.8187)
  [Class IoU] C0: 0.8056321150538941 | C1: 0.9018 | C2: 0.8584 | C3: 0.6222
Epoch 376/400 | Train Loss: 28.9261
 Avg Train Loss: 28.9261 | Seg Loss: 0.2892 | Recon Loss: 0.0043
  Val mIoU: 0.8001 (Best: 0.8187)
  [Class IoU] C0: 0.8066691419043784 | C1: 0.9060 | C2: 0.8625 | C3: 0.6252
Epoch 377/400 | Train Loss: 29.0161
 Avg Train Loss: 29.0161 | Seg Loss: 0.2901 | Recon Loss: 0.0045
  Val mIoU: 0.7958 (Best: 0.8187)
  [Class IoU] C0: 0.810189573240045 | C1: 0.9208 | C2: 0.8573 | C3: 0.5951
Epoch 378/400 | Train Loss: 29.8169
 Avg Train Loss: 29.8169 | Seg Loss: 0.2981 | Recon Loss: 0.0042
  Val mIoU: 0.8044 (Best: 0.8187)
  [Class IoU] C0: 0.8107010297313619 | C1: 0.9111 | C2: 0.8652 | C3: 0.6307
Epoch 379/400 | Train Loss: 30.2007
 Avg Train Loss: 30.2007 | Seg Loss: 0.3020 | Recon Loss: 0.0042
  Val mIoU: 0.7870 (Best: 0.8187)
  [Class IoU] C0: 0.7914547467070456 | C1: 0.8412 | C2: 0.8663 | C3: 0.6491
Epoch 380/400 | Train Loss: 29.2896
 Avg Train Loss: 29.2896 | Seg Loss: 0.2929 | Recon Loss: 0.0044
  Val mIoU: 0.8059 (Best: 0.8187)
  [Class IoU] C0: 0.8120098441200554 | C1: 0.9139 | C2: 0.8647 | C3: 0.6331
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 29.2948
 Avg Train Loss: 29.2948 | Seg Loss: 0.2929 | Recon Loss: 0.0043
  Val mIoU: 0.7950 (Best: 0.8187)
  [Class IoU] C0: 0.8155307914991954 | C1: 0.9244 | C2: 0.8502 | C3: 0.5900
Epoch 382/400 | Train Loss: 29.3710
 Avg Train Loss: 29.3710 | Seg Loss: 0.2937 | Recon Loss: 0.0043
  Val mIoU: 0.7920 (Best: 0.8187)
  [Class IoU] C0: 0.8121933411978206 | C1: 0.9204 | C2: 0.8492 | C3: 0.5861
Epoch 383/400 | Train Loss: 29.6412
 Avg Train Loss: 29.6412 | Seg Loss: 0.2964 | Recon Loss: 0.0043
  Val mIoU: 0.7836 (Best: 0.8187)
  [Class IoU] C0: 0.7945002542773075 | C1: 0.8582 | C2: 0.8531 | C3: 0.6284
Epoch 384/400 | Train Loss: 29.8596
 Avg Train Loss: 29.8596 | Seg Loss: 0.2986 | Recon Loss: 0.0042
  Val mIoU: 0.7921 (Best: 0.8187)
  [Class IoU] C0: 0.8075519068288325 | C1: 0.9122 | C2: 0.8548 | C3: 0.5940
Epoch 385/400 | Train Loss: 29.5243
 Avg Train Loss: 29.5243 | Seg Loss: 0.2952 | Recon Loss: 0.0042
  Val mIoU: 0.7957 (Best: 0.8187)
  [Class IoU] C0: 0.8024944417028932 | C1: 0.8913 | C2: 0.8573 | C3: 0.6315
Epoch 386/400 | Train Loss: 28.2209
 Avg Train Loss: 28.2209 | Seg Loss: 0.2822 | Recon Loss: 0.0041
  Val mIoU: 0.7964 (Best: 0.8187)
  [Class IoU] C0: 0.8067499839997562 | C1: 0.8966 | C2: 0.8568 | C3: 0.6255
Epoch 387/400 | Train Loss: 29.6715
 Avg Train Loss: 29.6715 | Seg Loss: 0.2967 | Recon Loss: 0.0043
  Val mIoU: 0.7969 (Best: 0.8187)
  [Class IoU] C0: 0.8039158986913936 | C1: 0.8950 | C2: 0.8628 | C3: 0.6259
Epoch 388/400 | Train Loss: 28.9945
 Avg Train Loss: 28.9945 | Seg Loss: 0.2899 | Recon Loss: 0.0043
  Val mIoU: 0.7912 (Best: 0.8187)
  [Class IoU] C0: 0.810576559151345 | C1: 0.9164 | C2: 0.8495 | C3: 0.5885
Epoch 389/400 | Train Loss: 29.8253
 Avg Train Loss: 29.8253 | Seg Loss: 0.2982 | Recon Loss: 0.0044
  Val mIoU: 0.8023 (Best: 0.8187)
  [Class IoU] C0: 0.8099842568590112 | C1: 0.9094 | C2: 0.8638 | C3: 0.6259
Epoch 390/400 | Train Loss: 29.4109
 Avg Train Loss: 29.4109 | Seg Loss: 0.2941 | Recon Loss: 0.0043
  Val mIoU: 0.7935 (Best: 0.8187)
  [Class IoU] C0: 0.810465993249303 | C1: 0.9179 | C2: 0.8494 | C3: 0.5960
Epoch 391/400 | Train Loss: 29.6092
 Avg Train Loss: 29.6092 | Seg Loss: 0.2960 | Recon Loss: 0.0042
  Val mIoU: 0.7866 (Best: 0.8187)
  [Class IoU] C0: 0.8124122612468648 | C1: 0.9246 | C2: 0.8454 | C3: 0.5641
Epoch 392/400 | Train Loss: 29.3473
 Avg Train Loss: 29.3473 | Seg Loss: 0.2934 | Recon Loss: 0.0044
  Val mIoU: 0.7860 (Best: 0.8187)
  [Class IoU] C0: 0.809810932040753 | C1: 0.9184 | C2: 0.8447 | C3: 0.5711
Epoch 393/400 | Train Loss: 29.2463
 Avg Train Loss: 29.2463 | Seg Loss: 0.2924 | Recon Loss: 0.0044
  Val mIoU: 0.7984 (Best: 0.8187)
  [Class IoU] C0: 0.8066952075045177 | C1: 0.9028 | C2: 0.8626 | C3: 0.6214
Epoch 394/400 | Train Loss: 29.2152
 Avg Train Loss: 29.2152 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.7896 (Best: 0.8187)
  [Class IoU] C0: 0.8052100938637883 | C1: 0.9078 | C2: 0.8522 | C3: 0.5933
Epoch 395/400 | Train Loss: 29.7182
 Avg Train Loss: 29.7182 | Seg Loss: 0.2971 | Recon Loss: 0.0044
  Val mIoU: 0.7945 (Best: 0.8187)
  [Class IoU] C0: 0.8034197453543978 | C1: 0.8969 | C2: 0.8527 | C3: 0.6249
Epoch 396/400 | Train Loss: 29.0169
 Avg Train Loss: 29.0169 | Seg Loss: 0.2901 | Recon Loss: 0.0043
  Val mIoU: 0.8058 (Best: 0.8187)
  [Class IoU] C0: 0.8148092661004772 | C1: 0.9231 | C2: 0.8600 | C3: 0.6253
Epoch 397/400 | Train Loss: 29.3629
 Avg Train Loss: 29.3629 | Seg Loss: 0.2936 | Recon Loss: 0.0043
  Val mIoU: 0.7784 (Best: 0.8187)
  [Class IoU] C0: 0.810521907195191 | C1: 0.9238 | C2: 0.8371 | C3: 0.5421
Epoch 398/400 | Train Loss: 29.3122
 Avg Train Loss: 29.3122 | Seg Loss: 0.2931 | Recon Loss: 0.0043
  Val mIoU: 0.8008 (Best: 0.8187)
  [Class IoU] C0: 0.8122452731288466 | C1: 0.9219 | C2: 0.8611 | C3: 0.6081
Epoch 399/400 | Train Loss: 29.4275
 Avg Train Loss: 29.4275 | Seg Loss: 0.2942 | Recon Loss: 0.0043
  Val mIoU: 0.8006 (Best: 0.8187)
  [Class IoU] C0: 0.8074756592935097 | C1: 0.9047 | C2: 0.8631 | C3: 0.6271
Epoch 400/400 | Train Loss: 29.6193
 Avg Train Loss: 29.6193 | Seg Loss: 0.2962 | Recon Loss: 0.0043
  Val mIoU: 0.7961 (Best: 0.8187)
  [Class IoU] C0: 0.8139039573682525 | C1: 0.9233 | C2: 0.8545 | C3: 0.5928
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights and curves...
Best model saved /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Trained_models/VAE_val_best.pth
Final model saved /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Trained_models/VAE_val_final.pth
Done.
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27259774: <VAE_job_resnet_4> in cluster <dcc> Done

Job <VAE_job_resnet_4> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Wed Dec  3 10:52:18 2025
Job was executed on host(s) <4*n-62-13-16>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Wed Dec  3 12:00:54 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Wed Dec  3 12:00:54 2025
Terminated at Wed Dec  3 18:07:15 2025
Results reported at Wed Dec  3 18:07:15 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J VAE_job_resnet_4

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_%J.err
### --- Resource Requests ---
#BSUB -q gpul40s          # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 4                   # Request 4 CPU cores
#BSUB -R "rusage[mem=8GB]"   # Request 16GB memory
#BSUB -W 15:00                # 4 hour runtime limit

### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."
# This is the full, correct path to your environment
source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

### --- Run Script ---
echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/VAE_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   89758.00 sec.
    Max Memory :                                 2572 MB
    Average Memory :                             2120.07 MB
    Total Requested Memory :                     32768.00 MB
    Delta Memory :                               30196.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                82
    Run time :                                   21986 sec.
    Turnaround time :                            26097 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_res_job_27259774.err> for stderr output of this job.

