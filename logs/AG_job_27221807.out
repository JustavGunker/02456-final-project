Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 4.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/400 | Train Loss: 72.1867
 Avg Train Loss: 72.1867 | Seg Loss: 0.7213 | Recon Loss: 0.0535
  Val mIoU: 0.3962 (Best: 0.0000)
  [Class IoU]  C1: 0.3194 | C2: 0.7267 | C3: 0.1426
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 60.9621
 Avg Train Loss: 60.9621 | Seg Loss: 0.6094 | Recon Loss: 0.0215
  Val mIoU: 0.5891 (Best: 0.3962)
  [Class IoU]  C1: 0.8269 | C2: 0.7283 | C3: 0.2121
  --> New Best Model Saved!
Epoch 3/400 | Train Loss: 56.1321
 Avg Train Loss: 56.1321 | Seg Loss: 0.5612 | Recon Loss: 0.0114
  Val mIoU: 0.6149 (Best: 0.5891)
  [Class IoU]  C1: 0.8308 | C2: 0.7720 | C3: 0.2421
  --> New Best Model Saved!
Epoch 4/400 | Train Loss: 53.0021
 Avg Train Loss: 53.0021 | Seg Loss: 0.5299 | Recon Loss: 0.0102
  Val mIoU: 0.5740 (Best: 0.6149)
  [Class IoU]  C1: 0.8340 | C2: 0.7438 | C3: 0.1441
Epoch 5/400 | Train Loss: 51.1462
 Avg Train Loss: 51.1462 | Seg Loss: 0.5114 | Recon Loss: 0.0091
  Val mIoU: 0.5785 (Best: 0.6149)
  [Class IoU]  C1: 0.9003 | C2: 0.7476 | C3: 0.0877
Epoch 6/400 | Train Loss: 49.3773
 Avg Train Loss: 49.3773 | Seg Loss: 0.4937 | Recon Loss: 0.0086
  Val mIoU: 0.6108 (Best: 0.6149)
  [Class IoU]  C1: 0.8636 | C2: 0.7383 | C3: 0.2305
Epoch 7/400 | Train Loss: 48.1885
 Avg Train Loss: 48.1885 | Seg Loss: 0.4818 | Recon Loss: 0.0090
  Val mIoU: 0.6532 (Best: 0.6149)
  [Class IoU]  C1: 0.8920 | C2: 0.7876 | C3: 0.2800
  --> New Best Model Saved!
Epoch 8/400 | Train Loss: 46.3597
 Avg Train Loss: 46.3597 | Seg Loss: 0.4635 | Recon Loss: 0.0082
  Val mIoU: 0.6753 (Best: 0.6532)
  [Class IoU]  C1: 0.9053 | C2: 0.7772 | C3: 0.3435
  --> New Best Model Saved!
Epoch 9/400 | Train Loss: 45.9192
 Avg Train Loss: 45.9192 | Seg Loss: 0.4591 | Recon Loss: 0.0080
  Val mIoU: 0.6874 (Best: 0.6753)
  [Class IoU]  C1: 0.9050 | C2: 0.7493 | C3: 0.4081
  --> New Best Model Saved!
Epoch 10/400 | Train Loss: 44.5779
 Avg Train Loss: 44.5779 | Seg Loss: 0.4457 | Recon Loss: 0.0079
  Val mIoU: 0.5740 (Best: 0.6874)
  [Class IoU]  C1: 0.9127 | C2: 0.5527 | C3: 0.2565
Epoch 11/400 | Train Loss: 44.0356
 Avg Train Loss: 44.0356 | Seg Loss: 0.4403 | Recon Loss: 0.0077
  Val mIoU: 0.6747 (Best: 0.6874)
  [Class IoU]  C1: 0.9182 | C2: 0.7914 | C3: 0.3146
Epoch 12/400 | Train Loss: 43.0793
 Avg Train Loss: 43.0793 | Seg Loss: 0.4307 | Recon Loss: 0.0074
  Val mIoU: 0.6575 (Best: 0.6874)
  [Class IoU]  C1: 0.9091 | C2: 0.6955 | C3: 0.3680
Epoch 13/400 | Train Loss: 42.0762
 Avg Train Loss: 42.0762 | Seg Loss: 0.4207 | Recon Loss: 0.0072
  Val mIoU: 0.4439 (Best: 0.6874)
  [Class IoU]  C1: 0.4860 | C2: 0.5739 | C3: 0.2717
Epoch 14/400 | Train Loss: 40.9747
 Avg Train Loss: 40.9747 | Seg Loss: 0.4097 | Recon Loss: 0.0074
  Val mIoU: 0.5228 (Best: 0.6874)
  [Class IoU]  C1: 0.3960 | C2: 0.7642 | C3: 0.4081
Epoch 15/400 | Train Loss: 40.2256
 Avg Train Loss: 40.2256 | Seg Loss: 0.4022 | Recon Loss: 0.0073
  Val mIoU: 0.6486 (Best: 0.6874)
  [Class IoU]  C1: 0.7945 | C2: 0.7974 | C3: 0.3538
Epoch 16/400 | Train Loss: 39.6675
 Avg Train Loss: 39.6675 | Seg Loss: 0.3966 | Recon Loss: 0.0071
  Val mIoU: 0.5165 (Best: 0.6874)
  [Class IoU]  C1: 0.4113 | C2: 0.7421 | C3: 0.3962
Epoch 17/400 | Train Loss: 39.0485
 Avg Train Loss: 39.0485 | Seg Loss: 0.3904 | Recon Loss: 0.0071
  Val mIoU: 0.4733 (Best: 0.6874)
  [Class IoU]  C1: 0.2519 | C2: 0.7651 | C3: 0.4030
Epoch 18/400 | Train Loss: 38.6679
 Avg Train Loss: 38.6679 | Seg Loss: 0.3866 | Recon Loss: 0.0070
  Val mIoU: 0.2800 (Best: 0.6874)
  [Class IoU]  C1: 0.3040 | C2: 0.3500 | C3: 0.1862
Epoch 19/400 | Train Loss: 38.9416
 Avg Train Loss: 38.9416 | Seg Loss: 0.3893 | Recon Loss: 0.0068
  Val mIoU: 0.7130 (Best: 0.6874)
  [Class IoU]  C1: 0.9152 | C2: 0.7843 | C3: 0.4394
  --> New Best Model Saved!
Epoch 20/400 | Train Loss: 38.4675
 Avg Train Loss: 38.4675 | Seg Loss: 0.3846 | Recon Loss: 0.0067
  Val mIoU: 0.4415 (Best: 0.7130)
  [Class IoU]  C1: 0.2535 | C2: 0.7358 | C3: 0.3351
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 38.6784
 Avg Train Loss: 38.6784 | Seg Loss: 0.3867 | Recon Loss: 0.0067
  Val mIoU: 0.4651 (Best: 0.7130)
  [Class IoU]  C1: 0.9180 | C2: 0.2928 | C3: 0.1845
Epoch 22/400 | Train Loss: 37.7683
 Avg Train Loss: 37.7683 | Seg Loss: 0.3776 | Recon Loss: 0.0070
  Val mIoU: 0.7653 (Best: 0.7130)
  [Class IoU]  C1: 0.9196 | C2: 0.8283 | C3: 0.5482
  --> New Best Model Saved!
Epoch 23/400 | Train Loss: 37.1678
 Avg Train Loss: 37.1678 | Seg Loss: 0.3716 | Recon Loss: 0.0065
  Val mIoU: 0.7064 (Best: 0.7653)
  [Class IoU]  C1: 0.8655 | C2: 0.7761 | C3: 0.4775
Epoch 24/400 | Train Loss: 37.0302
 Avg Train Loss: 37.0302 | Seg Loss: 0.3702 | Recon Loss: 0.0067
  Val mIoU: 0.5005 (Best: 0.7653)
  [Class IoU]  C1: 0.2883 | C2: 0.7948 | C3: 0.4184
Epoch 25/400 | Train Loss: 36.8771
 Avg Train Loss: 36.8771 | Seg Loss: 0.3687 | Recon Loss: 0.0065
  Val mIoU: 0.4801 (Best: 0.7653)
  [Class IoU]  C1: 0.2487 | C2: 0.7952 | C3: 0.3965
Epoch 26/400 | Train Loss: 36.1783
 Avg Train Loss: 36.1783 | Seg Loss: 0.3617 | Recon Loss: 0.0063
  Val mIoU: 0.3638 (Best: 0.7653)
  [Class IoU]  C1: 0.3055 | C2: 0.5377 | C3: 0.2481
Epoch 27/400 | Train Loss: 35.8736
 Avg Train Loss: 35.8736 | Seg Loss: 0.3587 | Recon Loss: 0.0066
  Val mIoU: 0.3477 (Best: 0.7653)
  [Class IoU]  C1: 0.3289 | C2: 0.4916 | C3: 0.2225
Epoch 28/400 | Train Loss: 35.2061
 Avg Train Loss: 35.2061 | Seg Loss: 0.3520 | Recon Loss: 0.0063
  Val mIoU: 0.4195 (Best: 0.7653)
  [Class IoU]  C1: 0.2935 | C2: 0.6415 | C3: 0.3234
Epoch 29/400 | Train Loss: 35.1367
 Avg Train Loss: 35.1367 | Seg Loss: 0.3513 | Recon Loss: 0.0064
  Val mIoU: 0.3122 (Best: 0.7653)
  [Class IoU]  C1: 0.2893 | C2: 0.4370 | C3: 0.2102
Epoch 30/400 | Train Loss: 34.8908
 Avg Train Loss: 34.8908 | Seg Loss: 0.3488 | Recon Loss: 0.0063
  Val mIoU: 0.5139 (Best: 0.7653)
  [Class IoU]  C1: 0.2334 | C2: 0.7998 | C3: 0.5085
Epoch 31/400 | Train Loss: 34.8441
 Avg Train Loss: 34.8441 | Seg Loss: 0.3484 | Recon Loss: 0.0061
  Val mIoU: 0.3578 (Best: 0.7653)
  [Class IoU]  C1: 0.2568 | C2: 0.5585 | C3: 0.2583
Epoch 32/400 | Train Loss: 34.6647
 Avg Train Loss: 34.6647 | Seg Loss: 0.3466 | Recon Loss: 0.0060
  Val mIoU: 0.3661 (Best: 0.7653)
  [Class IoU]  C1: 0.2734 | C2: 0.5593 | C3: 0.2655
Epoch 33/400 | Train Loss: 34.1066
 Avg Train Loss: 34.1066 | Seg Loss: 0.3410 | Recon Loss: 0.0061
  Val mIoU: 0.5001 (Best: 0.7653)
  [Class IoU]  C1: 0.2385 | C2: 0.7793 | C3: 0.4825
Epoch 34/400 | Train Loss: 33.9869
 Avg Train Loss: 33.9869 | Seg Loss: 0.3398 | Recon Loss: 0.0060
  Val mIoU: 0.4727 (Best: 0.7653)
  [Class IoU]  C1: 0.2287 | C2: 0.7625 | C3: 0.4271
Epoch 35/400 | Train Loss: 34.4012
 Avg Train Loss: 34.4012 | Seg Loss: 0.3440 | Recon Loss: 0.0062
  Val mIoU: 0.5275 (Best: 0.7653)
  [Class IoU]  C1: 0.2414 | C2: 0.7920 | C3: 0.5492
Epoch 36/400 | Train Loss: 34.2932
 Avg Train Loss: 34.2932 | Seg Loss: 0.3429 | Recon Loss: 0.0057
  Val mIoU: 0.5045 (Best: 0.7653)
  [Class IoU]  C1: 0.2537 | C2: 0.7663 | C3: 0.4935
Epoch 37/400 | Train Loss: 33.9092
 Avg Train Loss: 33.9092 | Seg Loss: 0.3390 | Recon Loss: 0.0059
  Val mIoU: 0.5194 (Best: 0.7653)
  [Class IoU]  C1: 0.3265 | C2: 0.7639 | C3: 0.4678
Epoch 38/400 | Train Loss: 33.8116
 Avg Train Loss: 33.8116 | Seg Loss: 0.3381 | Recon Loss: 0.0060
  Val mIoU: 0.6453 (Best: 0.7653)
  [Class IoU]  C1: 0.7210 | C2: 0.7597 | C3: 0.4554
Epoch 39/400 | Train Loss: 33.8547
 Avg Train Loss: 33.8547 | Seg Loss: 0.3385 | Recon Loss: 0.0058
  Val mIoU: 0.5134 (Best: 0.7653)
  [Class IoU]  C1: 0.2480 | C2: 0.7855 | C3: 0.5066
Epoch 40/400 | Train Loss: 33.9448
 Avg Train Loss: 33.9448 | Seg Loss: 0.3394 | Recon Loss: 0.0059
  Val mIoU: 0.5009 (Best: 0.7653)
  [Class IoU]  C1: 0.2666 | C2: 0.7847 | C3: 0.4513
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 33.9825
 Avg Train Loss: 33.9825 | Seg Loss: 0.3398 | Recon Loss: 0.0058
  Val mIoU: 0.4634 (Best: 0.7653)
  [Class IoU]  C1: 0.2471 | C2: 0.7474 | C3: 0.3957
Epoch 42/400 | Train Loss: 33.4888
 Avg Train Loss: 33.4888 | Seg Loss: 0.3348 | Recon Loss: 0.0059
  Val mIoU: 0.5839 (Best: 0.7653)
  [Class IoU]  C1: 0.4648 | C2: 0.7920 | C3: 0.4950
Epoch 43/400 | Train Loss: 33.2525
 Avg Train Loss: 33.2525 | Seg Loss: 0.3325 | Recon Loss: 0.0058
  Val mIoU: 0.5772 (Best: 0.7653)
  [Class IoU]  C1: 0.6302 | C2: 0.7330 | C3: 0.3684
Epoch 44/400 | Train Loss: 32.7320
 Avg Train Loss: 32.7320 | Seg Loss: 0.3273 | Recon Loss: 0.0056
  Val mIoU: 0.4675 (Best: 0.7653)
  [Class IoU]  C1: 0.4636 | C2: 0.6369 | C3: 0.3020
Epoch 45/400 | Train Loss: 33.0247
 Avg Train Loss: 33.0247 | Seg Loss: 0.3302 | Recon Loss: 0.0055
  Val mIoU: 0.4345 (Best: 0.7653)
  [Class IoU]  C1: 0.2814 | C2: 0.6763 | C3: 0.3458
Epoch 46/400 | Train Loss: 32.5962
 Avg Train Loss: 32.5962 | Seg Loss: 0.3259 | Recon Loss: 0.0055
  Val mIoU: 0.4980 (Best: 0.7653)
  [Class IoU]  C1: 0.2667 | C2: 0.7719 | C3: 0.4555
Epoch 47/400 | Train Loss: 32.6742
 Avg Train Loss: 32.6742 | Seg Loss: 0.3267 | Recon Loss: 0.0056
  Val mIoU: 0.5182 (Best: 0.7653)
  [Class IoU]  C1: 0.2407 | C2: 0.8065 | C3: 0.5074
Epoch 48/400 | Train Loss: 32.3140
 Avg Train Loss: 32.3140 | Seg Loss: 0.3231 | Recon Loss: 0.0056
  Val mIoU: 0.4738 (Best: 0.7653)
  [Class IoU]  C1: 0.2719 | C2: 0.7365 | C3: 0.4131
Epoch 49/400 | Train Loss: 32.4637
 Avg Train Loss: 32.4637 | Seg Loss: 0.3246 | Recon Loss: 0.0057
  Val mIoU: 0.4353 (Best: 0.7653)
  [Class IoU]  C1: 0.2549 | C2: 0.6916 | C3: 0.3594
Epoch 50/400 | Train Loss: 31.7147
 Avg Train Loss: 31.7147 | Seg Loss: 0.3171 | Recon Loss: 0.0055
  Val mIoU: 0.4816 (Best: 0.7653)
  [Class IoU]  C1: 0.2705 | C2: 0.7398 | C3: 0.4343
Epoch 51/400 | Train Loss: 32.6105
 Avg Train Loss: 32.6105 | Seg Loss: 0.3260 | Recon Loss: 0.0057
  Val mIoU: 0.5247 (Best: 0.7653)
  [Class IoU]  C1: 0.2352 | C2: 0.8041 | C3: 0.5349
Epoch 52/400 | Train Loss: 32.0902
 Avg Train Loss: 32.0902 | Seg Loss: 0.3208 | Recon Loss: 0.0054
  Val mIoU: 0.5265 (Best: 0.7653)
  [Class IoU]  C1: 0.2314 | C2: 0.8073 | C3: 0.5407
Epoch 53/400 | Train Loss: 32.3613
 Avg Train Loss: 32.3613 | Seg Loss: 0.3236 | Recon Loss: 0.0056
  Val mIoU: 0.4681 (Best: 0.7653)
  [Class IoU]  C1: 0.2669 | C2: 0.7283 | C3: 0.4092
Epoch 54/400 | Train Loss: 31.6757
 Avg Train Loss: 31.6757 | Seg Loss: 0.3167 | Recon Loss: 0.0056
  Val mIoU: 0.5060 (Best: 0.7653)
  [Class IoU]  C1: 0.3537 | C2: 0.7391 | C3: 0.4252
Epoch 55/400 | Train Loss: 31.3827
 Avg Train Loss: 31.3827 | Seg Loss: 0.3138 | Recon Loss: 0.0055
  Val mIoU: 0.5458 (Best: 0.7653)
  [Class IoU]  C1: 0.4487 | C2: 0.7462 | C3: 0.4424
Epoch 56/400 | Train Loss: 31.7328
 Avg Train Loss: 31.7328 | Seg Loss: 0.3173 | Recon Loss: 0.0054
  Val mIoU: 0.4739 (Best: 0.7653)
  [Class IoU]  C1: 0.2498 | C2: 0.7479 | C3: 0.4240
Epoch 57/400 | Train Loss: 31.0140
 Avg Train Loss: 31.0140 | Seg Loss: 0.3101 | Recon Loss: 0.0054
  Val mIoU: 0.4550 (Best: 0.7653)
  [Class IoU]  C1: 0.2528 | C2: 0.7263 | C3: 0.3859
Epoch 58/400 | Train Loss: 31.2332
 Avg Train Loss: 31.2332 | Seg Loss: 0.3123 | Recon Loss: 0.0053
  Val mIoU: 0.4720 (Best: 0.7653)
  [Class IoU]  C1: 0.3061 | C2: 0.7095 | C3: 0.4003
Epoch 59/400 | Train Loss: 31.0753
 Avg Train Loss: 31.0753 | Seg Loss: 0.3107 | Recon Loss: 0.0052
  Val mIoU: 0.5883 (Best: 0.7653)
  [Class IoU]  C1: 0.4969 | C2: 0.7883 | C3: 0.4798
Epoch 60/400 | Train Loss: 31.2266
 Avg Train Loss: 31.2266 | Seg Loss: 0.3122 | Recon Loss: 0.0053
  Val mIoU: 0.4946 (Best: 0.7653)
  [Class IoU]  C1: 0.3535 | C2: 0.7295 | C3: 0.4008
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 31.7928
 Avg Train Loss: 31.7928 | Seg Loss: 0.3179 | Recon Loss: 0.0054
  Val mIoU: 0.5035 (Best: 0.7653)
  [Class IoU]  C1: 0.3501 | C2: 0.7606 | C3: 0.3998
Epoch 62/400 | Train Loss: 30.6784
 Avg Train Loss: 30.6784 | Seg Loss: 0.3067 | Recon Loss: 0.0055
  Val mIoU: 0.4194 (Best: 0.7653)
  [Class IoU]  C1: 0.2678 | C2: 0.6758 | C3: 0.3146
Epoch 63/400 | Train Loss: 31.0962
 Avg Train Loss: 31.0962 | Seg Loss: 0.3109 | Recon Loss: 0.0053
  Val mIoU: 0.5119 (Best: 0.7653)
  [Class IoU]  C1: 0.3412 | C2: 0.7635 | C3: 0.4310
Epoch 64/400 | Train Loss: 31.0940
 Avg Train Loss: 31.0940 | Seg Loss: 0.3109 | Recon Loss: 0.0054
  Val mIoU: 0.5186 (Best: 0.7653)
  [Class IoU]  C1: 0.3267 | C2: 0.7785 | C3: 0.4505
Epoch 65/400 | Train Loss: 31.1580
 Avg Train Loss: 31.1580 | Seg Loss: 0.3115 | Recon Loss: 0.0053
  Val mIoU: 0.5543 (Best: 0.7653)
  [Class IoU]  C1: 0.4059 | C2: 0.7821 | C3: 0.4750
Epoch 66/400 | Train Loss: 31.1986
 Avg Train Loss: 31.1986 | Seg Loss: 0.3119 | Recon Loss: 0.0053
  Val mIoU: 0.5194 (Best: 0.7653)
  [Class IoU]  C1: 0.3342 | C2: 0.7623 | C3: 0.4615
Epoch 67/400 | Train Loss: 31.8462
 Avg Train Loss: 31.8462 | Seg Loss: 0.3184 | Recon Loss: 0.0053
  Val mIoU: 0.5815 (Best: 0.7653)
  [Class IoU]  C1: 0.3404 | C2: 0.8108 | C3: 0.5934
Epoch 68/400 | Train Loss: 31.5267
 Avg Train Loss: 31.5267 | Seg Loss: 0.3152 | Recon Loss: 0.0053
  Val mIoU: 0.4906 (Best: 0.7653)
  [Class IoU]  C1: 0.2374 | C2: 0.7727 | C3: 0.4616
Epoch 69/400 | Train Loss: 31.2620
 Avg Train Loss: 31.2620 | Seg Loss: 0.3126 | Recon Loss: 0.0052
  Val mIoU: 0.5198 (Best: 0.7653)
  [Class IoU]  C1: 0.2639 | C2: 0.7926 | C3: 0.5029
Epoch 70/400 | Train Loss: 30.3626
 Avg Train Loss: 30.3626 | Seg Loss: 0.3036 | Recon Loss: 0.0053
  Val mIoU: 0.4837 (Best: 0.7653)
  [Class IoU]  C1: 0.2774 | C2: 0.7433 | C3: 0.4302
Epoch 71/400 | Train Loss: 30.9213
 Avg Train Loss: 30.9213 | Seg Loss: 0.3092 | Recon Loss: 0.0052
  Val mIoU: 0.4883 (Best: 0.7653)
  [Class IoU]  C1: 0.2335 | C2: 0.7714 | C3: 0.4600
Epoch 72/400 | Train Loss: 30.4157
 Avg Train Loss: 30.4157 | Seg Loss: 0.3041 | Recon Loss: 0.0054
  Val mIoU: 0.5233 (Best: 0.7653)
  [Class IoU]  C1: 0.2885 | C2: 0.7741 | C3: 0.5073
Epoch 73/400 | Train Loss: 31.2476
 Avg Train Loss: 31.2476 | Seg Loss: 0.3124 | Recon Loss: 0.0053
  Val mIoU: 0.5634 (Best: 0.7653)
  [Class IoU]  C1: 0.3212 | C2: 0.8086 | C3: 0.5603
Epoch 74/400 | Train Loss: 31.1547
 Avg Train Loss: 31.1547 | Seg Loss: 0.3115 | Recon Loss: 0.0052
  Val mIoU: 0.5848 (Best: 0.7653)
  [Class IoU]  C1: 0.2886 | C2: 0.8205 | C3: 0.6452
Epoch 75/400 | Train Loss: 31.0376
 Avg Train Loss: 31.0376 | Seg Loss: 0.3103 | Recon Loss: 0.0054
  Val mIoU: 0.5602 (Best: 0.7653)
  [Class IoU]  C1: 0.3318 | C2: 0.8007 | C3: 0.5481
Epoch 76/400 | Train Loss: 31.3496
 Avg Train Loss: 31.3496 | Seg Loss: 0.3134 | Recon Loss: 0.0052
  Val mIoU: 0.5233 (Best: 0.7653)
  [Class IoU]  C1: 0.2643 | C2: 0.7932 | C3: 0.5124
Epoch 77/400 | Train Loss: 30.9690
 Avg Train Loss: 30.9690 | Seg Loss: 0.3096 | Recon Loss: 0.0051
  Val mIoU: 0.4583 (Best: 0.7653)
  [Class IoU]  C1: 0.2425 | C2: 0.7330 | C3: 0.3995
Epoch 78/400 | Train Loss: 31.1728
 Avg Train Loss: 31.1728 | Seg Loss: 0.3117 | Recon Loss: 0.0053
  Val mIoU: 0.4813 (Best: 0.7653)
  [Class IoU]  C1: 0.2803 | C2: 0.7386 | C3: 0.4252
Epoch 79/400 | Train Loss: 30.7870
 Avg Train Loss: 30.7870 | Seg Loss: 0.3078 | Recon Loss: 0.0053
  Val mIoU: 0.5080 (Best: 0.7653)
  [Class IoU]  C1: 0.2614 | C2: 0.7836 | C3: 0.4789
Epoch 80/400 | Train Loss: 30.2146
 Avg Train Loss: 30.2146 | Seg Loss: 0.3021 | Recon Loss: 0.0053
  Val mIoU: 0.5150 (Best: 0.7653)
  [Class IoU]  C1: 0.3097 | C2: 0.7537 | C3: 0.4814
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 30.5703
 Avg Train Loss: 30.5703 | Seg Loss: 0.3057 | Recon Loss: 0.0052
  Val mIoU: 0.5200 (Best: 0.7653)
  [Class IoU]  C1: 0.3275 | C2: 0.7702 | C3: 0.4623
Epoch 82/400 | Train Loss: 30.5574
 Avg Train Loss: 30.5574 | Seg Loss: 0.3055 | Recon Loss: 0.0053
  Val mIoU: 0.4987 (Best: 0.7653)
  [Class IoU]  C1: 0.2618 | C2: 0.7788 | C3: 0.4555
Epoch 83/400 | Train Loss: 30.2604
 Avg Train Loss: 30.2604 | Seg Loss: 0.3026 | Recon Loss: 0.0052
  Val mIoU: 0.5000 (Best: 0.7653)
  [Class IoU]  C1: 0.3029 | C2: 0.7562 | C3: 0.4411
Epoch 84/400 | Train Loss: 30.1584
 Avg Train Loss: 30.1584 | Seg Loss: 0.3015 | Recon Loss: 0.0051
  Val mIoU: 0.4715 (Best: 0.7653)
  [Class IoU]  C1: 0.2381 | C2: 0.7514 | C3: 0.4249
Epoch 85/400 | Train Loss: 30.4864
 Avg Train Loss: 30.4864 | Seg Loss: 0.3048 | Recon Loss: 0.0050
  Val mIoU: 0.4889 (Best: 0.7653)
  [Class IoU]  C1: 0.2493 | C2: 0.7694 | C3: 0.4480
Epoch 86/400 | Train Loss: 29.7668
 Avg Train Loss: 29.7668 | Seg Loss: 0.2976 | Recon Loss: 0.0051
  Val mIoU: 0.5140 (Best: 0.7653)
  [Class IoU]  C1: 0.2559 | C2: 0.7935 | C3: 0.4926
Epoch 87/400 | Train Loss: 30.1980
 Avg Train Loss: 30.1980 | Seg Loss: 0.3019 | Recon Loss: 0.0051
  Val mIoU: 0.5170 (Best: 0.7653)
  [Class IoU]  C1: 0.2822 | C2: 0.7866 | C3: 0.4823
Epoch 88/400 | Train Loss: 30.7857
 Avg Train Loss: 30.7857 | Seg Loss: 0.3078 | Recon Loss: 0.0052
  Val mIoU: 0.4556 (Best: 0.7653)
  [Class IoU]  C1: 0.2448 | C2: 0.7307 | C3: 0.3914
Epoch 89/400 | Train Loss: 29.9900
 Avg Train Loss: 29.9900 | Seg Loss: 0.2998 | Recon Loss: 0.0051
  Val mIoU: 0.4965 (Best: 0.7653)
  [Class IoU]  C1: 0.2856 | C2: 0.7608 | C3: 0.4430
Epoch 90/400 | Train Loss: 30.3882
 Avg Train Loss: 30.3882 | Seg Loss: 0.3038 | Recon Loss: 0.0049
  Val mIoU: 0.5470 (Best: 0.7653)
  [Class IoU]  C1: 0.3251 | C2: 0.7943 | C3: 0.5216
Epoch 91/400 | Train Loss: 30.1044
 Avg Train Loss: 30.1044 | Seg Loss: 0.3010 | Recon Loss: 0.0051
  Val mIoU: 0.5019 (Best: 0.7653)
  [Class IoU]  C1: 0.2719 | C2: 0.7753 | C3: 0.4584
Epoch 92/400 | Train Loss: 30.4683
 Avg Train Loss: 30.4683 | Seg Loss: 0.3046 | Recon Loss: 0.0051
  Val mIoU: 0.5237 (Best: 0.7653)
  [Class IoU]  C1: 0.2840 | C2: 0.7925 | C3: 0.4945
Epoch 93/400 | Train Loss: 30.5496
 Avg Train Loss: 30.5496 | Seg Loss: 0.3054 | Recon Loss: 0.0052
  Val mIoU: 0.5084 (Best: 0.7653)
  [Class IoU]  C1: 0.2543 | C2: 0.7885 | C3: 0.4822
Epoch 94/400 | Train Loss: 29.9872
 Avg Train Loss: 29.9872 | Seg Loss: 0.2998 | Recon Loss: 0.0052
  Val mIoU: 0.5074 (Best: 0.7653)
  [Class IoU]  C1: 0.2581 | C2: 0.7842 | C3: 0.4799
Epoch 95/400 | Train Loss: 30.5174
 Avg Train Loss: 30.5174 | Seg Loss: 0.3051 | Recon Loss: 0.0051
  Val mIoU: 0.4499 (Best: 0.7653)
  [Class IoU]  C1: 0.2563 | C2: 0.7164 | C3: 0.3769
Epoch 96/400 | Train Loss: 30.7317
 Avg Train Loss: 30.7317 | Seg Loss: 0.3073 | Recon Loss: 0.0053
  Val mIoU: 0.5050 (Best: 0.7653)
  [Class IoU]  C1: 0.2797 | C2: 0.7669 | C3: 0.4684
Epoch 97/400 | Train Loss: 29.6687
 Avg Train Loss: 29.6687 | Seg Loss: 0.2966 | Recon Loss: 0.0052
  Val mIoU: 0.5336 (Best: 0.7653)
  [Class IoU]  C1: 0.3124 | C2: 0.7829 | C3: 0.5055
Epoch 98/400 | Train Loss: 30.7289
 Avg Train Loss: 30.7289 | Seg Loss: 0.3072 | Recon Loss: 0.0049
  Val mIoU: 0.4741 (Best: 0.7653)
  [Class IoU]  C1: 0.2737 | C2: 0.7421 | C3: 0.4065
Epoch 99/400 | Train Loss: 30.2786
 Avg Train Loss: 30.2786 | Seg Loss: 0.3027 | Recon Loss: 0.0051
  Val mIoU: 0.5261 (Best: 0.7653)
  [Class IoU]  C1: 0.2957 | C2: 0.7903 | C3: 0.4924
Epoch 100/400 | Train Loss: 29.6664
 Avg Train Loss: 29.6664 | Seg Loss: 0.2966 | Recon Loss: 0.0050
  Val mIoU: 0.4580 (Best: 0.7653)
  [Class IoU]  C1: 0.2630 | C2: 0.7240 | C3: 0.3872
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 30.1571
 Avg Train Loss: 30.1571 | Seg Loss: 0.3015 | Recon Loss: 0.0049
  Val mIoU: 0.5292 (Best: 0.7653)
  [Class IoU]  C1: 0.3231 | C2: 0.7853 | C3: 0.4792
Epoch 102/400 | Train Loss: 29.7356
 Avg Train Loss: 29.7356 | Seg Loss: 0.2973 | Recon Loss: 0.0051
  Val mIoU: 0.5253 (Best: 0.7653)
  [Class IoU]  C1: 0.3077 | C2: 0.7722 | C3: 0.4962
Epoch 103/400 | Train Loss: 30.2333
 Avg Train Loss: 30.2333 | Seg Loss: 0.3023 | Recon Loss: 0.0052
  Val mIoU: 0.7052 (Best: 0.7653)
  [Class IoU]  C1: 0.7931 | C2: 0.8045 | C3: 0.5181
Epoch 104/400 | Train Loss: 29.9411
 Avg Train Loss: 29.9411 | Seg Loss: 0.2994 | Recon Loss: 0.0051
  Val mIoU: 0.5987 (Best: 0.7653)
  [Class IoU]  C1: 0.5154 | C2: 0.7878 | C3: 0.4928
Epoch 105/400 | Train Loss: 29.5685
 Avg Train Loss: 29.5685 | Seg Loss: 0.2956 | Recon Loss: 0.0050
  Val mIoU: 0.5332 (Best: 0.7653)
  [Class IoU]  C1: 0.3270 | C2: 0.7876 | C3: 0.4849
Epoch 106/400 | Train Loss: 30.5535
 Avg Train Loss: 30.5535 | Seg Loss: 0.3055 | Recon Loss: 0.0052
  Val mIoU: 0.4653 (Best: 0.7653)
  [Class IoU]  C1: 0.2563 | C2: 0.7404 | C3: 0.3992
Epoch 107/400 | Train Loss: 29.2528
 Avg Train Loss: 29.2528 | Seg Loss: 0.2925 | Recon Loss: 0.0052
  Val mIoU: 0.5449 (Best: 0.7653)
  [Class IoU]  C1: 0.3117 | C2: 0.7966 | C3: 0.5263
Epoch 108/400 | Train Loss: 30.0040
 Avg Train Loss: 30.0040 | Seg Loss: 0.3000 | Recon Loss: 0.0049
  Val mIoU: 0.4970 (Best: 0.7653)
  [Class IoU]  C1: 0.2871 | C2: 0.7594 | C3: 0.4444
Epoch 109/400 | Train Loss: 29.9575
 Avg Train Loss: 29.9575 | Seg Loss: 0.2995 | Recon Loss: 0.0050
  Val mIoU: 0.4865 (Best: 0.7653)
  [Class IoU]  C1: 0.2992 | C2: 0.7399 | C3: 0.4205
Epoch 110/400 | Train Loss: 30.0202
 Avg Train Loss: 30.0202 | Seg Loss: 0.3001 | Recon Loss: 0.0052
  Val mIoU: 0.5207 (Best: 0.7653)
  [Class IoU]  C1: 0.3307 | C2: 0.7677 | C3: 0.4636
Epoch 111/400 | Train Loss: 29.9867
 Avg Train Loss: 29.9867 | Seg Loss: 0.2998 | Recon Loss: 0.0050
  Val mIoU: 0.4862 (Best: 0.7653)
  [Class IoU]  C1: 0.2391 | C2: 0.7714 | C3: 0.4482
Epoch 112/400 | Train Loss: 30.0896
 Avg Train Loss: 30.0896 | Seg Loss: 0.3008 | Recon Loss: 0.0051
  Val mIoU: 0.4757 (Best: 0.7653)
  [Class IoU]  C1: 0.2607 | C2: 0.7466 | C3: 0.4199
Epoch 113/400 | Train Loss: 30.0339
 Avg Train Loss: 30.0339 | Seg Loss: 0.3003 | Recon Loss: 0.0050
  Val mIoU: 0.5389 (Best: 0.7653)
  [Class IoU]  C1: 0.3571 | C2: 0.7765 | C3: 0.4833
Epoch 114/400 | Train Loss: 30.0536
 Avg Train Loss: 30.0536 | Seg Loss: 0.3005 | Recon Loss: 0.0051
  Val mIoU: 0.4859 (Best: 0.7653)
  [Class IoU]  C1: 0.2927 | C2: 0.7549 | C3: 0.4101
Epoch 115/400 | Train Loss: 30.5648
 Avg Train Loss: 30.5648 | Seg Loss: 0.3056 | Recon Loss: 0.0051
  Val mIoU: 0.4774 (Best: 0.7653)
  [Class IoU]  C1: 0.2868 | C2: 0.7406 | C3: 0.4046
Epoch 116/400 | Train Loss: 29.5273
 Avg Train Loss: 29.5273 | Seg Loss: 0.2952 | Recon Loss: 0.0050
  Val mIoU: 0.5320 (Best: 0.7653)
  [Class IoU]  C1: 0.3448 | C2: 0.7742 | C3: 0.4771
Epoch 117/400 | Train Loss: 30.0529
 Avg Train Loss: 30.0529 | Seg Loss: 0.3005 | Recon Loss: 0.0051
  Val mIoU: 0.4936 (Best: 0.7653)
  [Class IoU]  C1: 0.2639 | C2: 0.7758 | C3: 0.4412
Epoch 118/400 | Train Loss: 30.1651
 Avg Train Loss: 30.1651 | Seg Loss: 0.3016 | Recon Loss: 0.0051
  Val mIoU: 0.5413 (Best: 0.7653)
  [Class IoU]  C1: 0.3037 | C2: 0.7962 | C3: 0.5238
Epoch 119/400 | Train Loss: 29.4412
 Avg Train Loss: 29.4412 | Seg Loss: 0.2944 | Recon Loss: 0.0052
  Val mIoU: 0.4781 (Best: 0.7653)
  [Class IoU]  C1: 0.2694 | C2: 0.7481 | C3: 0.4166
Epoch 120/400 | Train Loss: 29.1402
 Avg Train Loss: 29.1402 | Seg Loss: 0.2914 | Recon Loss: 0.0050
  Val mIoU: 0.4736 (Best: 0.7653)
  [Class IoU]  C1: 0.2655 | C2: 0.7396 | C3: 0.4156
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 31.1133
 Avg Train Loss: 31.1133 | Seg Loss: 0.3111 | Recon Loss: 0.0051
  Val mIoU: 0.5040 (Best: 0.7653)
  [Class IoU]  C1: 0.2990 | C2: 0.7630 | C3: 0.4501
Epoch 122/400 | Train Loss: 30.3556
 Avg Train Loss: 30.3556 | Seg Loss: 0.3035 | Recon Loss: 0.0050
  Val mIoU: 0.5000 (Best: 0.7653)
  [Class IoU]  C1: 0.2608 | C2: 0.7781 | C3: 0.4612
Epoch 123/400 | Train Loss: 29.2323
 Avg Train Loss: 29.2323 | Seg Loss: 0.2923 | Recon Loss: 0.0051
  Val mIoU: 0.4882 (Best: 0.7653)
  [Class IoU]  C1: 0.2660 | C2: 0.7592 | C3: 0.4394
Epoch 124/400 | Train Loss: 29.4986
 Avg Train Loss: 29.4986 | Seg Loss: 0.2949 | Recon Loss: 0.0051
  Val mIoU: 0.5098 (Best: 0.7653)
  [Class IoU]  C1: 0.2900 | C2: 0.7759 | C3: 0.4636
Epoch 125/400 | Train Loss: 29.2829
 Avg Train Loss: 29.2829 | Seg Loss: 0.2928 | Recon Loss: 0.0050
  Val mIoU: 0.4908 (Best: 0.7653)
  [Class IoU]  C1: 0.2793 | C2: 0.7567 | C3: 0.4365
Epoch 126/400 | Train Loss: 30.2274
 Avg Train Loss: 30.2274 | Seg Loss: 0.3022 | Recon Loss: 0.0051
  Val mIoU: 0.4934 (Best: 0.7653)
  [Class IoU]  C1: 0.2819 | C2: 0.7535 | C3: 0.4447
Epoch 127/400 | Train Loss: 30.0755
 Avg Train Loss: 30.0755 | Seg Loss: 0.3007 | Recon Loss: 0.0051
  Val mIoU: 0.5955 (Best: 0.7653)
  [Class IoU]  C1: 0.4841 | C2: 0.7821 | C3: 0.5203
Epoch 128/400 | Train Loss: 29.4210
 Avg Train Loss: 29.4210 | Seg Loss: 0.2942 | Recon Loss: 0.0049
  Val mIoU: 0.4946 (Best: 0.7653)
  [Class IoU]  C1: 0.2981 | C2: 0.7410 | C3: 0.4448
Epoch 129/400 | Train Loss: 29.7344
 Avg Train Loss: 29.7344 | Seg Loss: 0.2973 | Recon Loss: 0.0050
  Val mIoU: 0.5358 (Best: 0.7653)
  [Class IoU]  C1: 0.3553 | C2: 0.7691 | C3: 0.4831
Epoch 130/400 | Train Loss: 29.9482
 Avg Train Loss: 29.9482 | Seg Loss: 0.2994 | Recon Loss: 0.0051
  Val mIoU: 0.5103 (Best: 0.7653)
  [Class IoU]  C1: 0.2899 | C2: 0.7734 | C3: 0.4676
Epoch 131/400 | Train Loss: 30.5166
 Avg Train Loss: 30.5166 | Seg Loss: 0.3051 | Recon Loss: 0.0051
  Val mIoU: 0.5096 (Best: 0.7653)
  [Class IoU]  C1: 0.3236 | C2: 0.7590 | C3: 0.4460
Epoch 132/400 | Train Loss: 30.4049
 Avg Train Loss: 30.4049 | Seg Loss: 0.3040 | Recon Loss: 0.0051
  Val mIoU: 0.4965 (Best: 0.7653)
  [Class IoU]  C1: 0.2648 | C2: 0.7685 | C3: 0.4561
Epoch 133/400 | Train Loss: 29.2117
 Avg Train Loss: 29.2117 | Seg Loss: 0.2921 | Recon Loss: 0.0051
  Val mIoU: 0.5042 (Best: 0.7653)
  [Class IoU]  C1: 0.2753 | C2: 0.7740 | C3: 0.4632
Epoch 134/400 | Train Loss: 29.9242
 Avg Train Loss: 29.9242 | Seg Loss: 0.2992 | Recon Loss: 0.0049
  Val mIoU: 0.5434 (Best: 0.7653)
  [Class IoU]  C1: 0.3365 | C2: 0.7845 | C3: 0.5093
Epoch 135/400 | Train Loss: 29.9083
 Avg Train Loss: 29.9083 | Seg Loss: 0.2990 | Recon Loss: 0.0052
  Val mIoU: 0.4962 (Best: 0.7653)
  [Class IoU]  C1: 0.2586 | C2: 0.7737 | C3: 0.4564
Epoch 136/400 | Train Loss: 29.6213
 Avg Train Loss: 29.6213 | Seg Loss: 0.2962 | Recon Loss: 0.0050
  Val mIoU: 0.5194 (Best: 0.7653)
  [Class IoU]  C1: 0.3067 | C2: 0.7794 | C3: 0.4723
Epoch 137/400 | Train Loss: 29.9700
 Avg Train Loss: 29.9700 | Seg Loss: 0.2996 | Recon Loss: 0.0051
  Val mIoU: 0.5126 (Best: 0.7653)
  [Class IoU]  C1: 0.3122 | C2: 0.7605 | C3: 0.4649
Epoch 138/400 | Train Loss: 29.3125
 Avg Train Loss: 29.3125 | Seg Loss: 0.2931 | Recon Loss: 0.0049
  Val mIoU: 0.4891 (Best: 0.7653)
  [Class IoU]  C1: 0.2836 | C2: 0.7489 | C3: 0.4349
Epoch 139/400 | Train Loss: 29.8966
 Avg Train Loss: 29.8966 | Seg Loss: 0.2989 | Recon Loss: 0.0049
  Val mIoU: 0.4962 (Best: 0.7653)
  [Class IoU]  C1: 0.2646 | C2: 0.7707 | C3: 0.4534
Epoch 140/400 | Train Loss: 29.3011
 Avg Train Loss: 29.3011 | Seg Loss: 0.2930 | Recon Loss: 0.0049
  Val mIoU: 0.6057 (Best: 0.7653)
  [Class IoU]  C1: 0.4706 | C2: 0.8003 | C3: 0.5461
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 28.8771
 Avg Train Loss: 28.8771 | Seg Loss: 0.2887 | Recon Loss: 0.0050
  Val mIoU: 0.5435 (Best: 0.7653)
  [Class IoU]  C1: 0.3628 | C2: 0.7810 | C3: 0.4867
Epoch 142/400 | Train Loss: 29.2423
 Avg Train Loss: 29.2423 | Seg Loss: 0.2924 | Recon Loss: 0.0049
  Val mIoU: 0.4818 (Best: 0.7653)
  [Class IoU]  C1: 0.2774 | C2: 0.7465 | C3: 0.4216
Epoch 143/400 | Train Loss: 29.6311
 Avg Train Loss: 29.6311 | Seg Loss: 0.2963 | Recon Loss: 0.0052
  Val mIoU: 0.5199 (Best: 0.7653)
  [Class IoU]  C1: 0.3055 | C2: 0.7723 | C3: 0.4819
Epoch 144/400 | Train Loss: 29.1687
 Avg Train Loss: 29.1687 | Seg Loss: 0.2916 | Recon Loss: 0.0051
  Val mIoU: 0.4876 (Best: 0.7653)
  [Class IoU]  C1: 0.2456 | C2: 0.7676 | C3: 0.4497
Epoch 145/400 | Train Loss: 29.6910
 Avg Train Loss: 29.6910 | Seg Loss: 0.2969 | Recon Loss: 0.0050
  Val mIoU: 0.5026 (Best: 0.7653)
  [Class IoU]  C1: 0.2936 | C2: 0.7565 | C3: 0.4577
Epoch 146/400 | Train Loss: 30.0530
 Avg Train Loss: 30.0530 | Seg Loss: 0.3005 | Recon Loss: 0.0049
  Val mIoU: 0.4779 (Best: 0.7653)
  [Class IoU]  C1: 0.2542 | C2: 0.7487 | C3: 0.4306
Epoch 147/400 | Train Loss: 29.9098
 Avg Train Loss: 29.9098 | Seg Loss: 0.2990 | Recon Loss: 0.0049
  Val mIoU: 0.5269 (Best: 0.7653)
  [Class IoU]  C1: 0.2951 | C2: 0.7810 | C3: 0.5045
Epoch 148/400 | Train Loss: 29.7287
 Avg Train Loss: 29.7287 | Seg Loss: 0.2972 | Recon Loss: 0.0050
  Val mIoU: 0.5108 (Best: 0.7653)
  [Class IoU]  C1: 0.2978 | C2: 0.7697 | C3: 0.4649
Epoch 149/400 | Train Loss: 29.3177
 Avg Train Loss: 29.3177 | Seg Loss: 0.2931 | Recon Loss: 0.0049
  Val mIoU: 0.5082 (Best: 0.7653)
  [Class IoU]  C1: 0.2636 | C2: 0.7798 | C3: 0.4812
Epoch 150/400 | Train Loss: 29.4507
 Avg Train Loss: 29.4507 | Seg Loss: 0.2945 | Recon Loss: 0.0049
  Val mIoU: 0.4715 (Best: 0.7653)
  [Class IoU]  C1: 0.2594 | C2: 0.7437 | C3: 0.4114
Epoch 151/400 | Train Loss: 29.6226
 Avg Train Loss: 29.6226 | Seg Loss: 0.2962 | Recon Loss: 0.0049
  Val mIoU: 0.5231 (Best: 0.7653)
  [Class IoU]  C1: 0.3061 | C2: 0.7689 | C3: 0.4942
Epoch 152/400 | Train Loss: 29.3511
 Avg Train Loss: 29.3511 | Seg Loss: 0.2935 | Recon Loss: 0.0051
  Val mIoU: 0.5197 (Best: 0.7653)
  [Class IoU]  C1: 0.3164 | C2: 0.7689 | C3: 0.4738
Epoch 153/400 | Train Loss: 29.5437
 Avg Train Loss: 29.5437 | Seg Loss: 0.2954 | Recon Loss: 0.0050
  Val mIoU: 0.5217 (Best: 0.7653)
  [Class IoU]  C1: 0.2994 | C2: 0.7690 | C3: 0.4966
Epoch 154/400 | Train Loss: 29.5388
 Avg Train Loss: 29.5388 | Seg Loss: 0.2953 | Recon Loss: 0.0050
  Val mIoU: 0.5048 (Best: 0.7653)
  [Class IoU]  C1: 0.2884 | C2: 0.7714 | C3: 0.4547
Epoch 155/400 | Train Loss: 29.5680
 Avg Train Loss: 29.5680 | Seg Loss: 0.2956 | Recon Loss: 0.0050
  Val mIoU: 0.5038 (Best: 0.7653)
  [Class IoU]  C1: 0.2799 | C2: 0.7680 | C3: 0.4635
Epoch 156/400 | Train Loss: 29.8694
 Avg Train Loss: 29.8694 | Seg Loss: 0.2986 | Recon Loss: 0.0050
  Val mIoU: 0.5190 (Best: 0.7653)
  [Class IoU]  C1: 0.2754 | C2: 0.7901 | C3: 0.4917
Epoch 157/400 | Train Loss: 29.1948
 Avg Train Loss: 29.1948 | Seg Loss: 0.2919 | Recon Loss: 0.0050
  Val mIoU: 0.5052 (Best: 0.7653)
  [Class IoU]  C1: 0.2563 | C2: 0.7813 | C3: 0.4781
Epoch 158/400 | Train Loss: 29.6129
 Avg Train Loss: 29.6129 | Seg Loss: 0.2961 | Recon Loss: 0.0051
  Val mIoU: 0.5178 (Best: 0.7653)
  [Class IoU]  C1: 0.2953 | C2: 0.7767 | C3: 0.4815
Epoch 159/400 | Train Loss: 28.9725
 Avg Train Loss: 28.9725 | Seg Loss: 0.2897 | Recon Loss: 0.0049
  Val mIoU: 0.5415 (Best: 0.7653)
  [Class IoU]  C1: 0.3056 | C2: 0.7928 | C3: 0.5261
Epoch 160/400 | Train Loss: 29.7248
 Avg Train Loss: 29.7248 | Seg Loss: 0.2972 | Recon Loss: 0.0052
  Val mIoU: 0.5171 (Best: 0.7653)
  [Class IoU]  C1: 0.2826 | C2: 0.7805 | C3: 0.4882
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 29.6327
 Avg Train Loss: 29.6327 | Seg Loss: 0.2963 | Recon Loss: 0.0050
  Val mIoU: 0.5305 (Best: 0.7653)
  [Class IoU]  C1: 0.3514 | C2: 0.7672 | C3: 0.4728
Epoch 162/400 | Train Loss: 30.2592
 Avg Train Loss: 30.2592 | Seg Loss: 0.3025 | Recon Loss: 0.0050
  Val mIoU: 0.5203 (Best: 0.7653)
  [Class IoU]  C1: 0.3278 | C2: 0.7628 | C3: 0.4702
Epoch 163/400 | Train Loss: 30.0619
 Avg Train Loss: 30.0619 | Seg Loss: 0.3006 | Recon Loss: 0.0049
  Val mIoU: 0.4789 (Best: 0.7653)
  [Class IoU]  C1: 0.2493 | C2: 0.7586 | C3: 0.4287
Epoch 164/400 | Train Loss: 29.5872
 Avg Train Loss: 29.5872 | Seg Loss: 0.2958 | Recon Loss: 0.0051
  Val mIoU: 0.5090 (Best: 0.7653)
  [Class IoU]  C1: 0.2990 | C2: 0.7678 | C3: 0.4602
Epoch 165/400 | Train Loss: 29.7410
 Avg Train Loss: 29.7410 | Seg Loss: 0.2974 | Recon Loss: 0.0050
  Val mIoU: 0.5180 (Best: 0.7653)
  [Class IoU]  C1: 0.2622 | C2: 0.7898 | C3: 0.5019
Epoch 166/400 | Train Loss: 29.6055
 Avg Train Loss: 29.6055 | Seg Loss: 0.2960 | Recon Loss: 0.0050
  Val mIoU: 0.4730 (Best: 0.7653)
  [Class IoU]  C1: 0.2760 | C2: 0.7354 | C3: 0.4074
Epoch 167/400 | Train Loss: 29.1995
 Avg Train Loss: 29.1995 | Seg Loss: 0.2919 | Recon Loss: 0.0050
  Val mIoU: 0.4890 (Best: 0.7653)
  [Class IoU]  C1: 0.2656 | C2: 0.7596 | C3: 0.4418
Epoch 168/400 | Train Loss: 29.7935
 Avg Train Loss: 29.7935 | Seg Loss: 0.2979 | Recon Loss: 0.0049
  Val mIoU: 0.4756 (Best: 0.7653)
  [Class IoU]  C1: 0.2693 | C2: 0.7424 | C3: 0.4152
Epoch 169/400 | Train Loss: 30.0926
 Avg Train Loss: 30.0926 | Seg Loss: 0.3009 | Recon Loss: 0.0049
  Val mIoU: 0.5008 (Best: 0.7653)
  [Class IoU]  C1: 0.2577 | C2: 0.7762 | C3: 0.4684
Epoch 170/400 | Train Loss: 29.6320
 Avg Train Loss: 29.6320 | Seg Loss: 0.2963 | Recon Loss: 0.0051
  Val mIoU: 0.5673 (Best: 0.7653)
  [Class IoU]  C1: 0.3832 | C2: 0.7882 | C3: 0.5303
Epoch 171/400 | Train Loss: 29.4355
 Avg Train Loss: 29.4355 | Seg Loss: 0.2943 | Recon Loss: 0.0047
  Val mIoU: 0.5219 (Best: 0.7653)
  [Class IoU]  C1: 0.3225 | C2: 0.7707 | C3: 0.4726
Epoch 172/400 | Train Loss: 29.0914
 Avg Train Loss: 29.0914 | Seg Loss: 0.2909 | Recon Loss: 0.0051
  Val mIoU: 0.5667 (Best: 0.7653)
  [Class IoU]  C1: 0.3695 | C2: 0.7985 | C3: 0.5323
Epoch 173/400 | Train Loss: 29.5000
 Avg Train Loss: 29.5000 | Seg Loss: 0.2949 | Recon Loss: 0.0051
  Val mIoU: 0.5838 (Best: 0.7653)
  [Class IoU]  C1: 0.3638 | C2: 0.8058 | C3: 0.5818
Epoch 174/400 | Train Loss: 29.8304
 Avg Train Loss: 29.8304 | Seg Loss: 0.2983 | Recon Loss: 0.0050
  Val mIoU: 0.5239 (Best: 0.7653)
  [Class IoU]  C1: 0.3302 | C2: 0.7662 | C3: 0.4753
Epoch 175/400 | Train Loss: 29.7211
 Avg Train Loss: 29.7211 | Seg Loss: 0.2972 | Recon Loss: 0.0048
  Val mIoU: 0.4881 (Best: 0.7653)
  [Class IoU]  C1: 0.2800 | C2: 0.7493 | C3: 0.4349
Epoch 176/400 | Train Loss: 29.0256
 Avg Train Loss: 29.0256 | Seg Loss: 0.2902 | Recon Loss: 0.0049
  Val mIoU: 0.5084 (Best: 0.7653)
  [Class IoU]  C1: 0.2704 | C2: 0.7779 | C3: 0.4769
Epoch 177/400 | Train Loss: 29.1645
 Avg Train Loss: 29.1645 | Seg Loss: 0.2916 | Recon Loss: 0.0049
  Val mIoU: 0.5182 (Best: 0.7653)
  [Class IoU]  C1: 0.2942 | C2: 0.7816 | C3: 0.4787
Epoch 178/400 | Train Loss: 29.8819
 Avg Train Loss: 29.8819 | Seg Loss: 0.2988 | Recon Loss: 0.0049
  Val mIoU: 0.4931 (Best: 0.7653)
  [Class IoU]  C1: 0.2550 | C2: 0.7672 | C3: 0.4570
Epoch 179/400 | Train Loss: 29.1061
 Avg Train Loss: 29.1061 | Seg Loss: 0.2910 | Recon Loss: 0.0050
  Val mIoU: 0.4998 (Best: 0.7653)
  [Class IoU]  C1: 0.2780 | C2: 0.7618 | C3: 0.4594
Epoch 180/400 | Train Loss: 30.2743
 Avg Train Loss: 30.2743 | Seg Loss: 0.3027 | Recon Loss: 0.0050
  Val mIoU: 0.4970 (Best: 0.7653)
  [Class IoU]  C1: 0.2662 | C2: 0.7651 | C3: 0.4596
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 29.0655
 Avg Train Loss: 29.0655 | Seg Loss: 0.2906 | Recon Loss: 0.0050
  Val mIoU: 0.4839 (Best: 0.7653)
  [Class IoU]  C1: 0.2851 | C2: 0.7435 | C3: 0.4232
Epoch 182/400 | Train Loss: 29.4007
 Avg Train Loss: 29.4007 | Seg Loss: 0.2940 | Recon Loss: 0.0048
  Val mIoU: 0.5179 (Best: 0.7653)
  [Class IoU]  C1: 0.3082 | C2: 0.7686 | C3: 0.4770
Epoch 183/400 | Train Loss: 29.2970
 Avg Train Loss: 29.2970 | Seg Loss: 0.2929 | Recon Loss: 0.0051
  Val mIoU: 0.5020 (Best: 0.7653)
  [Class IoU]  C1: 0.2807 | C2: 0.7706 | C3: 0.4546
Epoch 184/400 | Train Loss: 29.1234
 Avg Train Loss: 29.1234 | Seg Loss: 0.2912 | Recon Loss: 0.0051
  Val mIoU: 0.4959 (Best: 0.7653)
  [Class IoU]  C1: 0.2667 | C2: 0.7707 | C3: 0.4503
Epoch 185/400 | Train Loss: 29.5619
 Avg Train Loss: 29.5619 | Seg Loss: 0.2956 | Recon Loss: 0.0050
  Val mIoU: 0.4882 (Best: 0.7653)
  [Class IoU]  C1: 0.2592 | C2: 0.7637 | C3: 0.4417
Epoch 186/400 | Train Loss: 29.7719
 Avg Train Loss: 29.7719 | Seg Loss: 0.2977 | Recon Loss: 0.0052
  Val mIoU: 0.5503 (Best: 0.7653)
  [Class IoU]  C1: 0.3896 | C2: 0.7697 | C3: 0.4918
Epoch 187/400 | Train Loss: 29.9107
 Avg Train Loss: 29.9107 | Seg Loss: 0.2991 | Recon Loss: 0.0050
  Val mIoU: 0.4813 (Best: 0.7653)
  [Class IoU]  C1: 0.2466 | C2: 0.7648 | C3: 0.4324
Epoch 188/400 | Train Loss: 29.4862
 Avg Train Loss: 29.4862 | Seg Loss: 0.2948 | Recon Loss: 0.0050
  Val mIoU: 0.4691 (Best: 0.7653)
  [Class IoU]  C1: 0.2536 | C2: 0.7473 | C3: 0.4063
Epoch 189/400 | Train Loss: 29.0245
 Avg Train Loss: 29.0245 | Seg Loss: 0.2902 | Recon Loss: 0.0050
  Val mIoU: 0.4377 (Best: 0.7653)
  [Class IoU]  C1: 0.2458 | C2: 0.7014 | C3: 0.3658
Epoch 190/400 | Train Loss: 30.0293
 Avg Train Loss: 30.0293 | Seg Loss: 0.3002 | Recon Loss: 0.0050
  Val mIoU: 0.5273 (Best: 0.7653)
  [Class IoU]  C1: 0.2706 | C2: 0.7978 | C3: 0.5136
Epoch 191/400 | Train Loss: 29.4002
 Avg Train Loss: 29.4002 | Seg Loss: 0.2940 | Recon Loss: 0.0049
  Val mIoU: 0.5409 (Best: 0.7653)
  [Class IoU]  C1: 0.3216 | C2: 0.7848 | C3: 0.5164
Epoch 192/400 | Train Loss: 28.9516
 Avg Train Loss: 28.9516 | Seg Loss: 0.2895 | Recon Loss: 0.0049
  Val mIoU: 0.5194 (Best: 0.7653)
  [Class IoU]  C1: 0.2762 | C2: 0.7880 | C3: 0.4940
Epoch 193/400 | Train Loss: 29.5113
 Avg Train Loss: 29.5113 | Seg Loss: 0.2951 | Recon Loss: 0.0049
  Val mIoU: 0.4786 (Best: 0.7653)
  [Class IoU]  C1: 0.2568 | C2: 0.7501 | C3: 0.4288
Epoch 194/400 | Train Loss: 29.7397
 Avg Train Loss: 29.7397 | Seg Loss: 0.2973 | Recon Loss: 0.0051
  Val mIoU: 0.4489 (Best: 0.7653)
  [Class IoU]  C1: 0.2389 | C2: 0.7209 | C3: 0.3869
Epoch 195/400 | Train Loss: 29.4067
 Avg Train Loss: 29.4067 | Seg Loss: 0.2940 | Recon Loss: 0.0050
  Val mIoU: 0.5356 (Best: 0.7653)
  [Class IoU]  C1: 0.2824 | C2: 0.7969 | C3: 0.5276
Epoch 196/400 | Train Loss: 29.3537
 Avg Train Loss: 29.3537 | Seg Loss: 0.2935 | Recon Loss: 0.0049
  Val mIoU: 0.5739 (Best: 0.7653)
  [Class IoU]  C1: 0.3715 | C2: 0.7995 | C3: 0.5506
Epoch 197/400 | Train Loss: 30.2736
 Avg Train Loss: 30.2736 | Seg Loss: 0.3027 | Recon Loss: 0.0050
  Val mIoU: 0.5505 (Best: 0.7653)
  [Class IoU]  C1: 0.3233 | C2: 0.7981 | C3: 0.5302
Epoch 198/400 | Train Loss: 30.4753
 Avg Train Loss: 30.4753 | Seg Loss: 0.3047 | Recon Loss: 0.0051
  Val mIoU: 0.5213 (Best: 0.7653)
  [Class IoU]  C1: 0.3145 | C2: 0.7723 | C3: 0.4771
Epoch 199/400 | Train Loss: 29.4588
 Avg Train Loss: 29.4588 | Seg Loss: 0.2945 | Recon Loss: 0.0048
  Val mIoU: 0.4750 (Best: 0.7653)
  [Class IoU]  C1: 0.2687 | C2: 0.7461 | C3: 0.4102
Epoch 200/400 | Train Loss: 28.9186
 Avg Train Loss: 28.9186 | Seg Loss: 0.2891 | Recon Loss: 0.0049
  Val mIoU: 0.5483 (Best: 0.7653)
  [Class IoU]  C1: 0.3101 | C2: 0.8084 | C3: 0.5263
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 29.5781
 Avg Train Loss: 29.5781 | Seg Loss: 0.2957 | Recon Loss: 0.0048
  Val mIoU: 0.4838 (Best: 0.7653)
  [Class IoU]  C1: 0.2987 | C2: 0.7392 | C3: 0.4134
Epoch 202/400 | Train Loss: 29.8065
 Avg Train Loss: 29.8065 | Seg Loss: 0.2980 | Recon Loss: 0.0049
  Val mIoU: 0.5047 (Best: 0.7653)
  [Class IoU]  C1: 0.2615 | C2: 0.7817 | C3: 0.4708
Epoch 203/400 | Train Loss: 29.5658
 Avg Train Loss: 29.5658 | Seg Loss: 0.2956 | Recon Loss: 0.0051
  Val mIoU: 0.4702 (Best: 0.7653)
  [Class IoU]  C1: 0.2619 | C2: 0.7342 | C3: 0.4143
Epoch 204/400 | Train Loss: 29.8082
 Avg Train Loss: 29.8082 | Seg Loss: 0.2980 | Recon Loss: 0.0050
  Val mIoU: 0.5061 (Best: 0.7653)
  [Class IoU]  C1: 0.2875 | C2: 0.7740 | C3: 0.4569
Epoch 205/400 | Train Loss: 29.7876
 Avg Train Loss: 29.7876 | Seg Loss: 0.2978 | Recon Loss: 0.0050
  Val mIoU: 0.5817 (Best: 0.7653)
  [Class IoU]  C1: 0.3846 | C2: 0.8083 | C3: 0.5520
Epoch 206/400 | Train Loss: 29.7607
 Avg Train Loss: 29.7607 | Seg Loss: 0.2976 | Recon Loss: 0.0050
  Val mIoU: 0.4858 (Best: 0.7653)
  [Class IoU]  C1: 0.2968 | C2: 0.7410 | C3: 0.4197
Epoch 207/400 | Train Loss: 30.2307
 Avg Train Loss: 30.2307 | Seg Loss: 0.3023 | Recon Loss: 0.0051
  Val mIoU: 0.5246 (Best: 0.7653)
  [Class IoU]  C1: 0.3297 | C2: 0.7773 | C3: 0.4669
Epoch 208/400 | Train Loss: 29.0659
 Avg Train Loss: 29.0659 | Seg Loss: 0.2906 | Recon Loss: 0.0052
  Val mIoU: 0.4632 (Best: 0.7653)
  [Class IoU]  C1: 0.2686 | C2: 0.7255 | C3: 0.3956
Epoch 209/400 | Train Loss: 29.4498
 Avg Train Loss: 29.4498 | Seg Loss: 0.2944 | Recon Loss: 0.0051
  Val mIoU: 0.4883 (Best: 0.7653)
  [Class IoU]  C1: 0.2708 | C2: 0.7552 | C3: 0.4387
Epoch 210/400 | Train Loss: 29.3979
 Avg Train Loss: 29.3979 | Seg Loss: 0.2939 | Recon Loss: 0.0050
  Val mIoU: 0.4930 (Best: 0.7653)
  [Class IoU]  C1: 0.2772 | C2: 0.7585 | C3: 0.4433
Epoch 211/400 | Train Loss: 29.5146
 Avg Train Loss: 29.5146 | Seg Loss: 0.2951 | Recon Loss: 0.0050
  Val mIoU: 0.4810 (Best: 0.7653)
  [Class IoU]  C1: 0.2768 | C2: 0.7503 | C3: 0.4159
Epoch 212/400 | Train Loss: 29.4788
 Avg Train Loss: 29.4788 | Seg Loss: 0.2947 | Recon Loss: 0.0051
  Val mIoU: 0.5108 (Best: 0.7653)
  [Class IoU]  C1: 0.2712 | C2: 0.7789 | C3: 0.4822
Epoch 213/400 | Train Loss: 29.5094
 Avg Train Loss: 29.5094 | Seg Loss: 0.2950 | Recon Loss: 0.0051
  Val mIoU: 0.4900 (Best: 0.7653)
  [Class IoU]  C1: 0.2617 | C2: 0.7633 | C3: 0.4450
Epoch 214/400 | Train Loss: 30.1998
 Avg Train Loss: 30.1998 | Seg Loss: 0.3019 | Recon Loss: 0.0051
  Val mIoU: 0.5206 (Best: 0.7653)
  [Class IoU]  C1: 0.3224 | C2: 0.7713 | C3: 0.4681
Epoch 215/400 | Train Loss: 29.2371
 Avg Train Loss: 29.2371 | Seg Loss: 0.2923 | Recon Loss: 0.0050
  Val mIoU: 0.5001 (Best: 0.7653)
  [Class IoU]  C1: 0.2649 | C2: 0.7728 | C3: 0.4625
Epoch 216/400 | Train Loss: 29.1917
 Avg Train Loss: 29.1917 | Seg Loss: 0.2919 | Recon Loss: 0.0049
  Val mIoU: 0.4977 (Best: 0.7653)
  [Class IoU]  C1: 0.2666 | C2: 0.7687 | C3: 0.4579
Epoch 217/400 | Train Loss: 29.2121
 Avg Train Loss: 29.2121 | Seg Loss: 0.2921 | Recon Loss: 0.0051
  Val mIoU: 0.4966 (Best: 0.7653)
  [Class IoU]  C1: 0.2809 | C2: 0.7670 | C3: 0.4418
Epoch 218/400 | Train Loss: 29.3018
 Avg Train Loss: 29.3018 | Seg Loss: 0.2930 | Recon Loss: 0.0050
  Val mIoU: 0.5077 (Best: 0.7653)
  [Class IoU]  C1: 0.2930 | C2: 0.7553 | C3: 0.4748
Epoch 219/400 | Train Loss: 29.4974
 Avg Train Loss: 29.4974 | Seg Loss: 0.2949 | Recon Loss: 0.0050
  Val mIoU: 0.4961 (Best: 0.7653)
  [Class IoU]  C1: 0.2808 | C2: 0.7505 | C3: 0.4572
Epoch 220/400 | Train Loss: 29.5313
 Avg Train Loss: 29.5313 | Seg Loss: 0.2953 | Recon Loss: 0.0049
  Val mIoU: 0.6425 (Best: 0.7653)
  [Class IoU]  C1: 0.5934 | C2: 0.8046 | C3: 0.5296
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 29.9526
 Avg Train Loss: 29.9526 | Seg Loss: 0.2995 | Recon Loss: 0.0049
  Val mIoU: 0.5106 (Best: 0.7653)
  [Class IoU]  C1: 0.3078 | C2: 0.7731 | C3: 0.4510
Epoch 222/400 | Train Loss: 29.2568
 Avg Train Loss: 29.2568 | Seg Loss: 0.2925 | Recon Loss: 0.0050
  Val mIoU: 0.5080 (Best: 0.7653)
  [Class IoU]  C1: 0.2817 | C2: 0.7758 | C3: 0.4663
Epoch 223/400 | Train Loss: 30.0965
 Avg Train Loss: 30.0965 | Seg Loss: 0.3009 | Recon Loss: 0.0049
  Val mIoU: 0.5189 (Best: 0.7653)
  [Class IoU]  C1: 0.3006 | C2: 0.7809 | C3: 0.4752
Epoch 224/400 | Train Loss: 29.6953
 Avg Train Loss: 29.6953 | Seg Loss: 0.2969 | Recon Loss: 0.0050
  Val mIoU: 0.5369 (Best: 0.7653)
  [Class IoU]  C1: 0.3283 | C2: 0.7889 | C3: 0.4936
Epoch 225/400 | Train Loss: 29.0955
 Avg Train Loss: 29.0955 | Seg Loss: 0.2909 | Recon Loss: 0.0050
  Val mIoU: 0.5038 (Best: 0.7653)
  [Class IoU]  C1: 0.2852 | C2: 0.7693 | C3: 0.4570
Epoch 226/400 | Train Loss: 29.1179
 Avg Train Loss: 29.1179 | Seg Loss: 0.2911 | Recon Loss: 0.0050
  Val mIoU: 0.5372 (Best: 0.7653)
  [Class IoU]  C1: 0.3088 | C2: 0.7837 | C3: 0.5192
Epoch 227/400 | Train Loss: 29.5223
 Avg Train Loss: 29.5223 | Seg Loss: 0.2952 | Recon Loss: 0.0049
  Val mIoU: 0.5351 (Best: 0.7653)
  [Class IoU]  C1: 0.3146 | C2: 0.7884 | C3: 0.5024
Epoch 228/400 | Train Loss: 29.1458
 Avg Train Loss: 29.1458 | Seg Loss: 0.2914 | Recon Loss: 0.0052
  Val mIoU: 0.4797 (Best: 0.7653)
  [Class IoU]  C1: 0.2686 | C2: 0.7494 | C3: 0.4210
Epoch 229/400 | Train Loss: 29.8723
 Avg Train Loss: 29.8723 | Seg Loss: 0.2987 | Recon Loss: 0.0050
  Val mIoU: 0.4476 (Best: 0.7653)
  [Class IoU]  C1: 0.2400 | C2: 0.7217 | C3: 0.3810
Epoch 230/400 | Train Loss: 29.1900
 Avg Train Loss: 29.1900 | Seg Loss: 0.2918 | Recon Loss: 0.0051
  Val mIoU: 0.5739 (Best: 0.7653)
  [Class IoU]  C1: 0.3734 | C2: 0.8036 | C3: 0.5446
Epoch 231/400 | Train Loss: 29.6051
 Avg Train Loss: 29.6051 | Seg Loss: 0.2960 | Recon Loss: 0.0052
  Val mIoU: 0.5011 (Best: 0.7653)
  [Class IoU]  C1: 0.2865 | C2: 0.7629 | C3: 0.4539
Epoch 232/400 | Train Loss: 29.3149
 Avg Train Loss: 29.3149 | Seg Loss: 0.2931 | Recon Loss: 0.0049
  Val mIoU: 0.5270 (Best: 0.7653)
  [Class IoU]  C1: 0.3400 | C2: 0.7682 | C3: 0.4728
Epoch 233/400 | Train Loss: 29.8558
 Avg Train Loss: 29.8558 | Seg Loss: 0.2985 | Recon Loss: 0.0049
  Val mIoU: 0.5147 (Best: 0.7653)
  [Class IoU]  C1: 0.2936 | C2: 0.7785 | C3: 0.4721
Epoch 234/400 | Train Loss: 30.3643
 Avg Train Loss: 30.3643 | Seg Loss: 0.3036 | Recon Loss: 0.0050
  Val mIoU: 0.5972 (Best: 0.7653)
  [Class IoU]  C1: 0.4870 | C2: 0.7968 | C3: 0.5079
Epoch 235/400 | Train Loss: 29.3077
 Avg Train Loss: 29.3077 | Seg Loss: 0.2930 | Recon Loss: 0.0051
  Val mIoU: 0.5055 (Best: 0.7653)
  [Class IoU]  C1: 0.2634 | C2: 0.7781 | C3: 0.4749
Epoch 236/400 | Train Loss: 29.2478
 Avg Train Loss: 29.2478 | Seg Loss: 0.2924 | Recon Loss: 0.0050
  Val mIoU: 0.4812 (Best: 0.7653)
  [Class IoU]  C1: 0.2504 | C2: 0.7596 | C3: 0.4337
Epoch 237/400 | Train Loss: 28.9721
 Avg Train Loss: 28.9721 | Seg Loss: 0.2897 | Recon Loss: 0.0049
  Val mIoU: 0.5440 (Best: 0.7653)
  [Class IoU]  C1: 0.3489 | C2: 0.7829 | C3: 0.5003
Epoch 238/400 | Train Loss: 29.5976
 Avg Train Loss: 29.5976 | Seg Loss: 0.2959 | Recon Loss: 0.0049
  Val mIoU: 0.5264 (Best: 0.7653)
  [Class IoU]  C1: 0.2732 | C2: 0.7979 | C3: 0.5081
Epoch 239/400 | Train Loss: 29.8460
 Avg Train Loss: 29.8460 | Seg Loss: 0.2984 | Recon Loss: 0.0051
  Val mIoU: 0.5568 (Best: 0.7653)
  [Class IoU]  C1: 0.3519 | C2: 0.7982 | C3: 0.5203
Epoch 240/400 | Train Loss: 29.1581
 Avg Train Loss: 29.1581 | Seg Loss: 0.2915 | Recon Loss: 0.0052
  Val mIoU: 0.5183 (Best: 0.7653)
  [Class IoU]  C1: 0.2852 | C2: 0.7846 | C3: 0.4852
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 29.9852
 Avg Train Loss: 29.9852 | Seg Loss: 0.2998 | Recon Loss: 0.0050
  Val mIoU: 0.5295 (Best: 0.7653)
  [Class IoU]  C1: 0.3373 | C2: 0.7621 | C3: 0.4891
Epoch 242/400 | Train Loss: 29.6994
 Avg Train Loss: 29.6994 | Seg Loss: 0.2969 | Recon Loss: 0.0049
  Val mIoU: 0.5120 (Best: 0.7653)
  [Class IoU]  C1: 0.3291 | C2: 0.7553 | C3: 0.4516
Epoch 243/400 | Train Loss: 29.0681
 Avg Train Loss: 29.0681 | Seg Loss: 0.2906 | Recon Loss: 0.0049
  Val mIoU: 0.5538 (Best: 0.7653)
  [Class IoU]  C1: 0.3531 | C2: 0.7887 | C3: 0.5196
Epoch 244/400 | Train Loss: 29.5855
 Avg Train Loss: 29.5855 | Seg Loss: 0.2958 | Recon Loss: 0.0051
  Val mIoU: 0.5089 (Best: 0.7653)
  [Class IoU]  C1: 0.3190 | C2: 0.7571 | C3: 0.4505
Epoch 245/400 | Train Loss: 29.1839
 Avg Train Loss: 29.1839 | Seg Loss: 0.2918 | Recon Loss: 0.0051
  Val mIoU: 0.5233 (Best: 0.7653)
  [Class IoU]  C1: 0.2949 | C2: 0.7818 | C3: 0.4933
Epoch 246/400 | Train Loss: 29.4647
 Avg Train Loss: 29.4647 | Seg Loss: 0.2946 | Recon Loss: 0.0051
  Val mIoU: 0.5031 (Best: 0.7653)
  [Class IoU]  C1: 0.3101 | C2: 0.7513 | C3: 0.4478
Epoch 247/400 | Train Loss: 29.7576
 Avg Train Loss: 29.7576 | Seg Loss: 0.2975 | Recon Loss: 0.0050
  Val mIoU: 0.4722 (Best: 0.7653)
  [Class IoU]  C1: 0.2611 | C2: 0.7372 | C3: 0.4184
Epoch 248/400 | Train Loss: 29.4401
 Avg Train Loss: 29.4401 | Seg Loss: 0.2944 | Recon Loss: 0.0049
  Val mIoU: 0.5234 (Best: 0.7653)
  [Class IoU]  C1: 0.3041 | C2: 0.7757 | C3: 0.4903
Epoch 249/400 | Train Loss: 29.0744
 Avg Train Loss: 29.0744 | Seg Loss: 0.2907 | Recon Loss: 0.0050
  Val mIoU: 0.4700 (Best: 0.7653)
  [Class IoU]  C1: 0.2541 | C2: 0.7482 | C3: 0.4076
Epoch 250/400 | Train Loss: 30.0232
 Avg Train Loss: 30.0232 | Seg Loss: 0.3002 | Recon Loss: 0.0051
  Val mIoU: 0.4715 (Best: 0.7653)
  [Class IoU]  C1: 0.2507 | C2: 0.7472 | C3: 0.4166
Epoch 251/400 | Train Loss: 29.6471
 Avg Train Loss: 29.6471 | Seg Loss: 0.2964 | Recon Loss: 0.0049
  Val mIoU: 0.4926 (Best: 0.7653)
  [Class IoU]  C1: 0.2824 | C2: 0.7531 | C3: 0.4424
Epoch 252/400 | Train Loss: 29.3327
 Avg Train Loss: 29.3327 | Seg Loss: 0.2933 | Recon Loss: 0.0051
  Val mIoU: 0.5157 (Best: 0.7653)
  [Class IoU]  C1: 0.2975 | C2: 0.7686 | C3: 0.4809
Epoch 253/400 | Train Loss: 29.4158
 Avg Train Loss: 29.4158 | Seg Loss: 0.2941 | Recon Loss: 0.0050
  Val mIoU: 0.4838 (Best: 0.7653)
  [Class IoU]  C1: 0.2608 | C2: 0.7583 | C3: 0.4322
Epoch 254/400 | Train Loss: 29.4813
 Avg Train Loss: 29.4813 | Seg Loss: 0.2948 | Recon Loss: 0.0052
  Val mIoU: 0.5019 (Best: 0.7653)
  [Class IoU]  C1: 0.2832 | C2: 0.7662 | C3: 0.4563
Epoch 255/400 | Train Loss: 29.1917
 Avg Train Loss: 29.1917 | Seg Loss: 0.2919 | Recon Loss: 0.0050
  Val mIoU: 0.5199 (Best: 0.7653)
  [Class IoU]  C1: 0.2886 | C2: 0.7840 | C3: 0.4870
Epoch 256/400 | Train Loss: 29.1615
 Avg Train Loss: 29.1615 | Seg Loss: 0.2916 | Recon Loss: 0.0050
  Val mIoU: 0.4900 (Best: 0.7653)
  [Class IoU]  C1: 0.2688 | C2: 0.7614 | C3: 0.4397
Epoch 257/400 | Train Loss: 29.7117
 Avg Train Loss: 29.7117 | Seg Loss: 0.2971 | Recon Loss: 0.0049
  Val mIoU: 0.4784 (Best: 0.7653)
  [Class IoU]  C1: 0.2604 | C2: 0.7539 | C3: 0.4208
Epoch 258/400 | Train Loss: 28.9324
 Avg Train Loss: 28.9324 | Seg Loss: 0.2893 | Recon Loss: 0.0049
  Val mIoU: 0.5377 (Best: 0.7653)
  [Class IoU]  C1: 0.3432 | C2: 0.7732 | C3: 0.4966
Epoch 259/400 | Train Loss: 29.0973
 Avg Train Loss: 29.0973 | Seg Loss: 0.2909 | Recon Loss: 0.0050
  Val mIoU: 0.5195 (Best: 0.7653)
  [Class IoU]  C1: 0.2844 | C2: 0.7819 | C3: 0.4922
Epoch 260/400 | Train Loss: 29.6265
 Avg Train Loss: 29.6265 | Seg Loss: 0.2962 | Recon Loss: 0.0049
  Val mIoU: 0.5049 (Best: 0.7653)
  [Class IoU]  C1: 0.3142 | C2: 0.7540 | C3: 0.4466
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 29.3873
 Avg Train Loss: 29.3873 | Seg Loss: 0.2938 | Recon Loss: 0.0049
  Val mIoU: 0.4957 (Best: 0.7653)
  [Class IoU]  C1: 0.2696 | C2: 0.7652 | C3: 0.4523
Epoch 262/400 | Train Loss: 30.1754
 Avg Train Loss: 30.1754 | Seg Loss: 0.3017 | Recon Loss: 0.0051
  Val mIoU: 0.5123 (Best: 0.7653)
  [Class IoU]  C1: 0.3228 | C2: 0.7451 | C3: 0.4692
Epoch 263/400 | Train Loss: 28.6024
 Avg Train Loss: 28.6024 | Seg Loss: 0.2860 | Recon Loss: 0.0049
  Val mIoU: 0.4672 (Best: 0.7653)
  [Class IoU]  C1: 0.2510 | C2: 0.7383 | C3: 0.4122
Epoch 264/400 | Train Loss: 29.9472
 Avg Train Loss: 29.9472 | Seg Loss: 0.2994 | Recon Loss: 0.0051
  Val mIoU: 0.4851 (Best: 0.7653)
  [Class IoU]  C1: 0.2613 | C2: 0.7575 | C3: 0.4364
Epoch 265/400 | Train Loss: 29.4786
 Avg Train Loss: 29.4786 | Seg Loss: 0.2947 | Recon Loss: 0.0050
  Val mIoU: 0.5258 (Best: 0.7653)
  [Class IoU]  C1: 0.3299 | C2: 0.7595 | C3: 0.4879
Epoch 266/400 | Train Loss: 29.9484
 Avg Train Loss: 29.9484 | Seg Loss: 0.2994 | Recon Loss: 0.0048
  Val mIoU: 0.4994 (Best: 0.7653)
  [Class IoU]  C1: 0.2719 | C2: 0.7666 | C3: 0.4598
Epoch 267/400 | Train Loss: 29.1101
 Avg Train Loss: 29.1101 | Seg Loss: 0.2911 | Recon Loss: 0.0048
  Val mIoU: 0.5049 (Best: 0.7653)
  [Class IoU]  C1: 0.2836 | C2: 0.7707 | C3: 0.4604
Epoch 268/400 | Train Loss: 29.8945
 Avg Train Loss: 29.8945 | Seg Loss: 0.2989 | Recon Loss: 0.0051
  Val mIoU: 0.4616 (Best: 0.7653)
  [Class IoU]  C1: 0.2397 | C2: 0.7396 | C3: 0.4054
Epoch 269/400 | Train Loss: 29.2985
 Avg Train Loss: 29.2985 | Seg Loss: 0.2929 | Recon Loss: 0.0050
  Val mIoU: 0.5028 (Best: 0.7653)
  [Class IoU]  C1: 0.2935 | C2: 0.7635 | C3: 0.4515
Epoch 270/400 | Train Loss: 29.0259
 Avg Train Loss: 29.0259 | Seg Loss: 0.2902 | Recon Loss: 0.0049
  Val mIoU: 0.4430 (Best: 0.7653)
  [Class IoU]  C1: 0.2486 | C2: 0.7110 | C3: 0.3696
Epoch 271/400 | Train Loss: 28.5269
 Avg Train Loss: 28.5269 | Seg Loss: 0.2852 | Recon Loss: 0.0049
  Val mIoU: 0.4618 (Best: 0.7653)
  [Class IoU]  C1: 0.2848 | C2: 0.7161 | C3: 0.3845
Epoch 272/400 | Train Loss: 29.2073
 Avg Train Loss: 29.2073 | Seg Loss: 0.2920 | Recon Loss: 0.0050
  Val mIoU: 0.5032 (Best: 0.7653)
  [Class IoU]  C1: 0.2993 | C2: 0.7555 | C3: 0.4549
Epoch 273/400 | Train Loss: 28.7384
 Avg Train Loss: 28.7384 | Seg Loss: 0.2873 | Recon Loss: 0.0050
  Val mIoU: 0.4903 (Best: 0.7653)
  [Class IoU]  C1: 0.2478 | C2: 0.7707 | C3: 0.4524
Epoch 274/400 | Train Loss: 29.0675
 Avg Train Loss: 29.0675 | Seg Loss: 0.2906 | Recon Loss: 0.0050
  Val mIoU: 0.5702 (Best: 0.7653)
  [Class IoU]  C1: 0.3793 | C2: 0.7971 | C3: 0.5341
Epoch 275/400 | Train Loss: 29.6624
 Avg Train Loss: 29.6624 | Seg Loss: 0.2966 | Recon Loss: 0.0048
  Val mIoU: 0.5029 (Best: 0.7653)
  [Class IoU]  C1: 0.2662 | C2: 0.7762 | C3: 0.4663
Epoch 276/400 | Train Loss: 29.9415
 Avg Train Loss: 29.9415 | Seg Loss: 0.2994 | Recon Loss: 0.0049
  Val mIoU: 0.5483 (Best: 0.7653)
  [Class IoU]  C1: 0.3301 | C2: 0.7936 | C3: 0.5212
Epoch 277/400 | Train Loss: 29.6109
 Avg Train Loss: 29.6109 | Seg Loss: 0.2961 | Recon Loss: 0.0048
  Val mIoU: 0.5104 (Best: 0.7653)
  [Class IoU]  C1: 0.2727 | C2: 0.7815 | C3: 0.4770
Epoch 278/400 | Train Loss: 29.7591
 Avg Train Loss: 29.7591 | Seg Loss: 0.2975 | Recon Loss: 0.0050
  Val mIoU: 0.5262 (Best: 0.7653)
  [Class IoU]  C1: 0.3580 | C2: 0.7592 | C3: 0.4615
Epoch 279/400 | Train Loss: 29.7073
 Avg Train Loss: 29.7073 | Seg Loss: 0.2970 | Recon Loss: 0.0050
  Val mIoU: 0.4812 (Best: 0.7653)
  [Class IoU]  C1: 0.2576 | C2: 0.7548 | C3: 0.4311
Epoch 280/400 | Train Loss: 29.8427
 Avg Train Loss: 29.8427 | Seg Loss: 0.2984 | Recon Loss: 0.0051
  Val mIoU: 0.5080 (Best: 0.7653)
  [Class IoU]  C1: 0.2899 | C2: 0.7705 | C3: 0.4635
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 29.2922
 Avg Train Loss: 29.2922 | Seg Loss: 0.2929 | Recon Loss: 0.0050
  Val mIoU: 0.5452 (Best: 0.7653)
  [Class IoU]  C1: 0.3482 | C2: 0.7792 | C3: 0.5081
Epoch 282/400 | Train Loss: 29.5175
 Avg Train Loss: 29.5175 | Seg Loss: 0.2951 | Recon Loss: 0.0050
  Val mIoU: 0.4703 (Best: 0.7653)
  [Class IoU]  C1: 0.2535 | C2: 0.7471 | C3: 0.4102
Epoch 283/400 | Train Loss: 29.6736
 Avg Train Loss: 29.6736 | Seg Loss: 0.2967 | Recon Loss: 0.0048
  Val mIoU: 0.5102 (Best: 0.7653)
  [Class IoU]  C1: 0.2977 | C2: 0.7679 | C3: 0.4651
Epoch 284/400 | Train Loss: 29.2622
 Avg Train Loss: 29.2622 | Seg Loss: 0.2926 | Recon Loss: 0.0050
  Val mIoU: 0.4886 (Best: 0.7653)
  [Class IoU]  C1: 0.2750 | C2: 0.7569 | C3: 0.4339
Epoch 285/400 | Train Loss: 29.7918
 Avg Train Loss: 29.7918 | Seg Loss: 0.2979 | Recon Loss: 0.0051
  Val mIoU: 0.4592 (Best: 0.7653)
  [Class IoU]  C1: 0.2397 | C2: 0.7328 | C3: 0.4050
Epoch 286/400 | Train Loss: 29.3073
 Avg Train Loss: 29.3073 | Seg Loss: 0.2930 | Recon Loss: 0.0050
  Val mIoU: 0.4932 (Best: 0.7653)
  [Class IoU]  C1: 0.2654 | C2: 0.7671 | C3: 0.4470
Epoch 287/400 | Train Loss: 29.3379
 Avg Train Loss: 29.3379 | Seg Loss: 0.2933 | Recon Loss: 0.0050
  Val mIoU: 0.5089 (Best: 0.7653)
  [Class IoU]  C1: 0.3047 | C2: 0.7642 | C3: 0.4577
Epoch 288/400 | Train Loss: 29.0273
 Avg Train Loss: 29.0273 | Seg Loss: 0.2902 | Recon Loss: 0.0050
  Val mIoU: 0.4965 (Best: 0.7653)
  [Class IoU]  C1: 0.2680 | C2: 0.7652 | C3: 0.4563
Epoch 289/400 | Train Loss: 29.9800
 Avg Train Loss: 29.9800 | Seg Loss: 0.2997 | Recon Loss: 0.0051
  Val mIoU: 0.5083 (Best: 0.7653)
  [Class IoU]  C1: 0.2801 | C2: 0.7712 | C3: 0.4737
Epoch 290/400 | Train Loss: 30.0482
 Avg Train Loss: 30.0482 | Seg Loss: 0.3004 | Recon Loss: 0.0051
  Val mIoU: 0.4738 (Best: 0.7653)
  [Class IoU]  C1: 0.2920 | C2: 0.7255 | C3: 0.4040
Epoch 291/400 | Train Loss: 29.1037
 Avg Train Loss: 29.1037 | Seg Loss: 0.2910 | Recon Loss: 0.0050
  Val mIoU: 0.5002 (Best: 0.7653)
  [Class IoU]  C1: 0.2948 | C2: 0.7592 | C3: 0.4466
Epoch 292/400 | Train Loss: 29.6673
 Avg Train Loss: 29.6673 | Seg Loss: 0.2966 | Recon Loss: 0.0050
  Val mIoU: 0.4655 (Best: 0.7653)
  [Class IoU]  C1: 0.2419 | C2: 0.7402 | C3: 0.4144
Epoch 293/400 | Train Loss: 29.4807
 Avg Train Loss: 29.4807 | Seg Loss: 0.2948 | Recon Loss: 0.0050
  Val mIoU: 0.4879 (Best: 0.7653)
  [Class IoU]  C1: 0.2662 | C2: 0.7562 | C3: 0.4412
Epoch 294/400 | Train Loss: 29.7407
 Avg Train Loss: 29.7407 | Seg Loss: 0.2974 | Recon Loss: 0.0049
  Val mIoU: 0.4984 (Best: 0.7653)
  [Class IoU]  C1: 0.2757 | C2: 0.7678 | C3: 0.4515
Epoch 295/400 | Train Loss: 29.5497
 Avg Train Loss: 29.5497 | Seg Loss: 0.2954 | Recon Loss: 0.0049
  Val mIoU: 0.5003 (Best: 0.7653)
  [Class IoU]  C1: 0.2745 | C2: 0.7708 | C3: 0.4556
Epoch 296/400 | Train Loss: 29.6595
 Avg Train Loss: 29.6595 | Seg Loss: 0.2965 | Recon Loss: 0.0051
  Val mIoU: 0.5079 (Best: 0.7653)
  [Class IoU]  C1: 0.2620 | C2: 0.7841 | C3: 0.4777
Epoch 297/400 | Train Loss: 29.5387
 Avg Train Loss: 29.5387 | Seg Loss: 0.2953 | Recon Loss: 0.0051
  Val mIoU: 0.5137 (Best: 0.7653)
  [Class IoU]  C1: 0.2780 | C2: 0.7803 | C3: 0.4828
Epoch 298/400 | Train Loss: 29.8930
 Avg Train Loss: 29.8930 | Seg Loss: 0.2989 | Recon Loss: 0.0049
  Val mIoU: 0.4720 (Best: 0.7653)
  [Class IoU]  C1: 0.2649 | C2: 0.7419 | C3: 0.4093
Epoch 299/400 | Train Loss: 29.8415
 Avg Train Loss: 29.8415 | Seg Loss: 0.2984 | Recon Loss: 0.0050
  Val mIoU: 0.5530 (Best: 0.7653)
  [Class IoU]  C1: 0.3985 | C2: 0.7681 | C3: 0.4924
Epoch 300/400 | Train Loss: 29.5748
 Avg Train Loss: 29.5748 | Seg Loss: 0.2957 | Recon Loss: 0.0048
  Val mIoU: 0.4723 (Best: 0.7653)
  [Class IoU]  C1: 0.2478 | C2: 0.7477 | C3: 0.4214
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 28.3438
 Avg Train Loss: 28.3438 | Seg Loss: 0.2834 | Recon Loss: 0.0051
  Val mIoU: 0.5623 (Best: 0.7653)
  [Class IoU]  C1: 0.3444 | C2: 0.8016 | C3: 0.5408
Epoch 302/400 | Train Loss: 29.3892
 Avg Train Loss: 29.3892 | Seg Loss: 0.2938 | Recon Loss: 0.0049
  Val mIoU: 0.4962 (Best: 0.7653)
  [Class IoU]  C1: 0.2586 | C2: 0.7709 | C3: 0.4590
Epoch 303/400 | Train Loss: 29.4279
 Avg Train Loss: 29.4279 | Seg Loss: 0.2942 | Recon Loss: 0.0051
  Val mIoU: 0.5088 (Best: 0.7653)
  [Class IoU]  C1: 0.3110 | C2: 0.7604 | C3: 0.4552
Epoch 304/400 | Train Loss: 29.1965
 Avg Train Loss: 29.1965 | Seg Loss: 0.2919 | Recon Loss: 0.0048
  Val mIoU: 0.5295 (Best: 0.7653)
  [Class IoU]  C1: 0.2975 | C2: 0.7868 | C3: 0.5043
Epoch 305/400 | Train Loss: 30.3141
 Avg Train Loss: 30.3141 | Seg Loss: 0.3031 | Recon Loss: 0.0049
  Val mIoU: 0.5219 (Best: 0.7653)
  [Class IoU]  C1: 0.3261 | C2: 0.7623 | C3: 0.4772
Epoch 306/400 | Train Loss: 29.8282
 Avg Train Loss: 29.8282 | Seg Loss: 0.2982 | Recon Loss: 0.0052
  Val mIoU: 0.4701 (Best: 0.7653)
  [Class IoU]  C1: 0.2563 | C2: 0.7438 | C3: 0.4101
Epoch 307/400 | Train Loss: 29.0779
 Avg Train Loss: 29.0779 | Seg Loss: 0.2907 | Recon Loss: 0.0050
  Val mIoU: 0.5220 (Best: 0.7653)
  [Class IoU]  C1: 0.2916 | C2: 0.7862 | C3: 0.4883
Epoch 308/400 | Train Loss: 29.3860
 Avg Train Loss: 29.3860 | Seg Loss: 0.2938 | Recon Loss: 0.0051
  Val mIoU: 0.4600 (Best: 0.7653)
  [Class IoU]  C1: 0.2598 | C2: 0.7271 | C3: 0.3931
Epoch 309/400 | Train Loss: 29.6681
 Avg Train Loss: 29.6681 | Seg Loss: 0.2966 | Recon Loss: 0.0051
  Val mIoU: 0.4979 (Best: 0.7653)
  [Class IoU]  C1: 0.2694 | C2: 0.7661 | C3: 0.4581
Epoch 310/400 | Train Loss: 29.6044
 Avg Train Loss: 29.6044 | Seg Loss: 0.2960 | Recon Loss: 0.0051
  Val mIoU: 0.5256 (Best: 0.7653)
  [Class IoU]  C1: 0.3271 | C2: 0.7670 | C3: 0.4826
Epoch 311/400 | Train Loss: 29.6095
 Avg Train Loss: 29.6095 | Seg Loss: 0.2960 | Recon Loss: 0.0049
  Val mIoU: 0.4734 (Best: 0.7653)
  [Class IoU]  C1: 0.2552 | C2: 0.7484 | C3: 0.4166
Epoch 312/400 | Train Loss: 30.0158
 Avg Train Loss: 30.0158 | Seg Loss: 0.3001 | Recon Loss: 0.0050
  Val mIoU: 0.4990 (Best: 0.7653)
  [Class IoU]  C1: 0.2917 | C2: 0.7550 | C3: 0.4503
Epoch 313/400 | Train Loss: 29.0646
 Avg Train Loss: 29.0646 | Seg Loss: 0.2906 | Recon Loss: 0.0048
  Val mIoU: 0.4639 (Best: 0.7653)
  [Class IoU]  C1: 0.2604 | C2: 0.7261 | C3: 0.4052
Epoch 314/400 | Train Loss: 28.9964
 Avg Train Loss: 28.9964 | Seg Loss: 0.2899 | Recon Loss: 0.0048
  Val mIoU: 0.5311 (Best: 0.7653)
  [Class IoU]  C1: 0.2724 | C2: 0.7990 | C3: 0.5219
Epoch 315/400 | Train Loss: 28.8477
 Avg Train Loss: 28.8477 | Seg Loss: 0.2884 | Recon Loss: 0.0051
  Val mIoU: 0.5084 (Best: 0.7653)
  [Class IoU]  C1: 0.2755 | C2: 0.7832 | C3: 0.4664
Epoch 316/400 | Train Loss: 29.9933
 Avg Train Loss: 29.9933 | Seg Loss: 0.2999 | Recon Loss: 0.0049
  Val mIoU: 0.5105 (Best: 0.7653)
  [Class IoU]  C1: 0.3102 | C2: 0.7706 | C3: 0.4506
Epoch 317/400 | Train Loss: 29.6622
 Avg Train Loss: 29.6622 | Seg Loss: 0.2966 | Recon Loss: 0.0050
  Val mIoU: 0.5024 (Best: 0.7653)
  [Class IoU]  C1: 0.3176 | C2: 0.7558 | C3: 0.4339
Epoch 318/400 | Train Loss: 30.2771
 Avg Train Loss: 30.2771 | Seg Loss: 0.3027 | Recon Loss: 0.0051
  Val mIoU: 0.4454 (Best: 0.7653)
  [Class IoU]  C1: 0.2503 | C2: 0.7109 | C3: 0.3750
Epoch 319/400 | Train Loss: 28.9954
 Avg Train Loss: 28.9954 | Seg Loss: 0.2899 | Recon Loss: 0.0049
  Val mIoU: 0.5112 (Best: 0.7653)
  [Class IoU]  C1: 0.2634 | C2: 0.7820 | C3: 0.4881
Epoch 320/400 | Train Loss: 29.5326
 Avg Train Loss: 29.5326 | Seg Loss: 0.2953 | Recon Loss: 0.0049
  Val mIoU: 0.5176 (Best: 0.7653)
  [Class IoU]  C1: 0.2677 | C2: 0.7904 | C3: 0.4946
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 29.2358
 Avg Train Loss: 29.2358 | Seg Loss: 0.2923 | Recon Loss: 0.0049
  Val mIoU: 0.4855 (Best: 0.7653)
  [Class IoU]  C1: 0.2745 | C2: 0.7549 | C3: 0.4272
Epoch 322/400 | Train Loss: 29.3111
 Avg Train Loss: 29.3111 | Seg Loss: 0.2931 | Recon Loss: 0.0048
  Val mIoU: 0.4971 (Best: 0.7653)
  [Class IoU]  C1: 0.2607 | C2: 0.7736 | C3: 0.4571
Epoch 323/400 | Train Loss: 29.2206
 Avg Train Loss: 29.2206 | Seg Loss: 0.2922 | Recon Loss: 0.0050
  Val mIoU: 0.5128 (Best: 0.7653)
  [Class IoU]  C1: 0.2794 | C2: 0.7864 | C3: 0.4725
Epoch 324/400 | Train Loss: 29.7634
 Avg Train Loss: 29.7634 | Seg Loss: 0.2976 | Recon Loss: 0.0051
  Val mIoU: 0.4874 (Best: 0.7653)
  [Class IoU]  C1: 0.3021 | C2: 0.7370 | C3: 0.4231
Epoch 325/400 | Train Loss: 29.0366
 Avg Train Loss: 29.0366 | Seg Loss: 0.2903 | Recon Loss: 0.0052
  Val mIoU: 0.4666 (Best: 0.7653)
  [Class IoU]  C1: 0.2520 | C2: 0.7394 | C3: 0.4083
Epoch 326/400 | Train Loss: 29.2370
 Avg Train Loss: 29.2370 | Seg Loss: 0.2923 | Recon Loss: 0.0051
  Val mIoU: 0.4795 (Best: 0.7653)
  [Class IoU]  C1: 0.2597 | C2: 0.7504 | C3: 0.4285
Epoch 327/400 | Train Loss: 29.7026
 Avg Train Loss: 29.7026 | Seg Loss: 0.2970 | Recon Loss: 0.0051
  Val mIoU: 0.4946 (Best: 0.7653)
  [Class IoU]  C1: 0.2598 | C2: 0.7710 | C3: 0.4530
Epoch 328/400 | Train Loss: 30.0237
 Avg Train Loss: 30.0237 | Seg Loss: 0.3002 | Recon Loss: 0.0052
  Val mIoU: 0.4792 (Best: 0.7653)
  [Class IoU]  C1: 0.2535 | C2: 0.7491 | C3: 0.4351
Epoch 329/400 | Train Loss: 29.4617
 Avg Train Loss: 29.4617 | Seg Loss: 0.2946 | Recon Loss: 0.0050
  Val mIoU: 0.4813 (Best: 0.7653)
  [Class IoU]  C1: 0.2889 | C2: 0.7343 | C3: 0.4207
Epoch 330/400 | Train Loss: 28.9534
 Avg Train Loss: 28.9534 | Seg Loss: 0.2895 | Recon Loss: 0.0048
  Val mIoU: 0.5037 (Best: 0.7653)
  [Class IoU]  C1: 0.2691 | C2: 0.7713 | C3: 0.4707
Epoch 331/400 | Train Loss: 29.8124
 Avg Train Loss: 29.8124 | Seg Loss: 0.2981 | Recon Loss: 0.0051
  Val mIoU: 0.5143 (Best: 0.7653)
  [Class IoU]  C1: 0.3087 | C2: 0.7652 | C3: 0.4688
Epoch 332/400 | Train Loss: 29.2887
 Avg Train Loss: 29.2887 | Seg Loss: 0.2928 | Recon Loss: 0.0050
  Val mIoU: 0.5858 (Best: 0.7653)
  [Class IoU]  C1: 0.4105 | C2: 0.8104 | C3: 0.5364
Epoch 333/400 | Train Loss: 29.1109
 Avg Train Loss: 29.1109 | Seg Loss: 0.2911 | Recon Loss: 0.0050
  Val mIoU: 0.5053 (Best: 0.7653)
  [Class IoU]  C1: 0.3077 | C2: 0.7567 | C3: 0.4515
Epoch 334/400 | Train Loss: 29.8703
 Avg Train Loss: 29.8703 | Seg Loss: 0.2987 | Recon Loss: 0.0051
  Val mIoU: 0.4915 (Best: 0.7653)
  [Class IoU]  C1: 0.2537 | C2: 0.7722 | C3: 0.4485
Epoch 335/400 | Train Loss: 29.9502
 Avg Train Loss: 29.9502 | Seg Loss: 0.2995 | Recon Loss: 0.0049
  Val mIoU: 0.5524 (Best: 0.7653)
  [Class IoU]  C1: 0.3941 | C2: 0.7701 | C3: 0.4929
Epoch 336/400 | Train Loss: 29.8932
 Avg Train Loss: 29.8932 | Seg Loss: 0.2989 | Recon Loss: 0.0050
  Val mIoU: 0.4894 (Best: 0.7653)
  [Class IoU]  C1: 0.2763 | C2: 0.7521 | C3: 0.4398
Epoch 337/400 | Train Loss: 29.4331
 Avg Train Loss: 29.4331 | Seg Loss: 0.2943 | Recon Loss: 0.0052
  Val mIoU: 0.5129 (Best: 0.7653)
  [Class IoU]  C1: 0.2681 | C2: 0.7884 | C3: 0.4820
Epoch 338/400 | Train Loss: 28.9189
 Avg Train Loss: 28.9189 | Seg Loss: 0.2891 | Recon Loss: 0.0049
  Val mIoU: 0.4684 (Best: 0.7653)
  [Class IoU]  C1: 0.2786 | C2: 0.7282 | C3: 0.3985
Epoch 339/400 | Train Loss: 29.7931
 Avg Train Loss: 29.7931 | Seg Loss: 0.2979 | Recon Loss: 0.0051
  Val mIoU: 0.4729 (Best: 0.7653)
  [Class IoU]  C1: 0.2382 | C2: 0.7556 | C3: 0.4251
Epoch 340/400 | Train Loss: 29.3252
 Avg Train Loss: 29.3252 | Seg Loss: 0.2932 | Recon Loss: 0.0051
  Val mIoU: 0.5044 (Best: 0.7653)
  [Class IoU]  C1: 0.3176 | C2: 0.7532 | C3: 0.4423
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 29.4116
 Avg Train Loss: 29.4116 | Seg Loss: 0.2941 | Recon Loss: 0.0050
  Val mIoU: 0.4854 (Best: 0.7653)
  [Class IoU]  C1: 0.2629 | C2: 0.7603 | C3: 0.4331
Epoch 342/400 | Train Loss: 29.6298
 Avg Train Loss: 29.6298 | Seg Loss: 0.2962 | Recon Loss: 0.0049
  Val mIoU: 0.5100 (Best: 0.7653)
  [Class IoU]  C1: 0.2996 | C2: 0.7646 | C3: 0.4657
Epoch 343/400 | Train Loss: 30.1905
 Avg Train Loss: 30.1905 | Seg Loss: 0.3019 | Recon Loss: 0.0049
  Val mIoU: 0.4959 (Best: 0.7653)
  [Class IoU]  C1: 0.2900 | C2: 0.7527 | C3: 0.4449
Epoch 344/400 | Train Loss: 29.5297
 Avg Train Loss: 29.5297 | Seg Loss: 0.2952 | Recon Loss: 0.0051
  Val mIoU: 0.5229 (Best: 0.7653)
  [Class IoU]  C1: 0.3322 | C2: 0.7660 | C3: 0.4704
Epoch 345/400 | Train Loss: 29.0460
 Avg Train Loss: 29.0460 | Seg Loss: 0.2904 | Recon Loss: 0.0049
  Val mIoU: 0.4975 (Best: 0.7653)
  [Class IoU]  C1: 0.2976 | C2: 0.7524 | C3: 0.4423
Epoch 346/400 | Train Loss: 29.7261
 Avg Train Loss: 29.7261 | Seg Loss: 0.2972 | Recon Loss: 0.0050
  Val mIoU: 0.5105 (Best: 0.7653)
  [Class IoU]  C1: 0.2789 | C2: 0.7736 | C3: 0.4788
Epoch 347/400 | Train Loss: 28.7563
 Avg Train Loss: 28.7563 | Seg Loss: 0.2875 | Recon Loss: 0.0051
  Val mIoU: 0.4829 (Best: 0.7653)
  [Class IoU]  C1: 0.2670 | C2: 0.7548 | C3: 0.4268
Epoch 348/400 | Train Loss: 29.5493
 Avg Train Loss: 29.5493 | Seg Loss: 0.2954 | Recon Loss: 0.0050
  Val mIoU: 0.4620 (Best: 0.7653)
  [Class IoU]  C1: 0.2412 | C2: 0.7390 | C3: 0.4059
Epoch 349/400 | Train Loss: 29.8279
 Avg Train Loss: 29.8279 | Seg Loss: 0.2982 | Recon Loss: 0.0051
  Val mIoU: 0.5269 (Best: 0.7653)
  [Class IoU]  C1: 0.3610 | C2: 0.7655 | C3: 0.4541
Epoch 350/400 | Train Loss: 29.4596
 Avg Train Loss: 29.4596 | Seg Loss: 0.2945 | Recon Loss: 0.0049
  Val mIoU: 0.5518 (Best: 0.7653)
  [Class IoU]  C1: 0.3545 | C2: 0.7876 | C3: 0.5133
Epoch 351/400 | Train Loss: 29.0894
 Avg Train Loss: 29.0894 | Seg Loss: 0.2908 | Recon Loss: 0.0048
  Val mIoU: 0.4981 (Best: 0.7653)
  [Class IoU]  C1: 0.2910 | C2: 0.7550 | C3: 0.4483
Epoch 352/400 | Train Loss: 29.6448
 Avg Train Loss: 29.6448 | Seg Loss: 0.2964 | Recon Loss: 0.0050
  Val mIoU: 0.4488 (Best: 0.7653)
  [Class IoU]  C1: 0.2594 | C2: 0.7113 | C3: 0.3756
Epoch 353/400 | Train Loss: 29.2896
 Avg Train Loss: 29.2896 | Seg Loss: 0.2928 | Recon Loss: 0.0049
  Val mIoU: 0.4791 (Best: 0.7653)
  [Class IoU]  C1: 0.2623 | C2: 0.7508 | C3: 0.4240
Epoch 354/400 | Train Loss: 29.4845
 Avg Train Loss: 29.4845 | Seg Loss: 0.2948 | Recon Loss: 0.0049
  Val mIoU: 0.5845 (Best: 0.7653)
  [Class IoU]  C1: 0.4850 | C2: 0.7744 | C3: 0.4940
Epoch 355/400 | Train Loss: 29.6790
 Avg Train Loss: 29.6790 | Seg Loss: 0.2967 | Recon Loss: 0.0049
  Val mIoU: 0.4550 (Best: 0.7653)
  [Class IoU]  C1: 0.2577 | C2: 0.7234 | C3: 0.3839
Epoch 356/400 | Train Loss: 29.3349
 Avg Train Loss: 29.3349 | Seg Loss: 0.2933 | Recon Loss: 0.0051
  Val mIoU: 0.4602 (Best: 0.7653)
  [Class IoU]  C1: 0.2640 | C2: 0.7252 | C3: 0.3915
Epoch 357/400 | Train Loss: 29.3483
 Avg Train Loss: 29.3483 | Seg Loss: 0.2934 | Recon Loss: 0.0048
  Val mIoU: 0.5865 (Best: 0.7653)
  [Class IoU]  C1: 0.4076 | C2: 0.8062 | C3: 0.5459
Epoch 358/400 | Train Loss: 29.3092
 Avg Train Loss: 29.3092 | Seg Loss: 0.2930 | Recon Loss: 0.0048
  Val mIoU: 0.5250 (Best: 0.7653)
  [Class IoU]  C1: 0.2875 | C2: 0.7918 | C3: 0.4958
Epoch 359/400 | Train Loss: 29.3519
 Avg Train Loss: 29.3519 | Seg Loss: 0.2935 | Recon Loss: 0.0050
  Val mIoU: 0.4834 (Best: 0.7653)
  [Class IoU]  C1: 0.2741 | C2: 0.7452 | C3: 0.4310
Epoch 360/400 | Train Loss: 29.1753
 Avg Train Loss: 29.1753 | Seg Loss: 0.2917 | Recon Loss: 0.0050
  Val mIoU: 0.5002 (Best: 0.7653)
  [Class IoU]  C1: 0.2671 | C2: 0.7786 | C3: 0.4549
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 29.0267
 Avg Train Loss: 29.0267 | Seg Loss: 0.2902 | Recon Loss: 0.0049
  Val mIoU: 0.4747 (Best: 0.7653)
  [Class IoU]  C1: 0.2756 | C2: 0.7369 | C3: 0.4115
Epoch 362/400 | Train Loss: 29.8411
 Avg Train Loss: 29.8411 | Seg Loss: 0.2984 | Recon Loss: 0.0051
  Val mIoU: 0.4717 (Best: 0.7653)
  [Class IoU]  C1: 0.2595 | C2: 0.7444 | C3: 0.4113
Epoch 363/400 | Train Loss: 29.4654
 Avg Train Loss: 29.4654 | Seg Loss: 0.2946 | Recon Loss: 0.0049
  Val mIoU: 0.5202 (Best: 0.7653)
  [Class IoU]  C1: 0.3382 | C2: 0.7621 | C3: 0.4602
Epoch 364/400 | Train Loss: 28.9233
 Avg Train Loss: 28.9233 | Seg Loss: 0.2892 | Recon Loss: 0.0050
  Val mIoU: 0.4958 (Best: 0.7653)
  [Class IoU]  C1: 0.2872 | C2: 0.7590 | C3: 0.4411
Epoch 365/400 | Train Loss: 29.3763
 Avg Train Loss: 29.3763 | Seg Loss: 0.2937 | Recon Loss: 0.0049
  Val mIoU: 0.5537 (Best: 0.7653)
  [Class IoU]  C1: 0.3529 | C2: 0.7890 | C3: 0.5192
Epoch 366/400 | Train Loss: 29.9687
 Avg Train Loss: 29.9687 | Seg Loss: 0.2996 | Recon Loss: 0.0050
  Val mIoU: 0.5048 (Best: 0.7653)
  [Class IoU]  C1: 0.2951 | C2: 0.7598 | C3: 0.4597
Epoch 367/400 | Train Loss: 29.4371
 Avg Train Loss: 29.4371 | Seg Loss: 0.2943 | Recon Loss: 0.0048
  Val mIoU: 0.5919 (Best: 0.7653)
  [Class IoU]  C1: 0.4319 | C2: 0.7951 | C3: 0.5487
Epoch 368/400 | Train Loss: 29.2629
 Avg Train Loss: 29.2629 | Seg Loss: 0.2926 | Recon Loss: 0.0048
  Val mIoU: 0.5285 (Best: 0.7653)
  [Class IoU]  C1: 0.3127 | C2: 0.7751 | C3: 0.4978
Epoch 369/400 | Train Loss: 29.7513
 Avg Train Loss: 29.7513 | Seg Loss: 0.2975 | Recon Loss: 0.0050
  Val mIoU: 0.5226 (Best: 0.7653)
  [Class IoU]  C1: 0.2898 | C2: 0.7875 | C3: 0.4903
Epoch 370/400 | Train Loss: 29.3004
 Avg Train Loss: 29.3004 | Seg Loss: 0.2930 | Recon Loss: 0.0050
  Val mIoU: 0.4562 (Best: 0.7653)
  [Class IoU]  C1: 0.2574 | C2: 0.7226 | C3: 0.3886
Epoch 371/400 | Train Loss: 28.9174
 Avg Train Loss: 28.9174 | Seg Loss: 0.2891 | Recon Loss: 0.0050
  Val mIoU: 0.4893 (Best: 0.7653)
  [Class IoU]  C1: 0.2827 | C2: 0.7504 | C3: 0.4347
Epoch 372/400 | Train Loss: 29.4742
 Avg Train Loss: 29.4742 | Seg Loss: 0.2947 | Recon Loss: 0.0049
  Val mIoU: 0.5112 (Best: 0.7653)
  [Class IoU]  C1: 0.3215 | C2: 0.7547 | C3: 0.4574
Epoch 373/400 | Train Loss: 29.6370
 Avg Train Loss: 29.6370 | Seg Loss: 0.2963 | Recon Loss: 0.0051
  Val mIoU: 0.6019 (Best: 0.7653)
  [Class IoU]  C1: 0.5560 | C2: 0.7774 | C3: 0.4723
Epoch 374/400 | Train Loss: 29.5143
 Avg Train Loss: 29.5143 | Seg Loss: 0.2951 | Recon Loss: 0.0051
  Val mIoU: 0.4837 (Best: 0.7653)
  [Class IoU]  C1: 0.2517 | C2: 0.7600 | C3: 0.4395
Epoch 375/400 | Train Loss: 29.5610
 Avg Train Loss: 29.5610 | Seg Loss: 0.2956 | Recon Loss: 0.0052
  Val mIoU: 0.5128 (Best: 0.7653)
  [Class IoU]  C1: 0.2942 | C2: 0.7693 | C3: 0.4749
Epoch 376/400 | Train Loss: 29.7636
 Avg Train Loss: 29.7636 | Seg Loss: 0.2976 | Recon Loss: 0.0049
  Val mIoU: 0.5115 (Best: 0.7653)
  [Class IoU]  C1: 0.2874 | C2: 0.7736 | C3: 0.4735
Epoch 377/400 | Train Loss: 28.9270
 Avg Train Loss: 28.9270 | Seg Loss: 0.2892 | Recon Loss: 0.0050
  Val mIoU: 0.5383 (Best: 0.7653)
  [Class IoU]  C1: 0.3651 | C2: 0.7745 | C3: 0.4752
Epoch 378/400 | Train Loss: 29.8198
 Avg Train Loss: 29.8198 | Seg Loss: 0.2981 | Recon Loss: 0.0050
  Val mIoU: 0.5303 (Best: 0.7653)
  [Class IoU]  C1: 0.3418 | C2: 0.7732 | C3: 0.4758
Epoch 379/400 | Train Loss: 29.7774
 Avg Train Loss: 29.7774 | Seg Loss: 0.2977 | Recon Loss: 0.0049
  Val mIoU: 0.5042 (Best: 0.7653)
  [Class IoU]  C1: 0.2541 | C2: 0.7810 | C3: 0.4775
Epoch 380/400 | Train Loss: 28.9334
 Avg Train Loss: 28.9334 | Seg Loss: 0.2893 | Recon Loss: 0.0049
  Val mIoU: 0.5319 (Best: 0.7653)
  [Class IoU]  C1: 0.2942 | C2: 0.7922 | C3: 0.5093
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 29.4590
 Avg Train Loss: 29.4590 | Seg Loss: 0.2945 | Recon Loss: 0.0050
  Val mIoU: 0.5400 (Best: 0.7653)
  [Class IoU]  C1: 0.3463 | C2: 0.7805 | C3: 0.4931
Epoch 382/400 | Train Loss: 29.0652
 Avg Train Loss: 29.0652 | Seg Loss: 0.2906 | Recon Loss: 0.0049
  Val mIoU: 0.4894 (Best: 0.7653)
  [Class IoU]  C1: 0.2816 | C2: 0.7558 | C3: 0.4308
Epoch 383/400 | Train Loss: 29.4825
 Avg Train Loss: 29.4825 | Seg Loss: 0.2948 | Recon Loss: 0.0048
  Val mIoU: 0.5400 (Best: 0.7653)
  [Class IoU]  C1: 0.3046 | C2: 0.8008 | C3: 0.5146
Epoch 384/400 | Train Loss: 29.3329
 Avg Train Loss: 29.3329 | Seg Loss: 0.2933 | Recon Loss: 0.0050
  Val mIoU: 0.4595 (Best: 0.7653)
  [Class IoU]  C1: 0.2653 | C2: 0.7223 | C3: 0.3908
Epoch 385/400 | Train Loss: 29.7319
 Avg Train Loss: 29.7319 | Seg Loss: 0.2973 | Recon Loss: 0.0049
  Val mIoU: 0.5130 (Best: 0.7653)
  [Class IoU]  C1: 0.2764 | C2: 0.7902 | C3: 0.4723
Epoch 386/400 | Train Loss: 29.9175
 Avg Train Loss: 29.9175 | Seg Loss: 0.2991 | Recon Loss: 0.0050
  Val mIoU: 0.5126 (Best: 0.7653)
  [Class IoU]  C1: 0.2607 | C2: 0.7921 | C3: 0.4852
Epoch 387/400 | Train Loss: 29.4841
 Avg Train Loss: 29.4841 | Seg Loss: 0.2948 | Recon Loss: 0.0049
  Val mIoU: 0.4837 (Best: 0.7653)
  [Class IoU]  C1: 0.2710 | C2: 0.7523 | C3: 0.4277
Epoch 388/400 | Train Loss: 28.9559
 Avg Train Loss: 28.9559 | Seg Loss: 0.2895 | Recon Loss: 0.0050
  Val mIoU: 0.4821 (Best: 0.7653)
  [Class IoU]  C1: 0.2698 | C2: 0.7465 | C3: 0.4299
Epoch 389/400 | Train Loss: 29.9646
 Avg Train Loss: 29.9646 | Seg Loss: 0.2996 | Recon Loss: 0.0050
  Val mIoU: 0.5348 (Best: 0.7653)
  [Class IoU]  C1: 0.3571 | C2: 0.7661 | C3: 0.4814
Epoch 390/400 | Train Loss: 29.6544
 Avg Train Loss: 29.6544 | Seg Loss: 0.2965 | Recon Loss: 0.0051
  Val mIoU: 0.4936 (Best: 0.7653)
  [Class IoU]  C1: 0.2589 | C2: 0.7688 | C3: 0.4532
Epoch 391/400 | Train Loss: 29.4351
 Avg Train Loss: 29.4351 | Seg Loss: 0.2943 | Recon Loss: 0.0049
  Val mIoU: 0.5312 (Best: 0.7653)
  [Class IoU]  C1: 0.3278 | C2: 0.7728 | C3: 0.4929
Epoch 392/400 | Train Loss: 29.3939
 Avg Train Loss: 29.3939 | Seg Loss: 0.2939 | Recon Loss: 0.0051
  Val mIoU: 0.5279 (Best: 0.7653)
  [Class IoU]  C1: 0.3539 | C2: 0.7627 | C3: 0.4671
Epoch 393/400 | Train Loss: 29.9675
 Avg Train Loss: 29.9675 | Seg Loss: 0.2996 | Recon Loss: 0.0050
  Val mIoU: 0.5009 (Best: 0.7653)
  [Class IoU]  C1: 0.2846 | C2: 0.7613 | C3: 0.4569
Epoch 394/400 | Train Loss: 29.6306
 Avg Train Loss: 29.6306 | Seg Loss: 0.2963 | Recon Loss: 0.0049
  Val mIoU: 0.5150 (Best: 0.7653)
  [Class IoU]  C1: 0.3039 | C2: 0.7706 | C3: 0.4703
Epoch 395/400 | Train Loss: 29.1483
 Avg Train Loss: 29.1483 | Seg Loss: 0.2914 | Recon Loss: 0.0050
  Val mIoU: 0.5677 (Best: 0.7653)
  [Class IoU]  C1: 0.4772 | C2: 0.7635 | C3: 0.4625
Epoch 396/400 | Train Loss: 29.6668
 Avg Train Loss: 29.6668 | Seg Loss: 0.2966 | Recon Loss: 0.0051
  Val mIoU: 0.5035 (Best: 0.7653)
  [Class IoU]  C1: 0.2556 | C2: 0.7811 | C3: 0.4738
Epoch 397/400 | Train Loss: 29.4840
 Avg Train Loss: 29.4840 | Seg Loss: 0.2948 | Recon Loss: 0.0051
  Val mIoU: 0.4370 (Best: 0.7653)
  [Class IoU]  C1: 0.2567 | C2: 0.6959 | C3: 0.3586
Epoch 398/400 | Train Loss: 29.5728
 Avg Train Loss: 29.5728 | Seg Loss: 0.2957 | Recon Loss: 0.0051
  Val mIoU: 0.4892 (Best: 0.7653)
  [Class IoU]  C1: 0.2871 | C2: 0.7537 | C3: 0.4270
Epoch 399/400 | Train Loss: 29.6964
 Avg Train Loss: 29.6964 | Seg Loss: 0.2969 | Recon Loss: 0.0049
  Val mIoU: 0.5655 (Best: 0.7653)
  [Class IoU]  C1: 0.3773 | C2: 0.7895 | C3: 0.5296
Epoch 400/400 | Train Loss: 29.8515
 Avg Train Loss: 29.8515 | Seg Loss: 0.2985 | Recon Loss: 0.0050
  Val mIoU: 0.4843 (Best: 0.7653)
  [Class IoU]  C1: 0.2778 | C2: 0.7533 | C3: 0.4217
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights...
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27221807: <AG_job> in cluster <dcc> Done

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Sun Nov 30 21:23:16 2025
Job was executed on host(s) <8*n-62-12-22>, in queue <gpua100>, as user <s214776> in cluster <dcc> at Mon Dec  1 02:25:53 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Mon Dec  1 02:25:53 2025
Terminated at Mon Dec  1 07:03:19 2025
Results reported at Mon Dec  1 07:03:19 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpua100           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   48927.00 sec.
    Max Memory :                                 2527 MB
    Average Memory :                             1998.10 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               521761.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                55
    Run time :                                   16646 sec.
    Turnaround time :                            34803 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27221807.err> for stderr output of this job.

