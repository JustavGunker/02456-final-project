Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 4.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/400 | Train Loss: 63.1255
 Avg Train Loss: 63.1255 | Seg Loss: 0.6311 | Recon Loss: 0.0182
  Val mIoU: 0.5041 (Best: 0.0000)
  [Class IoU]  C1: 0.8126 | C2: 0.6289 | C3: 0.0709
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 53.5397
 Avg Train Loss: 53.5397 | Seg Loss: 0.5353 | Recon Loss: 0.0114
  Val mIoU: 0.4177 (Best: 0.5041)
  [Class IoU]  C1: 0.6418 | C2: 0.4976 | C3: 0.1137
Epoch 3/400 | Train Loss: 50.2757
 Avg Train Loss: 50.2757 | Seg Loss: 0.5027 | Recon Loss: 0.0094
  Val mIoU: 0.3236 (Best: 0.5041)
  [Class IoU]  C1: 0.6712 | C2: 0.2128 | C3: 0.0869
Epoch 4/400 | Train Loss: 48.8865
 Avg Train Loss: 48.8865 | Seg Loss: 0.4888 | Recon Loss: 0.0084
  Val mIoU: 0.3316 (Best: 0.5041)
  [Class IoU]  C1: 0.4399 | C2: 0.4169 | C3: 0.1380
Epoch 5/400 | Train Loss: 47.2170
 Avg Train Loss: 47.2170 | Seg Loss: 0.4721 | Recon Loss: 0.0075
  Val mIoU: 0.3439 (Best: 0.5041)
  [Class IoU]  C1: 0.3176 | C2: 0.6240 | C3: 0.0902
Epoch 6/400 | Train Loss: 46.2601
 Avg Train Loss: 46.2601 | Seg Loss: 0.4625 | Recon Loss: 0.0072
  Val mIoU: 0.5466 (Best: 0.5041)
  [Class IoU]  C1: 0.7311 | C2: 0.6917 | C3: 0.2170
  --> New Best Model Saved!
Epoch 7/400 | Train Loss: 45.3126
 Avg Train Loss: 45.3126 | Seg Loss: 0.4531 | Recon Loss: 0.0070
  Val mIoU: 0.3616 (Best: 0.5466)
  [Class IoU]  C1: 0.2070 | C2: 0.6807 | C3: 0.1969
Epoch 8/400 | Train Loss: 43.5172
 Avg Train Loss: 43.5172 | Seg Loss: 0.4351 | Recon Loss: 0.0069
  Val mIoU: 0.3923 (Best: 0.5466)
  [Class IoU]  C1: 0.2299 | C2: 0.7656 | C3: 0.1815
Epoch 9/400 | Train Loss: 43.3415
 Avg Train Loss: 43.3415 | Seg Loss: 0.4334 | Recon Loss: 0.0064
  Val mIoU: 0.3163 (Best: 0.5466)
  [Class IoU]  C1: 0.1639 | C2: 0.5644 | C3: 0.2205
Epoch 10/400 | Train Loss: 42.4146
 Avg Train Loss: 42.4146 | Seg Loss: 0.4241 | Recon Loss: 0.0066
  Val mIoU: 0.3352 (Best: 0.5466)
  [Class IoU]  C1: 0.1786 | C2: 0.7217 | C3: 0.1052
Epoch 11/400 | Train Loss: 41.3327
 Avg Train Loss: 41.3327 | Seg Loss: 0.4133 | Recon Loss: 0.0063
  Val mIoU: 0.4232 (Best: 0.5466)
  [Class IoU]  C1: 0.1724 | C2: 0.7388 | C3: 0.3584
Epoch 12/400 | Train Loss: 40.8529
 Avg Train Loss: 40.8529 | Seg Loss: 0.4085 | Recon Loss: 0.0062
  Val mIoU: 0.4157 (Best: 0.5466)
  [Class IoU]  C1: 0.2410 | C2: 0.7691 | C3: 0.2370
Epoch 13/400 | Train Loss: 39.6260
 Avg Train Loss: 39.6260 | Seg Loss: 0.3962 | Recon Loss: 0.0058
  Val mIoU: 0.4454 (Best: 0.5466)
  [Class IoU]  C1: 0.2382 | C2: 0.7781 | C3: 0.3198
Epoch 14/400 | Train Loss: 39.8477
 Avg Train Loss: 39.8477 | Seg Loss: 0.3984 | Recon Loss: 0.0060
  Val mIoU: 0.4012 (Best: 0.5466)
  [Class IoU]  C1: 0.1397 | C2: 0.5922 | C3: 0.4715
Epoch 15/400 | Train Loss: 38.9890
 Avg Train Loss: 38.9890 | Seg Loss: 0.3898 | Recon Loss: 0.0058
  Val mIoU: 0.3393 (Best: 0.5466)
  [Class IoU]  C1: 0.1864 | C2: 0.7292 | C3: 0.1022
Epoch 16/400 | Train Loss: 38.7783
 Avg Train Loss: 38.7783 | Seg Loss: 0.3877 | Recon Loss: 0.0056
  Val mIoU: 0.4582 (Best: 0.5466)
  [Class IoU]  C1: 0.2435 | C2: 0.7731 | C3: 0.3581
Epoch 17/400 | Train Loss: 37.7187
 Avg Train Loss: 37.7187 | Seg Loss: 0.3771 | Recon Loss: 0.0057
  Val mIoU: 0.4966 (Best: 0.5466)
  [Class IoU]  C1: 0.1875 | C2: 0.7835 | C3: 0.5190
Epoch 18/400 | Train Loss: 38.0958
 Avg Train Loss: 38.0958 | Seg Loss: 0.3809 | Recon Loss: 0.0055
  Val mIoU: 0.4831 (Best: 0.5466)
  [Class IoU]  C1: 0.2994 | C2: 0.8017 | C3: 0.3482
Epoch 19/400 | Train Loss: 38.0510
 Avg Train Loss: 38.0510 | Seg Loss: 0.3805 | Recon Loss: 0.0055
  Val mIoU: 0.5363 (Best: 0.5466)
  [Class IoU]  C1: 0.1913 | C2: 0.8179 | C3: 0.5998
Epoch 20/400 | Train Loss: 37.5025
 Avg Train Loss: 37.5025 | Seg Loss: 0.3750 | Recon Loss: 0.0056
  Val mIoU: 0.4689 (Best: 0.5466)
  [Class IoU]  C1: 0.1925 | C2: 0.7797 | C3: 0.4345
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 36.4166
 Avg Train Loss: 36.4166 | Seg Loss: 0.3641 | Recon Loss: 0.0056
  Val mIoU: 0.4992 (Best: 0.5466)
  [Class IoU]  C1: 0.2153 | C2: 0.8124 | C3: 0.4700
Epoch 22/400 | Train Loss: 36.4155
 Avg Train Loss: 36.4155 | Seg Loss: 0.3641 | Recon Loss: 0.0055
  Val mIoU: 0.4768 (Best: 0.5466)
  [Class IoU]  C1: 0.1942 | C2: 0.7822 | C3: 0.4542
Epoch 23/400 | Train Loss: 35.6265
 Avg Train Loss: 35.6265 | Seg Loss: 0.3562 | Recon Loss: 0.0055
  Val mIoU: 0.4008 (Best: 0.5466)
  [Class IoU]  C1: 0.1946 | C2: 0.7711 | C3: 0.2365
Epoch 24/400 | Train Loss: 36.4419
 Avg Train Loss: 36.4419 | Seg Loss: 0.3644 | Recon Loss: 0.0054
  Val mIoU: 0.3897 (Best: 0.5466)
  [Class IoU]  C1: 0.1755 | C2: 0.7434 | C3: 0.2503
Epoch 25/400 | Train Loss: 35.6662
 Avg Train Loss: 35.6662 | Seg Loss: 0.3566 | Recon Loss: 0.0054
  Val mIoU: 0.5355 (Best: 0.5466)
  [Class IoU]  C1: 0.1789 | C2: 0.7980 | C3: 0.6295
Epoch 26/400 | Train Loss: 35.5486
 Avg Train Loss: 35.5486 | Seg Loss: 0.3554 | Recon Loss: 0.0052
  Val mIoU: 0.4530 (Best: 0.5466)
  [Class IoU]  C1: 0.1975 | C2: 0.7891 | C3: 0.3725
Epoch 27/400 | Train Loss: 36.0276
 Avg Train Loss: 36.0276 | Seg Loss: 0.3602 | Recon Loss: 0.0052
  Val mIoU: 0.5077 (Best: 0.5466)
  [Class IoU]  C1: 0.2136 | C2: 0.8161 | C3: 0.4934
Epoch 28/400 | Train Loss: 35.3173
 Avg Train Loss: 35.3173 | Seg Loss: 0.3531 | Recon Loss: 0.0051
  Val mIoU: 0.4989 (Best: 0.5466)
  [Class IoU]  C1: 0.1930 | C2: 0.8030 | C3: 0.5008
Epoch 29/400 | Train Loss: 35.2139
 Avg Train Loss: 35.2139 | Seg Loss: 0.3521 | Recon Loss: 0.0053
  Val mIoU: 0.5250 (Best: 0.5466)
  [Class IoU]  C1: 0.2063 | C2: 0.8252 | C3: 0.5435
Epoch 30/400 | Train Loss: 34.5552
 Avg Train Loss: 34.5552 | Seg Loss: 0.3455 | Recon Loss: 0.0052
  Val mIoU: 0.4923 (Best: 0.5466)
  [Class IoU]  C1: 0.1966 | C2: 0.8076 | C3: 0.4727
Epoch 31/400 | Train Loss: 34.4274
 Avg Train Loss: 34.4274 | Seg Loss: 0.3442 | Recon Loss: 0.0051
  Val mIoU: 0.4885 (Best: 0.5466)
  [Class IoU]  C1: 0.1480 | C2: 0.6766 | C3: 0.6409
Epoch 32/400 | Train Loss: 34.0213
 Avg Train Loss: 34.0213 | Seg Loss: 0.3402 | Recon Loss: 0.0050
  Val mIoU: 0.5041 (Best: 0.5466)
  [Class IoU]  C1: 0.1712 | C2: 0.7639 | C3: 0.5774
Epoch 33/400 | Train Loss: 34.3290
 Avg Train Loss: 34.3290 | Seg Loss: 0.3432 | Recon Loss: 0.0050
  Val mIoU: 0.4785 (Best: 0.5466)
  [Class IoU]  C1: 0.1977 | C2: 0.8064 | C3: 0.4314
Epoch 34/400 | Train Loss: 34.1070
 Avg Train Loss: 34.1070 | Seg Loss: 0.3410 | Recon Loss: 0.0050
  Val mIoU: 0.4772 (Best: 0.5466)
  [Class IoU]  C1: 0.1867 | C2: 0.7901 | C3: 0.4548
Epoch 35/400 | Train Loss: 34.4663
 Avg Train Loss: 34.4663 | Seg Loss: 0.3446 | Recon Loss: 0.0050
  Val mIoU: 0.4438 (Best: 0.5466)
  [Class IoU]  C1: 0.1702 | C2: 0.7513 | C3: 0.4098
Epoch 36/400 | Train Loss: 34.2990
 Avg Train Loss: 34.2990 | Seg Loss: 0.3429 | Recon Loss: 0.0049
  Val mIoU: 0.4492 (Best: 0.5466)
  [Class IoU]  C1: 0.1653 | C2: 0.7363 | C3: 0.4462
Epoch 37/400 | Train Loss: 34.6526
 Avg Train Loss: 34.6526 | Seg Loss: 0.3465 | Recon Loss: 0.0051
  Val mIoU: 0.4536 (Best: 0.5466)
  [Class IoU]  C1: 0.1819 | C2: 0.7738 | C3: 0.4051
Epoch 38/400 | Train Loss: 33.1942
 Avg Train Loss: 33.1942 | Seg Loss: 0.3319 | Recon Loss: 0.0050
  Val mIoU: 0.5554 (Best: 0.5466)
  [Class IoU]  C1: 0.2033 | C2: 0.8318 | C3: 0.6312
  --> New Best Model Saved!
Epoch 39/400 | Train Loss: 33.9040
 Avg Train Loss: 33.9040 | Seg Loss: 0.3390 | Recon Loss: 0.0051
  Val mIoU: 0.5331 (Best: 0.5554)
  [Class IoU]  C1: 0.2033 | C2: 0.8280 | C3: 0.5681
Epoch 40/400 | Train Loss: 33.5942
 Avg Train Loss: 33.5942 | Seg Loss: 0.3359 | Recon Loss: 0.0050
  Val mIoU: 0.5559 (Best: 0.5554)
  [Class IoU]  C1: 0.2128 | C2: 0.8301 | C3: 0.6247
  --> New Best Model Saved!
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 33.6649
 Avg Train Loss: 33.6649 | Seg Loss: 0.3366 | Recon Loss: 0.0050
  Val mIoU: 0.5426 (Best: 0.5559)
  [Class IoU]  C1: 0.2150 | C2: 0.8260 | C3: 0.5870
Epoch 42/400 | Train Loss: 34.0697
 Avg Train Loss: 34.0697 | Seg Loss: 0.3406 | Recon Loss: 0.0048
  Val mIoU: 0.5623 (Best: 0.5559)
  [Class IoU]  C1: 0.2141 | C2: 0.8327 | C3: 0.6402
  --> New Best Model Saved!
Epoch 43/400 | Train Loss: 34.2712
 Avg Train Loss: 34.2712 | Seg Loss: 0.3427 | Recon Loss: 0.0048
  Val mIoU: 0.5013 (Best: 0.5623)
  [Class IoU]  C1: 0.1607 | C2: 0.7200 | C3: 0.6232
Epoch 44/400 | Train Loss: 32.9344
 Avg Train Loss: 32.9344 | Seg Loss: 0.3293 | Recon Loss: 0.0048
  Val mIoU: 0.5565 (Best: 0.5623)
  [Class IoU]  C1: 0.1975 | C2: 0.8289 | C3: 0.6430
Epoch 45/400 | Train Loss: 33.2477
 Avg Train Loss: 33.2477 | Seg Loss: 0.3324 | Recon Loss: 0.0049
  Val mIoU: 0.5591 (Best: 0.5623)
  [Class IoU]  C1: 0.2160 | C2: 0.8251 | C3: 0.6363
Epoch 46/400 | Train Loss: 33.6074
 Avg Train Loss: 33.6074 | Seg Loss: 0.3360 | Recon Loss: 0.0049
  Val mIoU: 0.5578 (Best: 0.5623)
  [Class IoU]  C1: 0.1994 | C2: 0.8302 | C3: 0.6440
Epoch 47/400 | Train Loss: 32.4663
 Avg Train Loss: 32.4663 | Seg Loss: 0.3246 | Recon Loss: 0.0049
  Val mIoU: 0.4518 (Best: 0.5623)
  [Class IoU]  C1: 0.1577 | C2: 0.6887 | C3: 0.5090
Epoch 48/400 | Train Loss: 32.8568
 Avg Train Loss: 32.8568 | Seg Loss: 0.3285 | Recon Loss: 0.0048
  Val mIoU: 0.4764 (Best: 0.5623)
  [Class IoU]  C1: 0.1796 | C2: 0.7806 | C3: 0.4689
Epoch 49/400 | Train Loss: 32.7866
 Avg Train Loss: 32.7866 | Seg Loss: 0.3278 | Recon Loss: 0.0050
  Val mIoU: 0.4623 (Best: 0.5623)
  [Class IoU]  C1: 0.2168 | C2: 0.8042 | C3: 0.3659
Epoch 50/400 | Train Loss: 32.7389
 Avg Train Loss: 32.7389 | Seg Loss: 0.3273 | Recon Loss: 0.0047
  Val mIoU: 0.5460 (Best: 0.5623)
  [Class IoU]  C1: 0.1836 | C2: 0.8106 | C3: 0.6439
Epoch 51/400 | Train Loss: 33.1773
 Avg Train Loss: 33.1773 | Seg Loss: 0.3317 | Recon Loss: 0.0047
  Val mIoU: 0.5612 (Best: 0.5623)
  [Class IoU]  C1: 0.2033 | C2: 0.8291 | C3: 0.6511
Epoch 52/400 | Train Loss: 32.6327
 Avg Train Loss: 32.6327 | Seg Loss: 0.3263 | Recon Loss: 0.0048
  Val mIoU: 0.5330 (Best: 0.5623)
  [Class IoU]  C1: 0.1988 | C2: 0.8170 | C3: 0.5830
Epoch 53/400 | Train Loss: 32.1682
 Avg Train Loss: 32.1682 | Seg Loss: 0.3216 | Recon Loss: 0.0048
  Val mIoU: 0.5312 (Best: 0.5623)
  [Class IoU]  C1: 0.1945 | C2: 0.8024 | C3: 0.5966
Epoch 54/400 | Train Loss: 32.6678
 Avg Train Loss: 32.6678 | Seg Loss: 0.3266 | Recon Loss: 0.0047
  Val mIoU: 0.5647 (Best: 0.5623)
  [Class IoU]  C1: 0.1984 | C2: 0.8343 | C3: 0.6614
  --> New Best Model Saved!
Epoch 55/400 | Train Loss: 32.2040
 Avg Train Loss: 32.2040 | Seg Loss: 0.3220 | Recon Loss: 0.0049
  Val mIoU: 0.5630 (Best: 0.5647)
  [Class IoU]  C1: 0.2268 | C2: 0.8241 | C3: 0.6382
Epoch 56/400 | Train Loss: 32.8528
 Avg Train Loss: 32.8528 | Seg Loss: 0.3285 | Recon Loss: 0.0048
  Val mIoU: 0.5755 (Best: 0.5647)
  [Class IoU]  C1: 0.2288 | C2: 0.8393 | C3: 0.6583
  --> New Best Model Saved!
Epoch 57/400 | Train Loss: 33.2572
 Avg Train Loss: 33.2572 | Seg Loss: 0.3325 | Recon Loss: 0.0048
  Val mIoU: 0.5578 (Best: 0.5755)
  [Class IoU]  C1: 0.2089 | C2: 0.8328 | C3: 0.6318
Epoch 58/400 | Train Loss: 32.2912
 Avg Train Loss: 32.2912 | Seg Loss: 0.3229 | Recon Loss: 0.0048
  Val mIoU: 0.4723 (Best: 0.5755)
  [Class IoU]  C1: 0.1856 | C2: 0.7943 | C3: 0.4369
Epoch 59/400 | Train Loss: 31.9053
 Avg Train Loss: 31.9053 | Seg Loss: 0.3190 | Recon Loss: 0.0049
  Val mIoU: 0.5744 (Best: 0.5755)
  [Class IoU]  C1: 0.2148 | C2: 0.8417 | C3: 0.6668
Epoch 60/400 | Train Loss: 32.0177
 Avg Train Loss: 32.0177 | Seg Loss: 0.3201 | Recon Loss: 0.0048
  Val mIoU: 0.5724 (Best: 0.5755)
  [Class IoU]  C1: 0.2188 | C2: 0.8402 | C3: 0.6583
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 31.8249
 Avg Train Loss: 31.8249 | Seg Loss: 0.3182 | Recon Loss: 0.0049
  Val mIoU: 0.5236 (Best: 0.5755)
  [Class IoU]  C1: 0.1964 | C2: 0.8157 | C3: 0.5587
Epoch 62/400 | Train Loss: 32.1116
 Avg Train Loss: 32.1116 | Seg Loss: 0.3211 | Recon Loss: 0.0047
  Val mIoU: 0.4975 (Best: 0.5755)
  [Class IoU]  C1: 0.1701 | C2: 0.7604 | C3: 0.5618
Epoch 63/400 | Train Loss: 31.7473
 Avg Train Loss: 31.7473 | Seg Loss: 0.3174 | Recon Loss: 0.0050
  Val mIoU: 0.5814 (Best: 0.5755)
  [Class IoU]  C1: 0.2308 | C2: 0.8406 | C3: 0.6730
  --> New Best Model Saved!
Epoch 64/400 | Train Loss: 32.6276
 Avg Train Loss: 32.6276 | Seg Loss: 0.3262 | Recon Loss: 0.0048
  Val mIoU: 0.5229 (Best: 0.5814)
  [Class IoU]  C1: 0.1826 | C2: 0.7894 | C3: 0.5967
Epoch 65/400 | Train Loss: 31.8890
 Avg Train Loss: 31.8890 | Seg Loss: 0.3188 | Recon Loss: 0.0047
  Val mIoU: 0.4160 (Best: 0.5814)
  [Class IoU]  C1: 0.1401 | C2: 0.6259 | C3: 0.4821
Epoch 66/400 | Train Loss: 32.0128
 Avg Train Loss: 32.0128 | Seg Loss: 0.3201 | Recon Loss: 0.0048
  Val mIoU: 0.5437 (Best: 0.5814)
  [Class IoU]  C1: 0.1983 | C2: 0.8161 | C3: 0.6166
Epoch 67/400 | Train Loss: 31.7931
 Avg Train Loss: 31.7931 | Seg Loss: 0.3179 | Recon Loss: 0.0048
  Val mIoU: 0.4414 (Best: 0.5814)
  [Class IoU]  C1: 0.1576 | C2: 0.7040 | C3: 0.4625
Epoch 68/400 | Train Loss: 31.8216
 Avg Train Loss: 31.8216 | Seg Loss: 0.3182 | Recon Loss: 0.0047
  Val mIoU: 0.4868 (Best: 0.5814)
  [Class IoU]  C1: 0.1581 | C2: 0.7163 | C3: 0.5859
Epoch 69/400 | Train Loss: 31.7447
 Avg Train Loss: 31.7447 | Seg Loss: 0.3174 | Recon Loss: 0.0048
  Val mIoU: 0.5013 (Best: 0.5814)
  [Class IoU]  C1: 0.1695 | C2: 0.7603 | C3: 0.5740
Epoch 70/400 | Train Loss: 32.1838
 Avg Train Loss: 32.1838 | Seg Loss: 0.3218 | Recon Loss: 0.0047
  Val mIoU: 0.5257 (Best: 0.5814)
  [Class IoU]  C1: 0.2018 | C2: 0.8152 | C3: 0.5601
Epoch 71/400 | Train Loss: 31.2784
 Avg Train Loss: 31.2784 | Seg Loss: 0.3127 | Recon Loss: 0.0046
  Val mIoU: 0.4641 (Best: 0.5814)
  [Class IoU]  C1: 0.1735 | C2: 0.7468 | C3: 0.4720
Epoch 72/400 | Train Loss: 30.9213
 Avg Train Loss: 30.9213 | Seg Loss: 0.3092 | Recon Loss: 0.0046
  Val mIoU: 0.5234 (Best: 0.5814)
  [Class IoU]  C1: 0.1798 | C2: 0.7902 | C3: 0.6003
Epoch 73/400 | Train Loss: 31.4124
 Avg Train Loss: 31.4124 | Seg Loss: 0.3141 | Recon Loss: 0.0048
  Val mIoU: 0.5637 (Best: 0.5814)
  [Class IoU]  C1: 0.2017 | C2: 0.8349 | C3: 0.6544
Epoch 74/400 | Train Loss: 30.6584
 Avg Train Loss: 30.6584 | Seg Loss: 0.3065 | Recon Loss: 0.0048
  Val mIoU: 0.5292 (Best: 0.5814)
  [Class IoU]  C1: 0.1927 | C2: 0.8054 | C3: 0.5897
Epoch 75/400 | Train Loss: 31.8557
 Avg Train Loss: 31.8557 | Seg Loss: 0.3185 | Recon Loss: 0.0047
  Val mIoU: 0.5018 (Best: 0.5814)
  [Class IoU]  C1: 0.2111 | C2: 0.7877 | C3: 0.5065
Epoch 76/400 | Train Loss: 30.9294
 Avg Train Loss: 30.9294 | Seg Loss: 0.3092 | Recon Loss: 0.0046
  Val mIoU: 0.4801 (Best: 0.5814)
  [Class IoU]  C1: 0.2029 | C2: 0.7638 | C3: 0.4736
Epoch 77/400 | Train Loss: 31.1084
 Avg Train Loss: 31.1084 | Seg Loss: 0.3110 | Recon Loss: 0.0047
  Val mIoU: 0.5053 (Best: 0.5814)
  [Class IoU]  C1: 0.1935 | C2: 0.7870 | C3: 0.5355
Epoch 78/400 | Train Loss: 31.1766
 Avg Train Loss: 31.1766 | Seg Loss: 0.3117 | Recon Loss: 0.0048
  Val mIoU: 0.5376 (Best: 0.5814)
  [Class IoU]  C1: 0.1793 | C2: 0.7989 | C3: 0.6346
Epoch 79/400 | Train Loss: 30.3590
 Avg Train Loss: 30.3590 | Seg Loss: 0.3035 | Recon Loss: 0.0047
  Val mIoU: 0.5485 (Best: 0.5814)
  [Class IoU]  C1: 0.1976 | C2: 0.8298 | C3: 0.6181
Epoch 80/400 | Train Loss: 31.2318
 Avg Train Loss: 31.2318 | Seg Loss: 0.3123 | Recon Loss: 0.0048
  Val mIoU: 0.5629 (Best: 0.5814)
  [Class IoU]  C1: 0.2047 | C2: 0.8322 | C3: 0.6518
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 31.4011
 Avg Train Loss: 31.4011 | Seg Loss: 0.3140 | Recon Loss: 0.0047
  Val mIoU: 0.5728 (Best: 0.5814)
  [Class IoU]  C1: 0.2496 | C2: 0.8410 | C3: 0.6277
Epoch 82/400 | Train Loss: 30.8612
 Avg Train Loss: 30.8612 | Seg Loss: 0.3086 | Recon Loss: 0.0047
  Val mIoU: 0.5578 (Best: 0.5814)
  [Class IoU]  C1: 0.1956 | C2: 0.8314 | C3: 0.6464
Epoch 83/400 | Train Loss: 30.1819
 Avg Train Loss: 30.1819 | Seg Loss: 0.3018 | Recon Loss: 0.0047
  Val mIoU: 0.5531 (Best: 0.5814)
  [Class IoU]  C1: 0.1987 | C2: 0.8331 | C3: 0.6276
Epoch 84/400 | Train Loss: 31.5730
 Avg Train Loss: 31.5730 | Seg Loss: 0.3157 | Recon Loss: 0.0047
  Val mIoU: 0.5444 (Best: 0.5814)
  [Class IoU]  C1: 0.2257 | C2: 0.8204 | C3: 0.5871
Epoch 85/400 | Train Loss: 30.5780
 Avg Train Loss: 30.5780 | Seg Loss: 0.3057 | Recon Loss: 0.0047
  Val mIoU: 0.5303 (Best: 0.5814)
  [Class IoU]  C1: 0.2381 | C2: 0.8040 | C3: 0.5490
Epoch 86/400 | Train Loss: 31.2534
 Avg Train Loss: 31.2534 | Seg Loss: 0.3125 | Recon Loss: 0.0047
  Val mIoU: 0.5270 (Best: 0.5814)
  [Class IoU]  C1: 0.2570 | C2: 0.7905 | C3: 0.5335
Epoch 87/400 | Train Loss: 30.5346
 Avg Train Loss: 30.5346 | Seg Loss: 0.3053 | Recon Loss: 0.0047
  Val mIoU: 0.5395 (Best: 0.5814)
  [Class IoU]  C1: 0.2135 | C2: 0.8204 | C3: 0.5846
Epoch 88/400 | Train Loss: 31.1814
 Avg Train Loss: 31.1814 | Seg Loss: 0.3118 | Recon Loss: 0.0046
  Val mIoU: 0.5060 (Best: 0.5814)
  [Class IoU]  C1: 0.1616 | C2: 0.7301 | C3: 0.6263
Epoch 89/400 | Train Loss: 30.2528
 Avg Train Loss: 30.2528 | Seg Loss: 0.3025 | Recon Loss: 0.0046
  Val mIoU: 0.5635 (Best: 0.5814)
  [Class IoU]  C1: 0.1985 | C2: 0.8304 | C3: 0.6616
Epoch 90/400 | Train Loss: 30.4209
 Avg Train Loss: 30.4209 | Seg Loss: 0.3042 | Recon Loss: 0.0046
  Val mIoU: 0.5502 (Best: 0.5814)
  [Class IoU]  C1: 0.1883 | C2: 0.8187 | C3: 0.6435
Epoch 91/400 | Train Loss: 30.6437
 Avg Train Loss: 30.6437 | Seg Loss: 0.3064 | Recon Loss: 0.0044
  Val mIoU: 0.5574 (Best: 0.5814)
  [Class IoU]  C1: 0.1918 | C2: 0.8201 | C3: 0.6602
Epoch 92/400 | Train Loss: 30.4720
 Avg Train Loss: 30.4720 | Seg Loss: 0.3047 | Recon Loss: 0.0046
  Val mIoU: 0.5797 (Best: 0.5814)
  [Class IoU]  C1: 0.2190 | C2: 0.8462 | C3: 0.6739
Epoch 93/400 | Train Loss: 30.3000
 Avg Train Loss: 30.3000 | Seg Loss: 0.3030 | Recon Loss: 0.0045
  Val mIoU: 0.5498 (Best: 0.5814)
  [Class IoU]  C1: 0.2177 | C2: 0.8256 | C3: 0.6060
Epoch 94/400 | Train Loss: 30.5743
 Avg Train Loss: 30.5743 | Seg Loss: 0.3057 | Recon Loss: 0.0046
  Val mIoU: 0.5720 (Best: 0.5814)
  [Class IoU]  C1: 0.2117 | C2: 0.8418 | C3: 0.6626
Epoch 95/400 | Train Loss: 30.4834
 Avg Train Loss: 30.4834 | Seg Loss: 0.3048 | Recon Loss: 0.0044
  Val mIoU: 0.5466 (Best: 0.5814)
  [Class IoU]  C1: 0.2579 | C2: 0.8030 | C3: 0.5789
Epoch 96/400 | Train Loss: 30.5267
 Avg Train Loss: 30.5267 | Seg Loss: 0.3052 | Recon Loss: 0.0047
  Val mIoU: 0.5612 (Best: 0.5814)
  [Class IoU]  C1: 0.2100 | C2: 0.8323 | C3: 0.6415
Epoch 97/400 | Train Loss: 30.9014
 Avg Train Loss: 30.9014 | Seg Loss: 0.3090 | Recon Loss: 0.0046
  Val mIoU: 0.5754 (Best: 0.5814)
  [Class IoU]  C1: 0.1985 | C2: 0.8423 | C3: 0.6852
Epoch 98/400 | Train Loss: 30.2134
 Avg Train Loss: 30.2134 | Seg Loss: 0.3021 | Recon Loss: 0.0044
  Val mIoU: 0.5611 (Best: 0.5814)
  [Class IoU]  C1: 0.2261 | C2: 0.8324 | C3: 0.6246
Epoch 99/400 | Train Loss: 29.6753
 Avg Train Loss: 29.6753 | Seg Loss: 0.2967 | Recon Loss: 0.0047
  Val mIoU: 0.5283 (Best: 0.5814)
  [Class IoU]  C1: 0.2027 | C2: 0.8133 | C3: 0.5688
Epoch 100/400 | Train Loss: 29.8478
 Avg Train Loss: 29.8478 | Seg Loss: 0.2984 | Recon Loss: 0.0046
  Val mIoU: 0.5621 (Best: 0.5814)
  [Class IoU]  C1: 0.2046 | C2: 0.8369 | C3: 0.6448
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 29.5551
 Avg Train Loss: 29.5551 | Seg Loss: 0.2955 | Recon Loss: 0.0046
  Val mIoU: 0.5598 (Best: 0.5814)
  [Class IoU]  C1: 0.2130 | C2: 0.8347 | C3: 0.6317
Epoch 102/400 | Train Loss: 29.9826
 Avg Train Loss: 29.9826 | Seg Loss: 0.2998 | Recon Loss: 0.0044
  Val mIoU: 0.5195 (Best: 0.5814)
  [Class IoU]  C1: 0.2293 | C2: 0.7984 | C3: 0.5310
Epoch 103/400 | Train Loss: 30.4396
 Avg Train Loss: 30.4396 | Seg Loss: 0.3044 | Recon Loss: 0.0045
  Val mIoU: 0.5656 (Best: 0.5814)
  [Class IoU]  C1: 0.2277 | C2: 0.8309 | C3: 0.6383
Epoch 104/400 | Train Loss: 29.6293
 Avg Train Loss: 29.6293 | Seg Loss: 0.2962 | Recon Loss: 0.0045
  Val mIoU: 0.5426 (Best: 0.5814)
  [Class IoU]  C1: 0.2287 | C2: 0.8124 | C3: 0.5866
Epoch 105/400 | Train Loss: 30.0330
 Avg Train Loss: 30.0330 | Seg Loss: 0.3003 | Recon Loss: 0.0045
  Val mIoU: 0.5674 (Best: 0.5814)
  [Class IoU]  C1: 0.2277 | C2: 0.8299 | C3: 0.6447
Epoch 106/400 | Train Loss: 29.7854
 Avg Train Loss: 29.7854 | Seg Loss: 0.2978 | Recon Loss: 0.0046
  Val mIoU: 0.5584 (Best: 0.5814)
  [Class IoU]  C1: 0.2121 | C2: 0.8328 | C3: 0.6305
Epoch 107/400 | Train Loss: 29.8808
 Avg Train Loss: 29.8808 | Seg Loss: 0.2988 | Recon Loss: 0.0046
  Val mIoU: 0.5715 (Best: 0.5814)
  [Class IoU]  C1: 0.2246 | C2: 0.8351 | C3: 0.6549
Epoch 108/400 | Train Loss: 29.8156
 Avg Train Loss: 29.8156 | Seg Loss: 0.2981 | Recon Loss: 0.0045
  Val mIoU: 0.5781 (Best: 0.5814)
  [Class IoU]  C1: 0.2255 | C2: 0.8368 | C3: 0.6720
Epoch 109/400 | Train Loss: 29.7585
 Avg Train Loss: 29.7585 | Seg Loss: 0.2975 | Recon Loss: 0.0045
  Val mIoU: 0.5839 (Best: 0.5814)
  [Class IoU]  C1: 0.2303 | C2: 0.8441 | C3: 0.6772
  --> New Best Model Saved!
Epoch 110/400 | Train Loss: 29.3370
 Avg Train Loss: 29.3370 | Seg Loss: 0.2933 | Recon Loss: 0.0046
  Val mIoU: 0.5806 (Best: 0.5839)
  [Class IoU]  C1: 0.2310 | C2: 0.8426 | C3: 0.6683
Epoch 111/400 | Train Loss: 29.2869
 Avg Train Loss: 29.2869 | Seg Loss: 0.2928 | Recon Loss: 0.0046
  Val mIoU: 0.5823 (Best: 0.5839)
  [Class IoU]  C1: 0.2242 | C2: 0.8407 | C3: 0.6820
Epoch 112/400 | Train Loss: 30.5491
 Avg Train Loss: 30.5491 | Seg Loss: 0.3054 | Recon Loss: 0.0044
  Val mIoU: 0.5647 (Best: 0.5839)
  [Class IoU]  C1: 0.2385 | C2: 0.8237 | C3: 0.6319
Epoch 113/400 | Train Loss: 29.9110
 Avg Train Loss: 29.9110 | Seg Loss: 0.2991 | Recon Loss: 0.0044
  Val mIoU: 0.5605 (Best: 0.5839)
  [Class IoU]  C1: 0.2095 | C2: 0.8369 | C3: 0.6351
Epoch 114/400 | Train Loss: 29.9770
 Avg Train Loss: 29.9770 | Seg Loss: 0.2997 | Recon Loss: 0.0044
  Val mIoU: 0.5743 (Best: 0.5839)
  [Class IoU]  C1: 0.2305 | C2: 0.8356 | C3: 0.6569
Epoch 115/400 | Train Loss: 29.5246
 Avg Train Loss: 29.5246 | Seg Loss: 0.2952 | Recon Loss: 0.0045
  Val mIoU: 0.5650 (Best: 0.5839)
  [Class IoU]  C1: 0.2122 | C2: 0.8369 | C3: 0.6459
Epoch 116/400 | Train Loss: 29.7557
 Avg Train Loss: 29.7557 | Seg Loss: 0.2975 | Recon Loss: 0.0044
  Val mIoU: 0.5754 (Best: 0.5839)
  [Class IoU]  C1: 0.2465 | C2: 0.8215 | C3: 0.6581
Epoch 117/400 | Train Loss: 30.2724
 Avg Train Loss: 30.2724 | Seg Loss: 0.3027 | Recon Loss: 0.0045
  Val mIoU: 0.5767 (Best: 0.5839)
  [Class IoU]  C1: 0.2232 | C2: 0.8423 | C3: 0.6645
Epoch 118/400 | Train Loss: 29.3366
 Avg Train Loss: 29.3366 | Seg Loss: 0.2933 | Recon Loss: 0.0044
  Val mIoU: 0.5569 (Best: 0.5839)
  [Class IoU]  C1: 0.2079 | C2: 0.8317 | C3: 0.6311
Epoch 119/400 | Train Loss: 29.3385
 Avg Train Loss: 29.3385 | Seg Loss: 0.2933 | Recon Loss: 0.0045
  Val mIoU: 0.5497 (Best: 0.5839)
  [Class IoU]  C1: 0.2120 | C2: 0.8253 | C3: 0.6117
Epoch 120/400 | Train Loss: 30.0119
 Avg Train Loss: 30.0119 | Seg Loss: 0.3001 | Recon Loss: 0.0046
  Val mIoU: 0.5642 (Best: 0.5839)
  [Class IoU]  C1: 0.1999 | C2: 0.8344 | C3: 0.6582
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 30.0358
 Avg Train Loss: 30.0358 | Seg Loss: 0.3003 | Recon Loss: 0.0045
  Val mIoU: 0.5733 (Best: 0.5839)
  [Class IoU]  C1: 0.2227 | C2: 0.8387 | C3: 0.6586
Epoch 122/400 | Train Loss: 29.4821
 Avg Train Loss: 29.4821 | Seg Loss: 0.2948 | Recon Loss: 0.0044
  Val mIoU: 0.5761 (Best: 0.5839)
  [Class IoU]  C1: 0.2295 | C2: 0.8389 | C3: 0.6601
Epoch 123/400 | Train Loss: 29.3484
 Avg Train Loss: 29.3484 | Seg Loss: 0.2934 | Recon Loss: 0.0046
  Val mIoU: 0.5846 (Best: 0.5839)
  [Class IoU]  C1: 0.2296 | C2: 0.8424 | C3: 0.6816
  --> New Best Model Saved!
Epoch 124/400 | Train Loss: 29.5800
 Avg Train Loss: 29.5800 | Seg Loss: 0.2958 | Recon Loss: 0.0044
  Val mIoU: 0.5667 (Best: 0.5846)
  [Class IoU]  C1: 0.2130 | C2: 0.8385 | C3: 0.6487
Epoch 125/400 | Train Loss: 29.7112
 Avg Train Loss: 29.7112 | Seg Loss: 0.2971 | Recon Loss: 0.0045
  Val mIoU: 0.5685 (Best: 0.5846)
  [Class IoU]  C1: 0.2349 | C2: 0.8341 | C3: 0.6367
Epoch 126/400 | Train Loss: 30.1627
 Avg Train Loss: 30.1627 | Seg Loss: 0.3016 | Recon Loss: 0.0046
  Val mIoU: 0.5600 (Best: 0.5846)
  [Class IoU]  C1: 0.2270 | C2: 0.8293 | C3: 0.6238
Epoch 127/400 | Train Loss: 29.4001
 Avg Train Loss: 29.4001 | Seg Loss: 0.2940 | Recon Loss: 0.0044
  Val mIoU: 0.5704 (Best: 0.5846)
  [Class IoU]  C1: 0.2309 | C2: 0.8341 | C3: 0.6462
Epoch 128/400 | Train Loss: 28.7467
 Avg Train Loss: 28.7467 | Seg Loss: 0.2874 | Recon Loss: 0.0044
  Val mIoU: 0.5495 (Best: 0.5846)
  [Class IoU]  C1: 0.2494 | C2: 0.8084 | C3: 0.5907
Epoch 129/400 | Train Loss: 30.0168
 Avg Train Loss: 30.0168 | Seg Loss: 0.3001 | Recon Loss: 0.0046
  Val mIoU: 0.5520 (Best: 0.5846)
  [Class IoU]  C1: 0.2561 | C2: 0.8087 | C3: 0.5913
Epoch 130/400 | Train Loss: 30.0762
 Avg Train Loss: 30.0762 | Seg Loss: 0.3007 | Recon Loss: 0.0046
  Val mIoU: 0.5548 (Best: 0.5846)
  [Class IoU]  C1: 0.2441 | C2: 0.8167 | C3: 0.6036
Epoch 131/400 | Train Loss: 29.5531
 Avg Train Loss: 29.5531 | Seg Loss: 0.2955 | Recon Loss: 0.0044
  Val mIoU: 0.5593 (Best: 0.5846)
  [Class IoU]  C1: 0.2533 | C2: 0.8216 | C3: 0.6031
Epoch 132/400 | Train Loss: 29.4754
 Avg Train Loss: 29.4754 | Seg Loss: 0.2947 | Recon Loss: 0.0044
  Val mIoU: 0.5574 (Best: 0.5846)
  [Class IoU]  C1: 0.2486 | C2: 0.8123 | C3: 0.6115
Epoch 133/400 | Train Loss: 29.6367
 Avg Train Loss: 29.6367 | Seg Loss: 0.2963 | Recon Loss: 0.0045
  Val mIoU: 0.5718 (Best: 0.5846)
  [Class IoU]  C1: 0.2190 | C2: 0.8384 | C3: 0.6581
Epoch 134/400 | Train Loss: 29.4420
 Avg Train Loss: 29.4420 | Seg Loss: 0.2944 | Recon Loss: 0.0044
  Val mIoU: 0.5452 (Best: 0.5846)
  [Class IoU]  C1: 0.2669 | C2: 0.8083 | C3: 0.5603
Epoch 135/400 | Train Loss: 29.4354
 Avg Train Loss: 29.4354 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.5435 (Best: 0.5846)
  [Class IoU]  C1: 0.2289 | C2: 0.8151 | C3: 0.5866
Epoch 136/400 | Train Loss: 29.5324
 Avg Train Loss: 29.5324 | Seg Loss: 0.2953 | Recon Loss: 0.0046
  Val mIoU: 0.5580 (Best: 0.5846)
  [Class IoU]  C1: 0.2467 | C2: 0.8194 | C3: 0.6078
Epoch 137/400 | Train Loss: 29.6037
 Avg Train Loss: 29.6037 | Seg Loss: 0.2960 | Recon Loss: 0.0045
  Val mIoU: 0.5398 (Best: 0.5846)
  [Class IoU]  C1: 0.2182 | C2: 0.8189 | C3: 0.5823
Epoch 138/400 | Train Loss: 29.3471
 Avg Train Loss: 29.3471 | Seg Loss: 0.2934 | Recon Loss: 0.0044
  Val mIoU: 0.5313 (Best: 0.5846)
  [Class IoU]  C1: 0.2356 | C2: 0.7990 | C3: 0.5592
Epoch 139/400 | Train Loss: 29.5074
 Avg Train Loss: 29.5074 | Seg Loss: 0.2950 | Recon Loss: 0.0044
  Val mIoU: 0.5657 (Best: 0.5846)
  [Class IoU]  C1: 0.2484 | C2: 0.8246 | C3: 0.6240
Epoch 140/400 | Train Loss: 29.0836
 Avg Train Loss: 29.0836 | Seg Loss: 0.2908 | Recon Loss: 0.0045
  Val mIoU: 0.5588 (Best: 0.5846)
  [Class IoU]  C1: 0.2256 | C2: 0.8280 | C3: 0.6226
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 28.8291
 Avg Train Loss: 28.8291 | Seg Loss: 0.2882 | Recon Loss: 0.0045
  Val mIoU: 0.5586 (Best: 0.5846)
  [Class IoU]  C1: 0.2401 | C2: 0.8224 | C3: 0.6133
Epoch 142/400 | Train Loss: 29.3917
 Avg Train Loss: 29.3917 | Seg Loss: 0.2939 | Recon Loss: 0.0045
  Val mIoU: 0.5380 (Best: 0.5846)
  [Class IoU]  C1: 0.2249 | C2: 0.8100 | C3: 0.5791
Epoch 143/400 | Train Loss: 29.3723
 Avg Train Loss: 29.3723 | Seg Loss: 0.2937 | Recon Loss: 0.0044
  Val mIoU: 0.5644 (Best: 0.5846)
  [Class IoU]  C1: 0.2346 | C2: 0.8331 | C3: 0.6254
Epoch 144/400 | Train Loss: 29.2954
 Avg Train Loss: 29.2954 | Seg Loss: 0.2929 | Recon Loss: 0.0044
  Val mIoU: 0.5379 (Best: 0.5846)
  [Class IoU]  C1: 0.2247 | C2: 0.8126 | C3: 0.5764
Epoch 145/400 | Train Loss: 29.2528
 Avg Train Loss: 29.2528 | Seg Loss: 0.2925 | Recon Loss: 0.0046
  Val mIoU: 0.5547 (Best: 0.5846)
  [Class IoU]  C1: 0.2342 | C2: 0.8240 | C3: 0.6060
Epoch 146/400 | Train Loss: 29.1586
 Avg Train Loss: 29.1586 | Seg Loss: 0.2915 | Recon Loss: 0.0044
  Val mIoU: 0.5522 (Best: 0.5846)
  [Class IoU]  C1: 0.2491 | C2: 0.8126 | C3: 0.5948
Epoch 147/400 | Train Loss: 29.9739
 Avg Train Loss: 29.9739 | Seg Loss: 0.2997 | Recon Loss: 0.0046
  Val mIoU: 0.5375 (Best: 0.5846)
  [Class IoU]  C1: 0.2463 | C2: 0.8030 | C3: 0.5631
Epoch 148/400 | Train Loss: 29.4223
 Avg Train Loss: 29.4223 | Seg Loss: 0.2942 | Recon Loss: 0.0043
  Val mIoU: 0.5015 (Best: 0.5846)
  [Class IoU]  C1: 0.2727 | C2: 0.7540 | C3: 0.4777
Epoch 149/400 | Train Loss: 29.2229
 Avg Train Loss: 29.2229 | Seg Loss: 0.2922 | Recon Loss: 0.0044
  Val mIoU: 0.5376 (Best: 0.5846)
  [Class IoU]  C1: 0.2162 | C2: 0.8172 | C3: 0.5793
Epoch 150/400 | Train Loss: 29.6824
 Avg Train Loss: 29.6824 | Seg Loss: 0.2968 | Recon Loss: 0.0044
  Val mIoU: 0.5049 (Best: 0.5846)
  [Class IoU]  C1: 0.2522 | C2: 0.7678 | C3: 0.4945
Epoch 151/400 | Train Loss: 29.2443
 Avg Train Loss: 29.2443 | Seg Loss: 0.2924 | Recon Loss: 0.0045
  Val mIoU: 0.5369 (Best: 0.5846)
  [Class IoU]  C1: 0.2254 | C2: 0.8112 | C3: 0.5742
Epoch 152/400 | Train Loss: 29.8750
 Avg Train Loss: 29.8750 | Seg Loss: 0.2987 | Recon Loss: 0.0045
  Val mIoU: 0.5272 (Best: 0.5846)
  [Class IoU]  C1: 0.2717 | C2: 0.7824 | C3: 0.5273
Epoch 153/400 | Train Loss: 29.3248
 Avg Train Loss: 29.3248 | Seg Loss: 0.2932 | Recon Loss: 0.0044
  Val mIoU: 0.5453 (Best: 0.5846)
  [Class IoU]  C1: 0.2078 | C2: 0.8234 | C3: 0.6046
Epoch 154/400 | Train Loss: 29.7359
 Avg Train Loss: 29.7359 | Seg Loss: 0.2973 | Recon Loss: 0.0044
  Val mIoU: 0.5422 (Best: 0.5846)
  [Class IoU]  C1: 0.2533 | C2: 0.8013 | C3: 0.5720
Epoch 155/400 | Train Loss: 29.1667
 Avg Train Loss: 29.1667 | Seg Loss: 0.2916 | Recon Loss: 0.0043
  Val mIoU: 0.5667 (Best: 0.5846)
  [Class IoU]  C1: 0.2404 | C2: 0.8273 | C3: 0.6323
Epoch 156/400 | Train Loss: 29.0838
 Avg Train Loss: 29.0838 | Seg Loss: 0.2908 | Recon Loss: 0.0046
  Val mIoU: 0.5511 (Best: 0.5846)
  [Class IoU]  C1: 0.2448 | C2: 0.8142 | C3: 0.5944
Epoch 157/400 | Train Loss: 29.4410
 Avg Train Loss: 29.4410 | Seg Loss: 0.2944 | Recon Loss: 0.0045
  Val mIoU: 0.5496 (Best: 0.5846)
  [Class IoU]  C1: 0.2246 | C2: 0.8233 | C3: 0.6008
Epoch 158/400 | Train Loss: 29.0938
 Avg Train Loss: 29.0938 | Seg Loss: 0.2909 | Recon Loss: 0.0044
  Val mIoU: 0.5526 (Best: 0.5846)
  [Class IoU]  C1: 0.2231 | C2: 0.8259 | C3: 0.6087
Epoch 159/400 | Train Loss: 29.8680
 Avg Train Loss: 29.8680 | Seg Loss: 0.2986 | Recon Loss: 0.0045
  Val mIoU: 0.5697 (Best: 0.5846)
  [Class IoU]  C1: 0.2143 | C2: 0.8393 | C3: 0.6555
Epoch 160/400 | Train Loss: 29.7180
 Avg Train Loss: 29.7180 | Seg Loss: 0.2971 | Recon Loss: 0.0045
  Val mIoU: 0.5530 (Best: 0.5846)
  [Class IoU]  C1: 0.2305 | C2: 0.8214 | C3: 0.6070
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 28.6594
 Avg Train Loss: 28.6594 | Seg Loss: 0.2866 | Recon Loss: 0.0044
  Val mIoU: 0.5562 (Best: 0.5846)
  [Class IoU]  C1: 0.2487 | C2: 0.8184 | C3: 0.6014
Epoch 162/400 | Train Loss: 29.4806
 Avg Train Loss: 29.4806 | Seg Loss: 0.2948 | Recon Loss: 0.0044
  Val mIoU: 0.5433 (Best: 0.5846)
  [Class IoU]  C1: 0.2230 | C2: 0.8198 | C3: 0.5870
Epoch 163/400 | Train Loss: 29.1393
 Avg Train Loss: 29.1393 | Seg Loss: 0.2913 | Recon Loss: 0.0047
  Val mIoU: 0.5483 (Best: 0.5846)
  [Class IoU]  C1: 0.2361 | C2: 0.8191 | C3: 0.5896
Epoch 164/400 | Train Loss: 29.3927
 Avg Train Loss: 29.3927 | Seg Loss: 0.2939 | Recon Loss: 0.0045
  Val mIoU: 0.5837 (Best: 0.5846)
  [Class IoU]  C1: 0.2368 | C2: 0.8429 | C3: 0.6713
Epoch 165/400 | Train Loss: 29.3471
 Avg Train Loss: 29.3471 | Seg Loss: 0.2934 | Recon Loss: 0.0045
  Val mIoU: 0.5615 (Best: 0.5846)
  [Class IoU]  C1: 0.2134 | C2: 0.8348 | C3: 0.6361
Epoch 166/400 | Train Loss: 29.1225
 Avg Train Loss: 29.1225 | Seg Loss: 0.2912 | Recon Loss: 0.0045
  Val mIoU: 0.5565 (Best: 0.5846)
  [Class IoU]  C1: 0.2438 | C2: 0.8197 | C3: 0.6062
Epoch 167/400 | Train Loss: 29.2254
 Avg Train Loss: 29.2254 | Seg Loss: 0.2922 | Recon Loss: 0.0045
  Val mIoU: 0.5436 (Best: 0.5846)
  [Class IoU]  C1: 0.2522 | C2: 0.8047 | C3: 0.5739
Epoch 168/400 | Train Loss: 28.8161
 Avg Train Loss: 28.8161 | Seg Loss: 0.2881 | Recon Loss: 0.0044
  Val mIoU: 0.5624 (Best: 0.5846)
  [Class IoU]  C1: 0.2080 | C2: 0.8364 | C3: 0.6430
Epoch 169/400 | Train Loss: 29.1339
 Avg Train Loss: 29.1339 | Seg Loss: 0.2913 | Recon Loss: 0.0044
  Val mIoU: 0.5681 (Best: 0.5846)
  [Class IoU]  C1: 0.2424 | C2: 0.8315 | C3: 0.6305
Epoch 170/400 | Train Loss: 29.2016
 Avg Train Loss: 29.2016 | Seg Loss: 0.2920 | Recon Loss: 0.0045
  Val mIoU: 0.5509 (Best: 0.5846)
  [Class IoU]  C1: 0.2500 | C2: 0.8092 | C3: 0.5935
Epoch 171/400 | Train Loss: 29.0594
 Avg Train Loss: 29.0594 | Seg Loss: 0.2905 | Recon Loss: 0.0044
  Val mIoU: 0.5673 (Best: 0.5846)
  [Class IoU]  C1: 0.2296 | C2: 0.8334 | C3: 0.6390
Epoch 172/400 | Train Loss: 29.1816
 Avg Train Loss: 29.1816 | Seg Loss: 0.2918 | Recon Loss: 0.0045
  Val mIoU: 0.5690 (Best: 0.5846)
  [Class IoU]  C1: 0.2407 | C2: 0.8262 | C3: 0.6402
Epoch 173/400 | Train Loss: 29.2143
 Avg Train Loss: 29.2143 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.5886 (Best: 0.5846)
  [Class IoU]  C1: 0.2693 | C2: 0.8227 | C3: 0.6737
  --> New Best Model Saved!
Epoch 174/400 | Train Loss: 29.3476
 Avg Train Loss: 29.3476 | Seg Loss: 0.2934 | Recon Loss: 0.0044
  Val mIoU: 0.5661 (Best: 0.5886)
  [Class IoU]  C1: 0.2179 | C2: 0.8362 | C3: 0.6441
Epoch 175/400 | Train Loss: 28.9209
 Avg Train Loss: 28.9209 | Seg Loss: 0.2892 | Recon Loss: 0.0045
  Val mIoU: 0.5614 (Best: 0.5886)
  [Class IoU]  C1: 0.2495 | C2: 0.8220 | C3: 0.6126
Epoch 176/400 | Train Loss: 29.4388
 Avg Train Loss: 29.4388 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.5630 (Best: 0.5886)
  [Class IoU]  C1: 0.2229 | C2: 0.8312 | C3: 0.6350
Epoch 177/400 | Train Loss: 29.1179
 Avg Train Loss: 29.1179 | Seg Loss: 0.2911 | Recon Loss: 0.0044
  Val mIoU: 0.5732 (Best: 0.5886)
  [Class IoU]  C1: 0.2374 | C2: 0.8317 | C3: 0.6506
Epoch 178/400 | Train Loss: 29.2420
 Avg Train Loss: 29.2420 | Seg Loss: 0.2924 | Recon Loss: 0.0043
  Val mIoU: 0.5878 (Best: 0.5886)
  [Class IoU]  C1: 0.2412 | C2: 0.8404 | C3: 0.6819
Epoch 179/400 | Train Loss: 29.4381
 Avg Train Loss: 29.4381 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.5566 (Best: 0.5886)
  [Class IoU]  C1: 0.2234 | C2: 0.8272 | C3: 0.6191
Epoch 180/400 | Train Loss: 29.6277
 Avg Train Loss: 29.6277 | Seg Loss: 0.2962 | Recon Loss: 0.0044
  Val mIoU: 0.5529 (Best: 0.5886)
  [Class IoU]  C1: 0.2272 | C2: 0.8240 | C3: 0.6073
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 28.9937
 Avg Train Loss: 28.9937 | Seg Loss: 0.2899 | Recon Loss: 0.0044
  Val mIoU: 0.5491 (Best: 0.5886)
  [Class IoU]  C1: 0.2313 | C2: 0.8200 | C3: 0.5961
Epoch 182/400 | Train Loss: 28.7586
 Avg Train Loss: 28.7586 | Seg Loss: 0.2875 | Recon Loss: 0.0045
  Val mIoU: 0.5470 (Best: 0.5886)
  [Class IoU]  C1: 0.2281 | C2: 0.8197 | C3: 0.5931
Epoch 183/400 | Train Loss: 29.3555
 Avg Train Loss: 29.3555 | Seg Loss: 0.2935 | Recon Loss: 0.0044
  Val mIoU: 0.5740 (Best: 0.5886)
  [Class IoU]  C1: 0.2331 | C2: 0.8371 | C3: 0.6520
Epoch 184/400 | Train Loss: 28.6537
 Avg Train Loss: 28.6537 | Seg Loss: 0.2865 | Recon Loss: 0.0045
  Val mIoU: 0.5613 (Best: 0.5886)
  [Class IoU]  C1: 0.2374 | C2: 0.8264 | C3: 0.6202
Epoch 185/400 | Train Loss: 28.4260
 Avg Train Loss: 28.4260 | Seg Loss: 0.2842 | Recon Loss: 0.0043
  Val mIoU: 0.5488 (Best: 0.5886)
  [Class IoU]  C1: 0.2454 | C2: 0.8071 | C3: 0.5938
Epoch 186/400 | Train Loss: 29.2570
 Avg Train Loss: 29.2570 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.5726 (Best: 0.5886)
  [Class IoU]  C1: 0.2501 | C2: 0.8288 | C3: 0.6389
Epoch 187/400 | Train Loss: 28.9481
 Avg Train Loss: 28.9481 | Seg Loss: 0.2894 | Recon Loss: 0.0044
  Val mIoU: 0.5578 (Best: 0.5886)
  [Class IoU]  C1: 0.2548 | C2: 0.8166 | C3: 0.6019
Epoch 188/400 | Train Loss: 29.2728
 Avg Train Loss: 29.2728 | Seg Loss: 0.2927 | Recon Loss: 0.0044
  Val mIoU: 0.5707 (Best: 0.5886)
  [Class IoU]  C1: 0.2392 | C2: 0.8335 | C3: 0.6392
Epoch 189/400 | Train Loss: 29.1322
 Avg Train Loss: 29.1322 | Seg Loss: 0.2913 | Recon Loss: 0.0044
  Val mIoU: 0.5559 (Best: 0.5886)
  [Class IoU]  C1: 0.2415 | C2: 0.8176 | C3: 0.6086
Epoch 190/400 | Train Loss: 28.7332
 Avg Train Loss: 28.7332 | Seg Loss: 0.2873 | Recon Loss: 0.0043
  Val mIoU: 0.5760 (Best: 0.5886)
  [Class IoU]  C1: 0.2142 | C2: 0.8447 | C3: 0.6692
Epoch 191/400 | Train Loss: 28.8243
 Avg Train Loss: 28.8243 | Seg Loss: 0.2882 | Recon Loss: 0.0044
  Val mIoU: 0.5695 (Best: 0.5886)
  [Class IoU]  C1: 0.2202 | C2: 0.8374 | C3: 0.6509
Epoch 192/400 | Train Loss: 29.1052
 Avg Train Loss: 29.1052 | Seg Loss: 0.2910 | Recon Loss: 0.0043
  Val mIoU: 0.5733 (Best: 0.5886)
  [Class IoU]  C1: 0.2154 | C2: 0.8441 | C3: 0.6605
Epoch 193/400 | Train Loss: 29.7175
 Avg Train Loss: 29.7175 | Seg Loss: 0.2971 | Recon Loss: 0.0045
  Val mIoU: 0.5720 (Best: 0.5886)
  [Class IoU]  C1: 0.2210 | C2: 0.8411 | C3: 0.6539
Epoch 194/400 | Train Loss: 29.1022
 Avg Train Loss: 29.1022 | Seg Loss: 0.2910 | Recon Loss: 0.0045
  Val mIoU: 0.5624 (Best: 0.5886)
  [Class IoU]  C1: 0.2131 | C2: 0.8364 | C3: 0.6378
Epoch 195/400 | Train Loss: 28.5293
 Avg Train Loss: 28.5293 | Seg Loss: 0.2852 | Recon Loss: 0.0045
  Val mIoU: 0.5825 (Best: 0.5886)
  [Class IoU]  C1: 0.2659 | C2: 0.8267 | C3: 0.6547
Epoch 196/400 | Train Loss: 29.3056
 Avg Train Loss: 29.3056 | Seg Loss: 0.2930 | Recon Loss: 0.0044
  Val mIoU: 0.5676 (Best: 0.5886)
  [Class IoU]  C1: 0.2435 | C2: 0.8291 | C3: 0.6303
Epoch 197/400 | Train Loss: 28.7176
 Avg Train Loss: 28.7176 | Seg Loss: 0.2871 | Recon Loss: 0.0046
  Val mIoU: 0.5643 (Best: 0.5886)
  [Class IoU]  C1: 0.2423 | C2: 0.8218 | C3: 0.6288
Epoch 198/400 | Train Loss: 28.6437
 Avg Train Loss: 28.6437 | Seg Loss: 0.2864 | Recon Loss: 0.0044
  Val mIoU: 0.5791 (Best: 0.5886)
  [Class IoU]  C1: 0.2680 | C2: 0.8267 | C3: 0.6427
Epoch 199/400 | Train Loss: 29.7562
 Avg Train Loss: 29.7562 | Seg Loss: 0.2975 | Recon Loss: 0.0045
  Val mIoU: 0.5644 (Best: 0.5886)
  [Class IoU]  C1: 0.2539 | C2: 0.8159 | C3: 0.6236
Epoch 200/400 | Train Loss: 29.0230
 Avg Train Loss: 29.0230 | Seg Loss: 0.2902 | Recon Loss: 0.0043
  Val mIoU: 0.5530 (Best: 0.5886)
  [Class IoU]  C1: 0.2124 | C2: 0.8280 | C3: 0.6185
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 28.8630
 Avg Train Loss: 28.8630 | Seg Loss: 0.2886 | Recon Loss: 0.0044
  Val mIoU: 0.5745 (Best: 0.5886)
  [Class IoU]  C1: 0.2219 | C2: 0.8381 | C3: 0.6637
Epoch 202/400 | Train Loss: 29.4274
 Avg Train Loss: 29.4274 | Seg Loss: 0.2942 | Recon Loss: 0.0044
  Val mIoU: 0.5527 (Best: 0.5886)
  [Class IoU]  C1: 0.2355 | C2: 0.8179 | C3: 0.6048
Epoch 203/400 | Train Loss: 29.1933
 Avg Train Loss: 29.1933 | Seg Loss: 0.2919 | Recon Loss: 0.0044
  Val mIoU: 0.5621 (Best: 0.5886)
  [Class IoU]  C1: 0.2408 | C2: 0.8248 | C3: 0.6208
Epoch 204/400 | Train Loss: 28.8785
 Avg Train Loss: 28.8785 | Seg Loss: 0.2887 | Recon Loss: 0.0044
  Val mIoU: 0.5653 (Best: 0.5886)
  [Class IoU]  C1: 0.2344 | C2: 0.8312 | C3: 0.6304
Epoch 205/400 | Train Loss: 28.3879
 Avg Train Loss: 28.3879 | Seg Loss: 0.2838 | Recon Loss: 0.0043
  Val mIoU: 0.5488 (Best: 0.5886)
  [Class IoU]  C1: 0.2489 | C2: 0.8097 | C3: 0.5879
Epoch 206/400 | Train Loss: 28.7586
 Avg Train Loss: 28.7586 | Seg Loss: 0.2875 | Recon Loss: 0.0044
  Val mIoU: 0.5738 (Best: 0.5886)
  [Class IoU]  C1: 0.2548 | C2: 0.8256 | C3: 0.6411
Epoch 207/400 | Train Loss: 29.1995
 Avg Train Loss: 29.1995 | Seg Loss: 0.2920 | Recon Loss: 0.0044
  Val mIoU: 0.5737 (Best: 0.5886)
  [Class IoU]  C1: 0.2435 | C2: 0.8351 | C3: 0.6424
Epoch 208/400 | Train Loss: 28.9126
 Avg Train Loss: 28.9126 | Seg Loss: 0.2891 | Recon Loss: 0.0046
  Val mIoU: 0.5714 (Best: 0.5886)
  [Class IoU]  C1: 0.2112 | C2: 0.8416 | C3: 0.6613
Epoch 209/400 | Train Loss: 28.1812
 Avg Train Loss: 28.1812 | Seg Loss: 0.2818 | Recon Loss: 0.0045
  Val mIoU: 0.5783 (Best: 0.5886)
  [Class IoU]  C1: 0.2274 | C2: 0.8400 | C3: 0.6674
Epoch 210/400 | Train Loss: 29.0580
 Avg Train Loss: 29.0580 | Seg Loss: 0.2905 | Recon Loss: 0.0044
  Val mIoU: 0.5651 (Best: 0.5886)
  [Class IoU]  C1: 0.2287 | C2: 0.8345 | C3: 0.6320
Epoch 211/400 | Train Loss: 29.1219
 Avg Train Loss: 29.1219 | Seg Loss: 0.2912 | Recon Loss: 0.0045
  Val mIoU: 0.5683 (Best: 0.5886)
  [Class IoU]  C1: 0.2216 | C2: 0.8376 | C3: 0.6456
Epoch 212/400 | Train Loss: 29.2175
 Avg Train Loss: 29.2175 | Seg Loss: 0.2921 | Recon Loss: 0.0044
  Val mIoU: 0.5688 (Best: 0.5886)
  [Class IoU]  C1: 0.2373 | C2: 0.8328 | C3: 0.6362
Epoch 213/400 | Train Loss: 28.5247
 Avg Train Loss: 28.5247 | Seg Loss: 0.2852 | Recon Loss: 0.0044
  Val mIoU: 0.5840 (Best: 0.5886)
  [Class IoU]  C1: 0.2225 | C2: 0.8459 | C3: 0.6837
Epoch 214/400 | Train Loss: 28.5594
 Avg Train Loss: 28.5594 | Seg Loss: 0.2855 | Recon Loss: 0.0045
  Val mIoU: 0.5721 (Best: 0.5886)
  [Class IoU]  C1: 0.2247 | C2: 0.8392 | C3: 0.6523
Epoch 215/400 | Train Loss: 29.2676
 Avg Train Loss: 29.2676 | Seg Loss: 0.2926 | Recon Loss: 0.0044
  Val mIoU: 0.5744 (Best: 0.5886)
  [Class IoU]  C1: 0.2320 | C2: 0.8412 | C3: 0.6499
Epoch 216/400 | Train Loss: 28.3934
 Avg Train Loss: 28.3934 | Seg Loss: 0.2839 | Recon Loss: 0.0043
  Val mIoU: 0.5692 (Best: 0.5886)
  [Class IoU]  C1: 0.2222 | C2: 0.8395 | C3: 0.6460
Epoch 217/400 | Train Loss: 29.2391
 Avg Train Loss: 29.2391 | Seg Loss: 0.2923 | Recon Loss: 0.0042
  Val mIoU: 0.5632 (Best: 0.5886)
  [Class IoU]  C1: 0.2434 | C2: 0.8254 | C3: 0.6207
Epoch 218/400 | Train Loss: 29.0365
 Avg Train Loss: 29.0365 | Seg Loss: 0.2903 | Recon Loss: 0.0044
  Val mIoU: 0.5637 (Best: 0.5886)
  [Class IoU]  C1: 0.2383 | C2: 0.8260 | C3: 0.6269
Epoch 219/400 | Train Loss: 29.0359
 Avg Train Loss: 29.0359 | Seg Loss: 0.2903 | Recon Loss: 0.0045
  Val mIoU: 0.5617 (Best: 0.5886)
  [Class IoU]  C1: 0.2212 | C2: 0.8332 | C3: 0.6309
Epoch 220/400 | Train Loss: 28.3674
 Avg Train Loss: 28.3674 | Seg Loss: 0.2836 | Recon Loss: 0.0045
  Val mIoU: 0.5647 (Best: 0.5886)
  [Class IoU]  C1: 0.2319 | C2: 0.8294 | C3: 0.6329
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 28.9638
 Avg Train Loss: 28.9638 | Seg Loss: 0.2896 | Recon Loss: 0.0044
  Val mIoU: 0.5750 (Best: 0.5886)
  [Class IoU]  C1: 0.2379 | C2: 0.8384 | C3: 0.6487
Epoch 222/400 | Train Loss: 29.3526
 Avg Train Loss: 29.3526 | Seg Loss: 0.2935 | Recon Loss: 0.0044
  Val mIoU: 0.5746 (Best: 0.5886)
  [Class IoU]  C1: 0.2393 | C2: 0.8401 | C3: 0.6443
Epoch 223/400 | Train Loss: 29.2585
 Avg Train Loss: 29.2585 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.5650 (Best: 0.5886)
  [Class IoU]  C1: 0.2204 | C2: 0.8358 | C3: 0.6388
Epoch 224/400 | Train Loss: 29.1962
 Avg Train Loss: 29.1962 | Seg Loss: 0.2919 | Recon Loss: 0.0043
  Val mIoU: 0.5710 (Best: 0.5886)
  [Class IoU]  C1: 0.2250 | C2: 0.8401 | C3: 0.6479
Epoch 225/400 | Train Loss: 28.8993
 Avg Train Loss: 28.8993 | Seg Loss: 0.2890 | Recon Loss: 0.0042
  Val mIoU: 0.5778 (Best: 0.5886)
  [Class IoU]  C1: 0.2141 | C2: 0.8448 | C3: 0.6744
Epoch 226/400 | Train Loss: 28.7132
 Avg Train Loss: 28.7132 | Seg Loss: 0.2871 | Recon Loss: 0.0043
  Val mIoU: 0.5709 (Best: 0.5886)
  [Class IoU]  C1: 0.2306 | C2: 0.8372 | C3: 0.6448
Epoch 227/400 | Train Loss: 29.1466
 Avg Train Loss: 29.1466 | Seg Loss: 0.2914 | Recon Loss: 0.0044
  Val mIoU: 0.5781 (Best: 0.5886)
  [Class IoU]  C1: 0.2150 | C2: 0.8460 | C3: 0.6732
Epoch 228/400 | Train Loss: 28.5689
 Avg Train Loss: 28.5689 | Seg Loss: 0.2856 | Recon Loss: 0.0043
  Val mIoU: 0.5644 (Best: 0.5886)
  [Class IoU]  C1: 0.2178 | C2: 0.8370 | C3: 0.6383
Epoch 229/400 | Train Loss: 29.0495
 Avg Train Loss: 29.0495 | Seg Loss: 0.2905 | Recon Loss: 0.0042
  Val mIoU: 0.5707 (Best: 0.5886)
  [Class IoU]  C1: 0.2237 | C2: 0.8388 | C3: 0.6496
Epoch 230/400 | Train Loss: 29.4963
 Avg Train Loss: 29.4963 | Seg Loss: 0.2949 | Recon Loss: 0.0045
  Val mIoU: 0.5686 (Best: 0.5886)
  [Class IoU]  C1: 0.2267 | C2: 0.8363 | C3: 0.6427
Epoch 231/400 | Train Loss: 28.8313
 Avg Train Loss: 28.8313 | Seg Loss: 0.2883 | Recon Loss: 0.0043
  Val mIoU: 0.5709 (Best: 0.5886)
  [Class IoU]  C1: 0.2387 | C2: 0.8283 | C3: 0.6456
Epoch 232/400 | Train Loss: 29.1114
 Avg Train Loss: 29.1114 | Seg Loss: 0.2911 | Recon Loss: 0.0043
  Val mIoU: 0.5825 (Best: 0.5886)
  [Class IoU]  C1: 0.2241 | C2: 0.8477 | C3: 0.6757
Epoch 233/400 | Train Loss: 28.9966
 Avg Train Loss: 28.9966 | Seg Loss: 0.2899 | Recon Loss: 0.0045
  Val mIoU: 0.5699 (Best: 0.5886)
  [Class IoU]  C1: 0.2318 | C2: 0.8341 | C3: 0.6436
Epoch 234/400 | Train Loss: 28.8757
 Avg Train Loss: 28.8757 | Seg Loss: 0.2887 | Recon Loss: 0.0044
  Val mIoU: 0.5686 (Best: 0.5886)
  [Class IoU]  C1: 0.2199 | C2: 0.8366 | C3: 0.6494
Epoch 235/400 | Train Loss: 29.1849
 Avg Train Loss: 29.1849 | Seg Loss: 0.2918 | Recon Loss: 0.0045
  Val mIoU: 0.5585 (Best: 0.5886)
  [Class IoU]  C1: 0.2236 | C2: 0.8265 | C3: 0.6255
Epoch 236/400 | Train Loss: 29.2900
 Avg Train Loss: 29.2900 | Seg Loss: 0.2929 | Recon Loss: 0.0045
  Val mIoU: 0.5734 (Best: 0.5886)
  [Class IoU]  C1: 0.2330 | C2: 0.8344 | C3: 0.6527
Epoch 237/400 | Train Loss: 29.0360
 Avg Train Loss: 29.0360 | Seg Loss: 0.2903 | Recon Loss: 0.0044
  Val mIoU: 0.5721 (Best: 0.5886)
  [Class IoU]  C1: 0.2492 | C2: 0.8217 | C3: 0.6456
Epoch 238/400 | Train Loss: 28.6266
 Avg Train Loss: 28.6266 | Seg Loss: 0.2862 | Recon Loss: 0.0044
  Val mIoU: 0.5646 (Best: 0.5886)
  [Class IoU]  C1: 0.2235 | C2: 0.8353 | C3: 0.6350
Epoch 239/400 | Train Loss: 28.4726
 Avg Train Loss: 28.4726 | Seg Loss: 0.2847 | Recon Loss: 0.0044
  Val mIoU: 0.5657 (Best: 0.5886)
  [Class IoU]  C1: 0.2277 | C2: 0.8349 | C3: 0.6345
Epoch 240/400 | Train Loss: 28.5603
 Avg Train Loss: 28.5603 | Seg Loss: 0.2856 | Recon Loss: 0.0044
  Val mIoU: 0.5779 (Best: 0.5886)
  [Class IoU]  C1: 0.2511 | C2: 0.8284 | C3: 0.6542
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 28.2752
 Avg Train Loss: 28.2752 | Seg Loss: 0.2827 | Recon Loss: 0.0043
  Val mIoU: 0.5562 (Best: 0.5886)
  [Class IoU]  C1: 0.2226 | C2: 0.8273 | C3: 0.6187
Epoch 242/400 | Train Loss: 29.4844
 Avg Train Loss: 29.4844 | Seg Loss: 0.2948 | Recon Loss: 0.0044
  Val mIoU: 0.5708 (Best: 0.5886)
  [Class IoU]  C1: 0.2354 | C2: 0.8318 | C3: 0.6451
Epoch 243/400 | Train Loss: 28.9240
 Avg Train Loss: 28.9240 | Seg Loss: 0.2892 | Recon Loss: 0.0045
  Val mIoU: 0.5835 (Best: 0.5886)
  [Class IoU]  C1: 0.2270 | C2: 0.8445 | C3: 0.6789
Epoch 244/400 | Train Loss: 28.6944
 Avg Train Loss: 28.6944 | Seg Loss: 0.2869 | Recon Loss: 0.0044
  Val mIoU: 0.5465 (Best: 0.5886)
  [Class IoU]  C1: 0.2308 | C2: 0.8191 | C3: 0.5896
Epoch 245/400 | Train Loss: 28.7991
 Avg Train Loss: 28.7991 | Seg Loss: 0.2879 | Recon Loss: 0.0044
  Val mIoU: 0.5840 (Best: 0.5886)
  [Class IoU]  C1: 0.2184 | C2: 0.8482 | C3: 0.6853
Epoch 246/400 | Train Loss: 29.1946
 Avg Train Loss: 29.1946 | Seg Loss: 0.2919 | Recon Loss: 0.0044
  Val mIoU: 0.5791 (Best: 0.5886)
  [Class IoU]  C1: 0.2257 | C2: 0.8406 | C3: 0.6711
Epoch 247/400 | Train Loss: 28.6497
 Avg Train Loss: 28.6497 | Seg Loss: 0.2865 | Recon Loss: 0.0044
  Val mIoU: 0.5813 (Best: 0.5886)
  [Class IoU]  C1: 0.2342 | C2: 0.8407 | C3: 0.6691
Epoch 248/400 | Train Loss: 29.4002
 Avg Train Loss: 29.4002 | Seg Loss: 0.2940 | Recon Loss: 0.0044
  Val mIoU: 0.5776 (Best: 0.5886)
  [Class IoU]  C1: 0.2233 | C2: 0.8436 | C3: 0.6659
Epoch 249/400 | Train Loss: 28.6471
 Avg Train Loss: 28.6471 | Seg Loss: 0.2864 | Recon Loss: 0.0044
  Val mIoU: 0.5687 (Best: 0.5886)
  [Class IoU]  C1: 0.2345 | C2: 0.8314 | C3: 0.6403
Epoch 250/400 | Train Loss: 28.4017
 Avg Train Loss: 28.4017 | Seg Loss: 0.2840 | Recon Loss: 0.0045
  Val mIoU: 0.5647 (Best: 0.5886)
  [Class IoU]  C1: 0.2217 | C2: 0.8368 | C3: 0.6356
Epoch 251/400 | Train Loss: 29.0947
 Avg Train Loss: 29.0947 | Seg Loss: 0.2909 | Recon Loss: 0.0045
  Val mIoU: 0.5657 (Best: 0.5886)
  [Class IoU]  C1: 0.2384 | C2: 0.8314 | C3: 0.6273
Epoch 252/400 | Train Loss: 28.2715
 Avg Train Loss: 28.2715 | Seg Loss: 0.2827 | Recon Loss: 0.0043
  Val mIoU: 0.5906 (Best: 0.5886)
  [Class IoU]  C1: 0.2357 | C2: 0.8471 | C3: 0.6889
  --> New Best Model Saved!
Epoch 253/400 | Train Loss: 29.0221
 Avg Train Loss: 29.0221 | Seg Loss: 0.2902 | Recon Loss: 0.0043
  Val mIoU: 0.5789 (Best: 0.5906)
  [Class IoU]  C1: 0.2189 | C2: 0.8448 | C3: 0.6729
Epoch 254/400 | Train Loss: 28.3282
 Avg Train Loss: 28.3282 | Seg Loss: 0.2832 | Recon Loss: 0.0044
  Val mIoU: 0.5745 (Best: 0.5906)
  [Class IoU]  C1: 0.2263 | C2: 0.8386 | C3: 0.6586
Epoch 255/400 | Train Loss: 29.0725
 Avg Train Loss: 29.0725 | Seg Loss: 0.2907 | Recon Loss: 0.0046
  Val mIoU: 0.5725 (Best: 0.5906)
  [Class IoU]  C1: 0.2304 | C2: 0.8354 | C3: 0.6517
Epoch 256/400 | Train Loss: 29.2275
 Avg Train Loss: 29.2275 | Seg Loss: 0.2922 | Recon Loss: 0.0044
  Val mIoU: 0.5790 (Best: 0.5906)
  [Class IoU]  C1: 0.2254 | C2: 0.8388 | C3: 0.6727
Epoch 257/400 | Train Loss: 29.2039
 Avg Train Loss: 29.2039 | Seg Loss: 0.2920 | Recon Loss: 0.0044
  Val mIoU: 0.5737 (Best: 0.5906)
  [Class IoU]  C1: 0.2120 | C2: 0.8416 | C3: 0.6676
Epoch 258/400 | Train Loss: 28.9528
 Avg Train Loss: 28.9528 | Seg Loss: 0.2895 | Recon Loss: 0.0044
  Val mIoU: 0.5827 (Best: 0.5906)
  [Class IoU]  C1: 0.2363 | C2: 0.8425 | C3: 0.6694
Epoch 259/400 | Train Loss: 28.6953
 Avg Train Loss: 28.6953 | Seg Loss: 0.2869 | Recon Loss: 0.0044
  Val mIoU: 0.5690 (Best: 0.5906)
  [Class IoU]  C1: 0.2270 | C2: 0.8378 | C3: 0.6421
Epoch 260/400 | Train Loss: 29.2175
 Avg Train Loss: 29.2175 | Seg Loss: 0.2921 | Recon Loss: 0.0043
  Val mIoU: 0.5792 (Best: 0.5906)
  [Class IoU]  C1: 0.2333 | C2: 0.8384 | C3: 0.6660
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 28.6371
 Avg Train Loss: 28.6371 | Seg Loss: 0.2863 | Recon Loss: 0.0045
  Val mIoU: 0.5733 (Best: 0.5906)
  [Class IoU]  C1: 0.2257 | C2: 0.8365 | C3: 0.6578
Epoch 262/400 | Train Loss: 28.8249
 Avg Train Loss: 28.8249 | Seg Loss: 0.2882 | Recon Loss: 0.0044
  Val mIoU: 0.5752 (Best: 0.5906)
  [Class IoU]  C1: 0.2354 | C2: 0.8354 | C3: 0.6547
Epoch 263/400 | Train Loss: 28.4743
 Avg Train Loss: 28.4743 | Seg Loss: 0.2847 | Recon Loss: 0.0043
  Val mIoU: 0.5653 (Best: 0.5906)
  [Class IoU]  C1: 0.2110 | C2: 0.8366 | C3: 0.6483
Epoch 264/400 | Train Loss: 28.5291
 Avg Train Loss: 28.5291 | Seg Loss: 0.2852 | Recon Loss: 0.0046
  Val mIoU: 0.5720 (Best: 0.5906)
  [Class IoU]  C1: 0.2175 | C2: 0.8409 | C3: 0.6577
Epoch 265/400 | Train Loss: 29.3195
 Avg Train Loss: 29.3195 | Seg Loss: 0.2932 | Recon Loss: 0.0045
  Val mIoU: 0.5732 (Best: 0.5906)
  [Class IoU]  C1: 0.2405 | C2: 0.8321 | C3: 0.6471
Epoch 266/400 | Train Loss: 28.6445
 Avg Train Loss: 28.6445 | Seg Loss: 0.2864 | Recon Loss: 0.0045
  Val mIoU: 0.5893 (Best: 0.5906)
  [Class IoU]  C1: 0.2339 | C2: 0.8439 | C3: 0.6902
Epoch 267/400 | Train Loss: 29.6786
 Avg Train Loss: 29.6786 | Seg Loss: 0.2967 | Recon Loss: 0.0044
  Val mIoU: 0.5664 (Best: 0.5906)
  [Class IoU]  C1: 0.2342 | C2: 0.8339 | C3: 0.6312
Epoch 268/400 | Train Loss: 28.7702
 Avg Train Loss: 28.7702 | Seg Loss: 0.2877 | Recon Loss: 0.0045
  Val mIoU: 0.5759 (Best: 0.5906)
  [Class IoU]  C1: 0.2424 | C2: 0.8343 | C3: 0.6511
Epoch 269/400 | Train Loss: 28.8733
 Avg Train Loss: 28.8733 | Seg Loss: 0.2887 | Recon Loss: 0.0044
  Val mIoU: 0.5713 (Best: 0.5906)
  [Class IoU]  C1: 0.2174 | C2: 0.8386 | C3: 0.6580
Epoch 270/400 | Train Loss: 28.6846
 Avg Train Loss: 28.6846 | Seg Loss: 0.2868 | Recon Loss: 0.0045
  Val mIoU: 0.5811 (Best: 0.5906)
  [Class IoU]  C1: 0.2354 | C2: 0.8370 | C3: 0.6708
Epoch 271/400 | Train Loss: 28.7444
 Avg Train Loss: 28.7444 | Seg Loss: 0.2874 | Recon Loss: 0.0042
  Val mIoU: 0.5858 (Best: 0.5906)
  [Class IoU]  C1: 0.2571 | C2: 0.8318 | C3: 0.6685
Epoch 272/400 | Train Loss: 28.8563
 Avg Train Loss: 28.8563 | Seg Loss: 0.2885 | Recon Loss: 0.0045
  Val mIoU: 0.5762 (Best: 0.5906)
  [Class IoU]  C1: 0.2332 | C2: 0.8357 | C3: 0.6598
Epoch 273/400 | Train Loss: 29.3732
 Avg Train Loss: 29.3732 | Seg Loss: 0.2937 | Recon Loss: 0.0045
  Val mIoU: 0.5720 (Best: 0.5906)
  [Class IoU]  C1: 0.2235 | C2: 0.8353 | C3: 0.6572
Epoch 274/400 | Train Loss: 28.9246
 Avg Train Loss: 28.9246 | Seg Loss: 0.2892 | Recon Loss: 0.0045
  Val mIoU: 0.5773 (Best: 0.5906)
  [Class IoU]  C1: 0.2258 | C2: 0.8426 | C3: 0.6634
Epoch 275/400 | Train Loss: 29.2397
 Avg Train Loss: 29.2397 | Seg Loss: 0.2924 | Recon Loss: 0.0044
  Val mIoU: 0.6033 (Best: 0.5906)
  [Class IoU]  C1: 0.2736 | C2: 0.8479 | C3: 0.6883
  --> New Best Model Saved!
Epoch 276/400 | Train Loss: 28.9437
 Avg Train Loss: 28.9437 | Seg Loss: 0.2894 | Recon Loss: 0.0045
  Val mIoU: 0.5753 (Best: 0.6033)
  [Class IoU]  C1: 0.2267 | C2: 0.8414 | C3: 0.6578
Epoch 277/400 | Train Loss: 29.1601
 Avg Train Loss: 29.1601 | Seg Loss: 0.2916 | Recon Loss: 0.0043
  Val mIoU: 0.5716 (Best: 0.6033)
  [Class IoU]  C1: 0.2123 | C2: 0.8417 | C3: 0.6608
Epoch 278/400 | Train Loss: 28.6059
 Avg Train Loss: 28.6059 | Seg Loss: 0.2860 | Recon Loss: 0.0045
  Val mIoU: 0.5807 (Best: 0.6033)
  [Class IoU]  C1: 0.2334 | C2: 0.8404 | C3: 0.6683
Epoch 279/400 | Train Loss: 29.1819
 Avg Train Loss: 29.1819 | Seg Loss: 0.2918 | Recon Loss: 0.0045
  Val mIoU: 0.5784 (Best: 0.6033)
  [Class IoU]  C1: 0.2263 | C2: 0.8399 | C3: 0.6691
Epoch 280/400 | Train Loss: 29.7169
 Avg Train Loss: 29.7169 | Seg Loss: 0.2971 | Recon Loss: 0.0043
  Val mIoU: 0.5936 (Best: 0.6033)
  [Class IoU]  C1: 0.2561 | C2: 0.8373 | C3: 0.6872
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 29.0009
 Avg Train Loss: 29.0009 | Seg Loss: 0.2900 | Recon Loss: 0.0044
  Val mIoU: 0.5786 (Best: 0.6033)
  [Class IoU]  C1: 0.2280 | C2: 0.8399 | C3: 0.6680
Epoch 282/400 | Train Loss: 28.9982
 Avg Train Loss: 28.9982 | Seg Loss: 0.2899 | Recon Loss: 0.0045
  Val mIoU: 0.5655 (Best: 0.6033)
  [Class IoU]  C1: 0.2403 | C2: 0.8292 | C3: 0.6271
Epoch 283/400 | Train Loss: 29.1122
 Avg Train Loss: 29.1122 | Seg Loss: 0.2911 | Recon Loss: 0.0043
  Val mIoU: 0.5762 (Best: 0.6033)
  [Class IoU]  C1: 0.2190 | C2: 0.8419 | C3: 0.6678
Epoch 284/400 | Train Loss: 28.9192
 Avg Train Loss: 28.9192 | Seg Loss: 0.2891 | Recon Loss: 0.0045
  Val mIoU: 0.5814 (Best: 0.6033)
  [Class IoU]  C1: 0.2493 | C2: 0.8354 | C3: 0.6594
Epoch 285/400 | Train Loss: 28.5067
 Avg Train Loss: 28.5067 | Seg Loss: 0.2850 | Recon Loss: 0.0045
  Val mIoU: 0.5797 (Best: 0.6033)
  [Class IoU]  C1: 0.2431 | C2: 0.8366 | C3: 0.6594
Epoch 286/400 | Train Loss: 28.6987
 Avg Train Loss: 28.6987 | Seg Loss: 0.2869 | Recon Loss: 0.0044
  Val mIoU: 0.5672 (Best: 0.6033)
  [Class IoU]  C1: 0.2193 | C2: 0.8361 | C3: 0.6463
Epoch 287/400 | Train Loss: 28.9589
 Avg Train Loss: 28.9589 | Seg Loss: 0.2895 | Recon Loss: 0.0044
  Val mIoU: 0.5698 (Best: 0.6033)
  [Class IoU]  C1: 0.2264 | C2: 0.8362 | C3: 0.6468
Epoch 288/400 | Train Loss: 28.2787
 Avg Train Loss: 28.2787 | Seg Loss: 0.2827 | Recon Loss: 0.0043
  Val mIoU: 0.5719 (Best: 0.6033)
  [Class IoU]  C1: 0.2420 | C2: 0.8271 | C3: 0.6467
Epoch 289/400 | Train Loss: 29.3198
 Avg Train Loss: 29.3198 | Seg Loss: 0.2932 | Recon Loss: 0.0044
  Val mIoU: 0.5690 (Best: 0.6033)
  [Class IoU]  C1: 0.2243 | C2: 0.8359 | C3: 0.6469
Epoch 290/400 | Train Loss: 28.8954
 Avg Train Loss: 28.8954 | Seg Loss: 0.2889 | Recon Loss: 0.0044
  Val mIoU: 0.5679 (Best: 0.6033)
  [Class IoU]  C1: 0.2287 | C2: 0.8340 | C3: 0.6410
Epoch 291/400 | Train Loss: 28.5741
 Avg Train Loss: 28.5741 | Seg Loss: 0.2857 | Recon Loss: 0.0044
  Val mIoU: 0.5786 (Best: 0.6033)
  [Class IoU]  C1: 0.2657 | C2: 0.8283 | C3: 0.6417
Epoch 292/400 | Train Loss: 28.8259
 Avg Train Loss: 28.8259 | Seg Loss: 0.2882 | Recon Loss: 0.0044
  Val mIoU: 0.5865 (Best: 0.6033)
  [Class IoU]  C1: 0.2409 | C2: 0.8428 | C3: 0.6756
Epoch 293/400 | Train Loss: 29.2596
 Avg Train Loss: 29.2596 | Seg Loss: 0.2926 | Recon Loss: 0.0044
  Val mIoU: 0.5802 (Best: 0.6033)
  [Class IoU]  C1: 0.2076 | C2: 0.8474 | C3: 0.6854
Epoch 294/400 | Train Loss: 28.6723
 Avg Train Loss: 28.6723 | Seg Loss: 0.2867 | Recon Loss: 0.0044
  Val mIoU: 0.5751 (Best: 0.6033)
  [Class IoU]  C1: 0.2353 | C2: 0.8362 | C3: 0.6538
Epoch 295/400 | Train Loss: 28.6605
 Avg Train Loss: 28.6605 | Seg Loss: 0.2866 | Recon Loss: 0.0043
  Val mIoU: 0.5739 (Best: 0.6033)
  [Class IoU]  C1: 0.2444 | C2: 0.8324 | C3: 0.6450
Epoch 296/400 | Train Loss: 28.5257
 Avg Train Loss: 28.5257 | Seg Loss: 0.2852 | Recon Loss: 0.0045
  Val mIoU: 0.5848 (Best: 0.6033)
  [Class IoU]  C1: 0.2477 | C2: 0.8355 | C3: 0.6713
Epoch 297/400 | Train Loss: 29.5295
 Avg Train Loss: 29.5295 | Seg Loss: 0.2952 | Recon Loss: 0.0045
  Val mIoU: 0.5729 (Best: 0.6033)
  [Class IoU]  C1: 0.2297 | C2: 0.8345 | C3: 0.6544
Epoch 298/400 | Train Loss: 29.5097
 Avg Train Loss: 29.5097 | Seg Loss: 0.2951 | Recon Loss: 0.0044
  Val mIoU: 0.5689 (Best: 0.6033)
  [Class IoU]  C1: 0.2225 | C2: 0.8384 | C3: 0.6458
Epoch 299/400 | Train Loss: 28.8381
 Avg Train Loss: 28.8381 | Seg Loss: 0.2883 | Recon Loss: 0.0043
  Val mIoU: 0.5663 (Best: 0.6033)
  [Class IoU]  C1: 0.2259 | C2: 0.8363 | C3: 0.6366
Epoch 300/400 | Train Loss: 28.8056
 Avg Train Loss: 28.8056 | Seg Loss: 0.2880 | Recon Loss: 0.0044
  Val mIoU: 0.5735 (Best: 0.6033)
  [Class IoU]  C1: 0.2260 | C2: 0.8388 | C3: 0.6558
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 28.5973
 Avg Train Loss: 28.5973 | Seg Loss: 0.2859 | Recon Loss: 0.0044
  Val mIoU: 0.5752 (Best: 0.6033)
  [Class IoU]  C1: 0.2169 | C2: 0.8425 | C3: 0.6661
Epoch 302/400 | Train Loss: 28.6860
 Avg Train Loss: 28.6860 | Seg Loss: 0.2868 | Recon Loss: 0.0044
  Val mIoU: 0.5643 (Best: 0.6033)
  [Class IoU]  C1: 0.2116 | C2: 0.8384 | C3: 0.6429
Epoch 303/400 | Train Loss: 29.0309
 Avg Train Loss: 29.0309 | Seg Loss: 0.2903 | Recon Loss: 0.0044
  Val mIoU: 0.5924 (Best: 0.6033)
  [Class IoU]  C1: 0.2519 | C2: 0.8459 | C3: 0.6795
Epoch 304/400 | Train Loss: 28.8036
 Avg Train Loss: 28.8036 | Seg Loss: 0.2880 | Recon Loss: 0.0044
  Val mIoU: 0.5802 (Best: 0.6033)
  [Class IoU]  C1: 0.2153 | C2: 0.8456 | C3: 0.6796
Epoch 305/400 | Train Loss: 28.9349
 Avg Train Loss: 28.9349 | Seg Loss: 0.2893 | Recon Loss: 0.0043
  Val mIoU: 0.5744 (Best: 0.6033)
  [Class IoU]  C1: 0.2442 | C2: 0.8339 | C3: 0.6450
Epoch 306/400 | Train Loss: 29.1103
 Avg Train Loss: 29.1103 | Seg Loss: 0.2911 | Recon Loss: 0.0044
  Val mIoU: 0.5670 (Best: 0.6033)
  [Class IoU]  C1: 0.2289 | C2: 0.8325 | C3: 0.6395
Epoch 307/400 | Train Loss: 28.4544
 Avg Train Loss: 28.4544 | Seg Loss: 0.2845 | Recon Loss: 0.0043
  Val mIoU: 0.5691 (Best: 0.6033)
  [Class IoU]  C1: 0.2231 | C2: 0.8371 | C3: 0.6470
Epoch 308/400 | Train Loss: 28.5820
 Avg Train Loss: 28.5820 | Seg Loss: 0.2858 | Recon Loss: 0.0045
  Val mIoU: 0.5822 (Best: 0.6033)
  [Class IoU]  C1: 0.2395 | C2: 0.8417 | C3: 0.6654
Epoch 309/400 | Train Loss: 28.9815
 Avg Train Loss: 28.9815 | Seg Loss: 0.2898 | Recon Loss: 0.0044
  Val mIoU: 0.5803 (Best: 0.6033)
  [Class IoU]  C1: 0.2257 | C2: 0.8425 | C3: 0.6726
Epoch 310/400 | Train Loss: 28.6318
 Avg Train Loss: 28.6318 | Seg Loss: 0.2863 | Recon Loss: 0.0043
  Val mIoU: 0.5707 (Best: 0.6033)
  [Class IoU]  C1: 0.2683 | C2: 0.8252 | C3: 0.6187
Epoch 311/400 | Train Loss: 28.5922
 Avg Train Loss: 28.5922 | Seg Loss: 0.2859 | Recon Loss: 0.0044
  Val mIoU: 0.5715 (Best: 0.6033)
  [Class IoU]  C1: 0.2123 | C2: 0.8416 | C3: 0.6605
Epoch 312/400 | Train Loss: 27.8157
 Avg Train Loss: 27.8157 | Seg Loss: 0.2781 | Recon Loss: 0.0043
  Val mIoU: 0.5651 (Best: 0.6033)
  [Class IoU]  C1: 0.1985 | C2: 0.8346 | C3: 0.6622
Epoch 313/400 | Train Loss: 29.2249
 Avg Train Loss: 29.2249 | Seg Loss: 0.2922 | Recon Loss: 0.0044
  Val mIoU: 0.5715 (Best: 0.6033)
  [Class IoU]  C1: 0.2477 | C2: 0.8326 | C3: 0.6343
Epoch 314/400 | Train Loss: 28.7782
 Avg Train Loss: 28.7782 | Seg Loss: 0.2877 | Recon Loss: 0.0044
  Val mIoU: 0.5643 (Best: 0.6033)
  [Class IoU]  C1: 0.2286 | C2: 0.8303 | C3: 0.6339
Epoch 315/400 | Train Loss: 29.0912
 Avg Train Loss: 29.0912 | Seg Loss: 0.2909 | Recon Loss: 0.0045
  Val mIoU: 0.5870 (Best: 0.6033)
  [Class IoU]  C1: 0.2191 | C2: 0.8482 | C3: 0.6938
Epoch 316/400 | Train Loss: 29.5065
 Avg Train Loss: 29.5065 | Seg Loss: 0.2950 | Recon Loss: 0.0044
  Val mIoU: 0.5662 (Best: 0.6033)
  [Class IoU]  C1: 0.2152 | C2: 0.8379 | C3: 0.6456
Epoch 317/400 | Train Loss: 29.1716
 Avg Train Loss: 29.1716 | Seg Loss: 0.2917 | Recon Loss: 0.0044
  Val mIoU: 0.5548 (Best: 0.6033)
  [Class IoU]  C1: 0.2404 | C2: 0.8183 | C3: 0.6057
Epoch 318/400 | Train Loss: 29.6429
 Avg Train Loss: 29.6429 | Seg Loss: 0.2964 | Recon Loss: 0.0045
  Val mIoU: 0.5604 (Best: 0.6033)
  [Class IoU]  C1: 0.2394 | C2: 0.8269 | C3: 0.6149
Epoch 319/400 | Train Loss: 28.4887
 Avg Train Loss: 28.4887 | Seg Loss: 0.2848 | Recon Loss: 0.0044
  Val mIoU: 0.5887 (Best: 0.6033)
  [Class IoU]  C1: 0.2349 | C2: 0.8436 | C3: 0.6877
Epoch 320/400 | Train Loss: 28.6575
 Avg Train Loss: 28.6575 | Seg Loss: 0.2865 | Recon Loss: 0.0044
  Val mIoU: 0.5837 (Best: 0.6033)
  [Class IoU]  C1: 0.2283 | C2: 0.8434 | C3: 0.6794
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 28.8328
 Avg Train Loss: 28.8328 | Seg Loss: 0.2883 | Recon Loss: 0.0044
  Val mIoU: 0.5630 (Best: 0.6033)
  [Class IoU]  C1: 0.2334 | C2: 0.8287 | C3: 0.6267
Epoch 322/400 | Train Loss: 29.3961
 Avg Train Loss: 29.3961 | Seg Loss: 0.2939 | Recon Loss: 0.0044
  Val mIoU: 0.5815 (Best: 0.6033)
  [Class IoU]  C1: 0.2290 | C2: 0.8424 | C3: 0.6732
Epoch 323/400 | Train Loss: 28.8055
 Avg Train Loss: 28.8055 | Seg Loss: 0.2880 | Recon Loss: 0.0044
  Val mIoU: 0.5580 (Best: 0.6033)
  [Class IoU]  C1: 0.2617 | C2: 0.8159 | C3: 0.5963
Epoch 324/400 | Train Loss: 29.0668
 Avg Train Loss: 29.0668 | Seg Loss: 0.2906 | Recon Loss: 0.0044
  Val mIoU: 0.5838 (Best: 0.6033)
  [Class IoU]  C1: 0.2404 | C2: 0.8434 | C3: 0.6678
Epoch 325/400 | Train Loss: 29.0330
 Avg Train Loss: 29.0330 | Seg Loss: 0.2903 | Recon Loss: 0.0043
  Val mIoU: 0.5701 (Best: 0.6033)
  [Class IoU]  C1: 0.2334 | C2: 0.8305 | C3: 0.6463
Epoch 326/400 | Train Loss: 29.2842
 Avg Train Loss: 29.2842 | Seg Loss: 0.2928 | Recon Loss: 0.0044
  Val mIoU: 0.5731 (Best: 0.6033)
  [Class IoU]  C1: 0.2268 | C2: 0.8422 | C3: 0.6502
Epoch 327/400 | Train Loss: 29.0938
 Avg Train Loss: 29.0938 | Seg Loss: 0.2909 | Recon Loss: 0.0045
  Val mIoU: 0.5719 (Best: 0.6033)
  [Class IoU]  C1: 0.2303 | C2: 0.8367 | C3: 0.6489
Epoch 328/400 | Train Loss: 29.0395
 Avg Train Loss: 29.0395 | Seg Loss: 0.2903 | Recon Loss: 0.0046
  Val mIoU: 0.5725 (Best: 0.6033)
  [Class IoU]  C1: 0.2138 | C2: 0.8426 | C3: 0.6610
Epoch 329/400 | Train Loss: 29.2782
 Avg Train Loss: 29.2782 | Seg Loss: 0.2927 | Recon Loss: 0.0044
  Val mIoU: 0.5632 (Best: 0.6033)
  [Class IoU]  C1: 0.2328 | C2: 0.8326 | C3: 0.6243
Epoch 330/400 | Train Loss: 28.4422
 Avg Train Loss: 28.4422 | Seg Loss: 0.2844 | Recon Loss: 0.0043
  Val mIoU: 0.5587 (Best: 0.6033)
  [Class IoU]  C1: 0.2258 | C2: 0.8283 | C3: 0.6220
Epoch 331/400 | Train Loss: 29.4118
 Avg Train Loss: 29.4118 | Seg Loss: 0.2941 | Recon Loss: 0.0045
  Val mIoU: 0.5754 (Best: 0.6033)
  [Class IoU]  C1: 0.2358 | C2: 0.8415 | C3: 0.6490
Epoch 332/400 | Train Loss: 29.0002
 Avg Train Loss: 29.0002 | Seg Loss: 0.2900 | Recon Loss: 0.0043
  Val mIoU: 0.5808 (Best: 0.6033)
  [Class IoU]  C1: 0.2547 | C2: 0.8291 | C3: 0.6586
Epoch 333/400 | Train Loss: 28.9623
 Avg Train Loss: 28.9623 | Seg Loss: 0.2896 | Recon Loss: 0.0044
  Val mIoU: 0.5680 (Best: 0.6033)
  [Class IoU]  C1: 0.2341 | C2: 0.8287 | C3: 0.6412
Epoch 334/400 | Train Loss: 28.9640
 Avg Train Loss: 28.9640 | Seg Loss: 0.2896 | Recon Loss: 0.0044
  Val mIoU: 0.5876 (Best: 0.6033)
  [Class IoU]  C1: 0.2416 | C2: 0.8408 | C3: 0.6805
Epoch 335/400 | Train Loss: 29.2033
 Avg Train Loss: 29.2033 | Seg Loss: 0.2920 | Recon Loss: 0.0045
  Val mIoU: 0.5874 (Best: 0.6033)
  [Class IoU]  C1: 0.2618 | C2: 0.8404 | C3: 0.6600
Epoch 336/400 | Train Loss: 29.3343
 Avg Train Loss: 29.3343 | Seg Loss: 0.2933 | Recon Loss: 0.0045
  Val mIoU: 0.5567 (Best: 0.6033)
  [Class IoU]  C1: 0.2225 | C2: 0.8295 | C3: 0.6180
Epoch 337/400 | Train Loss: 28.7245
 Avg Train Loss: 28.7245 | Seg Loss: 0.2872 | Recon Loss: 0.0043
  Val mIoU: 0.5602 (Best: 0.6033)
  [Class IoU]  C1: 0.2391 | C2: 0.8201 | C3: 0.6213
Epoch 338/400 | Train Loss: 28.5671
 Avg Train Loss: 28.5671 | Seg Loss: 0.2856 | Recon Loss: 0.0044
  Val mIoU: 0.5756 (Best: 0.6033)
  [Class IoU]  C1: 0.2319 | C2: 0.8376 | C3: 0.6573
Epoch 339/400 | Train Loss: 28.5060
 Avg Train Loss: 28.5060 | Seg Loss: 0.2850 | Recon Loss: 0.0044
  Val mIoU: 0.5504 (Best: 0.6033)
  [Class IoU]  C1: 0.2356 | C2: 0.8185 | C3: 0.5970
Epoch 340/400 | Train Loss: 28.9380
 Avg Train Loss: 28.9380 | Seg Loss: 0.2893 | Recon Loss: 0.0044
  Val mIoU: 0.5522 (Best: 0.6033)
  [Class IoU]  C1: 0.2258 | C2: 0.8256 | C3: 0.6053
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 28.6696
 Avg Train Loss: 28.6696 | Seg Loss: 0.2867 | Recon Loss: 0.0044
  Val mIoU: 0.5767 (Best: 0.6033)
  [Class IoU]  C1: 0.2372 | C2: 0.8383 | C3: 0.6544
Epoch 342/400 | Train Loss: 29.1016
 Avg Train Loss: 29.1016 | Seg Loss: 0.2910 | Recon Loss: 0.0043
  Val mIoU: 0.5685 (Best: 0.6033)
  [Class IoU]  C1: 0.2330 | C2: 0.8350 | C3: 0.6376
Epoch 343/400 | Train Loss: 29.1086
 Avg Train Loss: 29.1086 | Seg Loss: 0.2910 | Recon Loss: 0.0043
  Val mIoU: 0.5774 (Best: 0.6033)
  [Class IoU]  C1: 0.2335 | C2: 0.8352 | C3: 0.6635
Epoch 344/400 | Train Loss: 28.7744
 Avg Train Loss: 28.7744 | Seg Loss: 0.2877 | Recon Loss: 0.0045
  Val mIoU: 0.5686 (Best: 0.6033)
  [Class IoU]  C1: 0.2389 | C2: 0.8312 | C3: 0.6356
Epoch 345/400 | Train Loss: 29.2643
 Avg Train Loss: 29.2643 | Seg Loss: 0.2926 | Recon Loss: 0.0044
  Val mIoU: 0.5760 (Best: 0.6033)
  [Class IoU]  C1: 0.2224 | C2: 0.8420 | C3: 0.6635
Epoch 346/400 | Train Loss: 29.3318
 Avg Train Loss: 29.3318 | Seg Loss: 0.2933 | Recon Loss: 0.0044
  Val mIoU: 0.5758 (Best: 0.6033)
  [Class IoU]  C1: 0.2557 | C2: 0.8287 | C3: 0.6430
Epoch 347/400 | Train Loss: 29.1302
 Avg Train Loss: 29.1302 | Seg Loss: 0.2913 | Recon Loss: 0.0044
  Val mIoU: 0.5716 (Best: 0.6033)
  [Class IoU]  C1: 0.2368 | C2: 0.8316 | C3: 0.6464
Epoch 348/400 | Train Loss: 28.9387
 Avg Train Loss: 28.9387 | Seg Loss: 0.2893 | Recon Loss: 0.0044
  Val mIoU: 0.5408 (Best: 0.6033)
  [Class IoU]  C1: 0.2365 | C2: 0.8109 | C3: 0.5751
Epoch 349/400 | Train Loss: 28.8372
 Avg Train Loss: 28.8372 | Seg Loss: 0.2883 | Recon Loss: 0.0044
  Val mIoU: 0.5723 (Best: 0.6033)
  [Class IoU]  C1: 0.2311 | C2: 0.8345 | C3: 0.6512
Epoch 350/400 | Train Loss: 29.6502
 Avg Train Loss: 29.6502 | Seg Loss: 0.2965 | Recon Loss: 0.0045
  Val mIoU: 0.5682 (Best: 0.6033)
  [Class IoU]  C1: 0.2242 | C2: 0.8344 | C3: 0.6461
Epoch 351/400 | Train Loss: 28.5619
 Avg Train Loss: 28.5619 | Seg Loss: 0.2856 | Recon Loss: 0.0043
  Val mIoU: 0.5935 (Best: 0.6033)
  [Class IoU]  C1: 0.2483 | C2: 0.8419 | C3: 0.6903
Epoch 352/400 | Train Loss: 28.8889
 Avg Train Loss: 28.8889 | Seg Loss: 0.2888 | Recon Loss: 0.0044
  Val mIoU: 0.5501 (Best: 0.6033)
  [Class IoU]  C1: 0.2343 | C2: 0.8207 | C3: 0.5952
Epoch 353/400 | Train Loss: 28.6756
 Avg Train Loss: 28.6756 | Seg Loss: 0.2867 | Recon Loss: 0.0044
  Val mIoU: 0.5815 (Best: 0.6033)
  [Class IoU]  C1: 0.2312 | C2: 0.8410 | C3: 0.6724
Epoch 354/400 | Train Loss: 28.8869
 Avg Train Loss: 28.8869 | Seg Loss: 0.2888 | Recon Loss: 0.0044
  Val mIoU: 0.5870 (Best: 0.6033)
  [Class IoU]  C1: 0.2263 | C2: 0.8436 | C3: 0.6911
Epoch 355/400 | Train Loss: 28.6828
 Avg Train Loss: 28.6828 | Seg Loss: 0.2868 | Recon Loss: 0.0043
  Val mIoU: 0.5742 (Best: 0.6033)
  [Class IoU]  C1: 0.2466 | C2: 0.8245 | C3: 0.6514
Epoch 356/400 | Train Loss: 29.0036
 Avg Train Loss: 29.0036 | Seg Loss: 0.2900 | Recon Loss: 0.0046
  Val mIoU: 0.5658 (Best: 0.6033)
  [Class IoU]  C1: 0.2469 | C2: 0.8221 | C3: 0.6286
Epoch 357/400 | Train Loss: 28.9264
 Avg Train Loss: 28.9264 | Seg Loss: 0.2892 | Recon Loss: 0.0044
  Val mIoU: 0.5822 (Best: 0.6033)
  [Class IoU]  C1: 0.2387 | C2: 0.8359 | C3: 0.6720
Epoch 358/400 | Train Loss: 28.6931
 Avg Train Loss: 28.6931 | Seg Loss: 0.2869 | Recon Loss: 0.0045
  Val mIoU: 0.5752 (Best: 0.6033)
  [Class IoU]  C1: 0.2204 | C2: 0.8428 | C3: 0.6625
Epoch 359/400 | Train Loss: 29.3566
 Avg Train Loss: 29.3566 | Seg Loss: 0.2935 | Recon Loss: 0.0043
  Val mIoU: 0.5723 (Best: 0.6033)
  [Class IoU]  C1: 0.2188 | C2: 0.8422 | C3: 0.6560
Epoch 360/400 | Train Loss: 29.1734
 Avg Train Loss: 29.1734 | Seg Loss: 0.2917 | Recon Loss: 0.0044
  Val mIoU: 0.5891 (Best: 0.6033)
  [Class IoU]  C1: 0.2512 | C2: 0.8383 | C3: 0.6779
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 29.4297
 Avg Train Loss: 29.4297 | Seg Loss: 0.2943 | Recon Loss: 0.0044
  Val mIoU: 0.5717 (Best: 0.6033)
  [Class IoU]  C1: 0.2529 | C2: 0.8255 | C3: 0.6366
Epoch 362/400 | Train Loss: 28.6828
 Avg Train Loss: 28.6828 | Seg Loss: 0.2868 | Recon Loss: 0.0044
  Val mIoU: 0.5610 (Best: 0.6033)
  [Class IoU]  C1: 0.2299 | C2: 0.8327 | C3: 0.6205
Epoch 363/400 | Train Loss: 28.7280
 Avg Train Loss: 28.7280 | Seg Loss: 0.2872 | Recon Loss: 0.0045
  Val mIoU: 0.5726 (Best: 0.6033)
  [Class IoU]  C1: 0.2322 | C2: 0.8360 | C3: 0.6495
Epoch 364/400 | Train Loss: 29.5899
 Avg Train Loss: 29.5899 | Seg Loss: 0.2959 | Recon Loss: 0.0044
  Val mIoU: 0.5679 (Best: 0.6033)
  [Class IoU]  C1: 0.2263 | C2: 0.8388 | C3: 0.6386
Epoch 365/400 | Train Loss: 28.5697
 Avg Train Loss: 28.5697 | Seg Loss: 0.2857 | Recon Loss: 0.0045
  Val mIoU: 0.5931 (Best: 0.6033)
  [Class IoU]  C1: 0.2538 | C2: 0.8424 | C3: 0.6832
Epoch 366/400 | Train Loss: 29.2504
 Avg Train Loss: 29.2504 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.5524 (Best: 0.6033)
  [Class IoU]  C1: 0.2275 | C2: 0.8230 | C3: 0.6066
Epoch 367/400 | Train Loss: 28.7882
 Avg Train Loss: 28.7882 | Seg Loss: 0.2878 | Recon Loss: 0.0044
  Val mIoU: 0.5682 (Best: 0.6033)
  [Class IoU]  C1: 0.2335 | C2: 0.8312 | C3: 0.6397
Epoch 368/400 | Train Loss: 28.7039
 Avg Train Loss: 28.7039 | Seg Loss: 0.2870 | Recon Loss: 0.0044
  Val mIoU: 0.5757 (Best: 0.6033)
  [Class IoU]  C1: 0.2287 | C2: 0.8393 | C3: 0.6590
Epoch 369/400 | Train Loss: 29.2564
 Avg Train Loss: 29.2564 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.5737 (Best: 0.6033)
  [Class IoU]  C1: 0.2418 | C2: 0.8300 | C3: 0.6492
Epoch 370/400 | Train Loss: 29.2413
 Avg Train Loss: 29.2413 | Seg Loss: 0.2924 | Recon Loss: 0.0046
  Val mIoU: 0.5755 (Best: 0.6033)
  [Class IoU]  C1: 0.2291 | C2: 0.8418 | C3: 0.6557
Epoch 371/400 | Train Loss: 28.5980
 Avg Train Loss: 28.5980 | Seg Loss: 0.2859 | Recon Loss: 0.0042
  Val mIoU: 0.5736 (Best: 0.6033)
  [Class IoU]  C1: 0.2134 | C2: 0.8433 | C3: 0.6642
Epoch 372/400 | Train Loss: 28.9417
 Avg Train Loss: 28.9417 | Seg Loss: 0.2894 | Recon Loss: 0.0045
  Val mIoU: 0.5810 (Best: 0.6033)
  [Class IoU]  C1: 0.2301 | C2: 0.8420 | C3: 0.6711
Epoch 373/400 | Train Loss: 28.4279
 Avg Train Loss: 28.4279 | Seg Loss: 0.2842 | Recon Loss: 0.0043
  Val mIoU: 0.5777 (Best: 0.6033)
  [Class IoU]  C1: 0.2286 | C2: 0.8409 | C3: 0.6638
Epoch 374/400 | Train Loss: 28.6947
 Avg Train Loss: 28.6947 | Seg Loss: 0.2869 | Recon Loss: 0.0043
  Val mIoU: 0.5793 (Best: 0.6033)
  [Class IoU]  C1: 0.2118 | C2: 0.8482 | C3: 0.6781
Epoch 375/400 | Train Loss: 29.3381
 Avg Train Loss: 29.3381 | Seg Loss: 0.2933 | Recon Loss: 0.0042
  Val mIoU: 0.5641 (Best: 0.6033)
  [Class IoU]  C1: 0.2366 | C2: 0.8259 | C3: 0.6298
Epoch 376/400 | Train Loss: 29.2592
 Avg Train Loss: 29.2592 | Seg Loss: 0.2925 | Recon Loss: 0.0044
  Val mIoU: 0.5711 (Best: 0.6033)
  [Class IoU]  C1: 0.2209 | C2: 0.8397 | C3: 0.6528
Epoch 377/400 | Train Loss: 29.2386
 Avg Train Loss: 29.2386 | Seg Loss: 0.2923 | Recon Loss: 0.0044
  Val mIoU: 0.5752 (Best: 0.6033)
  [Class IoU]  C1: 0.2142 | C2: 0.8431 | C3: 0.6684
Epoch 378/400 | Train Loss: 28.7109
 Avg Train Loss: 28.7109 | Seg Loss: 0.2871 | Recon Loss: 0.0045
  Val mIoU: 0.5525 (Best: 0.6033)
  [Class IoU]  C1: 0.2315 | C2: 0.8252 | C3: 0.6008
Epoch 379/400 | Train Loss: 28.6331
 Avg Train Loss: 28.6331 | Seg Loss: 0.2863 | Recon Loss: 0.0044
  Val mIoU: 0.5663 (Best: 0.6033)
  [Class IoU]  C1: 0.2455 | C2: 0.8200 | C3: 0.6334
Epoch 380/400 | Train Loss: 29.1460
 Avg Train Loss: 29.1460 | Seg Loss: 0.2914 | Recon Loss: 0.0044
  Val mIoU: 0.5759 (Best: 0.6033)
  [Class IoU]  C1: 0.2400 | C2: 0.8347 | C3: 0.6529
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 28.7372
 Avg Train Loss: 28.7372 | Seg Loss: 0.2873 | Recon Loss: 0.0043
  Val mIoU: 0.5758 (Best: 0.6033)
  [Class IoU]  C1: 0.2113 | C2: 0.8444 | C3: 0.6717
Epoch 382/400 | Train Loss: 28.7809
 Avg Train Loss: 28.7809 | Seg Loss: 0.2878 | Recon Loss: 0.0044
  Val mIoU: 0.5568 (Best: 0.6033)
  [Class IoU]  C1: 0.2538 | C2: 0.8178 | C3: 0.5988
Epoch 383/400 | Train Loss: 28.5874
 Avg Train Loss: 28.5874 | Seg Loss: 0.2858 | Recon Loss: 0.0044
  Val mIoU: 0.5686 (Best: 0.6033)
  [Class IoU]  C1: 0.2214 | C2: 0.8362 | C3: 0.6482
Epoch 384/400 | Train Loss: 28.3222
 Avg Train Loss: 28.3222 | Seg Loss: 0.2832 | Recon Loss: 0.0042
  Val mIoU: 0.5688 (Best: 0.6033)
  [Class IoU]  C1: 0.2068 | C2: 0.8382 | C3: 0.6613
Epoch 385/400 | Train Loss: 28.3096
 Avg Train Loss: 28.3096 | Seg Loss: 0.2831 | Recon Loss: 0.0044
  Val mIoU: 0.5799 (Best: 0.6033)
  [Class IoU]  C1: 0.2433 | C2: 0.8320 | C3: 0.6645
Epoch 386/400 | Train Loss: 29.3323
 Avg Train Loss: 29.3323 | Seg Loss: 0.2933 | Recon Loss: 0.0044
  Val mIoU: 0.5820 (Best: 0.6033)
  [Class IoU]  C1: 0.2249 | C2: 0.8431 | C3: 0.6780
Epoch 387/400 | Train Loss: 29.0691
 Avg Train Loss: 29.0691 | Seg Loss: 0.2906 | Recon Loss: 0.0045
  Val mIoU: 0.5807 (Best: 0.6033)
  [Class IoU]  C1: 0.2133 | C2: 0.8478 | C3: 0.6809
Epoch 388/400 | Train Loss: 28.0359
 Avg Train Loss: 28.0359 | Seg Loss: 0.2803 | Recon Loss: 0.0043
  Val mIoU: 0.5796 (Best: 0.6033)
  [Class IoU]  C1: 0.2256 | C2: 0.8431 | C3: 0.6702
Epoch 389/400 | Train Loss: 28.6330
 Avg Train Loss: 28.6330 | Seg Loss: 0.2863 | Recon Loss: 0.0044
  Val mIoU: 0.5701 (Best: 0.6033)
  [Class IoU]  C1: 0.2400 | C2: 0.8342 | C3: 0.6363
Epoch 390/400 | Train Loss: 28.6886
 Avg Train Loss: 28.6886 | Seg Loss: 0.2868 | Recon Loss: 0.0045
  Val mIoU: 0.5701 (Best: 0.6033)
  [Class IoU]  C1: 0.2341 | C2: 0.8335 | C3: 0.6428
Epoch 391/400 | Train Loss: 28.3498
 Avg Train Loss: 28.3498 | Seg Loss: 0.2835 | Recon Loss: 0.0044
  Val mIoU: 0.5819 (Best: 0.6033)
  [Class IoU]  C1: 0.2430 | C2: 0.8424 | C3: 0.6605
Epoch 392/400 | Train Loss: 29.1791
 Avg Train Loss: 29.1791 | Seg Loss: 0.2917 | Recon Loss: 0.0044
  Val mIoU: 0.5822 (Best: 0.6033)
  [Class IoU]  C1: 0.2231 | C2: 0.8434 | C3: 0.6802
Epoch 393/400 | Train Loss: 28.9020
 Avg Train Loss: 28.9020 | Seg Loss: 0.2890 | Recon Loss: 0.0044
  Val mIoU: 0.5770 (Best: 0.6033)
  [Class IoU]  C1: 0.2390 | C2: 0.8358 | C3: 0.6563
Epoch 394/400 | Train Loss: 28.5696
 Avg Train Loss: 28.5696 | Seg Loss: 0.2857 | Recon Loss: 0.0043
  Val mIoU: 0.5751 (Best: 0.6033)
  [Class IoU]  C1: 0.2284 | C2: 0.8377 | C3: 0.6592
Epoch 395/400 | Train Loss: 29.0663
 Avg Train Loss: 29.0663 | Seg Loss: 0.2906 | Recon Loss: 0.0043
  Val mIoU: 0.5794 (Best: 0.6033)
  [Class IoU]  C1: 0.2398 | C2: 0.8306 | C3: 0.6679
Epoch 396/400 | Train Loss: 28.9677
 Avg Train Loss: 28.9677 | Seg Loss: 0.2896 | Recon Loss: 0.0043
  Val mIoU: 0.5726 (Best: 0.6033)
  [Class IoU]  C1: 0.2368 | C2: 0.8347 | C3: 0.6463
Epoch 397/400 | Train Loss: 29.1141
 Avg Train Loss: 29.1141 | Seg Loss: 0.2911 | Recon Loss: 0.0044
  Val mIoU: 0.5727 (Best: 0.6033)
  [Class IoU]  C1: 0.2253 | C2: 0.8416 | C3: 0.6513
Epoch 398/400 | Train Loss: 29.3534
 Avg Train Loss: 29.3534 | Seg Loss: 0.2935 | Recon Loss: 0.0045
  Val mIoU: 0.5752 (Best: 0.6033)
  [Class IoU]  C1: 0.2537 | C2: 0.8248 | C3: 0.6470
Epoch 399/400 | Train Loss: 29.7004
 Avg Train Loss: 29.7004 | Seg Loss: 0.2970 | Recon Loss: 0.0045
  Val mIoU: 0.5756 (Best: 0.6033)
  [Class IoU]  C1: 0.2546 | C2: 0.8225 | C3: 0.6496
Epoch 400/400 | Train Loss: 29.5447
 Avg Train Loss: 29.5447 | Seg Loss: 0.2954 | Recon Loss: 0.0045
  Val mIoU: 0.5873 (Best: 0.6033)
  [Class IoU]  C1: 0.2574 | C2: 0.8297 | C3: 0.6748
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights...
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27219194: <AG_job> in cluster <dcc> Done

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Sun Nov 30 13:13:11 2025
Job was executed on host(s) <8*n-62-13-18>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Sun Nov 30 13:13:12 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Sun Nov 30 13:13:12 2025
Terminated at Sun Nov 30 18:57:26 2025
Results reported at Sun Nov 30 18:57:26 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   96122.00 sec.
    Max Memory :                                 2570 MB
    Average Memory :                             1975.32 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               521718.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                139
    Run time :                                   20707 sec.
    Turnaround time :                            20655 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27219194.err> for stderr output of this job.

