Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 4.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/400 | Train Loss: 69.2222
 Avg Train Loss: 69.2222 | Seg Loss: 0.6895 | Recon Loss: 0.2744
  Val mIoU: 0.1996 (Best: 0.0000)
  [Class IoU]  C1: 0.1127 | C2: 0.3448 | C3: 0.1415
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 58.7406
 Avg Train Loss: 58.7406 | Seg Loss: 0.5862 | Recon Loss: 0.1212
  Val mIoU: 0.4594 (Best: 0.1996)
  [Class IoU]  C1: 0.2685 | C2: 0.5838 | C3: 0.5259
  --> New Best Model Saved!
Epoch 3/400 | Train Loss: 55.5080
 Avg Train Loss: 55.5080 | Seg Loss: 0.5544 | Recon Loss: 0.0672
  Val mIoU: 0.4212 (Best: 0.4594)
  [Class IoU]  C1: 0.0672 | C2: 0.7448 | C3: 0.4516
Epoch 4/400 | Train Loss: 52.9271
 Avg Train Loss: 52.9271 | Seg Loss: 0.5288 | Recon Loss: 0.0435
  Val mIoU: 0.6932 (Best: 0.4594)
  [Class IoU]  C1: 0.8987 | C2: 0.7470 | C3: 0.4339
  --> New Best Model Saved!
Epoch 5/400 | Train Loss: 50.7935
 Avg Train Loss: 50.7935 | Seg Loss: 0.5076 | Recon Loss: 0.0328
  Val mIoU: 0.5940 (Best: 0.6932)
  [Class IoU]  C1: 0.9114 | C2: 0.7196 | C3: 0.1511
Epoch 6/400 | Train Loss: 48.8663
 Avg Train Loss: 48.8663 | Seg Loss: 0.4884 | Recon Loss: 0.0269
  Val mIoU: 0.5829 (Best: 0.6932)
  [Class IoU]  C1: 0.8590 | C2: 0.7066 | C3: 0.1831
Epoch 7/400 | Train Loss: 47.3239
 Avg Train Loss: 47.3239 | Seg Loss: 0.4730 | Recon Loss: 0.0242
  Val mIoU: 0.7581 (Best: 0.6932)
  [Class IoU]  C1: 0.9020 | C2: 0.8234 | C3: 0.5488
  --> New Best Model Saved!
Epoch 8/400 | Train Loss: 46.6914
 Avg Train Loss: 46.6914 | Seg Loss: 0.4667 | Recon Loss: 0.0227
  Val mIoU: 0.5064 (Best: 0.7581)
  [Class IoU]  C1: 0.7301 | C2: 0.4669 | C3: 0.3221
Epoch 9/400 | Train Loss: 45.0137
 Avg Train Loss: 45.0137 | Seg Loss: 0.4499 | Recon Loss: 0.0214
  Val mIoU: 0.6840 (Best: 0.7581)
  [Class IoU]  C1: 0.8837 | C2: 0.7632 | C3: 0.4051
Epoch 10/400 | Train Loss: 44.1831
 Avg Train Loss: 44.1831 | Seg Loss: 0.4416 | Recon Loss: 0.0202
  Val mIoU: 0.6762 (Best: 0.7581)
  [Class IoU]  C1: 0.8975 | C2: 0.6969 | C3: 0.4342
Epoch 11/400 | Train Loss: 42.9038
 Avg Train Loss: 42.9038 | Seg Loss: 0.4288 | Recon Loss: 0.0192
  Val mIoU: 0.7216 (Best: 0.7581)
  [Class IoU]  C1: 0.9200 | C2: 0.7697 | C3: 0.4749
Epoch 12/400 | Train Loss: 42.6088
 Avg Train Loss: 42.6088 | Seg Loss: 0.4259 | Recon Loss: 0.0182
  Val mIoU: 0.7502 (Best: 0.7581)
  [Class IoU]  C1: 0.9227 | C2: 0.7971 | C3: 0.5309
Epoch 13/400 | Train Loss: 42.2576
 Avg Train Loss: 42.2576 | Seg Loss: 0.4224 | Recon Loss: 0.0183
  Val mIoU: 0.6562 (Best: 0.7581)
  [Class IoU]  C1: 0.9182 | C2: 0.6704 | C3: 0.3801
Epoch 14/400 | Train Loss: 41.1274
 Avg Train Loss: 41.1274 | Seg Loss: 0.4111 | Recon Loss: 0.0174
  Val mIoU: 0.6623 (Best: 0.7581)
  [Class IoU]  C1: 0.9122 | C2: 0.7453 | C3: 0.3293
Epoch 15/400 | Train Loss: 40.6364
 Avg Train Loss: 40.6364 | Seg Loss: 0.4062 | Recon Loss: 0.0167
  Val mIoU: 0.7700 (Best: 0.7581)
  [Class IoU]  C1: 0.9250 | C2: 0.8089 | C3: 0.5761
  --> New Best Model Saved!
Epoch 16/400 | Train Loss: 39.6768
 Avg Train Loss: 39.6768 | Seg Loss: 0.3966 | Recon Loss: 0.0165
  Val mIoU: 0.7350 (Best: 0.7700)
  [Class IoU]  C1: 0.9268 | C2: 0.7537 | C3: 0.5246
Epoch 17/400 | Train Loss: 40.0846
 Avg Train Loss: 40.0846 | Seg Loss: 0.4007 | Recon Loss: 0.0161
  Val mIoU: 0.6679 (Best: 0.7700)
  [Class IoU]  C1: 0.9183 | C2: 0.6824 | C3: 0.4031
Epoch 18/400 | Train Loss: 38.9568
 Avg Train Loss: 38.9568 | Seg Loss: 0.3894 | Recon Loss: 0.0172
  Val mIoU: 0.7817 (Best: 0.7700)
  [Class IoU]  C1: 0.9254 | C2: 0.8220 | C3: 0.5976
  --> New Best Model Saved!
Epoch 19/400 | Train Loss: 38.2974
 Avg Train Loss: 38.2974 | Seg Loss: 0.3828 | Recon Loss: 0.0157
  Val mIoU: 0.7345 (Best: 0.7817)
  [Class IoU]  C1: 0.9238 | C2: 0.7309 | C3: 0.5487
Epoch 20/400 | Train Loss: 37.4999
 Avg Train Loss: 37.4999 | Seg Loss: 0.3748 | Recon Loss: 0.0151
  Val mIoU: 0.7126 (Best: 0.7817)
  [Class IoU]  C1: 0.8747 | C2: 0.7623 | C3: 0.5008
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 37.5249
 Avg Train Loss: 37.5249 | Seg Loss: 0.3751 | Recon Loss: 0.0151
  Val mIoU: 0.7787 (Best: 0.7817)
  [Class IoU]  C1: 0.9234 | C2: 0.8179 | C3: 0.5948
Epoch 22/400 | Train Loss: 37.0048
 Avg Train Loss: 37.0048 | Seg Loss: 0.3699 | Recon Loss: 0.0145
  Val mIoU: 0.7750 (Best: 0.7817)
  [Class IoU]  C1: 0.9277 | C2: 0.8016 | C3: 0.5957
Epoch 23/400 | Train Loss: 36.6959
 Avg Train Loss: 36.6959 | Seg Loss: 0.3668 | Recon Loss: 0.0146
  Val mIoU: 0.6559 (Best: 0.7817)
  [Class IoU]  C1: 0.9149 | C2: 0.6663 | C3: 0.3866
Epoch 24/400 | Train Loss: 37.0497
 Avg Train Loss: 37.0497 | Seg Loss: 0.3704 | Recon Loss: 0.0144
  Val mIoU: 0.5285 (Best: 0.7817)
  [Class IoU]  C1: 0.5474 | C2: 0.6733 | C3: 0.3647
Epoch 25/400 | Train Loss: 36.6524
 Avg Train Loss: 36.6524 | Seg Loss: 0.3664 | Recon Loss: 0.0141
  Val mIoU: 0.5923 (Best: 0.7817)
  [Class IoU]  C1: 0.9164 | C2: 0.5155 | C3: 0.3452
Epoch 26/400 | Train Loss: 35.7733
 Avg Train Loss: 35.7733 | Seg Loss: 0.3576 | Recon Loss: 0.0138
  Val mIoU: 0.6357 (Best: 0.7817)
  [Class IoU]  C1: 0.9196 | C2: 0.6305 | C3: 0.3569
Epoch 27/400 | Train Loss: 35.3039
 Avg Train Loss: 35.3039 | Seg Loss: 0.3529 | Recon Loss: 0.0136
  Val mIoU: 0.7338 (Best: 0.7817)
  [Class IoU]  C1: 0.9229 | C2: 0.7811 | C3: 0.4973
Epoch 28/400 | Train Loss: 34.8244
 Avg Train Loss: 34.8244 | Seg Loss: 0.3481 | Recon Loss: 0.0134
  Val mIoU: 0.6867 (Best: 0.7817)
  [Class IoU]  C1: 0.9124 | C2: 0.7212 | C3: 0.4266
Epoch 29/400 | Train Loss: 35.1084
 Avg Train Loss: 35.1084 | Seg Loss: 0.3510 | Recon Loss: 0.0126
  Val mIoU: 0.7469 (Best: 0.7817)
  [Class IoU]  C1: 0.9226 | C2: 0.8229 | C3: 0.4951
Epoch 30/400 | Train Loss: 34.2850
 Avg Train Loss: 34.2850 | Seg Loss: 0.3427 | Recon Loss: 0.0128
  Val mIoU: 0.6745 (Best: 0.7817)
  [Class IoU]  C1: 0.6257 | C2: 0.8339 | C3: 0.5640
Epoch 31/400 | Train Loss: 34.4737
 Avg Train Loss: 34.4737 | Seg Loss: 0.3446 | Recon Loss: 0.0126
  Val mIoU: 0.7191 (Best: 0.7817)
  [Class IoU]  C1: 0.9154 | C2: 0.8033 | C3: 0.4385
Epoch 32/400 | Train Loss: 34.0180
 Avg Train Loss: 34.0180 | Seg Loss: 0.3401 | Recon Loss: 0.0125
  Val mIoU: 0.7727 (Best: 0.7817)
  [Class IoU]  C1: 0.9254 | C2: 0.7716 | C3: 0.6212
Epoch 33/400 | Train Loss: 34.2774
 Avg Train Loss: 34.2774 | Seg Loss: 0.3426 | Recon Loss: 0.0128
  Val mIoU: 0.5819 (Best: 0.7817)
  [Class IoU]  C1: 0.3791 | C2: 0.8168 | C3: 0.5498
Epoch 34/400 | Train Loss: 34.3729
 Avg Train Loss: 34.3729 | Seg Loss: 0.3436 | Recon Loss: 0.0127
  Val mIoU: 0.7656 (Best: 0.7817)
  [Class IoU]  C1: 0.9253 | C2: 0.7619 | C3: 0.6095
Epoch 35/400 | Train Loss: 33.3535
 Avg Train Loss: 33.3535 | Seg Loss: 0.3334 | Recon Loss: 0.0123
  Val mIoU: 0.7819 (Best: 0.7817)
  [Class IoU]  C1: 0.9196 | C2: 0.8411 | C3: 0.5848
  --> New Best Model Saved!
Epoch 36/400 | Train Loss: 33.7267
 Avg Train Loss: 33.7267 | Seg Loss: 0.3371 | Recon Loss: 0.0120
  Val mIoU: 0.7966 (Best: 0.7819)
  [Class IoU]  C1: 0.9257 | C2: 0.8401 | C3: 0.6242
  --> New Best Model Saved!
Epoch 37/400 | Train Loss: 32.6776
 Avg Train Loss: 32.6776 | Seg Loss: 0.3267 | Recon Loss: 0.0114
  Val mIoU: 0.7332 (Best: 0.7966)
  [Class IoU]  C1: 0.9234 | C2: 0.7710 | C3: 0.5051
Epoch 38/400 | Train Loss: 33.6165
 Avg Train Loss: 33.6165 | Seg Loss: 0.3360 | Recon Loss: 0.0118
  Val mIoU: 0.7642 (Best: 0.7966)
  [Class IoU]  C1: 0.9275 | C2: 0.7778 | C3: 0.5874
Epoch 39/400 | Train Loss: 32.3747
 Avg Train Loss: 32.3747 | Seg Loss: 0.3236 | Recon Loss: 0.0120
  Val mIoU: 0.7544 (Best: 0.7966)
  [Class IoU]  C1: 0.9154 | C2: 0.7793 | C3: 0.5685
Epoch 40/400 | Train Loss: 31.9335
 Avg Train Loss: 31.9335 | Seg Loss: 0.3192 | Recon Loss: 0.0116
  Val mIoU: 0.7664 (Best: 0.7966)
  [Class IoU]  C1: 0.8739 | C2: 0.8098 | C3: 0.6157
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 32.3689
 Avg Train Loss: 32.3689 | Seg Loss: 0.3236 | Recon Loss: 0.0112
  Val mIoU: 0.5881 (Best: 0.7966)
  [Class IoU]  C1: 0.3032 | C2: 0.8266 | C3: 0.6344
Epoch 42/400 | Train Loss: 32.6741
 Avg Train Loss: 32.6741 | Seg Loss: 0.3266 | Recon Loss: 0.0114
  Val mIoU: 0.7935 (Best: 0.7966)
  [Class IoU]  C1: 0.8534 | C2: 0.8482 | C3: 0.6789
Epoch 43/400 | Train Loss: 32.6136
 Avg Train Loss: 32.6136 | Seg Loss: 0.3260 | Recon Loss: 0.0111
  Val mIoU: 0.7863 (Best: 0.7966)
  [Class IoU]  C1: 0.9241 | C2: 0.8216 | C3: 0.6132
Epoch 44/400 | Train Loss: 32.0415
 Avg Train Loss: 32.0415 | Seg Loss: 0.3203 | Recon Loss: 0.0113
  Val mIoU: 0.7327 (Best: 0.7966)
  [Class IoU]  C1: 0.8200 | C2: 0.8161 | C3: 0.5621
Epoch 45/400 | Train Loss: 32.4136
 Avg Train Loss: 32.4136 | Seg Loss: 0.3240 | Recon Loss: 0.0113
  Val mIoU: 0.6238 (Best: 0.7966)
  [Class IoU]  C1: 0.3790 | C2: 0.8508 | C3: 0.6416
Epoch 46/400 | Train Loss: 32.5238
 Avg Train Loss: 32.5238 | Seg Loss: 0.3251 | Recon Loss: 0.0110
  Val mIoU: 0.5781 (Best: 0.7966)
  [Class IoU]  C1: 0.2878 | C2: 0.8291 | C3: 0.6174
Epoch 47/400 | Train Loss: 32.4123
 Avg Train Loss: 32.4123 | Seg Loss: 0.3240 | Recon Loss: 0.0111
  Val mIoU: 0.7578 (Best: 0.7966)
  [Class IoU]  C1: 0.9121 | C2: 0.7780 | C3: 0.5831
Epoch 48/400 | Train Loss: 31.9526
 Avg Train Loss: 31.9526 | Seg Loss: 0.3194 | Recon Loss: 0.0109
  Val mIoU: 0.7709 (Best: 0.7966)
  [Class IoU]  C1: 0.9222 | C2: 0.7783 | C3: 0.6120
Epoch 49/400 | Train Loss: 32.2356
 Avg Train Loss: 32.2356 | Seg Loss: 0.3222 | Recon Loss: 0.0113
  Val mIoU: 0.5658 (Best: 0.7966)
  [Class IoU]  C1: 0.2947 | C2: 0.8079 | C3: 0.5948
Epoch 50/400 | Train Loss: 31.8143
 Avg Train Loss: 31.8143 | Seg Loss: 0.3180 | Recon Loss: 0.0111
  Val mIoU: 0.7959 (Best: 0.7966)
  [Class IoU]  C1: 0.9265 | C2: 0.8237 | C3: 0.6377
Epoch 51/400 | Train Loss: 31.4792
 Avg Train Loss: 31.4792 | Seg Loss: 0.3147 | Recon Loss: 0.0109
  Val mIoU: 0.5361 (Best: 0.7966)
  [Class IoU]  C1: 0.2859 | C2: 0.7693 | C3: 0.5530
Epoch 52/400 | Train Loss: 32.5310
 Avg Train Loss: 32.5310 | Seg Loss: 0.3252 | Recon Loss: 0.0108
  Val mIoU: 0.7375 (Best: 0.7966)
  [Class IoU]  C1: 0.7514 | C2: 0.8241 | C3: 0.6371
Epoch 53/400 | Train Loss: 31.1292
 Avg Train Loss: 31.1292 | Seg Loss: 0.3112 | Recon Loss: 0.0109
  Val mIoU: 0.7691 (Best: 0.7966)
  [Class IoU]  C1: 0.9163 | C2: 0.8381 | C3: 0.5530
Epoch 54/400 | Train Loss: 30.9745
 Avg Train Loss: 30.9745 | Seg Loss: 0.3096 | Recon Loss: 0.0107
  Val mIoU: 0.8023 (Best: 0.7966)
  [Class IoU]  C1: 0.9225 | C2: 0.8450 | C3: 0.6394
  --> New Best Model Saved!
Epoch 55/400 | Train Loss: 31.1826
 Avg Train Loss: 31.1826 | Seg Loss: 0.3117 | Recon Loss: 0.0105
  Val mIoU: 0.7961 (Best: 0.8023)
  [Class IoU]  C1: 0.8962 | C2: 0.8485 | C3: 0.6435
Epoch 56/400 | Train Loss: 31.7107
 Avg Train Loss: 31.7107 | Seg Loss: 0.3170 | Recon Loss: 0.0104
  Val mIoU: 0.7957 (Best: 0.8023)
  [Class IoU]  C1: 0.8895 | C2: 0.8531 | C3: 0.6445
Epoch 57/400 | Train Loss: 31.4112
 Avg Train Loss: 31.4112 | Seg Loss: 0.3140 | Recon Loss: 0.0106
  Val mIoU: 0.5766 (Best: 0.8023)
  [Class IoU]  C1: 0.2314 | C2: 0.8406 | C3: 0.6578
Epoch 58/400 | Train Loss: 31.3301
 Avg Train Loss: 31.3301 | Seg Loss: 0.3132 | Recon Loss: 0.0104
  Val mIoU: 0.6138 (Best: 0.8023)
  [Class IoU]  C1: 0.3281 | C2: 0.8447 | C3: 0.6687
Epoch 59/400 | Train Loss: 30.4085
 Avg Train Loss: 30.4085 | Seg Loss: 0.3040 | Recon Loss: 0.0104
  Val mIoU: 0.7473 (Best: 0.8023)
  [Class IoU]  C1: 0.9095 | C2: 0.7949 | C3: 0.5374
Epoch 60/400 | Train Loss: 30.6920
 Avg Train Loss: 30.6920 | Seg Loss: 0.3068 | Recon Loss: 0.0105
  Val mIoU: 0.6532 (Best: 0.8023)
  [Class IoU]  C1: 0.7665 | C2: 0.7481 | C3: 0.4450
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 31.0670
 Avg Train Loss: 31.0670 | Seg Loss: 0.3106 | Recon Loss: 0.0104
  Val mIoU: 0.7787 (Best: 0.8023)
  [Class IoU]  C1: 0.9181 | C2: 0.8341 | C3: 0.5837
Epoch 62/400 | Train Loss: 30.9213
 Avg Train Loss: 30.9213 | Seg Loss: 0.3091 | Recon Loss: 0.0104
  Val mIoU: 0.7737 (Best: 0.8023)
  [Class IoU]  C1: 0.8855 | C2: 0.8391 | C3: 0.5966
Epoch 63/400 | Train Loss: 30.8969
 Avg Train Loss: 30.8969 | Seg Loss: 0.3089 | Recon Loss: 0.0101
  Val mIoU: 0.7924 (Best: 0.8023)
  [Class IoU]  C1: 0.8857 | C2: 0.8314 | C3: 0.6601
Epoch 64/400 | Train Loss: 30.8745
 Avg Train Loss: 30.8745 | Seg Loss: 0.3086 | Recon Loss: 0.0101
  Val mIoU: 0.8115 (Best: 0.8023)
  [Class IoU]  C1: 0.9239 | C2: 0.8264 | C3: 0.6842
  --> New Best Model Saved!
Epoch 65/400 | Train Loss: 30.2290
 Avg Train Loss: 30.2290 | Seg Loss: 0.3022 | Recon Loss: 0.0101
  Val mIoU: 0.7243 (Best: 0.8115)
  [Class IoU]  C1: 0.6573 | C2: 0.8510 | C3: 0.6646
Epoch 66/400 | Train Loss: 30.0642
 Avg Train Loss: 30.0642 | Seg Loss: 0.3005 | Recon Loss: 0.0102
  Val mIoU: 0.7816 (Best: 0.8115)
  [Class IoU]  C1: 0.9186 | C2: 0.8331 | C3: 0.5932
Epoch 67/400 | Train Loss: 30.8835
 Avg Train Loss: 30.8835 | Seg Loss: 0.3087 | Recon Loss: 0.0100
  Val mIoU: 0.7624 (Best: 0.8115)
  [Class IoU]  C1: 0.8170 | C2: 0.8467 | C3: 0.6236
Epoch 68/400 | Train Loss: 30.0956
 Avg Train Loss: 30.0956 | Seg Loss: 0.3009 | Recon Loss: 0.0100
  Val mIoU: 0.7858 (Best: 0.8115)
  [Class IoU]  C1: 0.9289 | C2: 0.8315 | C3: 0.5971
Epoch 69/400 | Train Loss: 30.7533
 Avg Train Loss: 30.7533 | Seg Loss: 0.3074 | Recon Loss: 0.0100
  Val mIoU: 0.7692 (Best: 0.8115)
  [Class IoU]  C1: 0.9038 | C2: 0.7971 | C3: 0.6067
Epoch 70/400 | Train Loss: 30.3101
 Avg Train Loss: 30.3101 | Seg Loss: 0.3030 | Recon Loss: 0.0099
  Val mIoU: 0.7526 (Best: 0.8115)
  [Class IoU]  C1: 0.9255 | C2: 0.7965 | C3: 0.5358
Epoch 71/400 | Train Loss: 30.3841
 Avg Train Loss: 30.3841 | Seg Loss: 0.3037 | Recon Loss: 0.0100
  Val mIoU: 0.7602 (Best: 0.8115)
  [Class IoU]  C1: 0.9094 | C2: 0.8197 | C3: 0.5514
Epoch 72/400 | Train Loss: 30.1281
 Avg Train Loss: 30.1281 | Seg Loss: 0.3012 | Recon Loss: 0.0099
  Val mIoU: 0.5994 (Best: 0.8115)
  [Class IoU]  C1: 0.4145 | C2: 0.8181 | C3: 0.5655
Epoch 73/400 | Train Loss: 30.2905
 Avg Train Loss: 30.2905 | Seg Loss: 0.3028 | Recon Loss: 0.0101
  Val mIoU: 0.5612 (Best: 0.8115)
  [Class IoU]  C1: 0.2980 | C2: 0.8181 | C3: 0.5675
Epoch 74/400 | Train Loss: 31.1125
 Avg Train Loss: 31.1125 | Seg Loss: 0.3110 | Recon Loss: 0.0098
  Val mIoU: 0.5860 (Best: 0.8115)
  [Class IoU]  C1: 0.2584 | C2: 0.8368 | C3: 0.6627
Epoch 75/400 | Train Loss: 29.9636
 Avg Train Loss: 29.9636 | Seg Loss: 0.2995 | Recon Loss: 0.0096
  Val mIoU: 0.5687 (Best: 0.8115)
  [Class IoU]  C1: 0.2912 | C2: 0.8197 | C3: 0.5952
Epoch 76/400 | Train Loss: 30.0662
 Avg Train Loss: 30.0662 | Seg Loss: 0.3006 | Recon Loss: 0.0096
  Val mIoU: 0.8156 (Best: 0.8115)
  [Class IoU]  C1: 0.9207 | C2: 0.8589 | C3: 0.6671
  --> New Best Model Saved!
Epoch 77/400 | Train Loss: 29.7018
 Avg Train Loss: 29.7018 | Seg Loss: 0.2969 | Recon Loss: 0.0095
  Val mIoU: 0.8095 (Best: 0.8156)
  [Class IoU]  C1: 0.9157 | C2: 0.8466 | C3: 0.6662
Epoch 78/400 | Train Loss: 29.6311
 Avg Train Loss: 29.6311 | Seg Loss: 0.2962 | Recon Loss: 0.0094
  Val mIoU: 0.7905 (Best: 0.8156)
  [Class IoU]  C1: 0.9260 | C2: 0.8388 | C3: 0.6066
Epoch 79/400 | Train Loss: 30.1247
 Avg Train Loss: 30.1247 | Seg Loss: 0.3012 | Recon Loss: 0.0097
  Val mIoU: 0.7971 (Best: 0.8156)
  [Class IoU]  C1: 0.9154 | C2: 0.8515 | C3: 0.6244
Epoch 80/400 | Train Loss: 30.8582
 Avg Train Loss: 30.8582 | Seg Loss: 0.3085 | Recon Loss: 0.0095
  Val mIoU: 0.6646 (Best: 0.8156)
  [Class IoU]  C1: 0.5677 | C2: 0.8309 | C3: 0.5952
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 29.5698
 Avg Train Loss: 29.5698 | Seg Loss: 0.2956 | Recon Loss: 0.0093
  Val mIoU: 0.6660 (Best: 0.8156)
  [Class IoU]  C1: 0.7638 | C2: 0.7844 | C3: 0.4498
Epoch 82/400 | Train Loss: 30.2450
 Avg Train Loss: 30.2450 | Seg Loss: 0.3024 | Recon Loss: 0.0093
  Val mIoU: 0.5989 (Best: 0.8156)
  [Class IoU]  C1: 0.2939 | C2: 0.8310 | C3: 0.6718
Epoch 83/400 | Train Loss: 30.2516
 Avg Train Loss: 30.2516 | Seg Loss: 0.3024 | Recon Loss: 0.0095
  Val mIoU: 0.6041 (Best: 0.8156)
  [Class IoU]  C1: 0.3994 | C2: 0.8208 | C3: 0.5920
Epoch 84/400 | Train Loss: 29.9092
 Avg Train Loss: 29.9092 | Seg Loss: 0.2990 | Recon Loss: 0.0092
  Val mIoU: 0.5767 (Best: 0.8156)
  [Class IoU]  C1: 0.2833 | C2: 0.8167 | C3: 0.6299
Epoch 85/400 | Train Loss: 28.9518
 Avg Train Loss: 28.9518 | Seg Loss: 0.2894 | Recon Loss: 0.0093
  Val mIoU: 0.8166 (Best: 0.8156)
  [Class IoU]  C1: 0.9144 | C2: 0.8591 | C3: 0.6762
  --> New Best Model Saved!
Epoch 86/400 | Train Loss: 29.6592
 Avg Train Loss: 29.6592 | Seg Loss: 0.2965 | Recon Loss: 0.0094
  Val mIoU: 0.8259 (Best: 0.8166)
  [Class IoU]  C1: 0.8939 | C2: 0.8650 | C3: 0.7187
  --> New Best Model Saved!
Epoch 87/400 | Train Loss: 30.4154
 Avg Train Loss: 30.4154 | Seg Loss: 0.3041 | Recon Loss: 0.0091
  Val mIoU: 0.8234 (Best: 0.8259)
  [Class IoU]  C1: 0.9205 | C2: 0.8520 | C3: 0.6977
Epoch 88/400 | Train Loss: 30.2828
 Avg Train Loss: 30.2828 | Seg Loss: 0.3027 | Recon Loss: 0.0091
  Val mIoU: 0.7435 (Best: 0.8259)
  [Class IoU]  C1: 0.7510 | C2: 0.8461 | C3: 0.6332
Epoch 89/400 | Train Loss: 28.9596
 Avg Train Loss: 28.9596 | Seg Loss: 0.2895 | Recon Loss: 0.0091
  Val mIoU: 0.7153 (Best: 0.8259)
  [Class IoU]  C1: 0.6676 | C2: 0.8450 | C3: 0.6333
Epoch 90/400 | Train Loss: 28.8751
 Avg Train Loss: 28.8751 | Seg Loss: 0.2887 | Recon Loss: 0.0090
  Val mIoU: 0.7941 (Best: 0.8259)
  [Class IoU]  C1: 0.9248 | C2: 0.8469 | C3: 0.6106
Epoch 91/400 | Train Loss: 28.8474
 Avg Train Loss: 28.8474 | Seg Loss: 0.2884 | Recon Loss: 0.0091
  Val mIoU: 0.8234 (Best: 0.8259)
  [Class IoU]  C1: 0.8936 | C2: 0.8667 | C3: 0.7099
Epoch 92/400 | Train Loss: 29.1422
 Avg Train Loss: 29.1422 | Seg Loss: 0.2913 | Recon Loss: 0.0091
  Val mIoU: 0.8326 (Best: 0.8259)
  [Class IoU]  C1: 0.9213 | C2: 0.8732 | C3: 0.7033
  --> New Best Model Saved!
Epoch 93/400 | Train Loss: 29.6501
 Avg Train Loss: 29.6501 | Seg Loss: 0.2964 | Recon Loss: 0.0089
  Val mIoU: 0.8324 (Best: 0.8326)
  [Class IoU]  C1: 0.9272 | C2: 0.8720 | C3: 0.6980
Epoch 94/400 | Train Loss: 29.1160
 Avg Train Loss: 29.1160 | Seg Loss: 0.2911 | Recon Loss: 0.0088
  Val mIoU: 0.8374 (Best: 0.8326)
  [Class IoU]  C1: 0.9265 | C2: 0.8790 | C3: 0.7067
  --> New Best Model Saved!
Epoch 95/400 | Train Loss: 29.2681
 Avg Train Loss: 29.2681 | Seg Loss: 0.2926 | Recon Loss: 0.0090
  Val mIoU: 0.8062 (Best: 0.8374)
  [Class IoU]  C1: 0.8957 | C2: 0.8595 | C3: 0.6635
Epoch 96/400 | Train Loss: 29.5609
 Avg Train Loss: 29.5609 | Seg Loss: 0.2955 | Recon Loss: 0.0087
  Val mIoU: 0.8231 (Best: 0.8374)
  [Class IoU]  C1: 0.9289 | C2: 0.8657 | C3: 0.6748
Epoch 97/400 | Train Loss: 29.9532
 Avg Train Loss: 29.9532 | Seg Loss: 0.2994 | Recon Loss: 0.0086
  Val mIoU: 0.8366 (Best: 0.8374)
  [Class IoU]  C1: 0.9257 | C2: 0.8696 | C3: 0.7143
Epoch 98/400 | Train Loss: 28.8023
 Avg Train Loss: 28.8023 | Seg Loss: 0.2879 | Recon Loss: 0.0087
  Val mIoU: 0.7371 (Best: 0.8374)
  [Class IoU]  C1: 0.7275 | C2: 0.8583 | C3: 0.6255
Epoch 99/400 | Train Loss: 29.7631
 Avg Train Loss: 29.7631 | Seg Loss: 0.2975 | Recon Loss: 0.0087
  Val mIoU: 0.8281 (Best: 0.8374)
  [Class IoU]  C1: 0.8995 | C2: 0.8733 | C3: 0.7116
Epoch 100/400 | Train Loss: 29.5345
 Avg Train Loss: 29.5345 | Seg Loss: 0.2953 | Recon Loss: 0.0090
  Val mIoU: 0.8374 (Best: 0.8374)
  [Class IoU]  C1: 0.9201 | C2: 0.8779 | C3: 0.7141
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 28.9393
 Avg Train Loss: 28.9393 | Seg Loss: 0.2893 | Recon Loss: 0.0088
  Val mIoU: 0.8110 (Best: 0.8374)
  [Class IoU]  C1: 0.9222 | C2: 0.8590 | C3: 0.6519
Epoch 102/400 | Train Loss: 28.4302
 Avg Train Loss: 28.4302 | Seg Loss: 0.2842 | Recon Loss: 0.0087
  Val mIoU: 0.7268 (Best: 0.8374)
  [Class IoU]  C1: 0.8832 | C2: 0.7953 | C3: 0.5019
Epoch 103/400 | Train Loss: 28.7880
 Avg Train Loss: 28.7880 | Seg Loss: 0.2878 | Recon Loss: 0.0090
  Val mIoU: 0.8261 (Best: 0.8374)
  [Class IoU]  C1: 0.9253 | C2: 0.8672 | C3: 0.6858
Epoch 104/400 | Train Loss: 28.2395
 Avg Train Loss: 28.2395 | Seg Loss: 0.2823 | Recon Loss: 0.0087
  Val mIoU: 0.6259 (Best: 0.8374)
  [Class IoU]  C1: 0.4174 | C2: 0.8522 | C3: 0.6081
Epoch 105/400 | Train Loss: 29.4928
 Avg Train Loss: 29.4928 | Seg Loss: 0.2948 | Recon Loss: 0.0087
  Val mIoU: 0.7474 (Best: 0.8374)
  [Class IoU]  C1: 0.9180 | C2: 0.7900 | C3: 0.5342
Epoch 106/400 | Train Loss: 29.2580
 Avg Train Loss: 29.2580 | Seg Loss: 0.2925 | Recon Loss: 0.0087
  Val mIoU: 0.7693 (Best: 0.8374)
  [Class IoU]  C1: 0.9305 | C2: 0.7936 | C3: 0.5838
Epoch 107/400 | Train Loss: 28.7379
 Avg Train Loss: 28.7379 | Seg Loss: 0.2873 | Recon Loss: 0.0089
  Val mIoU: 0.8092 (Best: 0.8374)
  [Class IoU]  C1: 0.9284 | C2: 0.8284 | C3: 0.6707
Epoch 108/400 | Train Loss: 29.3289
 Avg Train Loss: 29.3289 | Seg Loss: 0.2932 | Recon Loss: 0.0087
  Val mIoU: 0.7963 (Best: 0.8374)
  [Class IoU]  C1: 0.9077 | C2: 0.8473 | C3: 0.6339
Epoch 109/400 | Train Loss: 29.1271
 Avg Train Loss: 29.1271 | Seg Loss: 0.2912 | Recon Loss: 0.0087
  Val mIoU: 0.7541 (Best: 0.8374)
  [Class IoU]  C1: 0.7917 | C2: 0.8421 | C3: 0.6286
Epoch 110/400 | Train Loss: 28.4450
 Avg Train Loss: 28.4450 | Seg Loss: 0.2844 | Recon Loss: 0.0087
  Val mIoU: 0.6196 (Best: 0.8374)
  [Class IoU]  C1: 0.4358 | C2: 0.8318 | C3: 0.5911
Epoch 111/400 | Train Loss: 29.4328
 Avg Train Loss: 29.4328 | Seg Loss: 0.2942 | Recon Loss: 0.0086
  Val mIoU: 0.8285 (Best: 0.8374)
  [Class IoU]  C1: 0.9132 | C2: 0.8739 | C3: 0.6985
Epoch 112/400 | Train Loss: 29.0760
 Avg Train Loss: 29.0760 | Seg Loss: 0.2907 | Recon Loss: 0.0088
  Val mIoU: 0.8381 (Best: 0.8374)
  [Class IoU]  C1: 0.9183 | C2: 0.8744 | C3: 0.7214
  --> New Best Model Saved!
Epoch 113/400 | Train Loss: 28.8923
 Avg Train Loss: 28.8923 | Seg Loss: 0.2888 | Recon Loss: 0.0086
  Val mIoU: 0.7937 (Best: 0.8381)
  [Class IoU]  C1: 0.7954 | C2: 0.8683 | C3: 0.7174
Epoch 114/400 | Train Loss: 28.2281
 Avg Train Loss: 28.2281 | Seg Loss: 0.2822 | Recon Loss: 0.0086
  Val mIoU: 0.8420 (Best: 0.8381)
  [Class IoU]  C1: 0.9093 | C2: 0.8758 | C3: 0.7409
  --> New Best Model Saved!
Epoch 115/400 | Train Loss: 28.6806
 Avg Train Loss: 28.6806 | Seg Loss: 0.2867 | Recon Loss: 0.0086
  Val mIoU: 0.7912 (Best: 0.8420)
  [Class IoU]  C1: 0.9229 | C2: 0.8340 | C3: 0.6168
Epoch 116/400 | Train Loss: 28.0313
 Avg Train Loss: 28.0313 | Seg Loss: 0.2802 | Recon Loss: 0.0085
  Val mIoU: 0.8355 (Best: 0.8420)
  [Class IoU]  C1: 0.9217 | C2: 0.8633 | C3: 0.7216
Epoch 117/400 | Train Loss: 28.2971
 Avg Train Loss: 28.2971 | Seg Loss: 0.2829 | Recon Loss: 0.0086
  Val mIoU: 0.8328 (Best: 0.8420)
  [Class IoU]  C1: 0.9199 | C2: 0.8719 | C3: 0.7067
Epoch 118/400 | Train Loss: 27.6876
 Avg Train Loss: 27.6876 | Seg Loss: 0.2768 | Recon Loss: 0.0087
  Val mIoU: 0.8147 (Best: 0.8420)
  [Class IoU]  C1: 0.9117 | C2: 0.8658 | C3: 0.6666
Epoch 119/400 | Train Loss: 28.3669
 Avg Train Loss: 28.3669 | Seg Loss: 0.2836 | Recon Loss: 0.0086
  Val mIoU: 0.8298 (Best: 0.8420)
  [Class IoU]  C1: 0.9082 | C2: 0.8757 | C3: 0.7057
Epoch 120/400 | Train Loss: 28.0139
 Avg Train Loss: 28.0139 | Seg Loss: 0.2801 | Recon Loss: 0.0085
  Val mIoU: 0.8344 (Best: 0.8420)
  [Class IoU]  C1: 0.9028 | C2: 0.8824 | C3: 0.7180
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 28.6158
 Avg Train Loss: 28.6158 | Seg Loss: 0.2861 | Recon Loss: 0.0086
  Val mIoU: 0.7716 (Best: 0.8420)
  [Class IoU]  C1: 0.9209 | C2: 0.8245 | C3: 0.5693
Epoch 122/400 | Train Loss: 28.8843
 Avg Train Loss: 28.8843 | Seg Loss: 0.2888 | Recon Loss: 0.0086
  Val mIoU: 0.8324 (Best: 0.8420)
  [Class IoU]  C1: 0.9177 | C2: 0.8710 | C3: 0.7085
Epoch 123/400 | Train Loss: 27.8607
 Avg Train Loss: 27.8607 | Seg Loss: 0.2785 | Recon Loss: 0.0086
  Val mIoU: 0.7870 (Best: 0.8420)
  [Class IoU]  C1: 0.8499 | C2: 0.8422 | C3: 0.6689
Epoch 124/400 | Train Loss: 27.9082
 Avg Train Loss: 27.9082 | Seg Loss: 0.2790 | Recon Loss: 0.0086
  Val mIoU: 0.7873 (Best: 0.8420)
  [Class IoU]  C1: 0.8390 | C2: 0.8658 | C3: 0.6572
Epoch 125/400 | Train Loss: 28.9294
 Avg Train Loss: 28.9294 | Seg Loss: 0.2892 | Recon Loss: 0.0085
  Val mIoU: 0.7788 (Best: 0.8420)
  [Class IoU]  C1: 0.8968 | C2: 0.8339 | C3: 0.6056
Epoch 126/400 | Train Loss: 28.5374
 Avg Train Loss: 28.5374 | Seg Loss: 0.2853 | Recon Loss: 0.0087
  Val mIoU: 0.8222 (Best: 0.8420)
  [Class IoU]  C1: 0.9186 | C2: 0.8678 | C3: 0.6802
Epoch 127/400 | Train Loss: 28.6733
 Avg Train Loss: 28.6733 | Seg Loss: 0.2866 | Recon Loss: 0.0086
  Val mIoU: 0.8224 (Best: 0.8420)
  [Class IoU]  C1: 0.9222 | C2: 0.8715 | C3: 0.6737
Epoch 128/400 | Train Loss: 28.5266
 Avg Train Loss: 28.5266 | Seg Loss: 0.2852 | Recon Loss: 0.0087
  Val mIoU: 0.7778 (Best: 0.8420)
  [Class IoU]  C1: 0.7512 | C2: 0.8698 | C3: 0.7122
Epoch 129/400 | Train Loss: 28.1539
 Avg Train Loss: 28.1539 | Seg Loss: 0.2815 | Recon Loss: 0.0088
  Val mIoU: 0.7785 (Best: 0.8420)
  [Class IoU]  C1: 0.9262 | C2: 0.8191 | C3: 0.5901
Epoch 130/400 | Train Loss: 28.0432
 Avg Train Loss: 28.0432 | Seg Loss: 0.2803 | Recon Loss: 0.0086
  Val mIoU: 0.7818 (Best: 0.8420)
  [Class IoU]  C1: 0.9111 | C2: 0.8059 | C3: 0.6285
Epoch 131/400 | Train Loss: 28.6596
 Avg Train Loss: 28.6596 | Seg Loss: 0.2865 | Recon Loss: 0.0088
  Val mIoU: 0.7274 (Best: 0.8420)
  [Class IoU]  C1: 0.7879 | C2: 0.8068 | C3: 0.5876
Epoch 132/400 | Train Loss: 28.1092
 Avg Train Loss: 28.1092 | Seg Loss: 0.2810 | Recon Loss: 0.0086
  Val mIoU: 0.6872 (Best: 0.8420)
  [Class IoU]  C1: 0.6672 | C2: 0.8188 | C3: 0.5756
Epoch 133/400 | Train Loss: 28.8574
 Avg Train Loss: 28.8574 | Seg Loss: 0.2885 | Recon Loss: 0.0087
  Val mIoU: 0.7636 (Best: 0.8420)
  [Class IoU]  C1: 0.8916 | C2: 0.8193 | C3: 0.5797
Epoch 134/400 | Train Loss: 27.6855
 Avg Train Loss: 27.6855 | Seg Loss: 0.2768 | Recon Loss: 0.0086
  Val mIoU: 0.8020 (Best: 0.8420)
  [Class IoU]  C1: 0.8677 | C2: 0.8459 | C3: 0.6925
Epoch 135/400 | Train Loss: 27.4817
 Avg Train Loss: 27.4817 | Seg Loss: 0.2747 | Recon Loss: 0.0086
  Val mIoU: 0.7671 (Best: 0.8420)
  [Class IoU]  C1: 0.8840 | C2: 0.8312 | C3: 0.5860
Epoch 136/400 | Train Loss: 27.5248
 Avg Train Loss: 27.5248 | Seg Loss: 0.2752 | Recon Loss: 0.0085
  Val mIoU: 0.7879 (Best: 0.8420)
  [Class IoU]  C1: 0.7821 | C2: 0.8619 | C3: 0.7198
Epoch 137/400 | Train Loss: 28.2092
 Avg Train Loss: 28.2092 | Seg Loss: 0.2820 | Recon Loss: 0.0086
  Val mIoU: 0.8014 (Best: 0.8420)
  [Class IoU]  C1: 0.8681 | C2: 0.8642 | C3: 0.6721
Epoch 138/400 | Train Loss: 27.4898
 Avg Train Loss: 27.4898 | Seg Loss: 0.2748 | Recon Loss: 0.0085
  Val mIoU: 0.7369 (Best: 0.8420)
  [Class IoU]  C1: 0.7549 | C2: 0.8156 | C3: 0.6401
Epoch 139/400 | Train Loss: 27.8086
 Avg Train Loss: 27.8086 | Seg Loss: 0.2780 | Recon Loss: 0.0086
  Val mIoU: 0.8004 (Best: 0.8420)
  [Class IoU]  C1: 0.9208 | C2: 0.8393 | C3: 0.6411
Epoch 140/400 | Train Loss: 27.2552
 Avg Train Loss: 27.2552 | Seg Loss: 0.2725 | Recon Loss: 0.0085
  Val mIoU: 0.7943 (Best: 0.8420)
  [Class IoU]  C1: 0.7815 | C2: 0.8661 | C3: 0.7352
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 27.0109
 Avg Train Loss: 27.0109 | Seg Loss: 0.2700 | Recon Loss: 0.0085
  Val mIoU: 0.8322 (Best: 0.8420)
  [Class IoU]  C1: 0.9135 | C2: 0.8707 | C3: 0.7124
Epoch 142/400 | Train Loss: 27.6998
 Avg Train Loss: 27.6998 | Seg Loss: 0.2769 | Recon Loss: 0.0085
  Val mIoU: 0.7958 (Best: 0.8420)
  [Class IoU]  C1: 0.8964 | C2: 0.8584 | C3: 0.6326
Epoch 143/400 | Train Loss: 28.2991
 Avg Train Loss: 28.2991 | Seg Loss: 0.2829 | Recon Loss: 0.0086
  Val mIoU: 0.7943 (Best: 0.8420)
  [Class IoU]  C1: 0.9190 | C2: 0.8494 | C3: 0.6145
Epoch 144/400 | Train Loss: 27.3442
 Avg Train Loss: 27.3442 | Seg Loss: 0.2734 | Recon Loss: 0.0085
  Val mIoU: 0.8093 (Best: 0.8420)
  [Class IoU]  C1: 0.9216 | C2: 0.8537 | C3: 0.6528
Epoch 145/400 | Train Loss: 27.2465
 Avg Train Loss: 27.2465 | Seg Loss: 0.2724 | Recon Loss: 0.0086
  Val mIoU: 0.8161 (Best: 0.8420)
  [Class IoU]  C1: 0.8767 | C2: 0.8728 | C3: 0.6988
Epoch 146/400 | Train Loss: 27.4495
 Avg Train Loss: 27.4495 | Seg Loss: 0.2744 | Recon Loss: 0.0085
  Val mIoU: 0.7974 (Best: 0.8420)
  [Class IoU]  C1: 0.9032 | C2: 0.8414 | C3: 0.6476
Epoch 147/400 | Train Loss: 27.3225
 Avg Train Loss: 27.3225 | Seg Loss: 0.2731 | Recon Loss: 0.0084
  Val mIoU: 0.8129 (Best: 0.8420)
  [Class IoU]  C1: 0.9154 | C2: 0.8640 | C3: 0.6593
Epoch 148/400 | Train Loss: 27.8304
 Avg Train Loss: 27.8304 | Seg Loss: 0.2782 | Recon Loss: 0.0085
  Val mIoU: 0.7668 (Best: 0.8420)
  [Class IoU]  C1: 0.8631 | C2: 0.8414 | C3: 0.5958
Epoch 149/400 | Train Loss: 27.6722
 Avg Train Loss: 27.6722 | Seg Loss: 0.2766 | Recon Loss: 0.0084
  Val mIoU: 0.8025 (Best: 0.8420)
  [Class IoU]  C1: 0.8548 | C2: 0.8719 | C3: 0.6808
Epoch 150/400 | Train Loss: 27.3016
 Avg Train Loss: 27.3016 | Seg Loss: 0.2729 | Recon Loss: 0.0084
  Val mIoU: 0.8151 (Best: 0.8420)
  [Class IoU]  C1: 0.9041 | C2: 0.8637 | C3: 0.6775
Epoch 151/400 | Train Loss: 27.1104
 Avg Train Loss: 27.1104 | Seg Loss: 0.2710 | Recon Loss: 0.0087
  Val mIoU: 0.7989 (Best: 0.8420)
  [Class IoU]  C1: 0.8940 | C2: 0.8585 | C3: 0.6442
Epoch 152/400 | Train Loss: 27.2519
 Avg Train Loss: 27.2519 | Seg Loss: 0.2724 | Recon Loss: 0.0085
  Val mIoU: 0.7768 (Best: 0.8420)
  [Class IoU]  C1: 0.8088 | C2: 0.8595 | C3: 0.6622
Epoch 153/400 | Train Loss: 27.7749
 Avg Train Loss: 27.7749 | Seg Loss: 0.2777 | Recon Loss: 0.0086
  Val mIoU: 0.8129 (Best: 0.8420)
  [Class IoU]  C1: 0.9147 | C2: 0.8639 | C3: 0.6599
Epoch 154/400 | Train Loss: 27.0085
 Avg Train Loss: 27.0085 | Seg Loss: 0.2700 | Recon Loss: 0.0087
  Val mIoU: 0.8147 (Best: 0.8420)
  [Class IoU]  C1: 0.8770 | C2: 0.8718 | C3: 0.6953
Epoch 155/400 | Train Loss: 27.6011
 Avg Train Loss: 27.6011 | Seg Loss: 0.2759 | Recon Loss: 0.0084
  Val mIoU: 0.7846 (Best: 0.8420)
  [Class IoU]  C1: 0.8415 | C2: 0.8576 | C3: 0.6546
Epoch 156/400 | Train Loss: 27.2456
 Avg Train Loss: 27.2456 | Seg Loss: 0.2724 | Recon Loss: 0.0084
  Val mIoU: 0.8225 (Best: 0.8420)
  [Class IoU]  C1: 0.9052 | C2: 0.8733 | C3: 0.6892
Epoch 157/400 | Train Loss: 26.3560
 Avg Train Loss: 26.3560 | Seg Loss: 0.2635 | Recon Loss: 0.0085
  Val mIoU: 0.8150 (Best: 0.8420)
  [Class IoU]  C1: 0.8790 | C2: 0.8719 | C3: 0.6941
Epoch 158/400 | Train Loss: 26.5571
 Avg Train Loss: 26.5571 | Seg Loss: 0.2655 | Recon Loss: 0.0084
  Val mIoU: 0.8064 (Best: 0.8420)
  [Class IoU]  C1: 0.9080 | C2: 0.8652 | C3: 0.6462
Epoch 159/400 | Train Loss: 27.1622
 Avg Train Loss: 27.1622 | Seg Loss: 0.2715 | Recon Loss: 0.0085
  Val mIoU: 0.8159 (Best: 0.8420)
  [Class IoU]  C1: 0.8955 | C2: 0.8732 | C3: 0.6789
Epoch 160/400 | Train Loss: 27.2395
 Avg Train Loss: 27.2395 | Seg Loss: 0.2723 | Recon Loss: 0.0085
  Val mIoU: 0.8282 (Best: 0.8420)
  [Class IoU]  C1: 0.8732 | C2: 0.8850 | C3: 0.7264
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 27.3042
 Avg Train Loss: 27.3042 | Seg Loss: 0.2730 | Recon Loss: 0.0084
  Val mIoU: 0.8166 (Best: 0.8420)
  [Class IoU]  C1: 0.9042 | C2: 0.8656 | C3: 0.6800
Epoch 162/400 | Train Loss: 26.1970
 Avg Train Loss: 26.1970 | Seg Loss: 0.2619 | Recon Loss: 0.0084
  Val mIoU: 0.8201 (Best: 0.8420)
  [Class IoU]  C1: 0.9120 | C2: 0.8677 | C3: 0.6805
Epoch 163/400 | Train Loss: 27.2218
 Avg Train Loss: 27.2218 | Seg Loss: 0.2721 | Recon Loss: 0.0084
  Val mIoU: 0.7915 (Best: 0.8420)
  [Class IoU]  C1: 0.7910 | C2: 0.8658 | C3: 0.7176
Epoch 164/400 | Train Loss: 27.1530
 Avg Train Loss: 27.1530 | Seg Loss: 0.2714 | Recon Loss: 0.0084
  Val mIoU: 0.8366 (Best: 0.8420)
  [Class IoU]  C1: 0.9172 | C2: 0.8704 | C3: 0.7222
Epoch 165/400 | Train Loss: 26.6133
 Avg Train Loss: 26.6133 | Seg Loss: 0.2660 | Recon Loss: 0.0084
  Val mIoU: 0.8118 (Best: 0.8420)
  [Class IoU]  C1: 0.8900 | C2: 0.8604 | C3: 0.6851
Epoch 166/400 | Train Loss: 27.1820
 Avg Train Loss: 27.1820 | Seg Loss: 0.2717 | Recon Loss: 0.0085
  Val mIoU: 0.8383 (Best: 0.8420)
  [Class IoU]  C1: 0.9208 | C2: 0.8688 | C3: 0.7254
Epoch 167/400 | Train Loss: 27.2291
 Avg Train Loss: 27.2291 | Seg Loss: 0.2722 | Recon Loss: 0.0085
  Val mIoU: 0.8267 (Best: 0.8420)
  [Class IoU]  C1: 0.9162 | C2: 0.8555 | C3: 0.7084
Epoch 168/400 | Train Loss: 27.0743
 Avg Train Loss: 27.0743 | Seg Loss: 0.2707 | Recon Loss: 0.0085
  Val mIoU: 0.8326 (Best: 0.8420)
  [Class IoU]  C1: 0.9164 | C2: 0.8787 | C3: 0.7026
Epoch 169/400 | Train Loss: 27.1147
 Avg Train Loss: 27.1147 | Seg Loss: 0.2711 | Recon Loss: 0.0083
  Val mIoU: 0.8201 (Best: 0.8420)
  [Class IoU]  C1: 0.8643 | C2: 0.8723 | C3: 0.7239
Epoch 170/400 | Train Loss: 27.5447
 Avg Train Loss: 27.5447 | Seg Loss: 0.2754 | Recon Loss: 0.0084
  Val mIoU: 0.8375 (Best: 0.8420)
  [Class IoU]  C1: 0.9249 | C2: 0.8779 | C3: 0.7097
Epoch 171/400 | Train Loss: 27.0464
 Avg Train Loss: 27.0464 | Seg Loss: 0.2704 | Recon Loss: 0.0083
  Val mIoU: 0.8273 (Best: 0.8420)
  [Class IoU]  C1: 0.9285 | C2: 0.8686 | C3: 0.6848
Epoch 172/400 | Train Loss: 27.1511
 Avg Train Loss: 27.1511 | Seg Loss: 0.2714 | Recon Loss: 0.0085
  Val mIoU: 0.7105 (Best: 0.8420)
  [Class IoU]  C1: 0.5693 | C2: 0.8595 | C3: 0.7027
Epoch 173/400 | Train Loss: 26.5422
 Avg Train Loss: 26.5422 | Seg Loss: 0.2653 | Recon Loss: 0.0084
  Val mIoU: 0.8293 (Best: 0.8420)
  [Class IoU]  C1: 0.9166 | C2: 0.8771 | C3: 0.6941
Epoch 174/400 | Train Loss: 26.8386
 Avg Train Loss: 26.8386 | Seg Loss: 0.2683 | Recon Loss: 0.0085
  Val mIoU: 0.8141 (Best: 0.8420)
  [Class IoU]  C1: 0.9205 | C2: 0.8583 | C3: 0.6635
Epoch 175/400 | Train Loss: 26.9057
 Avg Train Loss: 26.9057 | Seg Loss: 0.2690 | Recon Loss: 0.0084
  Val mIoU: 0.8343 (Best: 0.8420)
  [Class IoU]  C1: 0.9017 | C2: 0.8807 | C3: 0.7204
Epoch 176/400 | Train Loss: 27.2180
 Avg Train Loss: 27.2180 | Seg Loss: 0.2721 | Recon Loss: 0.0085
  Val mIoU: 0.8197 (Best: 0.8420)
  [Class IoU]  C1: 0.9119 | C2: 0.8658 | C3: 0.6814
Epoch 177/400 | Train Loss: 26.8987
 Avg Train Loss: 26.8987 | Seg Loss: 0.2689 | Recon Loss: 0.0084
  Val mIoU: 0.8249 (Best: 0.8420)
  [Class IoU]  C1: 0.9203 | C2: 0.8711 | C3: 0.6832
Epoch 178/400 | Train Loss: 26.1181
 Avg Train Loss: 26.1181 | Seg Loss: 0.2611 | Recon Loss: 0.0086
  Val mIoU: 0.8222 (Best: 0.8420)
  [Class IoU]  C1: 0.9185 | C2: 0.8651 | C3: 0.6829
Epoch 179/400 | Train Loss: 27.1041
 Avg Train Loss: 27.1041 | Seg Loss: 0.2710 | Recon Loss: 0.0084
  Val mIoU: 0.7921 (Best: 0.8420)
  [Class IoU]  C1: 0.8893 | C2: 0.8462 | C3: 0.6409
Epoch 180/400 | Train Loss: 26.4029
 Avg Train Loss: 26.4029 | Seg Loss: 0.2639 | Recon Loss: 0.0084
  Val mIoU: 0.7982 (Best: 0.8420)
  [Class IoU]  C1: 0.9094 | C2: 0.8471 | C3: 0.6382
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 26.6889
 Avg Train Loss: 26.6889 | Seg Loss: 0.2668 | Recon Loss: 0.0083
  Val mIoU: 0.7828 (Best: 0.8420)
  [Class IoU]  C1: 0.9175 | C2: 0.8308 | C3: 0.6002
Epoch 182/400 | Train Loss: 26.4011
 Avg Train Loss: 26.4011 | Seg Loss: 0.2639 | Recon Loss: 0.0083
  Val mIoU: 0.7651 (Best: 0.8420)
  [Class IoU]  C1: 0.8888 | C2: 0.8129 | C3: 0.5935
Epoch 183/400 | Train Loss: 26.2166
 Avg Train Loss: 26.2166 | Seg Loss: 0.2621 | Recon Loss: 0.0083
  Val mIoU: 0.8054 (Best: 0.8420)
  [Class IoU]  C1: 0.9144 | C2: 0.8438 | C3: 0.6581
Epoch 184/400 | Train Loss: 26.8661
 Avg Train Loss: 26.8661 | Seg Loss: 0.2686 | Recon Loss: 0.0084
  Val mIoU: 0.7923 (Best: 0.8420)
  [Class IoU]  C1: 0.9008 | C2: 0.8455 | C3: 0.6306
Epoch 185/400 | Train Loss: 26.6590
 Avg Train Loss: 26.6590 | Seg Loss: 0.2665 | Recon Loss: 0.0085
  Val mIoU: 0.8115 (Best: 0.8420)
  [Class IoU]  C1: 0.8869 | C2: 0.8548 | C3: 0.6927
Epoch 186/400 | Train Loss: 26.5409
 Avg Train Loss: 26.5409 | Seg Loss: 0.2653 | Recon Loss: 0.0084
  Val mIoU: 0.7622 (Best: 0.8420)
  [Class IoU]  C1: 0.8101 | C2: 0.8392 | C3: 0.6375
Epoch 187/400 | Train Loss: 26.7855
 Avg Train Loss: 26.7855 | Seg Loss: 0.2678 | Recon Loss: 0.0084
  Val mIoU: 0.7899 (Best: 0.8420)
  [Class IoU]  C1: 0.8804 | C2: 0.8503 | C3: 0.6392
Epoch 188/400 | Train Loss: 26.7581
 Avg Train Loss: 26.7581 | Seg Loss: 0.2675 | Recon Loss: 0.0083
  Val mIoU: 0.7814 (Best: 0.8420)
  [Class IoU]  C1: 0.9239 | C2: 0.8312 | C3: 0.5892
Epoch 189/400 | Train Loss: 26.6089
 Avg Train Loss: 26.6089 | Seg Loss: 0.2660 | Recon Loss: 0.0083
  Val mIoU: 0.7825 (Best: 0.8420)
  [Class IoU]  C1: 0.8914 | C2: 0.8285 | C3: 0.6275
Epoch 190/400 | Train Loss: 26.5290
 Avg Train Loss: 26.5290 | Seg Loss: 0.2652 | Recon Loss: 0.0085
  Val mIoU: 0.8263 (Best: 0.8420)
  [Class IoU]  C1: 0.9246 | C2: 0.8623 | C3: 0.6921
Epoch 191/400 | Train Loss: 26.7799
 Avg Train Loss: 26.7799 | Seg Loss: 0.2677 | Recon Loss: 0.0083
  Val mIoU: 0.8149 (Best: 0.8420)
  [Class IoU]  C1: 0.9080 | C2: 0.8498 | C3: 0.6867
Epoch 192/400 | Train Loss: 25.9938
 Avg Train Loss: 25.9938 | Seg Loss: 0.2599 | Recon Loss: 0.0083
  Val mIoU: 0.8176 (Best: 0.8420)
  [Class IoU]  C1: 0.9157 | C2: 0.8657 | C3: 0.6714
Epoch 193/400 | Train Loss: 26.6238
 Avg Train Loss: 26.6238 | Seg Loss: 0.2662 | Recon Loss: 0.0083
  Val mIoU: 0.8003 (Best: 0.8420)
  [Class IoU]  C1: 0.9246 | C2: 0.8520 | C3: 0.6243
Epoch 194/400 | Train Loss: 25.8256
 Avg Train Loss: 25.8256 | Seg Loss: 0.2582 | Recon Loss: 0.0083
  Val mIoU: 0.7960 (Best: 0.8420)
  [Class IoU]  C1: 0.8312 | C2: 0.8604 | C3: 0.6964
Epoch 195/400 | Train Loss: 26.7709
 Avg Train Loss: 26.7709 | Seg Loss: 0.2676 | Recon Loss: 0.0083
  Val mIoU: 0.8134 (Best: 0.8420)
  [Class IoU]  C1: 0.9106 | C2: 0.8580 | C3: 0.6716
Epoch 196/400 | Train Loss: 26.6213
 Avg Train Loss: 26.6213 | Seg Loss: 0.2661 | Recon Loss: 0.0084
  Val mIoU: 0.7797 (Best: 0.8420)
  [Class IoU]  C1: 0.8489 | C2: 0.8457 | C3: 0.6446
Epoch 197/400 | Train Loss: 26.6775
 Avg Train Loss: 26.6775 | Seg Loss: 0.2667 | Recon Loss: 0.0084
  Val mIoU: 0.7811 (Best: 0.8420)
  [Class IoU]  C1: 0.9118 | C2: 0.8301 | C3: 0.6012
Epoch 198/400 | Train Loss: 26.5326
 Avg Train Loss: 26.5326 | Seg Loss: 0.2652 | Recon Loss: 0.0083
  Val mIoU: 0.8049 (Best: 0.8420)
  [Class IoU]  C1: 0.9286 | C2: 0.8489 | C3: 0.6374
Epoch 199/400 | Train Loss: 27.1652
 Avg Train Loss: 27.1652 | Seg Loss: 0.2716 | Recon Loss: 0.0082
  Val mIoU: 0.8099 (Best: 0.8420)
  [Class IoU]  C1: 0.9247 | C2: 0.8505 | C3: 0.6546
Epoch 200/400 | Train Loss: 26.5632
 Avg Train Loss: 26.5632 | Seg Loss: 0.2655 | Recon Loss: 0.0083
  Val mIoU: 0.8160 (Best: 0.8420)
  [Class IoU]  C1: 0.9263 | C2: 0.8604 | C3: 0.6613
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 27.0413
 Avg Train Loss: 27.0413 | Seg Loss: 0.2703 | Recon Loss: 0.0084
  Val mIoU: 0.7812 (Best: 0.8420)
  [Class IoU]  C1: 0.8969 | C2: 0.8297 | C3: 0.6170
Epoch 202/400 | Train Loss: 26.6168
 Avg Train Loss: 26.6168 | Seg Loss: 0.2661 | Recon Loss: 0.0083
  Val mIoU: 0.7942 (Best: 0.8420)
  [Class IoU]  C1: 0.9071 | C2: 0.8375 | C3: 0.6381
Epoch 203/400 | Train Loss: 26.8328
 Avg Train Loss: 26.8328 | Seg Loss: 0.2682 | Recon Loss: 0.0084
  Val mIoU: 0.8101 (Best: 0.8420)
  [Class IoU]  C1: 0.9134 | C2: 0.8549 | C3: 0.6619
Epoch 204/400 | Train Loss: 26.3817
 Avg Train Loss: 26.3817 | Seg Loss: 0.2637 | Recon Loss: 0.0085
  Val mIoU: 0.8285 (Best: 0.8420)
  [Class IoU]  C1: 0.9109 | C2: 0.8760 | C3: 0.6984
Epoch 205/400 | Train Loss: 26.4076
 Avg Train Loss: 26.4076 | Seg Loss: 0.2640 | Recon Loss: 0.0083
  Val mIoU: 0.8050 (Best: 0.8420)
  [Class IoU]  C1: 0.8961 | C2: 0.8572 | C3: 0.6617
Epoch 206/400 | Train Loss: 26.9738
 Avg Train Loss: 26.9738 | Seg Loss: 0.2697 | Recon Loss: 0.0085
  Val mIoU: 0.8143 (Best: 0.8420)
  [Class IoU]  C1: 0.9178 | C2: 0.8556 | C3: 0.6695
Epoch 207/400 | Train Loss: 27.0173
 Avg Train Loss: 27.0173 | Seg Loss: 0.2701 | Recon Loss: 0.0082
  Val mIoU: 0.8196 (Best: 0.8420)
  [Class IoU]  C1: 0.9218 | C2: 0.8626 | C3: 0.6746
Epoch 208/400 | Train Loss: 26.3799
 Avg Train Loss: 26.3799 | Seg Loss: 0.2637 | Recon Loss: 0.0084
  Val mIoU: 0.7950 (Best: 0.8420)
  [Class IoU]  C1: 0.9021 | C2: 0.8419 | C3: 0.6409
Epoch 209/400 | Train Loss: 26.2551
 Avg Train Loss: 26.2551 | Seg Loss: 0.2625 | Recon Loss: 0.0085
  Val mIoU: 0.7845 (Best: 0.8420)
  [Class IoU]  C1: 0.8920 | C2: 0.8316 | C3: 0.6299
Epoch 210/400 | Train Loss: 26.3807
 Avg Train Loss: 26.3807 | Seg Loss: 0.2637 | Recon Loss: 0.0083
  Val mIoU: 0.7668 (Best: 0.8420)
  [Class IoU]  C1: 0.9223 | C2: 0.8149 | C3: 0.5632
Epoch 211/400 | Train Loss: 26.3341
 Avg Train Loss: 26.3341 | Seg Loss: 0.2633 | Recon Loss: 0.0082
  Val mIoU: 0.8210 (Best: 0.8420)
  [Class IoU]  C1: 0.8950 | C2: 0.8708 | C3: 0.6972
Epoch 212/400 | Train Loss: 26.9852
 Avg Train Loss: 26.9852 | Seg Loss: 0.2698 | Recon Loss: 0.0085
  Val mIoU: 0.8091 (Best: 0.8420)
  [Class IoU]  C1: 0.9221 | C2: 0.8494 | C3: 0.6557
Epoch 213/400 | Train Loss: 26.7454
 Avg Train Loss: 26.7454 | Seg Loss: 0.2674 | Recon Loss: 0.0083
  Val mIoU: 0.8191 (Best: 0.8420)
  [Class IoU]  C1: 0.9120 | C2: 0.8629 | C3: 0.6825
Epoch 214/400 | Train Loss: 26.7128
 Avg Train Loss: 26.7128 | Seg Loss: 0.2670 | Recon Loss: 0.0083
  Val mIoU: 0.8112 (Best: 0.8420)
  [Class IoU]  C1: 0.9189 | C2: 0.8609 | C3: 0.6539
Epoch 215/400 | Train Loss: 27.1339
 Avg Train Loss: 27.1339 | Seg Loss: 0.2713 | Recon Loss: 0.0083
  Val mIoU: 0.7803 (Best: 0.8420)
  [Class IoU]  C1: 0.9244 | C2: 0.8275 | C3: 0.5890
Epoch 216/400 | Train Loss: 26.2593
 Avg Train Loss: 26.2593 | Seg Loss: 0.2625 | Recon Loss: 0.0083
  Val mIoU: 0.7850 (Best: 0.8420)
  [Class IoU]  C1: 0.8285 | C2: 0.8612 | C3: 0.6652
Epoch 217/400 | Train Loss: 26.9125
 Avg Train Loss: 26.9125 | Seg Loss: 0.2690 | Recon Loss: 0.0084
  Val mIoU: 0.8119 (Best: 0.8420)
  [Class IoU]  C1: 0.8567 | C2: 0.8701 | C3: 0.7089
Epoch 218/400 | Train Loss: 26.5174
 Avg Train Loss: 26.5174 | Seg Loss: 0.2651 | Recon Loss: 0.0085
  Val mIoU: 0.8194 (Best: 0.8420)
  [Class IoU]  C1: 0.8935 | C2: 0.8714 | C3: 0.6932
Epoch 219/400 | Train Loss: 26.0114
 Avg Train Loss: 26.0114 | Seg Loss: 0.2600 | Recon Loss: 0.0084
  Val mIoU: 0.8168 (Best: 0.8420)
  [Class IoU]  C1: 0.8891 | C2: 0.8649 | C3: 0.6965
Epoch 220/400 | Train Loss: 26.3640
 Avg Train Loss: 26.3640 | Seg Loss: 0.2636 | Recon Loss: 0.0083
  Val mIoU: 0.7993 (Best: 0.8420)
  [Class IoU]  C1: 0.8823 | C2: 0.8545 | C3: 0.6612
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 26.7860
 Avg Train Loss: 26.7860 | Seg Loss: 0.2678 | Recon Loss: 0.0083
  Val mIoU: 0.8046 (Best: 0.8420)
  [Class IoU]  C1: 0.9240 | C2: 0.8517 | C3: 0.6382
Epoch 222/400 | Train Loss: 26.3453
 Avg Train Loss: 26.3453 | Seg Loss: 0.2634 | Recon Loss: 0.0083
  Val mIoU: 0.8062 (Best: 0.8420)
  [Class IoU]  C1: 0.9230 | C2: 0.8516 | C3: 0.6439
Epoch 223/400 | Train Loss: 26.6272
 Avg Train Loss: 26.6272 | Seg Loss: 0.2662 | Recon Loss: 0.0083
  Val mIoU: 0.8153 (Best: 0.8420)
  [Class IoU]  C1: 0.9044 | C2: 0.8642 | C3: 0.6774
Epoch 224/400 | Train Loss: 26.6349
 Avg Train Loss: 26.6349 | Seg Loss: 0.2663 | Recon Loss: 0.0083
  Val mIoU: 0.8105 (Best: 0.8420)
  [Class IoU]  C1: 0.8638 | C2: 0.8752 | C3: 0.6926
Epoch 225/400 | Train Loss: 26.8699
 Avg Train Loss: 26.8699 | Seg Loss: 0.2686 | Recon Loss: 0.0083
  Val mIoU: 0.8018 (Best: 0.8420)
  [Class IoU]  C1: 0.9139 | C2: 0.8530 | C3: 0.6385
Epoch 226/400 | Train Loss: 26.5250
 Avg Train Loss: 26.5250 | Seg Loss: 0.2652 | Recon Loss: 0.0083
  Val mIoU: 0.7858 (Best: 0.8420)
  [Class IoU]  C1: 0.9039 | C2: 0.8349 | C3: 0.6185
Epoch 227/400 | Train Loss: 26.0743
 Avg Train Loss: 26.0743 | Seg Loss: 0.2607 | Recon Loss: 0.0082
  Val mIoU: 0.8136 (Best: 0.8420)
  [Class IoU]  C1: 0.9112 | C2: 0.8588 | C3: 0.6706
Epoch 228/400 | Train Loss: 26.8735
 Avg Train Loss: 26.8735 | Seg Loss: 0.2687 | Recon Loss: 0.0083
  Val mIoU: 0.8189 (Best: 0.8420)
  [Class IoU]  C1: 0.9050 | C2: 0.8700 | C3: 0.6818
Epoch 229/400 | Train Loss: 26.9739
 Avg Train Loss: 26.9739 | Seg Loss: 0.2697 | Recon Loss: 0.0083
  Val mIoU: 0.8139 (Best: 0.8420)
  [Class IoU]  C1: 0.8910 | C2: 0.8710 | C3: 0.6799
Epoch 230/400 | Train Loss: 26.3685
 Avg Train Loss: 26.3685 | Seg Loss: 0.2636 | Recon Loss: 0.0083
  Val mIoU: 0.8176 (Best: 0.8420)
  [Class IoU]  C1: 0.9204 | C2: 0.8668 | C3: 0.6657
Epoch 231/400 | Train Loss: 26.0500
 Avg Train Loss: 26.0500 | Seg Loss: 0.2604 | Recon Loss: 0.0084
  Val mIoU: 0.8263 (Best: 0.8420)
  [Class IoU]  C1: 0.9218 | C2: 0.8692 | C3: 0.6878
Epoch 232/400 | Train Loss: 25.6373
 Avg Train Loss: 25.6373 | Seg Loss: 0.2563 | Recon Loss: 0.0084
  Val mIoU: 0.8059 (Best: 0.8420)
  [Class IoU]  C1: 0.9007 | C2: 0.8572 | C3: 0.6597
Epoch 233/400 | Train Loss: 26.5598
 Avg Train Loss: 26.5598 | Seg Loss: 0.2655 | Recon Loss: 0.0083
  Val mIoU: 0.8067 (Best: 0.8420)
  [Class IoU]  C1: 0.9004 | C2: 0.8585 | C3: 0.6613
Epoch 234/400 | Train Loss: 25.9600
 Avg Train Loss: 25.9600 | Seg Loss: 0.2595 | Recon Loss: 0.0082
  Val mIoU: 0.8148 (Best: 0.8420)
  [Class IoU]  C1: 0.9166 | C2: 0.8635 | C3: 0.6643
Epoch 235/400 | Train Loss: 26.2999
 Avg Train Loss: 26.2999 | Seg Loss: 0.2629 | Recon Loss: 0.0083
  Val mIoU: 0.8173 (Best: 0.8420)
  [Class IoU]  C1: 0.9166 | C2: 0.8626 | C3: 0.6726
Epoch 236/400 | Train Loss: 26.5222
 Avg Train Loss: 26.5222 | Seg Loss: 0.2651 | Recon Loss: 0.0083
  Val mIoU: 0.8047 (Best: 0.8420)
  [Class IoU]  C1: 0.9202 | C2: 0.8476 | C3: 0.6464
Epoch 237/400 | Train Loss: 26.6113
 Avg Train Loss: 26.6113 | Seg Loss: 0.2660 | Recon Loss: 0.0084
  Val mIoU: 0.7926 (Best: 0.8420)
  [Class IoU]  C1: 0.9219 | C2: 0.8424 | C3: 0.6136
Epoch 238/400 | Train Loss: 26.1886
 Avg Train Loss: 26.1886 | Seg Loss: 0.2618 | Recon Loss: 0.0083
  Val mIoU: 0.8109 (Best: 0.8420)
  [Class IoU]  C1: 0.8972 | C2: 0.8653 | C3: 0.6704
Epoch 239/400 | Train Loss: 26.5182
 Avg Train Loss: 26.5182 | Seg Loss: 0.2651 | Recon Loss: 0.0083
  Val mIoU: 0.8179 (Best: 0.8420)
  [Class IoU]  C1: 0.9226 | C2: 0.8571 | C3: 0.6739
Epoch 240/400 | Train Loss: 26.6012
 Avg Train Loss: 26.6012 | Seg Loss: 0.2659 | Recon Loss: 0.0084
  Val mIoU: 0.8100 (Best: 0.8420)
  [Class IoU]  C1: 0.9115 | C2: 0.8591 | C3: 0.6595
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 26.5863
 Avg Train Loss: 26.5863 | Seg Loss: 0.2658 | Recon Loss: 0.0083
  Val mIoU: 0.8051 (Best: 0.8420)
  [Class IoU]  C1: 0.8781 | C2: 0.8625 | C3: 0.6746
Epoch 242/400 | Train Loss: 26.1820
 Avg Train Loss: 26.1820 | Seg Loss: 0.2617 | Recon Loss: 0.0084
  Val mIoU: 0.8255 (Best: 0.8420)
  [Class IoU]  C1: 0.9234 | C2: 0.8577 | C3: 0.6954
Epoch 243/400 | Train Loss: 26.5794
 Avg Train Loss: 26.5794 | Seg Loss: 0.2657 | Recon Loss: 0.0083
  Val mIoU: 0.8034 (Best: 0.8420)
  [Class IoU]  C1: 0.9142 | C2: 0.8522 | C3: 0.6438
Epoch 244/400 | Train Loss: 26.1161
 Avg Train Loss: 26.1161 | Seg Loss: 0.2611 | Recon Loss: 0.0083
  Val mIoU: 0.8037 (Best: 0.8420)
  [Class IoU]  C1: 0.9168 | C2: 0.8559 | C3: 0.6384
Epoch 245/400 | Train Loss: 26.8091
 Avg Train Loss: 26.8091 | Seg Loss: 0.2680 | Recon Loss: 0.0083
  Val mIoU: 0.8201 (Best: 0.8420)
  [Class IoU]  C1: 0.9213 | C2: 0.8603 | C3: 0.6788
Epoch 246/400 | Train Loss: 26.5027
 Avg Train Loss: 26.5027 | Seg Loss: 0.2649 | Recon Loss: 0.0083
  Val mIoU: 0.8227 (Best: 0.8420)
  [Class IoU]  C1: 0.9174 | C2: 0.8711 | C3: 0.6795
Epoch 247/400 | Train Loss: 26.0001
 Avg Train Loss: 26.0001 | Seg Loss: 0.2599 | Recon Loss: 0.0083
  Val mIoU: 0.8132 (Best: 0.8420)
  [Class IoU]  C1: 0.9157 | C2: 0.8623 | C3: 0.6616
Epoch 248/400 | Train Loss: 26.5972
 Avg Train Loss: 26.5972 | Seg Loss: 0.2659 | Recon Loss: 0.0082
  Val mIoU: 0.8078 (Best: 0.8420)
  [Class IoU]  C1: 0.9117 | C2: 0.8554 | C3: 0.6562
Epoch 249/400 | Train Loss: 25.7010
 Avg Train Loss: 25.7010 | Seg Loss: 0.2569 | Recon Loss: 0.0083
  Val mIoU: 0.8170 (Best: 0.8420)
  [Class IoU]  C1: 0.9076 | C2: 0.8684 | C3: 0.6749
Epoch 250/400 | Train Loss: 26.3423
 Avg Train Loss: 26.3423 | Seg Loss: 0.2633 | Recon Loss: 0.0083
  Val mIoU: 0.8287 (Best: 0.8420)
  [Class IoU]  C1: 0.9146 | C2: 0.8730 | C3: 0.6984
Epoch 251/400 | Train Loss: 26.4098
 Avg Train Loss: 26.4098 | Seg Loss: 0.2640 | Recon Loss: 0.0082
  Val mIoU: 0.8065 (Best: 0.8420)
  [Class IoU]  C1: 0.8931 | C2: 0.8633 | C3: 0.6630
Epoch 252/400 | Train Loss: 26.9761
 Avg Train Loss: 26.9761 | Seg Loss: 0.2697 | Recon Loss: 0.0083
  Val mIoU: 0.8160 (Best: 0.8420)
  [Class IoU]  C1: 0.8922 | C2: 0.8705 | C3: 0.6853
Epoch 253/400 | Train Loss: 26.3720
 Avg Train Loss: 26.3720 | Seg Loss: 0.2636 | Recon Loss: 0.0082
  Val mIoU: 0.7977 (Best: 0.8420)
  [Class IoU]  C1: 0.8751 | C2: 0.8563 | C3: 0.6617
Epoch 254/400 | Train Loss: 26.4422
 Avg Train Loss: 26.4422 | Seg Loss: 0.2643 | Recon Loss: 0.0083
  Val mIoU: 0.8186 (Best: 0.8420)
  [Class IoU]  C1: 0.9060 | C2: 0.8573 | C3: 0.6924
Epoch 255/400 | Train Loss: 26.5516
 Avg Train Loss: 26.5516 | Seg Loss: 0.2654 | Recon Loss: 0.0083
  Val mIoU: 0.8190 (Best: 0.8420)
  [Class IoU]  C1: 0.9065 | C2: 0.8666 | C3: 0.6839
Epoch 256/400 | Train Loss: 26.7327
 Avg Train Loss: 26.7327 | Seg Loss: 0.2672 | Recon Loss: 0.0082
  Val mIoU: 0.8120 (Best: 0.8420)
  [Class IoU]  C1: 0.9224 | C2: 0.8555 | C3: 0.6580
Epoch 257/400 | Train Loss: 26.4140
 Avg Train Loss: 26.4140 | Seg Loss: 0.2641 | Recon Loss: 0.0083
  Val mIoU: 0.7815 (Best: 0.8420)
  [Class IoU]  C1: 0.8343 | C2: 0.8538 | C3: 0.6564
Epoch 258/400 | Train Loss: 26.3196
 Avg Train Loss: 26.3196 | Seg Loss: 0.2631 | Recon Loss: 0.0084
  Val mIoU: 0.8151 (Best: 0.8420)
  [Class IoU]  C1: 0.9068 | C2: 0.8706 | C3: 0.6679
Epoch 259/400 | Train Loss: 25.7815
 Avg Train Loss: 25.7815 | Seg Loss: 0.2577 | Recon Loss: 0.0082
  Val mIoU: 0.8164 (Best: 0.8420)
  [Class IoU]  C1: 0.9101 | C2: 0.8593 | C3: 0.6798
Epoch 260/400 | Train Loss: 26.1674
 Avg Train Loss: 26.1674 | Seg Loss: 0.2616 | Recon Loss: 0.0083
  Val mIoU: 0.8059 (Best: 0.8420)
  [Class IoU]  C1: 0.8746 | C2: 0.8652 | C3: 0.6779
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 25.9877
 Avg Train Loss: 25.9877 | Seg Loss: 0.2598 | Recon Loss: 0.0083
  Val mIoU: 0.8281 (Best: 0.8420)
  [Class IoU]  C1: 0.9112 | C2: 0.8727 | C3: 0.7004
Epoch 262/400 | Train Loss: 26.1197
 Avg Train Loss: 26.1197 | Seg Loss: 0.2611 | Recon Loss: 0.0084
  Val mIoU: 0.7828 (Best: 0.8420)
  [Class IoU]  C1: 0.8999 | C2: 0.8336 | C3: 0.6148
Epoch 263/400 | Train Loss: 26.4431
 Avg Train Loss: 26.4431 | Seg Loss: 0.2643 | Recon Loss: 0.0083
  Val mIoU: 0.8361 (Best: 0.8420)
  [Class IoU]  C1: 0.9097 | C2: 0.8828 | C3: 0.7157
Epoch 264/400 | Train Loss: 26.6741
 Avg Train Loss: 26.6741 | Seg Loss: 0.2667 | Recon Loss: 0.0083
  Val mIoU: 0.8083 (Best: 0.8420)
  [Class IoU]  C1: 0.8945 | C2: 0.8556 | C3: 0.6749
Epoch 265/400 | Train Loss: 26.6415
 Avg Train Loss: 26.6415 | Seg Loss: 0.2663 | Recon Loss: 0.0083
  Val mIoU: 0.7962 (Best: 0.8420)
  [Class IoU]  C1: 0.9056 | C2: 0.8499 | C3: 0.6332
Epoch 266/400 | Train Loss: 26.6936
 Avg Train Loss: 26.6936 | Seg Loss: 0.2669 | Recon Loss: 0.0083
  Val mIoU: 0.8173 (Best: 0.8420)
  [Class IoU]  C1: 0.9038 | C2: 0.8677 | C3: 0.6803
Epoch 267/400 | Train Loss: 26.5741
 Avg Train Loss: 26.5741 | Seg Loss: 0.2657 | Recon Loss: 0.0084
  Val mIoU: 0.8102 (Best: 0.8420)
  [Class IoU]  C1: 0.8755 | C2: 0.8737 | C3: 0.6814
Epoch 268/400 | Train Loss: 26.3106
 Avg Train Loss: 26.3106 | Seg Loss: 0.2630 | Recon Loss: 0.0084
  Val mIoU: 0.8178 (Best: 0.8420)
  [Class IoU]  C1: 0.9185 | C2: 0.8640 | C3: 0.6710
Epoch 269/400 | Train Loss: 26.6340
 Avg Train Loss: 26.6340 | Seg Loss: 0.2663 | Recon Loss: 0.0083
  Val mIoU: 0.7931 (Best: 0.8420)
  [Class IoU]  C1: 0.9166 | C2: 0.8447 | C3: 0.6182
Epoch 270/400 | Train Loss: 25.9886
 Avg Train Loss: 25.9886 | Seg Loss: 0.2598 | Recon Loss: 0.0083
  Val mIoU: 0.8052 (Best: 0.8420)
  [Class IoU]  C1: 0.9144 | C2: 0.8385 | C3: 0.6628
Epoch 271/400 | Train Loss: 26.5766
 Avg Train Loss: 26.5766 | Seg Loss: 0.2657 | Recon Loss: 0.0083
  Val mIoU: 0.8099 (Best: 0.8420)
  [Class IoU]  C1: 0.8788 | C2: 0.8610 | C3: 0.6901
Epoch 272/400 | Train Loss: 25.8424
 Avg Train Loss: 25.8424 | Seg Loss: 0.2583 | Recon Loss: 0.0084
  Val mIoU: 0.8086 (Best: 0.8420)
  [Class IoU]  C1: 0.9199 | C2: 0.8548 | C3: 0.6511
Epoch 273/400 | Train Loss: 26.6001
 Avg Train Loss: 26.6001 | Seg Loss: 0.2659 | Recon Loss: 0.0082
  Val mIoU: 0.7911 (Best: 0.8420)
  [Class IoU]  C1: 0.9211 | C2: 0.8446 | C3: 0.6078
Epoch 274/400 | Train Loss: 26.4740
 Avg Train Loss: 26.4740 | Seg Loss: 0.2647 | Recon Loss: 0.0083
  Val mIoU: 0.8212 (Best: 0.8420)
  [Class IoU]  C1: 0.9079 | C2: 0.8667 | C3: 0.6890
Epoch 275/400 | Train Loss: 26.8597
 Avg Train Loss: 26.8597 | Seg Loss: 0.2685 | Recon Loss: 0.0083
  Val mIoU: 0.8258 (Best: 0.8420)
  [Class IoU]  C1: 0.9046 | C2: 0.8761 | C3: 0.6967
Epoch 276/400 | Train Loss: 26.3474
 Avg Train Loss: 26.3474 | Seg Loss: 0.2634 | Recon Loss: 0.0083
  Val mIoU: 0.7887 (Best: 0.8420)
  [Class IoU]  C1: 0.8723 | C2: 0.8535 | C3: 0.6405
Epoch 277/400 | Train Loss: 26.0531
 Avg Train Loss: 26.0531 | Seg Loss: 0.2604 | Recon Loss: 0.0082
  Val mIoU: 0.8070 (Best: 0.8420)
  [Class IoU]  C1: 0.9158 | C2: 0.8573 | C3: 0.6478
Epoch 278/400 | Train Loss: 26.5700
 Avg Train Loss: 26.5700 | Seg Loss: 0.2656 | Recon Loss: 0.0082
  Val mIoU: 0.8109 (Best: 0.8420)
  [Class IoU]  C1: 0.9025 | C2: 0.8614 | C3: 0.6688
Epoch 279/400 | Train Loss: 26.4568
 Avg Train Loss: 26.4568 | Seg Loss: 0.2645 | Recon Loss: 0.0082
  Val mIoU: 0.8150 (Best: 0.8420)
  [Class IoU]  C1: 0.9193 | C2: 0.8632 | C3: 0.6623
Epoch 280/400 | Train Loss: 26.7376
 Avg Train Loss: 26.7376 | Seg Loss: 0.2673 | Recon Loss: 0.0083
  Val mIoU: 0.8163 (Best: 0.8420)
  [Class IoU]  C1: 0.9127 | C2: 0.8618 | C3: 0.6745
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 26.5364
 Avg Train Loss: 26.5364 | Seg Loss: 0.2653 | Recon Loss: 0.0083
  Val mIoU: 0.8128 (Best: 0.8420)
  [Class IoU]  C1: 0.8989 | C2: 0.8622 | C3: 0.6774
Epoch 282/400 | Train Loss: 26.3755
 Avg Train Loss: 26.3755 | Seg Loss: 0.2637 | Recon Loss: 0.0083
  Val mIoU: 0.7919 (Best: 0.8420)
  [Class IoU]  C1: 0.8819 | C2: 0.8498 | C3: 0.6439
Epoch 283/400 | Train Loss: 26.4877
 Avg Train Loss: 26.4877 | Seg Loss: 0.2648 | Recon Loss: 0.0082
  Val mIoU: 0.8072 (Best: 0.8420)
  [Class IoU]  C1: 0.9075 | C2: 0.8578 | C3: 0.6562
Epoch 284/400 | Train Loss: 26.1250
 Avg Train Loss: 26.1250 | Seg Loss: 0.2612 | Recon Loss: 0.0083
  Val mIoU: 0.8064 (Best: 0.8420)
  [Class IoU]  C1: 0.8972 | C2: 0.8581 | C3: 0.6640
Epoch 285/400 | Train Loss: 26.4930
 Avg Train Loss: 26.4930 | Seg Loss: 0.2648 | Recon Loss: 0.0083
  Val mIoU: 0.8179 (Best: 0.8420)
  [Class IoU]  C1: 0.8582 | C2: 0.8754 | C3: 0.7201
Epoch 286/400 | Train Loss: 26.5725
 Avg Train Loss: 26.5725 | Seg Loss: 0.2656 | Recon Loss: 0.0083
  Val mIoU: 0.8269 (Best: 0.8420)
  [Class IoU]  C1: 0.9156 | C2: 0.8686 | C3: 0.6964
Epoch 287/400 | Train Loss: 25.9297
 Avg Train Loss: 25.9297 | Seg Loss: 0.2592 | Recon Loss: 0.0083
  Val mIoU: 0.8131 (Best: 0.8420)
  [Class IoU]  C1: 0.9020 | C2: 0.8666 | C3: 0.6708
Epoch 288/400 | Train Loss: 26.7382
 Avg Train Loss: 26.7382 | Seg Loss: 0.2673 | Recon Loss: 0.0084
  Val mIoU: 0.8138 (Best: 0.8420)
  [Class IoU]  C1: 0.8916 | C2: 0.8654 | C3: 0.6846
Epoch 289/400 | Train Loss: 26.3710
 Avg Train Loss: 26.3710 | Seg Loss: 0.2636 | Recon Loss: 0.0083
  Val mIoU: 0.8023 (Best: 0.8420)
  [Class IoU]  C1: 0.8650 | C2: 0.8645 | C3: 0.6774
Epoch 290/400 | Train Loss: 26.5057
 Avg Train Loss: 26.5057 | Seg Loss: 0.2650 | Recon Loss: 0.0083
  Val mIoU: 0.8004 (Best: 0.8420)
  [Class IoU]  C1: 0.8702 | C2: 0.8647 | C3: 0.6664
Epoch 291/400 | Train Loss: 26.2172
 Avg Train Loss: 26.2172 | Seg Loss: 0.2621 | Recon Loss: 0.0083
  Val mIoU: 0.8098 (Best: 0.8420)
  [Class IoU]  C1: 0.8930 | C2: 0.8591 | C3: 0.6775
Epoch 292/400 | Train Loss: 26.3776
 Avg Train Loss: 26.3776 | Seg Loss: 0.2637 | Recon Loss: 0.0083
  Val mIoU: 0.7892 (Best: 0.8420)
  [Class IoU]  C1: 0.8956 | C2: 0.8404 | C3: 0.6315
Epoch 293/400 | Train Loss: 26.4521
 Avg Train Loss: 26.4521 | Seg Loss: 0.2644 | Recon Loss: 0.0084
  Val mIoU: 0.8185 (Best: 0.8420)
  [Class IoU]  C1: 0.9139 | C2: 0.8616 | C3: 0.6801
Epoch 294/400 | Train Loss: 26.1721
 Avg Train Loss: 26.1721 | Seg Loss: 0.2616 | Recon Loss: 0.0083
  Val mIoU: 0.8256 (Best: 0.8420)
  [Class IoU]  C1: 0.9128 | C2: 0.8693 | C3: 0.6949
Epoch 295/400 | Train Loss: 26.0641
 Avg Train Loss: 26.0641 | Seg Loss: 0.2606 | Recon Loss: 0.0083
  Val mIoU: 0.8053 (Best: 0.8420)
  [Class IoU]  C1: 0.8841 | C2: 0.8651 | C3: 0.6668
Epoch 296/400 | Train Loss: 25.8995
 Avg Train Loss: 25.8995 | Seg Loss: 0.2589 | Recon Loss: 0.0083
  Val mIoU: 0.7967 (Best: 0.8420)
  [Class IoU]  C1: 0.8697 | C2: 0.8634 | C3: 0.6569
Epoch 297/400 | Train Loss: 26.1668
 Avg Train Loss: 26.1668 | Seg Loss: 0.2616 | Recon Loss: 0.0083
  Val mIoU: 0.8196 (Best: 0.8420)
  [Class IoU]  C1: 0.8819 | C2: 0.8735 | C3: 0.7034
Epoch 298/400 | Train Loss: 26.3077
 Avg Train Loss: 26.3077 | Seg Loss: 0.2630 | Recon Loss: 0.0084
  Val mIoU: 0.8038 (Best: 0.8420)
  [Class IoU]  C1: 0.9038 | C2: 0.8525 | C3: 0.6550
Epoch 299/400 | Train Loss: 26.7727
 Avg Train Loss: 26.7727 | Seg Loss: 0.2676 | Recon Loss: 0.0083
  Val mIoU: 0.8268 (Best: 0.8420)
  [Class IoU]  C1: 0.9164 | C2: 0.8743 | C3: 0.6897
Epoch 300/400 | Train Loss: 26.2300
 Avg Train Loss: 26.2300 | Seg Loss: 0.2622 | Recon Loss: 0.0083
  Val mIoU: 0.7980 (Best: 0.8420)
  [Class IoU]  C1: 0.8747 | C2: 0.8498 | C3: 0.6696
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 26.4352
 Avg Train Loss: 26.4352 | Seg Loss: 0.2643 | Recon Loss: 0.0082
  Val mIoU: 0.8259 (Best: 0.8420)
  [Class IoU]  C1: 0.9216 | C2: 0.8654 | C3: 0.6907
Epoch 302/400 | Train Loss: 26.2592
 Avg Train Loss: 26.2592 | Seg Loss: 0.2625 | Recon Loss: 0.0084
  Val mIoU: 0.7946 (Best: 0.8420)
  [Class IoU]  C1: 0.8308 | C2: 0.8660 | C3: 0.6870
Epoch 303/400 | Train Loss: 26.3449
 Avg Train Loss: 26.3449 | Seg Loss: 0.2634 | Recon Loss: 0.0082
  Val mIoU: 0.8192 (Best: 0.8420)
  [Class IoU]  C1: 0.8878 | C2: 0.8771 | C3: 0.6927
Epoch 304/400 | Train Loss: 26.2611
 Avg Train Loss: 26.2611 | Seg Loss: 0.2625 | Recon Loss: 0.0082
  Val mIoU: 0.8163 (Best: 0.8420)
  [Class IoU]  C1: 0.8908 | C2: 0.8590 | C3: 0.6992
Epoch 305/400 | Train Loss: 26.4615
 Avg Train Loss: 26.4615 | Seg Loss: 0.2645 | Recon Loss: 0.0082
  Val mIoU: 0.8182 (Best: 0.8420)
  [Class IoU]  C1: 0.9012 | C2: 0.8677 | C3: 0.6858
Epoch 306/400 | Train Loss: 26.5892
 Avg Train Loss: 26.5892 | Seg Loss: 0.2658 | Recon Loss: 0.0083
  Val mIoU: 0.8008 (Best: 0.8420)
  [Class IoU]  C1: 0.9129 | C2: 0.8503 | C3: 0.6391
Epoch 307/400 | Train Loss: 26.6097
 Avg Train Loss: 26.6097 | Seg Loss: 0.2660 | Recon Loss: 0.0083
  Val mIoU: 0.8115 (Best: 0.8420)
  [Class IoU]  C1: 0.9075 | C2: 0.8579 | C3: 0.6691
Epoch 308/400 | Train Loss: 25.9663
 Avg Train Loss: 25.9663 | Seg Loss: 0.2596 | Recon Loss: 0.0082
  Val mIoU: 0.8126 (Best: 0.8420)
  [Class IoU]  C1: 0.8641 | C2: 0.8722 | C3: 0.7014
Epoch 309/400 | Train Loss: 26.2876
 Avg Train Loss: 26.2876 | Seg Loss: 0.2628 | Recon Loss: 0.0083
  Val mIoU: 0.8248 (Best: 0.8420)
  [Class IoU]  C1: 0.8996 | C2: 0.8760 | C3: 0.6988
Epoch 310/400 | Train Loss: 25.8528
 Avg Train Loss: 25.8528 | Seg Loss: 0.2584 | Recon Loss: 0.0083
  Val mIoU: 0.8221 (Best: 0.8420)
  [Class IoU]  C1: 0.9040 | C2: 0.8615 | C3: 0.7008
Epoch 311/400 | Train Loss: 26.3020
 Avg Train Loss: 26.3020 | Seg Loss: 0.2629 | Recon Loss: 0.0083
  Val mIoU: 0.8158 (Best: 0.8420)
  [Class IoU]  C1: 0.8924 | C2: 0.8670 | C3: 0.6880
Epoch 312/400 | Train Loss: 26.8673
 Avg Train Loss: 26.8673 | Seg Loss: 0.2686 | Recon Loss: 0.0084
  Val mIoU: 0.8341 (Best: 0.8420)
  [Class IoU]  C1: 0.9198 | C2: 0.8719 | C3: 0.7107
Epoch 313/400 | Train Loss: 26.7492
 Avg Train Loss: 26.7492 | Seg Loss: 0.2674 | Recon Loss: 0.0083
  Val mIoU: 0.8265 (Best: 0.8420)
  [Class IoU]  C1: 0.8768 | C2: 0.8764 | C3: 0.7264
Epoch 314/400 | Train Loss: 26.0494
 Avg Train Loss: 26.0494 | Seg Loss: 0.2604 | Recon Loss: 0.0084
  Val mIoU: 0.8098 (Best: 0.8420)
  [Class IoU]  C1: 0.8937 | C2: 0.8596 | C3: 0.6761
Epoch 315/400 | Train Loss: 26.9140
 Avg Train Loss: 26.9140 | Seg Loss: 0.2691 | Recon Loss: 0.0082
  Val mIoU: 0.8131 (Best: 0.8420)
  [Class IoU]  C1: 0.9209 | C2: 0.8582 | C3: 0.6603
Epoch 316/400 | Train Loss: 26.2715
 Avg Train Loss: 26.2715 | Seg Loss: 0.2626 | Recon Loss: 0.0083
  Val mIoU: 0.7947 (Best: 0.8420)
  [Class IoU]  C1: 0.9069 | C2: 0.8431 | C3: 0.6341
Epoch 317/400 | Train Loss: 26.2774
 Avg Train Loss: 26.2774 | Seg Loss: 0.2627 | Recon Loss: 0.0082
  Val mIoU: 0.8136 (Best: 0.8420)
  [Class IoU]  C1: 0.9060 | C2: 0.8652 | C3: 0.6697
Epoch 318/400 | Train Loss: 25.7566
 Avg Train Loss: 25.7566 | Seg Loss: 0.2575 | Recon Loss: 0.0084
  Val mIoU: 0.8224 (Best: 0.8420)
  [Class IoU]  C1: 0.9161 | C2: 0.8669 | C3: 0.6842
Epoch 319/400 | Train Loss: 26.6413
 Avg Train Loss: 26.6413 | Seg Loss: 0.2663 | Recon Loss: 0.0083
  Val mIoU: 0.8295 (Best: 0.8420)
  [Class IoU]  C1: 0.9219 | C2: 0.8785 | C3: 0.6882
Epoch 320/400 | Train Loss: 26.8644
 Avg Train Loss: 26.8644 | Seg Loss: 0.2686 | Recon Loss: 0.0084
  Val mIoU: 0.8172 (Best: 0.8420)
  [Class IoU]  C1: 0.9219 | C2: 0.8645 | C3: 0.6653
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 26.3256
 Avg Train Loss: 26.3256 | Seg Loss: 0.2632 | Recon Loss: 0.0083
  Val mIoU: 0.8104 (Best: 0.8420)
  [Class IoU]  C1: 0.9204 | C2: 0.8531 | C3: 0.6576
Epoch 322/400 | Train Loss: 26.3330
 Avg Train Loss: 26.3330 | Seg Loss: 0.2632 | Recon Loss: 0.0082
  Val mIoU: 0.8278 (Best: 0.8420)
  [Class IoU]  C1: 0.9130 | C2: 0.8690 | C3: 0.7015
Epoch 323/400 | Train Loss: 25.9420
 Avg Train Loss: 25.9420 | Seg Loss: 0.2593 | Recon Loss: 0.0084
  Val mIoU: 0.7890 (Best: 0.8420)
  [Class IoU]  C1: 0.9080 | C2: 0.8360 | C3: 0.6231
Epoch 324/400 | Train Loss: 26.1111
 Avg Train Loss: 26.1111 | Seg Loss: 0.2610 | Recon Loss: 0.0082
  Val mIoU: 0.8047 (Best: 0.8420)
  [Class IoU]  C1: 0.8569 | C2: 0.8652 | C3: 0.6920
Epoch 325/400 | Train Loss: 26.8041
 Avg Train Loss: 26.8041 | Seg Loss: 0.2680 | Recon Loss: 0.0081
  Val mIoU: 0.8273 (Best: 0.8420)
  [Class IoU]  C1: 0.9217 | C2: 0.8727 | C3: 0.6875
Epoch 326/400 | Train Loss: 26.6480
 Avg Train Loss: 26.6480 | Seg Loss: 0.2664 | Recon Loss: 0.0082
  Val mIoU: 0.8032 (Best: 0.8420)
  [Class IoU]  C1: 0.8788 | C2: 0.8589 | C3: 0.6719
Epoch 327/400 | Train Loss: 26.3933
 Avg Train Loss: 26.3933 | Seg Loss: 0.2639 | Recon Loss: 0.0082
  Val mIoU: 0.8299 (Best: 0.8420)
  [Class IoU]  C1: 0.9222 | C2: 0.8721 | C3: 0.6952
Epoch 328/400 | Train Loss: 26.8470
 Avg Train Loss: 26.8470 | Seg Loss: 0.2684 | Recon Loss: 0.0082
  Val mIoU: 0.8134 (Best: 0.8420)
  [Class IoU]  C1: 0.8783 | C2: 0.8653 | C3: 0.6967
Epoch 329/400 | Train Loss: 26.9893
 Avg Train Loss: 26.9893 | Seg Loss: 0.2698 | Recon Loss: 0.0082
  Val mIoU: 0.8089 (Best: 0.8420)
  [Class IoU]  C1: 0.8720 | C2: 0.8688 | C3: 0.6861
Epoch 330/400 | Train Loss: 26.5082
 Avg Train Loss: 26.5082 | Seg Loss: 0.2650 | Recon Loss: 0.0082
  Val mIoU: 0.8140 (Best: 0.8420)
  [Class IoU]  C1: 0.9131 | C2: 0.8590 | C3: 0.6699
Epoch 331/400 | Train Loss: 25.9553
 Avg Train Loss: 25.9553 | Seg Loss: 0.2595 | Recon Loss: 0.0083
  Val mIoU: 0.7962 (Best: 0.8420)
  [Class IoU]  C1: 0.9193 | C2: 0.8399 | C3: 0.6295
Epoch 332/400 | Train Loss: 26.4127
 Avg Train Loss: 26.4127 | Seg Loss: 0.2640 | Recon Loss: 0.0083
  Val mIoU: 0.8081 (Best: 0.8420)
  [Class IoU]  C1: 0.8927 | C2: 0.8643 | C3: 0.6672
Epoch 333/400 | Train Loss: 26.8903
 Avg Train Loss: 26.8903 | Seg Loss: 0.2688 | Recon Loss: 0.0084
  Val mIoU: 0.8024 (Best: 0.8420)
  [Class IoU]  C1: 0.9152 | C2: 0.8525 | C3: 0.6395
Epoch 334/400 | Train Loss: 25.9956
 Avg Train Loss: 25.9956 | Seg Loss: 0.2599 | Recon Loss: 0.0083
  Val mIoU: 0.7870 (Best: 0.8420)
  [Class IoU]  C1: 0.9133 | C2: 0.8216 | C3: 0.6260
Epoch 335/400 | Train Loss: 26.2435
 Avg Train Loss: 26.2435 | Seg Loss: 0.2624 | Recon Loss: 0.0083
  Val mIoU: 0.8256 (Best: 0.8420)
  [Class IoU]  C1: 0.9204 | C2: 0.8678 | C3: 0.6887
Epoch 336/400 | Train Loss: 26.2507
 Avg Train Loss: 26.2507 | Seg Loss: 0.2624 | Recon Loss: 0.0082
  Val mIoU: 0.8230 (Best: 0.8420)
  [Class IoU]  C1: 0.9113 | C2: 0.8717 | C3: 0.6861
Epoch 337/400 | Train Loss: 26.6293
 Avg Train Loss: 26.6293 | Seg Loss: 0.2662 | Recon Loss: 0.0082
  Val mIoU: 0.8232 (Best: 0.8420)
  [Class IoU]  C1: 0.8935 | C2: 0.8664 | C3: 0.7098
Epoch 338/400 | Train Loss: 26.6077
 Avg Train Loss: 26.6077 | Seg Loss: 0.2660 | Recon Loss: 0.0084
  Val mIoU: 0.7998 (Best: 0.8420)
  [Class IoU]  C1: 0.8659 | C2: 0.8592 | C3: 0.6744
Epoch 339/400 | Train Loss: 26.7816
 Avg Train Loss: 26.7816 | Seg Loss: 0.2677 | Recon Loss: 0.0083
  Val mIoU: 0.8337 (Best: 0.8420)
  [Class IoU]  C1: 0.9162 | C2: 0.8754 | C3: 0.7095
Epoch 340/400 | Train Loss: 26.2158
 Avg Train Loss: 26.2158 | Seg Loss: 0.2621 | Recon Loss: 0.0083
  Val mIoU: 0.7969 (Best: 0.8420)
  [Class IoU]  C1: 0.8956 | C2: 0.8410 | C3: 0.6542
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 26.1623
 Avg Train Loss: 26.1623 | Seg Loss: 0.2615 | Recon Loss: 0.0082
  Val mIoU: 0.8067 (Best: 0.8420)
  [Class IoU]  C1: 0.8898 | C2: 0.8587 | C3: 0.6716
Epoch 342/400 | Train Loss: 25.8866
 Avg Train Loss: 25.8866 | Seg Loss: 0.2588 | Recon Loss: 0.0083
  Val mIoU: 0.8188 (Best: 0.8420)
  [Class IoU]  C1: 0.8825 | C2: 0.8695 | C3: 0.7043
Epoch 343/400 | Train Loss: 26.2256
 Avg Train Loss: 26.2256 | Seg Loss: 0.2622 | Recon Loss: 0.0084
  Val mIoU: 0.7886 (Best: 0.8420)
  [Class IoU]  C1: 0.8511 | C2: 0.8533 | C3: 0.6614
Epoch 344/400 | Train Loss: 26.7503
 Avg Train Loss: 26.7503 | Seg Loss: 0.2674 | Recon Loss: 0.0083
  Val mIoU: 0.8162 (Best: 0.8420)
  [Class IoU]  C1: 0.9016 | C2: 0.8667 | C3: 0.6803
Epoch 345/400 | Train Loss: 26.1499
 Avg Train Loss: 26.1499 | Seg Loss: 0.2614 | Recon Loss: 0.0084
  Val mIoU: 0.8125 (Best: 0.8420)
  [Class IoU]  C1: 0.9128 | C2: 0.8613 | C3: 0.6633
Epoch 346/400 | Train Loss: 26.6788
 Avg Train Loss: 26.6788 | Seg Loss: 0.2667 | Recon Loss: 0.0082
  Val mIoU: 0.8110 (Best: 0.8420)
  [Class IoU]  C1: 0.9148 | C2: 0.8535 | C3: 0.6647
Epoch 347/400 | Train Loss: 26.1073
 Avg Train Loss: 26.1073 | Seg Loss: 0.2610 | Recon Loss: 0.0082
  Val mIoU: 0.8015 (Best: 0.8420)
  [Class IoU]  C1: 0.8856 | C2: 0.8601 | C3: 0.6588
Epoch 348/400 | Train Loss: 25.6580
 Avg Train Loss: 25.6580 | Seg Loss: 0.2565 | Recon Loss: 0.0083
  Val mIoU: 0.7867 (Best: 0.8420)
  [Class IoU]  C1: 0.9185 | C2: 0.8403 | C3: 0.6014
Epoch 349/400 | Train Loss: 26.1538
 Avg Train Loss: 26.1538 | Seg Loss: 0.2615 | Recon Loss: 0.0082
  Val mIoU: 0.8226 (Best: 0.8420)
  [Class IoU]  C1: 0.9152 | C2: 0.8623 | C3: 0.6903
Epoch 350/400 | Train Loss: 26.3372
 Avg Train Loss: 26.3372 | Seg Loss: 0.2633 | Recon Loss: 0.0082
  Val mIoU: 0.8027 (Best: 0.8420)
  [Class IoU]  C1: 0.9117 | C2: 0.8603 | C3: 0.6362
Epoch 351/400 | Train Loss: 26.3212
 Avg Train Loss: 26.3212 | Seg Loss: 0.2631 | Recon Loss: 0.0083
  Val mIoU: 0.8331 (Best: 0.8420)
  [Class IoU]  C1: 0.9168 | C2: 0.8787 | C3: 0.7037
Epoch 352/400 | Train Loss: 26.6858
 Avg Train Loss: 26.6858 | Seg Loss: 0.2668 | Recon Loss: 0.0083
  Val mIoU: 0.8071 (Best: 0.8420)
  [Class IoU]  C1: 0.9058 | C2: 0.8580 | C3: 0.6575
Epoch 353/400 | Train Loss: 26.1829
 Avg Train Loss: 26.1829 | Seg Loss: 0.2617 | Recon Loss: 0.0083
  Val mIoU: 0.8043 (Best: 0.8420)
  [Class IoU]  C1: 0.9117 | C2: 0.8503 | C3: 0.6508
Epoch 354/400 | Train Loss: 26.3355
 Avg Train Loss: 26.3355 | Seg Loss: 0.2633 | Recon Loss: 0.0082
  Val mIoU: 0.7955 (Best: 0.8420)
  [Class IoU]  C1: 0.9196 | C2: 0.8413 | C3: 0.6254
Epoch 355/400 | Train Loss: 26.5640
 Avg Train Loss: 26.5640 | Seg Loss: 0.2656 | Recon Loss: 0.0083
  Val mIoU: 0.8043 (Best: 0.8420)
  [Class IoU]  C1: 0.8998 | C2: 0.8510 | C3: 0.6622
Epoch 356/400 | Train Loss: 26.7928
 Avg Train Loss: 26.7928 | Seg Loss: 0.2678 | Recon Loss: 0.0082
  Val mIoU: 0.8087 (Best: 0.8420)
  [Class IoU]  C1: 0.8891 | C2: 0.8666 | C3: 0.6703
Epoch 357/400 | Train Loss: 25.8654
 Avg Train Loss: 25.8654 | Seg Loss: 0.2586 | Recon Loss: 0.0083
  Val mIoU: 0.8144 (Best: 0.8420)
  [Class IoU]  C1: 0.9194 | C2: 0.8609 | C3: 0.6628
Epoch 358/400 | Train Loss: 25.9461
 Avg Train Loss: 25.9461 | Seg Loss: 0.2594 | Recon Loss: 0.0083
  Val mIoU: 0.7928 (Best: 0.8420)
  [Class IoU]  C1: 0.8599 | C2: 0.8619 | C3: 0.6566
Epoch 359/400 | Train Loss: 26.4018
 Avg Train Loss: 26.4018 | Seg Loss: 0.2639 | Recon Loss: 0.0082
  Val mIoU: 0.7967 (Best: 0.8420)
  [Class IoU]  C1: 0.9162 | C2: 0.8425 | C3: 0.6315
Epoch 360/400 | Train Loss: 25.8087
 Avg Train Loss: 25.8087 | Seg Loss: 0.2580 | Recon Loss: 0.0083
  Val mIoU: 0.8016 (Best: 0.8420)
  [Class IoU]  C1: 0.8799 | C2: 0.8564 | C3: 0.6684
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 26.3947
 Avg Train Loss: 26.3947 | Seg Loss: 0.2639 | Recon Loss: 0.0084
  Val mIoU: 0.8128 (Best: 0.8420)
  [Class IoU]  C1: 0.9161 | C2: 0.8599 | C3: 0.6625
Epoch 362/400 | Train Loss: 26.4080
 Avg Train Loss: 26.4080 | Seg Loss: 0.2640 | Recon Loss: 0.0082
  Val mIoU: 0.8035 (Best: 0.8420)
  [Class IoU]  C1: 0.8901 | C2: 0.8584 | C3: 0.6619
Epoch 363/400 | Train Loss: 26.5506
 Avg Train Loss: 26.5506 | Seg Loss: 0.2654 | Recon Loss: 0.0084
  Val mIoU: 0.7988 (Best: 0.8420)
  [Class IoU]  C1: 0.8697 | C2: 0.8532 | C3: 0.6736
Epoch 364/400 | Train Loss: 25.7285
 Avg Train Loss: 25.7285 | Seg Loss: 0.2572 | Recon Loss: 0.0082
  Val mIoU: 0.8061 (Best: 0.8420)
  [Class IoU]  C1: 0.8979 | C2: 0.8634 | C3: 0.6571
Epoch 365/400 | Train Loss: 26.6121
 Avg Train Loss: 26.6121 | Seg Loss: 0.2660 | Recon Loss: 0.0081
  Val mIoU: 0.8191 (Best: 0.8420)
  [Class IoU]  C1: 0.9114 | C2: 0.8643 | C3: 0.6817
Epoch 366/400 | Train Loss: 26.5434
 Avg Train Loss: 26.5434 | Seg Loss: 0.2654 | Recon Loss: 0.0083
  Val mIoU: 0.7969 (Best: 0.8420)
  [Class IoU]  C1: 0.8548 | C2: 0.8652 | C3: 0.6707
Epoch 367/400 | Train Loss: 26.0664
 Avg Train Loss: 26.0664 | Seg Loss: 0.2606 | Recon Loss: 0.0083
  Val mIoU: 0.8116 (Best: 0.8420)
  [Class IoU]  C1: 0.8889 | C2: 0.8642 | C3: 0.6818
Epoch 368/400 | Train Loss: 26.5909
 Avg Train Loss: 26.5909 | Seg Loss: 0.2658 | Recon Loss: 0.0082
  Val mIoU: 0.7794 (Best: 0.8420)
  [Class IoU]  C1: 0.8639 | C2: 0.8471 | C3: 0.6272
Epoch 369/400 | Train Loss: 26.1313
 Avg Train Loss: 26.1313 | Seg Loss: 0.2612 | Recon Loss: 0.0084
  Val mIoU: 0.8113 (Best: 0.8420)
  [Class IoU]  C1: 0.8857 | C2: 0.8668 | C3: 0.6815
Epoch 370/400 | Train Loss: 26.0234
 Avg Train Loss: 26.0234 | Seg Loss: 0.2602 | Recon Loss: 0.0084
  Val mIoU: 0.8117 (Best: 0.8420)
  [Class IoU]  C1: 0.8578 | C2: 0.8705 | C3: 0.7067
Epoch 371/400 | Train Loss: 25.8910
 Avg Train Loss: 25.8910 | Seg Loss: 0.2588 | Recon Loss: 0.0083
  Val mIoU: 0.8128 (Best: 0.8420)
  [Class IoU]  C1: 0.9017 | C2: 0.8592 | C3: 0.6775
Epoch 372/400 | Train Loss: 26.3092
 Avg Train Loss: 26.3092 | Seg Loss: 0.2630 | Recon Loss: 0.0083
  Val mIoU: 0.8105 (Best: 0.8420)
  [Class IoU]  C1: 0.9131 | C2: 0.8576 | C3: 0.6607
Epoch 373/400 | Train Loss: 26.9074
 Avg Train Loss: 26.9074 | Seg Loss: 0.2690 | Recon Loss: 0.0083
  Val mIoU: 0.8025 (Best: 0.8420)
  [Class IoU]  C1: 0.9165 | C2: 0.8496 | C3: 0.6413
Epoch 374/400 | Train Loss: 26.5740
 Avg Train Loss: 26.5740 | Seg Loss: 0.2657 | Recon Loss: 0.0084
  Val mIoU: 0.8195 (Best: 0.8420)
  [Class IoU]  C1: 0.9147 | C2: 0.8574 | C3: 0.6865
Epoch 375/400 | Train Loss: 26.3839
 Avg Train Loss: 26.3839 | Seg Loss: 0.2638 | Recon Loss: 0.0082
  Val mIoU: 0.8064 (Best: 0.8420)
  [Class IoU]  C1: 0.9116 | C2: 0.8536 | C3: 0.6541
Epoch 376/400 | Train Loss: 26.6495
 Avg Train Loss: 26.6495 | Seg Loss: 0.2664 | Recon Loss: 0.0083
  Val mIoU: 0.8012 (Best: 0.8420)
  [Class IoU]  C1: 0.8935 | C2: 0.8498 | C3: 0.6601
Epoch 377/400 | Train Loss: 26.1701
 Avg Train Loss: 26.1701 | Seg Loss: 0.2616 | Recon Loss: 0.0082
  Val mIoU: 0.7962 (Best: 0.8420)
  [Class IoU]  C1: 0.9228 | C2: 0.8476 | C3: 0.6183
Epoch 378/400 | Train Loss: 26.4307
 Avg Train Loss: 26.4307 | Seg Loss: 0.2642 | Recon Loss: 0.0082
  Val mIoU: 0.8283 (Best: 0.8420)
  [Class IoU]  C1: 0.9064 | C2: 0.8779 | C3: 0.7005
Epoch 379/400 | Train Loss: 25.9121
 Avg Train Loss: 25.9121 | Seg Loss: 0.2590 | Recon Loss: 0.0084
  Val mIoU: 0.8138 (Best: 0.8420)
  [Class IoU]  C1: 0.9087 | C2: 0.8652 | C3: 0.6676
Epoch 380/400 | Train Loss: 26.2003
 Avg Train Loss: 26.2003 | Seg Loss: 0.2619 | Recon Loss: 0.0082
  Val mIoU: 0.8161 (Best: 0.8420)
  [Class IoU]  C1: 0.9194 | C2: 0.8591 | C3: 0.6699
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 26.4353
 Avg Train Loss: 26.4353 | Seg Loss: 0.2643 | Recon Loss: 0.0083
  Val mIoU: 0.8347 (Best: 0.8420)
  [Class IoU]  C1: 0.9012 | C2: 0.8768 | C3: 0.7263
Epoch 382/400 | Train Loss: 26.2158
 Avg Train Loss: 26.2158 | Seg Loss: 0.2621 | Recon Loss: 0.0084
  Val mIoU: 0.8123 (Best: 0.8420)
  [Class IoU]  C1: 0.8681 | C2: 0.8679 | C3: 0.7010
Epoch 383/400 | Train Loss: 26.7210
 Avg Train Loss: 26.7210 | Seg Loss: 0.2671 | Recon Loss: 0.0084
  Val mIoU: 0.8248 (Best: 0.8420)
  [Class IoU]  C1: 0.9154 | C2: 0.8704 | C3: 0.6886
Epoch 384/400 | Train Loss: 26.2518
 Avg Train Loss: 26.2518 | Seg Loss: 0.2624 | Recon Loss: 0.0083
  Val mIoU: 0.8191 (Best: 0.8420)
  [Class IoU]  C1: 0.9046 | C2: 0.8653 | C3: 0.6874
Epoch 385/400 | Train Loss: 26.5783
 Avg Train Loss: 26.5783 | Seg Loss: 0.2657 | Recon Loss: 0.0083
  Val mIoU: 0.8143 (Best: 0.8420)
  [Class IoU]  C1: 0.9198 | C2: 0.8619 | C3: 0.6611
Epoch 386/400 | Train Loss: 26.0865
 Avg Train Loss: 26.0865 | Seg Loss: 0.2608 | Recon Loss: 0.0084
  Val mIoU: 0.7792 (Best: 0.8420)
  [Class IoU]  C1: 0.8899 | C2: 0.8352 | C3: 0.6125
Epoch 387/400 | Train Loss: 26.0472
 Avg Train Loss: 26.0472 | Seg Loss: 0.2604 | Recon Loss: 0.0083
  Val mIoU: 0.8041 (Best: 0.8420)
  [Class IoU]  C1: 0.9179 | C2: 0.8543 | C3: 0.6401
Epoch 388/400 | Train Loss: 26.1313
 Avg Train Loss: 26.1313 | Seg Loss: 0.2612 | Recon Loss: 0.0083
  Val mIoU: 0.8063 (Best: 0.8420)
  [Class IoU]  C1: 0.9174 | C2: 0.8541 | C3: 0.6475
Epoch 389/400 | Train Loss: 26.6510
 Avg Train Loss: 26.6510 | Seg Loss: 0.2664 | Recon Loss: 0.0082
  Val mIoU: 0.8027 (Best: 0.8420)
  [Class IoU]  C1: 0.9028 | C2: 0.8524 | C3: 0.6530
Epoch 390/400 | Train Loss: 25.7033
 Avg Train Loss: 25.7033 | Seg Loss: 0.2570 | Recon Loss: 0.0083
  Val mIoU: 0.8017 (Best: 0.8420)
  [Class IoU]  C1: 0.8424 | C2: 0.8678 | C3: 0.6948
Epoch 391/400 | Train Loss: 26.5541
 Avg Train Loss: 26.5541 | Seg Loss: 0.2655 | Recon Loss: 0.0083
  Val mIoU: 0.8097 (Best: 0.8420)
  [Class IoU]  C1: 0.9197 | C2: 0.8529 | C3: 0.6566
Epoch 392/400 | Train Loss: 26.2931
 Avg Train Loss: 26.2931 | Seg Loss: 0.2628 | Recon Loss: 0.0082
  Val mIoU: 0.7884 (Best: 0.8420)
  [Class IoU]  C1: 0.9042 | C2: 0.8414 | C3: 0.6196
Epoch 393/400 | Train Loss: 25.6536
 Avg Train Loss: 25.6536 | Seg Loss: 0.2565 | Recon Loss: 0.0083
  Val mIoU: 0.8089 (Best: 0.8420)
  [Class IoU]  C1: 0.9006 | C2: 0.8559 | C3: 0.6701
Epoch 394/400 | Train Loss: 26.3370
 Avg Train Loss: 26.3370 | Seg Loss: 0.2633 | Recon Loss: 0.0082
  Val mIoU: 0.7889 (Best: 0.8420)
  [Class IoU]  C1: 0.8904 | C2: 0.8470 | C3: 0.6293
Epoch 395/400 | Train Loss: 26.2037
 Avg Train Loss: 26.2037 | Seg Loss: 0.2620 | Recon Loss: 0.0083
  Val mIoU: 0.8189 (Best: 0.8420)
  [Class IoU]  C1: 0.9035 | C2: 0.8690 | C3: 0.6842
Epoch 396/400 | Train Loss: 26.6875
 Avg Train Loss: 26.6875 | Seg Loss: 0.2668 | Recon Loss: 0.0083
  Val mIoU: 0.8277 (Best: 0.8420)
  [Class IoU]  C1: 0.8994 | C2: 0.8723 | C3: 0.7116
Epoch 397/400 | Train Loss: 26.8487
 Avg Train Loss: 26.8487 | Seg Loss: 0.2684 | Recon Loss: 0.0082
  Val mIoU: 0.7790 (Best: 0.8420)
  [Class IoU]  C1: 0.8939 | C2: 0.8332 | C3: 0.6101
Epoch 398/400 | Train Loss: 26.3312
 Avg Train Loss: 26.3312 | Seg Loss: 0.2632 | Recon Loss: 0.0084
  Val mIoU: 0.7990 (Best: 0.8420)
  [Class IoU]  C1: 0.8594 | C2: 0.8646 | C3: 0.6730
Epoch 399/400 | Train Loss: 25.9197
 Avg Train Loss: 25.9197 | Seg Loss: 0.2591 | Recon Loss: 0.0083
  Val mIoU: 0.8189 (Best: 0.8420)
  [Class IoU]  C1: 0.9143 | C2: 0.8609 | C3: 0.6814
Epoch 400/400 | Train Loss: 26.2233
 Avg Train Loss: 26.2233 | Seg Loss: 0.2622 | Recon Loss: 0.0083
  Val mIoU: 0.7984 (Best: 0.8420)
  [Class IoU]  C1: 0.8966 | C2: 0.8494 | C3: 0.6492
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights...
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27197801: <AG_job> in cluster <dcc> Done

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Thu Nov 27 19:34:27 2025
Job was executed on host(s) <8*n-62-13-15>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Thu Nov 27 19:50:58 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Thu Nov 27 19:50:58 2025
Terminated at Fri Nov 28 00:43:12 2025
Results reported at Fri Nov 28 00:43:12 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   91541.00 sec.
    Max Memory :                                 2618 MB
    Average Memory :                             1950.90 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               521670.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                81
    Run time :                                   17559 sec.
    Turnaround time :                            18525 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27197801.err> for stderr output of this job.

