Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([0.1000, 1.0000, 1.0000, 5.0000], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Loaders Ready ---
Train Batches: 59
Val Batches: 16
--- Starting Training ---
Epoch 1/800 | Train Loss: 2.4158
 Avg Train Loss: 2.4158 | Seg Loss: 0.4783 | Recon Loss: 0.0243
  Val mIoU: 0.6231 (Best: 0.0000)
  [Class IoU]  C1: 0.9039 | C2: 0.7765 | C3: 0.1890
  --> New Best Model Saved!
Epoch 2/800 | Train Loss: 3.7351
 Avg Train Loss: 3.7351 | Seg Loss: 0.3979 | Recon Loss: 0.0098
  Val mIoU: 0.6085 (Best: 0.6231)
  [Class IoU]  C1: 0.8881 | C2: 0.7753 | C3: 0.1621
Epoch 3/800 | Train Loss: 2.4567
 Avg Train Loss: 2.4567 | Seg Loss: 0.3688 | Recon Loss: 0.0086
  Val mIoU: 0.6252 (Best: 0.6231)
  [Class IoU]  C1: 0.9015 | C2: 0.7599 | C3: 0.2143
  --> New Best Model Saved!
Epoch 4/800 | Train Loss: 2.1985
 Avg Train Loss: 2.1985 | Seg Loss: 0.3645 | Recon Loss: 0.0073
  Val mIoU: 0.5954 (Best: 0.6252)
  [Class IoU]  C1: 0.9089 | C2: 0.7693 | C3: 0.1081
Epoch 5/800 | Train Loss: 2.0426
 Avg Train Loss: 2.0426 | Seg Loss: 0.3568 | Recon Loss: 0.0073
  Val mIoU: 0.6358 (Best: 0.6252)
  [Class IoU]  C1: 0.8985 | C2: 0.7777 | C3: 0.2313
  --> New Best Model Saved!
Epoch 6/800 | Train Loss: 1.9262
 Avg Train Loss: 1.9262 | Seg Loss: 0.3530 | Recon Loss: 0.0067
  Val mIoU: 0.6382 (Best: 0.6358)
  [Class IoU]  C1: 0.9196 | C2: 0.7759 | C3: 0.2191
  --> New Best Model Saved!
Epoch 7/800 | Train Loss: 1.8086
 Avg Train Loss: 1.8086 | Seg Loss: 0.3444 | Recon Loss: 0.0067
  Val mIoU: 0.6122 (Best: 0.6382)
  [Class IoU]  C1: 0.8665 | C2: 0.7697 | C3: 0.2003
Epoch 8/800 | Train Loss: 1.8055
 Avg Train Loss: 1.8055 | Seg Loss: 0.3476 | Recon Loss: 0.0062
  Val mIoU: 0.6156 (Best: 0.6382)
  [Class IoU]  C1: 0.9041 | C2: 0.7673 | C3: 0.1754
Epoch 9/800 | Train Loss: 1.7434
 Avg Train Loss: 1.7434 | Seg Loss: 0.3398 | Recon Loss: 0.0063
  Val mIoU: 0.6833 (Best: 0.6382)
  [Class IoU]  C1: 0.9172 | C2: 0.7927 | C3: 0.3400
  --> New Best Model Saved!
Epoch 10/800 | Train Loss: 1.7427
 Avg Train Loss: 1.7427 | Seg Loss: 0.3425 | Recon Loss: 0.0061
  Val mIoU: 0.6483 (Best: 0.6833)
  [Class IoU]  C1: 0.9028 | C2: 0.7846 | C3: 0.2577
Epoch 11/800 | Train Loss: 1.7495
 Avg Train Loss: 1.7495 | Seg Loss: 0.3450 | Recon Loss: 0.0058
  Val mIoU: 0.6172 (Best: 0.6833)
  [Class IoU]  C1: 0.9259 | C2: 0.7732 | C3: 0.1524
Epoch 12/800 | Train Loss: 1.7324
 Avg Train Loss: 1.7324 | Seg Loss: 0.3430 | Recon Loss: 0.0058
  Val mIoU: 0.6441 (Best: 0.6833)
  [Class IoU]  C1: 0.9013 | C2: 0.7762 | C3: 0.2550
Epoch 13/800 | Train Loss: 1.6556
 Avg Train Loss: 1.6556 | Seg Loss: 0.3281 | Recon Loss: 0.0057
  Val mIoU: 0.6488 (Best: 0.6833)
  [Class IoU]  C1: 0.9180 | C2: 0.7818 | C3: 0.2467
Epoch 14/800 | Train Loss: 1.6629
 Avg Train Loss: 1.6629 | Seg Loss: 0.3302 | Recon Loss: 0.0057
  Val mIoU: 0.6723 (Best: 0.6833)
  [Class IoU]  C1: 0.9166 | C2: 0.7894 | C3: 0.3107
Epoch 15/800 | Train Loss: 1.7215
 Avg Train Loss: 1.7215 | Seg Loss: 0.3420 | Recon Loss: 0.0057
  Val mIoU: 0.6396 (Best: 0.6833)
  [Class IoU]  C1: 0.9037 | C2: 0.7765 | C3: 0.2385
Epoch 16/800 | Train Loss: 1.6476
 Avg Train Loss: 1.6476 | Seg Loss: 0.3269 | Recon Loss: 0.0054
  Val mIoU: 0.6050 (Best: 0.6833)
  [Class IoU]  C1: 0.8575 | C2: 0.7769 | C3: 0.1807
Epoch 17/800 | Train Loss: 1.7031
 Avg Train Loss: 1.7031 | Seg Loss: 0.3379 | Recon Loss: 0.0055
  Val mIoU: 0.6409 (Best: 0.6833)
  [Class IoU]  C1: 0.8939 | C2: 0.7469 | C3: 0.2820
Epoch 18/800 | Train Loss: 1.7005
 Avg Train Loss: 1.7005 | Seg Loss: 0.3377 | Recon Loss: 0.0057
  Val mIoU: 0.6825 (Best: 0.6833)
  [Class IoU]  C1: 0.9094 | C2: 0.7936 | C3: 0.3445
Epoch 19/800 | Train Loss: 1.6797
 Avg Train Loss: 1.6797 | Seg Loss: 0.3332 | Recon Loss: 0.0054
  Val mIoU: 0.6653 (Best: 0.6833)
  [Class IoU]  C1: 0.9203 | C2: 0.7942 | C3: 0.2815
Epoch 20/800 | Train Loss: 1.6665
 Avg Train Loss: 1.6665 | Seg Loss: 0.3302 | Recon Loss: 0.0054
  Val mIoU: 0.6521 (Best: 0.6833)
  [Class IoU]  C1: 0.9217 | C2: 0.7805 | C3: 0.2540
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0020_predictions.png
Epoch 21/800 | Train Loss: 1.6880
 Avg Train Loss: 1.6880 | Seg Loss: 0.3311 | Recon Loss: 0.0054
  Val mIoU: 0.7145 (Best: 0.6833)
  [Class IoU]  C1: 0.9082 | C2: 0.7913 | C3: 0.4438
  --> New Best Model Saved!
Epoch 22/800 | Train Loss: 1.7211
 Avg Train Loss: 1.7211 | Seg Loss: 0.3402 | Recon Loss: 0.0056
  Val mIoU: 0.7128 (Best: 0.7145)
  [Class IoU]  C1: 0.9208 | C2: 0.7996 | C3: 0.4180
Epoch 23/800 | Train Loss: 1.6556
 Avg Train Loss: 1.6556 | Seg Loss: 0.3279 | Recon Loss: 0.0054
  Val mIoU: 0.7210 (Best: 0.7145)
  [Class IoU]  C1: 0.9183 | C2: 0.8021 | C3: 0.4427
  --> New Best Model Saved!
Epoch 24/800 | Train Loss: 1.7223
 Avg Train Loss: 1.7223 | Seg Loss: 0.3388 | Recon Loss: 0.0055
  Val mIoU: 0.6322 (Best: 0.7210)
  [Class IoU]  C1: 0.8524 | C2: 0.7801 | C3: 0.2640
Epoch 25/800 | Train Loss: 1.6695
 Avg Train Loss: 1.6695 | Seg Loss: 0.3308 | Recon Loss: 0.0056
  Val mIoU: 0.6796 (Best: 0.7210)
  [Class IoU]  C1: 0.9189 | C2: 0.7904 | C3: 0.3295
Epoch 26/800 | Train Loss: 1.6679
 Avg Train Loss: 1.6679 | Seg Loss: 0.3308 | Recon Loss: 0.0056
  Val mIoU: 0.6792 (Best: 0.7210)
  [Class IoU]  C1: 0.9128 | C2: 0.7876 | C3: 0.3371
Epoch 27/800 | Train Loss: 1.6700
 Avg Train Loss: 1.6700 | Seg Loss: 0.3319 | Recon Loss: 0.0054
  Val mIoU: 0.7296 (Best: 0.7210)
  [Class IoU]  C1: 0.9157 | C2: 0.8143 | C3: 0.4588
  --> New Best Model Saved!
Epoch 28/800 | Train Loss: 1.6393
 Avg Train Loss: 1.6393 | Seg Loss: 0.3265 | Recon Loss: 0.0055
  Val mIoU: 0.6547 (Best: 0.7296)
  [Class IoU]  C1: 0.9272 | C2: 0.7888 | C3: 0.2482
Epoch 29/800 | Train Loss: 1.5901
 Avg Train Loss: 1.5901 | Seg Loss: 0.3146 | Recon Loss: 0.0055
  Val mIoU: 0.7065 (Best: 0.7296)
  [Class IoU]  C1: 0.9082 | C2: 0.8009 | C3: 0.4104
Epoch 30/800 | Train Loss: 1.6271
 Avg Train Loss: 1.6271 | Seg Loss: 0.3224 | Recon Loss: 0.0056
  Val mIoU: 0.6475 (Best: 0.7296)
  [Class IoU]  C1: 0.9171 | C2: 0.7845 | C3: 0.2408
Epoch 31/800 | Train Loss: 1.6378
 Avg Train Loss: 1.6378 | Seg Loss: 0.3260 | Recon Loss: 0.0055
  Val mIoU: 0.7007 (Best: 0.7296)
  [Class IoU]  C1: 0.9283 | C2: 0.8042 | C3: 0.3696
Epoch 32/800 | Train Loss: 1.6416
 Avg Train Loss: 1.6416 | Seg Loss: 0.3269 | Recon Loss: 0.0056
  Val mIoU: 0.6899 (Best: 0.7296)
  [Class IoU]  C1: 0.9253 | C2: 0.7997 | C3: 0.3445
Epoch 33/800 | Train Loss: 1.6240
 Avg Train Loss: 1.6240 | Seg Loss: 0.3231 | Recon Loss: 0.0056
  Val mIoU: 0.6725 (Best: 0.7296)
  [Class IoU]  C1: 0.9168 | C2: 0.7922 | C3: 0.3085
Epoch 34/800 | Train Loss: 1.6410
 Avg Train Loss: 1.6410 | Seg Loss: 0.3259 | Recon Loss: 0.0055
  Val mIoU: 0.6844 (Best: 0.7296)
  [Class IoU]  C1: 0.9257 | C2: 0.7963 | C3: 0.3312
Epoch 35/800 | Train Loss: 1.6201
 Avg Train Loss: 1.6201 | Seg Loss: 0.3224 | Recon Loss: 0.0056
  Val mIoU: 0.6778 (Best: 0.7296)
  [Class IoU]  C1: 0.9207 | C2: 0.7958 | C3: 0.3170
Epoch 36/800 | Train Loss: 1.6421
 Avg Train Loss: 1.6421 | Seg Loss: 0.3271 | Recon Loss: 0.0056
  Val mIoU: 0.7294 (Best: 0.7296)
  [Class IoU]  C1: 0.9273 | C2: 0.8124 | C3: 0.4483
Epoch 37/800 | Train Loss: 1.5992
 Avg Train Loss: 1.5992 | Seg Loss: 0.3183 | Recon Loss: 0.0056
  Val mIoU: 0.6867 (Best: 0.7296)
  [Class IoU]  C1: 0.9078 | C2: 0.7729 | C3: 0.3795
Epoch 38/800 | Train Loss: 1.5854
 Avg Train Loss: 1.5854 | Seg Loss: 0.3153 | Recon Loss: 0.0056
  Val mIoU: 0.7176 (Best: 0.7296)
  [Class IoU]  C1: 0.8958 | C2: 0.7987 | C3: 0.4583
Epoch 39/800 | Train Loss: 1.6407
 Avg Train Loss: 1.6407 | Seg Loss: 0.3255 | Recon Loss: 0.0056
  Val mIoU: 0.7092 (Best: 0.7296)
  [Class IoU]  C1: 0.9257 | C2: 0.8061 | C3: 0.3958
Epoch 40/800 | Train Loss: 1.5953
 Avg Train Loss: 1.5953 | Seg Loss: 0.3171 | Recon Loss: 0.0056
  Val mIoU: 0.7398 (Best: 0.7296)
  [Class IoU]  C1: 0.9232 | C2: 0.8175 | C3: 0.4788
  --> New Best Model Saved!
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0040_predictions.png
Epoch 41/800 | Train Loss: 1.5995
 Avg Train Loss: 1.5995 | Seg Loss: 0.3185 | Recon Loss: 0.0057
  Val mIoU: 0.6877 (Best: 0.7398)
  [Class IoU]  C1: 0.9024 | C2: 0.7722 | C3: 0.3885
Epoch 42/800 | Train Loss: 1.5797
 Avg Train Loss: 1.5797 | Seg Loss: 0.3145 | Recon Loss: 0.0057
  Val mIoU: 0.6339 (Best: 0.7398)
  [Class IoU]  C1: 0.8817 | C2: 0.7727 | C3: 0.2472
Epoch 43/800 | Train Loss: 1.5918
 Avg Train Loss: 1.5918 | Seg Loss: 0.3169 | Recon Loss: 0.0057
  Val mIoU: 0.6520 (Best: 0.7398)
  [Class IoU]  C1: 0.9195 | C2: 0.7872 | C3: 0.2492
Epoch 44/800 | Train Loss: 1.5938
 Avg Train Loss: 1.5938 | Seg Loss: 0.3175 | Recon Loss: 0.0056
  Val mIoU: 0.7091 (Best: 0.7398)
  [Class IoU]  C1: 0.9026 | C2: 0.7977 | C3: 0.4268
Epoch 45/800 | Train Loss: 1.6837
 Avg Train Loss: 1.6837 | Seg Loss: 0.3355 | Recon Loss: 0.0058
  Val mIoU: 0.7516 (Best: 0.7398)
  [Class IoU]  C1: 0.9232 | C2: 0.8108 | C3: 0.5208
  --> New Best Model Saved!
Epoch 46/800 | Train Loss: 1.6469
 Avg Train Loss: 1.6469 | Seg Loss: 0.3282 | Recon Loss: 0.0059
  Val mIoU: 0.6675 (Best: 0.7516)
  [Class IoU]  C1: 0.8745 | C2: 0.7470 | C3: 0.3810
Epoch 47/800 | Train Loss: 1.6548
 Avg Train Loss: 1.6548 | Seg Loss: 0.3298 | Recon Loss: 0.0057
  Val mIoU: 0.6859 (Best: 0.7516)
  [Class IoU]  C1: 0.9175 | C2: 0.7942 | C3: 0.3459
Epoch 48/800 | Train Loss: 1.5986
 Avg Train Loss: 1.5986 | Seg Loss: 0.3184 | Recon Loss: 0.0057
  Val mIoU: 0.7317 (Best: 0.7516)
  [Class IoU]  C1: 0.8634 | C2: 0.7916 | C3: 0.5401
Epoch 49/800 | Train Loss: 1.5594
 Avg Train Loss: 1.5594 | Seg Loss: 0.3105 | Recon Loss: 0.0058
  Val mIoU: 0.6932 (Best: 0.7516)
  [Class IoU]  C1: 0.9178 | C2: 0.7916 | C3: 0.3703
Epoch 50/800 | Train Loss: 1.6208
 Avg Train Loss: 1.6208 | Seg Loss: 0.3226 | Recon Loss: 0.0058
  Val mIoU: 0.6828 (Best: 0.7516)
  [Class IoU]  C1: 0.9134 | C2: 0.7989 | C3: 0.3360
Epoch 51/800 | Train Loss: 1.5704
 Avg Train Loss: 1.5704 | Seg Loss: 0.3117 | Recon Loss: 0.0058
  Val mIoU: 0.7029 (Best: 0.7516)
  [Class IoU]  C1: 0.9164 | C2: 0.8079 | C3: 0.3846
Epoch 52/800 | Train Loss: 1.5968
 Avg Train Loss: 1.5968 | Seg Loss: 0.3177 | Recon Loss: 0.0059
  Val mIoU: 0.7789 (Best: 0.7516)
  [Class IoU]  C1: 0.9261 | C2: 0.8145 | C3: 0.5960
  --> New Best Model Saved!
Epoch 53/800 | Train Loss: 1.5693
 Avg Train Loss: 1.5693 | Seg Loss: 0.3126 | Recon Loss: 0.0058
  Val mIoU: 0.6614 (Best: 0.7789)
  [Class IoU]  C1: 0.8681 | C2: 0.7753 | C3: 0.3408
Epoch 54/800 | Train Loss: 1.6008
 Avg Train Loss: 1.6008 | Seg Loss: 0.3189 | Recon Loss: 0.0059
  Val mIoU: 0.6901 (Best: 0.7789)
  [Class IoU]  C1: 0.9253 | C2: 0.7998 | C3: 0.3452
Epoch 55/800 | Train Loss: 1.6231
 Avg Train Loss: 1.6231 | Seg Loss: 0.3233 | Recon Loss: 0.0059
  Val mIoU: 0.6437 (Best: 0.7789)
  [Class IoU]  C1: 0.9116 | C2: 0.7746 | C3: 0.2449
Epoch 56/800 | Train Loss: 1.6211
 Avg Train Loss: 1.6211 | Seg Loss: 0.3230 | Recon Loss: 0.0058
  Val mIoU: 0.6972 (Best: 0.7789)
  [Class IoU]  C1: 0.9231 | C2: 0.8006 | C3: 0.3679
Epoch 57/800 | Train Loss: 1.6005
 Avg Train Loss: 1.6005 | Seg Loss: 0.3188 | Recon Loss: 0.0059
  Val mIoU: 0.6553 (Best: 0.7789)
  [Class IoU]  C1: 0.9115 | C2: 0.7796 | C3: 0.2749
Epoch 58/800 | Train Loss: 1.5959
 Avg Train Loss: 1.5959 | Seg Loss: 0.3179 | Recon Loss: 0.0060
  Val mIoU: 0.7316 (Best: 0.7789)
  [Class IoU]  C1: 0.9142 | C2: 0.7983 | C3: 0.4822
Epoch 59/800 | Train Loss: 1.5884
 Avg Train Loss: 1.5884 | Seg Loss: 0.3164 | Recon Loss: 0.0060
  Val mIoU: 0.6281 (Best: 0.7789)
  [Class IoU]  C1: 0.9102 | C2: 0.7618 | C3: 0.2123
Epoch 60/800 | Train Loss: 1.5794
 Avg Train Loss: 1.5794 | Seg Loss: 0.3147 | Recon Loss: 0.0059
  Val mIoU: 0.6999 (Best: 0.7789)
  [Class IoU]  C1: 0.9027 | C2: 0.7881 | C3: 0.4087
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0060_predictions.png
Epoch 61/800 | Train Loss: 1.5789
 Avg Train Loss: 1.5789 | Seg Loss: 0.3145 | Recon Loss: 0.0061
  Val mIoU: 0.6846 (Best: 0.7789)
  [Class IoU]  C1: 0.9222 | C2: 0.7967 | C3: 0.3348
Epoch 62/800 | Train Loss: 1.5737
 Avg Train Loss: 1.5737 | Seg Loss: 0.3135 | Recon Loss: 0.0060
  Val mIoU: 0.6344 (Best: 0.7789)
  [Class IoU]  C1: 0.9259 | C2: 0.7794 | C3: 0.1978
Epoch 63/800 | Train Loss: 1.5444
 Avg Train Loss: 1.5444 | Seg Loss: 0.3077 | Recon Loss: 0.0058
  Val mIoU: 0.7047 (Best: 0.7789)
  [Class IoU]  C1: 0.9170 | C2: 0.7953 | C3: 0.4018
Epoch 64/800 | Train Loss: 1.5416
 Avg Train Loss: 1.5416 | Seg Loss: 0.3071 | Recon Loss: 0.0059
  Val mIoU: 0.6971 (Best: 0.7789)
  [Class IoU]  C1: 0.8868 | C2: 0.7863 | C3: 0.4183
Epoch 65/800 | Train Loss: 1.5882
 Avg Train Loss: 1.5882 | Seg Loss: 0.3164 | Recon Loss: 0.0058
  Val mIoU: 0.7218 (Best: 0.7789)
  [Class IoU]  C1: 0.9131 | C2: 0.7915 | C3: 0.4606
Epoch 66/800 | Train Loss: 1.5498
 Avg Train Loss: 1.5498 | Seg Loss: 0.3087 | Recon Loss: 0.0060
  Val mIoU: 0.7126 (Best: 0.7789)
  [Class IoU]  C1: 0.9130 | C2: 0.7808 | C3: 0.4440
Epoch 67/800 | Train Loss: 1.6226
 Avg Train Loss: 1.6226 | Seg Loss: 0.3233 | Recon Loss: 0.0059
  Val mIoU: 0.6586 (Best: 0.7789)
  [Class IoU]  C1: 0.9238 | C2: 0.7776 | C3: 0.2744
Epoch 68/800 | Train Loss: 1.5874
 Avg Train Loss: 1.5874 | Seg Loss: 0.3162 | Recon Loss: 0.0059
  Val mIoU: 0.6529 (Best: 0.7789)
  [Class IoU]  C1: 0.9195 | C2: 0.7870 | C3: 0.2521
Epoch 69/800 | Train Loss: 1.5757
 Avg Train Loss: 1.5757 | Seg Loss: 0.3139 | Recon Loss: 0.0059
  Val mIoU: 0.6866 (Best: 0.7789)
  [Class IoU]  C1: 0.9118 | C2: 0.7750 | C3: 0.3729
Epoch 70/800 | Train Loss: 1.5760
 Avg Train Loss: 1.5760 | Seg Loss: 0.3137 | Recon Loss: 0.0059
  Val mIoU: 0.7681 (Best: 0.7789)
  [Class IoU]  C1: 0.9068 | C2: 0.8037 | C3: 0.5936
Epoch 71/800 | Train Loss: 1.5488
 Avg Train Loss: 1.5488 | Seg Loss: 0.3079 | Recon Loss: 0.0060
  Val mIoU: 0.7105 (Best: 0.7789)
  [Class IoU]  C1: 0.9204 | C2: 0.7766 | C3: 0.4344
Epoch 72/800 | Train Loss: 1.5545
 Avg Train Loss: 1.5545 | Seg Loss: 0.3092 | Recon Loss: 0.0060
  Val mIoU: 0.7092 (Best: 0.7789)
  [Class IoU]  C1: 0.9153 | C2: 0.7938 | C3: 0.4186
Epoch 73/800 | Train Loss: 1.5697
 Avg Train Loss: 1.5697 | Seg Loss: 0.3127 | Recon Loss: 0.0059
  Val mIoU: 0.6423 (Best: 0.7789)
  [Class IoU]  C1: 0.8861 | C2: 0.7492 | C3: 0.2917
Epoch 74/800 | Train Loss: 1.5889
 Avg Train Loss: 1.5889 | Seg Loss: 0.3166 | Recon Loss: 0.0058
  Val mIoU: 0.6639 (Best: 0.7789)
  [Class IoU]  C1: 0.9208 | C2: 0.7891 | C3: 0.2818
Epoch 75/800 | Train Loss: 1.5273
 Avg Train Loss: 1.5273 | Seg Loss: 0.3043 | Recon Loss: 0.0058
  Val mIoU: 0.7092 (Best: 0.7789)
  [Class IoU]  C1: 0.8989 | C2: 0.8022 | C3: 0.4265
Epoch 76/800 | Train Loss: 1.5453
 Avg Train Loss: 1.5453 | Seg Loss: 0.3079 | Recon Loss: 0.0058
  Val mIoU: 0.7307 (Best: 0.7789)
  [Class IoU]  C1: 0.8799 | C2: 0.7808 | C3: 0.5313
Epoch 77/800 | Train Loss: 1.5889
 Avg Train Loss: 1.5889 | Seg Loss: 0.3166 | Recon Loss: 0.0059
  Val mIoU: 0.6463 (Best: 0.7789)
  [Class IoU]  C1: 0.8949 | C2: 0.7729 | C3: 0.2710
Epoch 78/800 | Train Loss: 1.5670
 Avg Train Loss: 1.5670 | Seg Loss: 0.3122 | Recon Loss: 0.0058
  Val mIoU: 0.7092 (Best: 0.7789)
  [Class IoU]  C1: 0.9018 | C2: 0.8087 | C3: 0.4170
Epoch 79/800 | Train Loss: 1.5677
 Avg Train Loss: 1.5677 | Seg Loss: 0.3124 | Recon Loss: 0.0058
  Val mIoU: 0.6760 (Best: 0.7789)
  [Class IoU]  C1: 0.8973 | C2: 0.7892 | C3: 0.3414
Epoch 80/800 | Train Loss: 1.5650
 Avg Train Loss: 1.5650 | Seg Loss: 0.3118 | Recon Loss: 0.0058
  Val mIoU: 0.6746 (Best: 0.7789)
  [Class IoU]  C1: 0.9166 | C2: 0.7867 | C3: 0.3206
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0080_predictions.png
Epoch 81/800 | Train Loss: 1.5372
 Avg Train Loss: 1.5372 | Seg Loss: 0.3063 | Recon Loss: 0.0058
  Val mIoU: 0.7109 (Best: 0.7789)
  [Class IoU]  C1: 0.9115 | C2: 0.7862 | C3: 0.4351
Epoch 82/800 | Train Loss: 1.5366
 Avg Train Loss: 1.5366 | Seg Loss: 0.3062 | Recon Loss: 0.0058
  Val mIoU: 0.7195 (Best: 0.7789)
  [Class IoU]  C1: 0.9141 | C2: 0.8098 | C3: 0.4345
Epoch 83/800 | Train Loss: 1.5482
 Avg Train Loss: 1.5482 | Seg Loss: 0.3085 | Recon Loss: 0.0058
  Val mIoU: 0.7143 (Best: 0.7789)
  [Class IoU]  C1: 0.9033 | C2: 0.7793 | C3: 0.4603
Epoch 84/800 | Train Loss: 1.5229
 Avg Train Loss: 1.5229 | Seg Loss: 0.3035 | Recon Loss: 0.0056
  Val mIoU: 0.7166 (Best: 0.7789)
  [Class IoU]  C1: 0.9156 | C2: 0.7994 | C3: 0.4349
Epoch 85/800 | Train Loss: 1.5182
 Avg Train Loss: 1.5182 | Seg Loss: 0.3025 | Recon Loss: 0.0058
  Val mIoU: 0.6797 (Best: 0.7789)
  [Class IoU]  C1: 0.8911 | C2: 0.7631 | C3: 0.3850
Epoch 86/800 | Train Loss: 1.5421
 Avg Train Loss: 1.5421 | Seg Loss: 0.3072 | Recon Loss: 0.0058
  Val mIoU: 0.6505 (Best: 0.7789)
  [Class IoU]  C1: 0.9078 | C2: 0.7738 | C3: 0.2699
Epoch 87/800 | Train Loss: 1.5651
 Avg Train Loss: 1.5651 | Seg Loss: 0.3119 | Recon Loss: 0.0056
  Val mIoU: 0.7029 (Best: 0.7789)
  [Class IoU]  C1: 0.9253 | C2: 0.7984 | C3: 0.3851
Epoch 88/800 | Train Loss: 1.5261
 Avg Train Loss: 1.5261 | Seg Loss: 0.3040 | Recon Loss: 0.0058
  Val mIoU: 0.7081 (Best: 0.7789)
  [Class IoU]  C1: 0.9107 | C2: 0.7924 | C3: 0.4213
Epoch 89/800 | Train Loss: 1.5412
 Avg Train Loss: 1.5412 | Seg Loss: 0.3071 | Recon Loss: 0.0059
  Val mIoU: 0.7531 (Best: 0.7789)
  [Class IoU]  C1: 0.9201 | C2: 0.8013 | C3: 0.5379
Epoch 90/800 | Train Loss: 1.5342
 Avg Train Loss: 1.5342 | Seg Loss: 0.3057 | Recon Loss: 0.0057
  Val mIoU: 0.7175 (Best: 0.7789)
  [Class IoU]  C1: 0.9229 | C2: 0.8019 | C3: 0.4277
Epoch 91/800 | Train Loss: 1.5316
 Avg Train Loss: 1.5316 | Seg Loss: 0.3052 | Recon Loss: 0.0058
  Val mIoU: 0.7320 (Best: 0.7789)
  [Class IoU]  C1: 0.9138 | C2: 0.8130 | C3: 0.4693
Epoch 92/800 | Train Loss: 1.5379
 Avg Train Loss: 1.5379 | Seg Loss: 0.3064 | Recon Loss: 0.0057
  Val mIoU: 0.6626 (Best: 0.7789)
  [Class IoU]  C1: 0.9233 | C2: 0.7941 | C3: 0.2705
Epoch 93/800 | Train Loss: 1.5246
 Avg Train Loss: 1.5246 | Seg Loss: 0.3037 | Recon Loss: 0.0058
  Val mIoU: 0.7349 (Best: 0.7789)
  [Class IoU]  C1: 0.8998 | C2: 0.7970 | C3: 0.5081
Epoch 94/800 | Train Loss: 1.5315
 Avg Train Loss: 1.5315 | Seg Loss: 0.3051 | Recon Loss: 0.0058
  Val mIoU: 0.7317 (Best: 0.7789)
  [Class IoU]  C1: 0.9264 | C2: 0.8023 | C3: 0.4663
Epoch 95/800 | Train Loss: 1.5478
 Avg Train Loss: 1.5478 | Seg Loss: 0.3084 | Recon Loss: 0.0058
  Val mIoU: 0.7141 (Best: 0.7789)
  [Class IoU]  C1: 0.9236 | C2: 0.8046 | C3: 0.4142
Epoch 96/800 | Train Loss: 1.5082
 Avg Train Loss: 1.5082 | Seg Loss: 0.3006 | Recon Loss: 0.0054
  Val mIoU: 0.7016 (Best: 0.7789)
  [Class IoU]  C1: 0.8787 | C2: 0.7974 | C3: 0.4286
Epoch 97/800 | Train Loss: 1.5257
 Avg Train Loss: 1.5257 | Seg Loss: 0.3040 | Recon Loss: 0.0056
  Val mIoU: 0.7044 (Best: 0.7789)
  [Class IoU]  C1: 0.9195 | C2: 0.8054 | C3: 0.3883
Epoch 98/800 | Train Loss: 1.5465
 Avg Train Loss: 1.5465 | Seg Loss: 0.3082 | Recon Loss: 0.0055
  Val mIoU: 0.7184 (Best: 0.7789)
  [Class IoU]  C1: 0.9144 | C2: 0.8130 | C3: 0.4276
Epoch 99/800 | Train Loss: 1.5153
 Avg Train Loss: 1.5153 | Seg Loss: 0.3019 | Recon Loss: 0.0055
  Val mIoU: 0.7140 (Best: 0.7789)
  [Class IoU]  C1: 0.9251 | C2: 0.8043 | C3: 0.4125
Epoch 100/800 | Train Loss: 1.5279
 Avg Train Loss: 1.5279 | Seg Loss: 0.3045 | Recon Loss: 0.0054
  Val mIoU: 0.7700 (Best: 0.7789)
  [Class IoU]  C1: 0.9151 | C2: 0.8257 | C3: 0.5690
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0100_predictions.png
Epoch 101/800 | Train Loss: 1.5088
 Avg Train Loss: 1.5088 | Seg Loss: 0.3006 | Recon Loss: 0.0056
  Val mIoU: 0.7165 (Best: 0.7789)
  [Class IoU]  C1: 0.8978 | C2: 0.7900 | C3: 0.4618
Epoch 102/800 | Train Loss: 1.5184
 Avg Train Loss: 1.5184 | Seg Loss: 0.3026 | Recon Loss: 0.0055
  Val mIoU: 0.6965 (Best: 0.7789)
  [Class IoU]  C1: 0.8813 | C2: 0.7809 | C3: 0.4272
Epoch 103/800 | Train Loss: 1.5092
 Avg Train Loss: 1.5092 | Seg Loss: 0.3007 | Recon Loss: 0.0056
  Val mIoU: 0.7104 (Best: 0.7789)
  [Class IoU]  C1: 0.9029 | C2: 0.8022 | C3: 0.4262
Epoch 104/800 | Train Loss: 1.4873
 Avg Train Loss: 1.4873 | Seg Loss: 0.2963 | Recon Loss: 0.0056
  Val mIoU: 0.7401 (Best: 0.7789)
  [Class IoU]  C1: 0.9069 | C2: 0.8166 | C3: 0.4966
Epoch 105/800 | Train Loss: 1.4819
 Avg Train Loss: 1.4819 | Seg Loss: 0.2953 | Recon Loss: 0.0055
  Val mIoU: 0.7764 (Best: 0.7789)
  [Class IoU]  C1: 0.9072 | C2: 0.8237 | C3: 0.5982
Epoch 106/800 | Train Loss: 1.4978
 Avg Train Loss: 1.4978 | Seg Loss: 0.2985 | Recon Loss: 0.0055
  Val mIoU: 0.6997 (Best: 0.7789)
  [Class IoU]  C1: 0.9051 | C2: 0.7951 | C3: 0.3990
Epoch 107/800 | Train Loss: 1.5043
 Avg Train Loss: 1.5043 | Seg Loss: 0.2997 | Recon Loss: 0.0055
  Val mIoU: 0.7264 (Best: 0.7789)
  [Class IoU]  C1: 0.8829 | C2: 0.7929 | C3: 0.5033
Epoch 108/800 | Train Loss: 1.4833
 Avg Train Loss: 1.4833 | Seg Loss: 0.2955 | Recon Loss: 0.0055
  Val mIoU: 0.7293 (Best: 0.7789)
  [Class IoU]  C1: 0.9186 | C2: 0.8046 | C3: 0.4646
Epoch 109/800 | Train Loss: 1.4984
 Avg Train Loss: 1.4984 | Seg Loss: 0.2986 | Recon Loss: 0.0056
  Val mIoU: 0.6580 (Best: 0.7789)
  [Class IoU]  C1: 0.8664 | C2: 0.7749 | C3: 0.3325
Epoch 110/800 | Train Loss: 1.5079
 Avg Train Loss: 1.5079 | Seg Loss: 0.3005 | Recon Loss: 0.0056
  Val mIoU: 0.6676 (Best: 0.7789)
  [Class IoU]  C1: 0.9082 | C2: 0.7968 | C3: 0.2978
Epoch 111/800 | Train Loss: 1.4936
 Avg Train Loss: 1.4936 | Seg Loss: 0.2976 | Recon Loss: 0.0055
  Val mIoU: 0.7005 (Best: 0.7789)
  [Class IoU]  C1: 0.9090 | C2: 0.7998 | C3: 0.3926
Epoch 112/800 | Train Loss: 1.5079
 Avg Train Loss: 1.5079 | Seg Loss: 0.3005 | Recon Loss: 0.0056
  Val mIoU: 0.7030 (Best: 0.7789)
  [Class IoU]  C1: 0.8926 | C2: 0.7945 | C3: 0.4218
Epoch 113/800 | Train Loss: 1.5020
 Avg Train Loss: 1.5020 | Seg Loss: 0.2993 | Recon Loss: 0.0056
  Val mIoU: 0.7439 (Best: 0.7789)
  [Class IoU]  C1: 0.9159 | C2: 0.8069 | C3: 0.5089
Epoch 114/800 | Train Loss: 1.5095
 Avg Train Loss: 1.5095 | Seg Loss: 0.3007 | Recon Loss: 0.0058
  Val mIoU: 0.7554 (Best: 0.7789)
  [Class IoU]  C1: 0.9217 | C2: 0.8136 | C3: 0.5311
Epoch 115/800 | Train Loss: 1.4915
 Avg Train Loss: 1.4915 | Seg Loss: 0.2972 | Recon Loss: 0.0055
  Val mIoU: 0.7421 (Best: 0.7789)
  [Class IoU]  C1: 0.9053 | C2: 0.7972 | C3: 0.5237
Epoch 116/800 | Train Loss: 1.4876
 Avg Train Loss: 1.4876 | Seg Loss: 0.2964 | Recon Loss: 0.0054
  Val mIoU: 0.7396 (Best: 0.7789)
  [Class IoU]  C1: 0.9157 | C2: 0.7997 | C3: 0.5034
Epoch 117/800 | Train Loss: 1.4563
 Avg Train Loss: 1.4563 | Seg Loss: 0.2902 | Recon Loss: 0.0054
  Val mIoU: 0.7399 (Best: 0.7789)
  [Class IoU]  C1: 0.9122 | C2: 0.7985 | C3: 0.5092
Epoch 118/800 | Train Loss: 1.4687
 Avg Train Loss: 1.4687 | Seg Loss: 0.2926 | Recon Loss: 0.0054
  Val mIoU: 0.7446 (Best: 0.7789)
  [Class IoU]  C1: 0.8884 | C2: 0.7956 | C3: 0.5498
Epoch 119/800 | Train Loss: 1.4756
 Avg Train Loss: 1.4756 | Seg Loss: 0.2940 | Recon Loss: 0.0056
  Val mIoU: 0.7435 (Best: 0.7789)
  [Class IoU]  C1: 0.9069 | C2: 0.8042 | C3: 0.5194
Epoch 120/800 | Train Loss: 1.4686
 Avg Train Loss: 1.4686 | Seg Loss: 0.2926 | Recon Loss: 0.0054
  Val mIoU: 0.7577 (Best: 0.7789)
  [Class IoU]  C1: 0.8919 | C2: 0.7959 | C3: 0.5854
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/AG_epoch_0120_predictions.png
Epoch 121/800 | Train Loss: 1.4639
 Avg Train Loss: 1.4639 | Seg Loss: 0.2917 | Recon Loss: 0.0054
  Val mIoU: 0.7236 (Best: 0.7789)
  [Class IoU]  C1: 0.8671 | C2: 0.7898 | C3: 0.5138
Epoch 122/800 | Train Loss: 1.4789
 Avg Train Loss: 1.4789 | Seg Loss: 0.2947 | Recon Loss: 0.0054
  Val mIoU: 0.7322 (Best: 0.7789)
  [Class IoU]  C1: 0.8976 | C2: 0.8116 | C3: 0.4875
Epoch 123/800 | Train Loss: 1.4827
 Avg Train Loss: 1.4827 | Seg Loss: 0.2955 | Recon Loss: 0.0054
  Val mIoU: 0.7430 (Best: 0.7789)
  [Class IoU]  C1: 0.9102 | C2: 0.8073 | C3: 0.5115
Epoch 124/800 | Train Loss: 1.4610
 Avg Train Loss: 1.4610 | Seg Loss: 0.2911 | Recon Loss: 0.0053
  Val mIoU: 0.7227 (Best: 0.7789)
  [Class IoU]  C1: 0.9039 | C2: 0.7877 | C3: 0.4766

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27162291: <VAE_job> in cluster <dcc> Exited

Job <VAE_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Mon Nov 24 19:26:20 2025
Job was executed on host(s) <8*n-62-13-16>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Mon Nov 24 20:17:21 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Mon Nov 24 20:17:21 2025
Terminated at Mon Nov 24 21:58:21 2025
Results reported at Mon Nov 24 21:58:21 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J VAE_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_%J.err
### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=16GB]"   # Request 16GB memory
#BSUB -W 15:00                # 4 hour runtime limit

### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."
# This is the full, correct path to your environment
source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

### --- Run Script ---
echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/VAE_vali.py

echo "Job Finished."
------------------------------------------------------------

TERM_OWNER: job killed by owner.
Exited with exit code 130.

Resource usage summary:

    CPU time :                                   29961.00 sec.
    Max Memory :                                 2309 MB
    Average Memory :                             1936.17 MB
    Total Requested Memory :                     131072.00 MB
    Delta Memory :                               128763.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                150
    Run time :                                   6061 sec.
    Turnaround time :                            9121 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/VAE_job_27162291.err> for stderr output of this job.

