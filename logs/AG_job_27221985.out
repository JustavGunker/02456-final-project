Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1., 1., 1., 4.], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Labeled Loader Ready ---
--- Unlabeled Loader Ready ---
--- Validation Loader Ready ---
Train Batches: 88
Val Batches: 24
--- Starting Training ---
Epoch 1/400 | Train Loss: 65.7996
 Avg Train Loss: 65.7996 | Seg Loss: 0.6576 | Recon Loss: 0.0355
  Val mIoU: 0.6153 (Best: 0.0000)
  [Class IoU]  C1: 0.8473 | C2: 0.7612 | C3: 0.2374
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 56.9037
 Avg Train Loss: 56.9037 | Seg Loss: 0.5689 | Recon Loss: 0.0121
  Val mIoU: 0.5940 (Best: 0.6153)
  [Class IoU]  C1: 0.9083 | C2: 0.7375 | C3: 0.1361
Epoch 3/400 | Train Loss: 52.9027
 Avg Train Loss: 52.9027 | Seg Loss: 0.5289 | Recon Loss: 0.0092
  Val mIoU: 0.5888 (Best: 0.6153)
  [Class IoU]  C1: 0.9059 | C2: 0.6940 | C3: 0.1663
Epoch 4/400 | Train Loss: 50.9231
 Avg Train Loss: 50.9231 | Seg Loss: 0.5091 | Recon Loss: 0.0085
  Val mIoU: 0.5531 (Best: 0.6153)
  [Class IoU]  C1: 0.9168 | C2: 0.6743 | C3: 0.0682
Epoch 5/400 | Train Loss: 48.6477
 Avg Train Loss: 48.6477 | Seg Loss: 0.4864 | Recon Loss: 0.0075
  Val mIoU: 0.7002 (Best: 0.6153)
  [Class IoU]  C1: 0.9063 | C2: 0.7446 | C3: 0.4497
  --> New Best Model Saved!
Epoch 6/400 | Train Loss: 47.1371
 Avg Train Loss: 47.1371 | Seg Loss: 0.4713 | Recon Loss: 0.0076
  Val mIoU: 0.6952 (Best: 0.7002)
  [Class IoU]  C1: 0.9026 | C2: 0.7688 | C3: 0.4143
Epoch 7/400 | Train Loss: 45.9508
 Avg Train Loss: 45.9508 | Seg Loss: 0.4594 | Recon Loss: 0.0073
  Val mIoU: 0.6023 (Best: 0.7002)
  [Class IoU]  C1: 0.9206 | C2: 0.7562 | C3: 0.1299
Epoch 8/400 | Train Loss: 44.7590
 Avg Train Loss: 44.7590 | Seg Loss: 0.4475 | Recon Loss: 0.0070
  Val mIoU: 0.6723 (Best: 0.7002)
  [Class IoU]  C1: 0.9252 | C2: 0.7647 | C3: 0.3269
Epoch 9/400 | Train Loss: 43.9540
 Avg Train Loss: 43.9540 | Seg Loss: 0.4395 | Recon Loss: 0.0068
  Val mIoU: 0.7833 (Best: 0.7002)
  [Class IoU]  C1: 0.9258 | C2: 0.8224 | C3: 0.6016
  --> New Best Model Saved!
Epoch 10/400 | Train Loss: 42.4879
 Avg Train Loss: 42.4879 | Seg Loss: 0.4248 | Recon Loss: 0.0069
  Val mIoU: 0.7791 (Best: 0.7833)
  [Class IoU]  C1: 0.9059 | C2: 0.8281 | C3: 0.6032
Epoch 11/400 | Train Loss: 41.9445
 Avg Train Loss: 41.9445 | Seg Loss: 0.4194 | Recon Loss: 0.0067
  Val mIoU: 0.6895 (Best: 0.7833)
  [Class IoU]  C1: 0.9254 | C2: 0.8010 | C3: 0.3421
Epoch 12/400 | Train Loss: 41.5827
 Avg Train Loss: 41.5827 | Seg Loss: 0.4158 | Recon Loss: 0.0063
  Val mIoU: 0.7074 (Best: 0.7833)
  [Class IoU]  C1: 0.9240 | C2: 0.7940 | C3: 0.4043
Epoch 13/400 | Train Loss: 40.7780
 Avg Train Loss: 40.7780 | Seg Loss: 0.4077 | Recon Loss: 0.0064
  Val mIoU: 0.7554 (Best: 0.7833)
  [Class IoU]  C1: 0.9275 | C2: 0.8200 | C3: 0.5186
Epoch 14/400 | Train Loss: 39.9627
 Avg Train Loss: 39.9627 | Seg Loss: 0.3996 | Recon Loss: 0.0063
  Val mIoU: 0.7659 (Best: 0.7833)
  [Class IoU]  C1: 0.9229 | C2: 0.8199 | C3: 0.5548
Epoch 15/400 | Train Loss: 39.7020
 Avg Train Loss: 39.7020 | Seg Loss: 0.3970 | Recon Loss: 0.0065
  Val mIoU: 0.7665 (Best: 0.7833)
  [Class IoU]  C1: 0.9271 | C2: 0.8217 | C3: 0.5507
Epoch 16/400 | Train Loss: 38.8085
 Avg Train Loss: 38.8085 | Seg Loss: 0.3880 | Recon Loss: 0.0062
  Val mIoU: 0.6402 (Best: 0.7833)
  [Class IoU]  C1: 0.9151 | C2: 0.7868 | C3: 0.2186
Epoch 17/400 | Train Loss: 38.3150
 Avg Train Loss: 38.3150 | Seg Loss: 0.3831 | Recon Loss: 0.0061
  Val mIoU: 0.7093 (Best: 0.7833)
  [Class IoU]  C1: 0.9162 | C2: 0.7923 | C3: 0.4194
Epoch 18/400 | Train Loss: 38.0667
 Avg Train Loss: 38.0667 | Seg Loss: 0.3806 | Recon Loss: 0.0061
  Val mIoU: 0.6749 (Best: 0.7833)
  [Class IoU]  C1: 0.9097 | C2: 0.7988 | C3: 0.3163
Epoch 19/400 | Train Loss: 37.3905
 Avg Train Loss: 37.3905 | Seg Loss: 0.3738 | Recon Loss: 0.0060
  Val mIoU: 0.6448 (Best: 0.7833)
  [Class IoU]  C1: 0.9168 | C2: 0.7879 | C3: 0.2298
Epoch 20/400 | Train Loss: 36.6732
 Avg Train Loss: 36.6732 | Seg Loss: 0.3667 | Recon Loss: 0.0059
  Val mIoU: 0.6724 (Best: 0.7833)
  [Class IoU]  C1: 0.9242 | C2: 0.7869 | C3: 0.3061
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 36.7788
 Avg Train Loss: 36.7788 | Seg Loss: 0.3677 | Recon Loss: 0.0060
  Val mIoU: 0.7025 (Best: 0.7833)
  [Class IoU]  C1: 0.7057 | C2: 0.8199 | C3: 0.5821
Epoch 22/400 | Train Loss: 36.7838
 Avg Train Loss: 36.7838 | Seg Loss: 0.3678 | Recon Loss: 0.0059
  Val mIoU: 0.5881 (Best: 0.7833)
  [Class IoU]  C1: 0.3665 | C2: 0.8044 | C3: 0.5932
Epoch 23/400 | Train Loss: 36.2871
 Avg Train Loss: 36.2871 | Seg Loss: 0.3628 | Recon Loss: 0.0056
  Val mIoU: 0.4721 (Best: 0.7833)
  [Class IoU]  C1: 0.3735 | C2: 0.6887 | C3: 0.3540
Epoch 24/400 | Train Loss: 36.0781
 Avg Train Loss: 36.0781 | Seg Loss: 0.3607 | Recon Loss: 0.0057
  Val mIoU: 0.7149 (Best: 0.7833)
  [Class IoU]  C1: 0.6825 | C2: 0.8296 | C3: 0.6328
Epoch 25/400 | Train Loss: 36.4703
 Avg Train Loss: 36.4703 | Seg Loss: 0.3646 | Recon Loss: 0.0058
  Val mIoU: 0.8102 (Best: 0.7833)
  [Class IoU]  C1: 0.9236 | C2: 0.8416 | C3: 0.6652
  --> New Best Model Saved!
Epoch 26/400 | Train Loss: 35.0883
 Avg Train Loss: 35.0883 | Seg Loss: 0.3508 | Recon Loss: 0.0057
  Val mIoU: 0.6038 (Best: 0.8102)
  [Class IoU]  C1: 0.3999 | C2: 0.8223 | C3: 0.5893
Epoch 27/400 | Train Loss: 35.9506
 Avg Train Loss: 35.9506 | Seg Loss: 0.3595 | Recon Loss: 0.0056
  Val mIoU: 0.7761 (Best: 0.8102)
  [Class IoU]  C1: 0.8928 | C2: 0.8296 | C3: 0.6059
Epoch 28/400 | Train Loss: 34.9399
 Avg Train Loss: 34.9399 | Seg Loss: 0.3493 | Recon Loss: 0.0055
  Val mIoU: 0.7346 (Best: 0.8102)
  [Class IoU]  C1: 0.9198 | C2: 0.8166 | C3: 0.4676
Epoch 29/400 | Train Loss: 34.5956
 Avg Train Loss: 34.5956 | Seg Loss: 0.3459 | Recon Loss: 0.0055
  Val mIoU: 0.6624 (Best: 0.8102)
  [Class IoU]  C1: 0.5996 | C2: 0.8033 | C3: 0.5844
Epoch 30/400 | Train Loss: 35.3575
 Avg Train Loss: 35.3575 | Seg Loss: 0.3535 | Recon Loss: 0.0057
  Val mIoU: 0.5778 (Best: 0.8102)
  [Class IoU]  C1: 0.3000 | C2: 0.8100 | C3: 0.6235
Epoch 31/400 | Train Loss: 33.6618
 Avg Train Loss: 33.6618 | Seg Loss: 0.3366 | Recon Loss: 0.0055
  Val mIoU: 0.6187 (Best: 0.8102)
  [Class IoU]  C1: 0.4568 | C2: 0.8114 | C3: 0.5879
Epoch 32/400 | Train Loss: 33.5997
 Avg Train Loss: 33.5997 | Seg Loss: 0.3359 | Recon Loss: 0.0055
  Val mIoU: 0.7204 (Best: 0.8102)
  [Class IoU]  C1: 0.7066 | C2: 0.8305 | C3: 0.6239
Epoch 33/400 | Train Loss: 34.3368
 Avg Train Loss: 34.3368 | Seg Loss: 0.3433 | Recon Loss: 0.0054
  Val mIoU: 0.4037 (Best: 0.8102)
  [Class IoU]  C1: 0.2758 | C2: 0.6466 | C3: 0.2888
Epoch 34/400 | Train Loss: 33.9645
 Avg Train Loss: 33.9645 | Seg Loss: 0.3396 | Recon Loss: 0.0057
  Val mIoU: 0.6716 (Best: 0.8102)
  [Class IoU]  C1: 0.5515 | C2: 0.8256 | C3: 0.6379
Epoch 35/400 | Train Loss: 34.1620
 Avg Train Loss: 34.1620 | Seg Loss: 0.3416 | Recon Loss: 0.0056
  Val mIoU: 0.6058 (Best: 0.8102)
  [Class IoU]  C1: 0.3634 | C2: 0.7974 | C3: 0.6567
Epoch 36/400 | Train Loss: 33.3238
 Avg Train Loss: 33.3238 | Seg Loss: 0.3332 | Recon Loss: 0.0054
  Val mIoU: 0.6266 (Best: 0.8102)
  [Class IoU]  C1: 0.6023 | C2: 0.7981 | C3: 0.4795
Epoch 37/400 | Train Loss: 33.9812
 Avg Train Loss: 33.9812 | Seg Loss: 0.3398 | Recon Loss: 0.0055
  Val mIoU: 0.5749 (Best: 0.8102)
  [Class IoU]  C1: 0.3269 | C2: 0.7891 | C3: 0.6085
Epoch 38/400 | Train Loss: 33.6414
 Avg Train Loss: 33.6414 | Seg Loss: 0.3364 | Recon Loss: 0.0051
  Val mIoU: 0.6723 (Best: 0.8102)
  [Class IoU]  C1: 0.5842 | C2: 0.8123 | C3: 0.6205
Epoch 39/400 | Train Loss: 33.2640
 Avg Train Loss: 33.2640 | Seg Loss: 0.3326 | Recon Loss: 0.0054
  Val mIoU: 0.7027 (Best: 0.8102)
  [Class IoU]  C1: 0.8496 | C2: 0.7817 | C3: 0.4768
Epoch 40/400 | Train Loss: 33.1740
 Avg Train Loss: 33.1740 | Seg Loss: 0.3317 | Recon Loss: 0.0054
  Val mIoU: 0.6151 (Best: 0.8102)
  [Class IoU]  C1: 0.4131 | C2: 0.8096 | C3: 0.6227
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 32.9135
 Avg Train Loss: 32.9135 | Seg Loss: 0.3291 | Recon Loss: 0.0053
  Val mIoU: 0.5623 (Best: 0.8102)
  [Class IoU]  C1: 0.3091 | C2: 0.8013 | C3: 0.5764
Epoch 42/400 | Train Loss: 32.2716
 Avg Train Loss: 32.2716 | Seg Loss: 0.3227 | Recon Loss: 0.0052
  Val mIoU: 0.5805 (Best: 0.8102)
  [Class IoU]  C1: 0.3680 | C2: 0.7892 | C3: 0.5843
Epoch 43/400 | Train Loss: 33.4423
 Avg Train Loss: 33.4423 | Seg Loss: 0.3344 | Recon Loss: 0.0052
  Val mIoU: 0.5385 (Best: 0.8102)
  [Class IoU]  C1: 0.3037 | C2: 0.7830 | C3: 0.5288
Epoch 44/400 | Train Loss: 32.0432
 Avg Train Loss: 32.0432 | Seg Loss: 0.3204 | Recon Loss: 0.0050
  Val mIoU: 0.5635 (Best: 0.8102)
  [Class IoU]  C1: 0.3498 | C2: 0.7907 | C3: 0.5501
Epoch 45/400 | Train Loss: 33.2355
 Avg Train Loss: 33.2355 | Seg Loss: 0.3323 | Recon Loss: 0.0053
  Val mIoU: 0.5441 (Best: 0.8102)
  [Class IoU]  C1: 0.3888 | C2: 0.8075 | C3: 0.4361
Epoch 46/400 | Train Loss: 33.1548
 Avg Train Loss: 33.1548 | Seg Loss: 0.3315 | Recon Loss: 0.0052
  Val mIoU: 0.5705 (Best: 0.8102)
  [Class IoU]  C1: 0.3201 | C2: 0.7636 | C3: 0.6277
Epoch 47/400 | Train Loss: 33.0825
 Avg Train Loss: 33.0825 | Seg Loss: 0.3308 | Recon Loss: 0.0051
  Val mIoU: 0.5640 (Best: 0.8102)
  [Class IoU]  C1: 0.3136 | C2: 0.7622 | C3: 0.6162
Epoch 48/400 | Train Loss: 31.6100
 Avg Train Loss: 31.6100 | Seg Loss: 0.3160 | Recon Loss: 0.0052
  Val mIoU: 0.5635 (Best: 0.8102)
  [Class IoU]  C1: 0.2992 | C2: 0.7805 | C3: 0.6107
Epoch 49/400 | Train Loss: 32.2111
 Avg Train Loss: 32.2111 | Seg Loss: 0.3221 | Recon Loss: 0.0050
  Val mIoU: 0.6334 (Best: 0.8102)
  [Class IoU]  C1: 0.4490 | C2: 0.7850 | C3: 0.6662
Epoch 50/400 | Train Loss: 31.7183
 Avg Train Loss: 31.7183 | Seg Loss: 0.3171 | Recon Loss: 0.0052
  Val mIoU: 0.7040 (Best: 0.8102)
  [Class IoU]  C1: 0.6768 | C2: 0.8106 | C3: 0.6246
Epoch 51/400 | Train Loss: 31.6808
 Avg Train Loss: 31.6808 | Seg Loss: 0.3168 | Recon Loss: 0.0051
  Val mIoU: 0.6021 (Best: 0.8102)
  [Class IoU]  C1: 0.3395 | C2: 0.7872 | C3: 0.6797
Epoch 52/400 | Train Loss: 31.8023
 Avg Train Loss: 31.8023 | Seg Loss: 0.3180 | Recon Loss: 0.0049
  Val mIoU: 0.7455 (Best: 0.8102)
  [Class IoU]  C1: 0.7855 | C2: 0.8192 | C3: 0.6318
Epoch 53/400 | Train Loss: 30.9863
 Avg Train Loss: 30.9863 | Seg Loss: 0.3098 | Recon Loss: 0.0050
  Val mIoU: 0.6054 (Best: 0.8102)
  [Class IoU]  C1: 0.3419 | C2: 0.8087 | C3: 0.6656
Epoch 54/400 | Train Loss: 31.7087
 Avg Train Loss: 31.7087 | Seg Loss: 0.3170 | Recon Loss: 0.0049
  Val mIoU: 0.5394 (Best: 0.8102)
  [Class IoU]  C1: 0.2505 | C2: 0.8058 | C3: 0.5619
Epoch 55/400 | Train Loss: 30.9116
 Avg Train Loss: 30.9116 | Seg Loss: 0.3091 | Recon Loss: 0.0049
  Val mIoU: 0.5228 (Best: 0.8102)
  [Class IoU]  C1: 0.2952 | C2: 0.7682 | C3: 0.5051
Epoch 56/400 | Train Loss: 31.7672
 Avg Train Loss: 31.7672 | Seg Loss: 0.3176 | Recon Loss: 0.0050
  Val mIoU: 0.6103 (Best: 0.8102)
  [Class IoU]  C1: 0.4598 | C2: 0.7778 | C3: 0.5932
Epoch 57/400 | Train Loss: 31.2065
 Avg Train Loss: 31.2065 | Seg Loss: 0.3120 | Recon Loss: 0.0049
  Val mIoU: 0.6076 (Best: 0.8102)
  [Class IoU]  C1: 0.3464 | C2: 0.8053 | C3: 0.6710
Epoch 58/400 | Train Loss: 30.8722
 Avg Train Loss: 30.8722 | Seg Loss: 0.3087 | Recon Loss: 0.0049
  Val mIoU: 0.5388 (Best: 0.8102)
  [Class IoU]  C1: 0.3140 | C2: 0.7770 | C3: 0.5254
Epoch 59/400 | Train Loss: 31.3984
 Avg Train Loss: 31.3984 | Seg Loss: 0.3139 | Recon Loss: 0.0049
  Val mIoU: 0.6191 (Best: 0.8102)
  [Class IoU]  C1: 0.4793 | C2: 0.7802 | C3: 0.5980
Epoch 60/400 | Train Loss: 31.4211
 Avg Train Loss: 31.4211 | Seg Loss: 0.3142 | Recon Loss: 0.0050
  Val mIoU: 0.5511 (Best: 0.8102)
  [Class IoU]  C1: 0.2717 | C2: 0.7963 | C3: 0.5854
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 31.6741
 Avg Train Loss: 31.6741 | Seg Loss: 0.3167 | Recon Loss: 0.0049
  Val mIoU: 0.5772 (Best: 0.8102)
  [Class IoU]  C1: 0.3260 | C2: 0.7819 | C3: 0.6238
Epoch 62/400 | Train Loss: 31.9666
 Avg Train Loss: 31.9666 | Seg Loss: 0.3196 | Recon Loss: 0.0051
  Val mIoU: 0.5971 (Best: 0.8102)
  [Class IoU]  C1: 0.4934 | C2: 0.7687 | C3: 0.5293
Epoch 63/400 | Train Loss: 31.0429
 Avg Train Loss: 31.0429 | Seg Loss: 0.3104 | Recon Loss: 0.0050
  Val mIoU: 0.7537 (Best: 0.8102)
  [Class IoU]  C1: 0.7623 | C2: 0.8399 | C3: 0.6590
Epoch 64/400 | Train Loss: 30.6854
 Avg Train Loss: 30.6854 | Seg Loss: 0.3068 | Recon Loss: 0.0049
  Val mIoU: 0.5962 (Best: 0.8102)
  [Class IoU]  C1: 0.3891 | C2: 0.7921 | C3: 0.6074
Epoch 65/400 | Train Loss: 30.8528
 Avg Train Loss: 30.8528 | Seg Loss: 0.3085 | Recon Loss: 0.0048
  Val mIoU: 0.5579 (Best: 0.8102)
  [Class IoU]  C1: 0.2800 | C2: 0.7932 | C3: 0.6004
Epoch 66/400 | Train Loss: 30.7201
 Avg Train Loss: 30.7201 | Seg Loss: 0.3072 | Recon Loss: 0.0050
  Val mIoU: 0.5753 (Best: 0.8102)
  [Class IoU]  C1: 0.3262 | C2: 0.7972 | C3: 0.6024
Epoch 67/400 | Train Loss: 30.5300
 Avg Train Loss: 30.5300 | Seg Loss: 0.3053 | Recon Loss: 0.0049
  Val mIoU: 0.5774 (Best: 0.8102)
  [Class IoU]  C1: 0.3432 | C2: 0.7699 | C3: 0.6192
Epoch 68/400 | Train Loss: 30.4587
 Avg Train Loss: 30.4587 | Seg Loss: 0.3045 | Recon Loss: 0.0050
  Val mIoU: 0.6043 (Best: 0.8102)
  [Class IoU]  C1: 0.3969 | C2: 0.7877 | C3: 0.6284
Epoch 69/400 | Train Loss: 29.8094
 Avg Train Loss: 29.8094 | Seg Loss: 0.2980 | Recon Loss: 0.0050
  Val mIoU: 0.5782 (Best: 0.8102)
  [Class IoU]  C1: 0.3180 | C2: 0.7987 | C3: 0.6179
Epoch 70/400 | Train Loss: 30.5131
 Avg Train Loss: 30.5131 | Seg Loss: 0.3051 | Recon Loss: 0.0049
  Val mIoU: 0.5490 (Best: 0.8102)
  [Class IoU]  C1: 0.3187 | C2: 0.7713 | C3: 0.5571
Epoch 71/400 | Train Loss: 30.8831
 Avg Train Loss: 30.8831 | Seg Loss: 0.3088 | Recon Loss: 0.0049
  Val mIoU: 0.5318 (Best: 0.8102)
  [Class IoU]  C1: 0.2865 | C2: 0.7676 | C3: 0.5413
Epoch 72/400 | Train Loss: 30.6359
 Avg Train Loss: 30.6359 | Seg Loss: 0.3063 | Recon Loss: 0.0048
  Val mIoU: 0.5591 (Best: 0.8102)
  [Class IoU]  C1: 0.2916 | C2: 0.7957 | C3: 0.5901
Epoch 73/400 | Train Loss: 30.2100
 Avg Train Loss: 30.2100 | Seg Loss: 0.3021 | Recon Loss: 0.0049
  Val mIoU: 0.5502 (Best: 0.8102)
  [Class IoU]  C1: 0.2959 | C2: 0.7893 | C3: 0.5654
Epoch 74/400 | Train Loss: 30.2787
 Avg Train Loss: 30.2787 | Seg Loss: 0.3027 | Recon Loss: 0.0049
  Val mIoU: 0.5487 (Best: 0.8102)
  [Class IoU]  C1: 0.2664 | C2: 0.8052 | C3: 0.5746
Epoch 75/400 | Train Loss: 30.2765
 Avg Train Loss: 30.2765 | Seg Loss: 0.3027 | Recon Loss: 0.0049
  Val mIoU: 0.5046 (Best: 0.8102)
  [Class IoU]  C1: 0.2983 | C2: 0.7413 | C3: 0.4742
Epoch 76/400 | Train Loss: 29.9496
 Avg Train Loss: 29.9496 | Seg Loss: 0.2994 | Recon Loss: 0.0048
  Val mIoU: 0.5285 (Best: 0.8102)
  [Class IoU]  C1: 0.2809 | C2: 0.7710 | C3: 0.5336
Epoch 77/400 | Train Loss: 29.4883
 Avg Train Loss: 29.4883 | Seg Loss: 0.2948 | Recon Loss: 0.0049
  Val mIoU: 0.5637 (Best: 0.8102)
  [Class IoU]  C1: 0.3145 | C2: 0.8012 | C3: 0.5753
Epoch 78/400 | Train Loss: 30.4264
 Avg Train Loss: 30.4264 | Seg Loss: 0.3042 | Recon Loss: 0.0050
  Val mIoU: 0.5179 (Best: 0.8102)
  [Class IoU]  C1: 0.3104 | C2: 0.7601 | C3: 0.4830
Epoch 79/400 | Train Loss: 30.4542
 Avg Train Loss: 30.4542 | Seg Loss: 0.3045 | Recon Loss: 0.0048
  Val mIoU: 0.5445 (Best: 0.8102)
  [Class IoU]  C1: 0.3877 | C2: 0.7621 | C3: 0.4836
Epoch 80/400 | Train Loss: 30.4336
 Avg Train Loss: 30.4336 | Seg Loss: 0.3043 | Recon Loss: 0.0047
  Val mIoU: 0.6029 (Best: 0.8102)
  [Class IoU]  C1: 0.4184 | C2: 0.8109 | C3: 0.5794
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 30.1426
 Avg Train Loss: 30.1426 | Seg Loss: 0.3014 | Recon Loss: 0.0049
  Val mIoU: 0.5996 (Best: 0.8102)
  [Class IoU]  C1: 0.4390 | C2: 0.8035 | C3: 0.5563
Epoch 82/400 | Train Loss: 30.1460
 Avg Train Loss: 30.1460 | Seg Loss: 0.3014 | Recon Loss: 0.0048
  Val mIoU: 0.6531 (Best: 0.8102)
  [Class IoU]  C1: 0.6271 | C2: 0.7945 | C3: 0.5377
Epoch 83/400 | Train Loss: 29.3891
 Avg Train Loss: 29.3891 | Seg Loss: 0.2938 | Recon Loss: 0.0047
  Val mIoU: 0.5074 (Best: 0.8102)
  [Class IoU]  C1: 0.3498 | C2: 0.7276 | C3: 0.4450
Epoch 84/400 | Train Loss: 29.4016
 Avg Train Loss: 29.4016 | Seg Loss: 0.2940 | Recon Loss: 0.0047
  Val mIoU: 0.7216 (Best: 0.8102)
  [Class IoU]  C1: 0.9024 | C2: 0.7795 | C3: 0.4828
Epoch 85/400 | Train Loss: 30.1397
 Avg Train Loss: 30.1397 | Seg Loss: 0.3014 | Recon Loss: 0.0047
  Val mIoU: 0.6393 (Best: 0.8102)
  [Class IoU]  C1: 0.7412 | C2: 0.7327 | C3: 0.4442
Epoch 86/400 | Train Loss: 30.2316
 Avg Train Loss: 30.2316 | Seg Loss: 0.3023 | Recon Loss: 0.0047
  Val mIoU: 0.5568 (Best: 0.8102)
  [Class IoU]  C1: 0.4865 | C2: 0.7336 | C3: 0.4501
Epoch 87/400 | Train Loss: 29.7708
 Avg Train Loss: 29.7708 | Seg Loss: 0.2977 | Recon Loss: 0.0047
  Val mIoU: 0.6739 (Best: 0.8102)
  [Class IoU]  C1: 0.8992 | C2: 0.7191 | C3: 0.4035
Epoch 88/400 | Train Loss: 29.7448
 Avg Train Loss: 29.7448 | Seg Loss: 0.2974 | Recon Loss: 0.0049
  Val mIoU: 0.6896 (Best: 0.8102)
  [Class IoU]  C1: 0.6737 | C2: 0.8071 | C3: 0.5881
Epoch 89/400 | Train Loss: 30.4258
 Avg Train Loss: 30.4258 | Seg Loss: 0.3042 | Recon Loss: 0.0049
  Val mIoU: 0.5750 (Best: 0.8102)
  [Class IoU]  C1: 0.4305 | C2: 0.7555 | C3: 0.5389
Epoch 90/400 | Train Loss: 29.9409
 Avg Train Loss: 29.9409 | Seg Loss: 0.2994 | Recon Loss: 0.0050
  Val mIoU: 0.5690 (Best: 0.8102)
  [Class IoU]  C1: 0.3911 | C2: 0.7735 | C3: 0.5424
Epoch 91/400 | Train Loss: 29.8243
 Avg Train Loss: 29.8243 | Seg Loss: 0.2982 | Recon Loss: 0.0048
  Val mIoU: 0.5672 (Best: 0.8102)
  [Class IoU]  C1: 0.3068 | C2: 0.7960 | C3: 0.5987
Epoch 92/400 | Train Loss: 29.6467
 Avg Train Loss: 29.6467 | Seg Loss: 0.2964 | Recon Loss: 0.0048
  Val mIoU: 0.6029 (Best: 0.8102)
  [Class IoU]  C1: 0.4437 | C2: 0.7977 | C3: 0.5671
Epoch 93/400 | Train Loss: 29.0703
 Avg Train Loss: 29.0703 | Seg Loss: 0.2907 | Recon Loss: 0.0048
  Val mIoU: 0.5156 (Best: 0.8102)
  [Class IoU]  C1: 0.3927 | C2: 0.7170 | C3: 0.4371
Epoch 94/400 | Train Loss: 30.4074
 Avg Train Loss: 30.4074 | Seg Loss: 0.3040 | Recon Loss: 0.0047
  Val mIoU: 0.5767 (Best: 0.8102)
  [Class IoU]  C1: 0.3826 | C2: 0.7681 | C3: 0.5794
Epoch 95/400 | Train Loss: 29.5346
 Avg Train Loss: 29.5346 | Seg Loss: 0.2953 | Recon Loss: 0.0045
  Val mIoU: 0.5441 (Best: 0.8102)
  [Class IoU]  C1: 0.4064 | C2: 0.7479 | C3: 0.4780
Epoch 96/400 | Train Loss: 29.8081
 Avg Train Loss: 29.8081 | Seg Loss: 0.2980 | Recon Loss: 0.0046
  Val mIoU: 0.5818 (Best: 0.8102)
  [Class IoU]  C1: 0.5458 | C2: 0.7416 | C3: 0.4581
Epoch 97/400 | Train Loss: 29.6429
 Avg Train Loss: 29.6429 | Seg Loss: 0.2964 | Recon Loss: 0.0047
  Val mIoU: 0.6145 (Best: 0.8102)
  [Class IoU]  C1: 0.5646 | C2: 0.7749 | C3: 0.5039
Epoch 98/400 | Train Loss: 29.4834
 Avg Train Loss: 29.4834 | Seg Loss: 0.2948 | Recon Loss: 0.0048
  Val mIoU: 0.5305 (Best: 0.8102)
  [Class IoU]  C1: 0.3395 | C2: 0.7573 | C3: 0.4947
Epoch 99/400 | Train Loss: 29.7999
 Avg Train Loss: 29.7999 | Seg Loss: 0.2980 | Recon Loss: 0.0047
  Val mIoU: 0.6015 (Best: 0.8102)
  [Class IoU]  C1: 0.5194 | C2: 0.7610 | C3: 0.5242
Epoch 100/400 | Train Loss: 29.5057
 Avg Train Loss: 29.5057 | Seg Loss: 0.2950 | Recon Loss: 0.0048
  Val mIoU: 0.5316 (Best: 0.8102)
  [Class IoU]  C1: 0.3532 | C2: 0.7524 | C3: 0.4892
  Saving visuals for Epoch 100...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0100_predictions.png
Epoch 101/400 | Train Loss: 29.0546
 Avg Train Loss: 29.0546 | Seg Loss: 0.2905 | Recon Loss: 0.0048
  Val mIoU: 0.5354 (Best: 0.8102)
  [Class IoU]  C1: 0.3607 | C2: 0.7471 | C3: 0.4985
Epoch 102/400 | Train Loss: 29.5518
 Avg Train Loss: 29.5518 | Seg Loss: 0.2955 | Recon Loss: 0.0047
  Val mIoU: 0.5164 (Best: 0.8102)
  [Class IoU]  C1: 0.3259 | C2: 0.7395 | C3: 0.4838
Epoch 103/400 | Train Loss: 29.7409
 Avg Train Loss: 29.7409 | Seg Loss: 0.2974 | Recon Loss: 0.0048
  Val mIoU: 0.5490 (Best: 0.8102)
  [Class IoU]  C1: 0.3971 | C2: 0.7479 | C3: 0.5021
Epoch 104/400 | Train Loss: 29.2675
 Avg Train Loss: 29.2675 | Seg Loss: 0.2926 | Recon Loss: 0.0049
  Val mIoU: 0.5663 (Best: 0.8102)
  [Class IoU]  C1: 0.3458 | C2: 0.7844 | C3: 0.5687
Epoch 105/400 | Train Loss: 30.0485
 Avg Train Loss: 30.0485 | Seg Loss: 0.3004 | Recon Loss: 0.0047
  Val mIoU: 0.6156 (Best: 0.8102)
  [Class IoU]  C1: 0.5662 | C2: 0.7731 | C3: 0.5074
Epoch 106/400 | Train Loss: 30.1968
 Avg Train Loss: 30.1968 | Seg Loss: 0.3019 | Recon Loss: 0.0047
  Val mIoU: 0.5454 (Best: 0.8102)
  [Class IoU]  C1: 0.4276 | C2: 0.7305 | C3: 0.4781
Epoch 107/400 | Train Loss: 29.6688
 Avg Train Loss: 29.6688 | Seg Loss: 0.2966 | Recon Loss: 0.0048
  Val mIoU: 0.5564 (Best: 0.8102)
  [Class IoU]  C1: 0.3617 | C2: 0.7680 | C3: 0.5396
Epoch 108/400 | Train Loss: 29.2222
 Avg Train Loss: 29.2222 | Seg Loss: 0.2922 | Recon Loss: 0.0049
  Val mIoU: 0.5479 (Best: 0.8102)
  [Class IoU]  C1: 0.3803 | C2: 0.7537 | C3: 0.5096
Epoch 109/400 | Train Loss: 30.3485
 Avg Train Loss: 30.3485 | Seg Loss: 0.3034 | Recon Loss: 0.0047
  Val mIoU: 0.5064 (Best: 0.8102)
  [Class IoU]  C1: 0.3091 | C2: 0.7355 | C3: 0.4745
Epoch 110/400 | Train Loss: 28.9720
 Avg Train Loss: 28.9720 | Seg Loss: 0.2897 | Recon Loss: 0.0047
  Val mIoU: 0.6491 (Best: 0.8102)
  [Class IoU]  C1: 0.7083 | C2: 0.7610 | C3: 0.4781
Epoch 111/400 | Train Loss: 30.0616
 Avg Train Loss: 30.0616 | Seg Loss: 0.3006 | Recon Loss: 0.0047
  Val mIoU: 0.5943 (Best: 0.8102)
  [Class IoU]  C1: 0.5650 | C2: 0.7392 | C3: 0.4786
Epoch 112/400 | Train Loss: 29.8673
 Avg Train Loss: 29.8673 | Seg Loss: 0.2986 | Recon Loss: 0.0047
  Val mIoU: 0.5377 (Best: 0.8102)
  [Class IoU]  C1: 0.3354 | C2: 0.7591 | C3: 0.5188
Epoch 113/400 | Train Loss: 30.1792
 Avg Train Loss: 30.1792 | Seg Loss: 0.3017 | Recon Loss: 0.0048
  Val mIoU: 0.5758 (Best: 0.8102)
  [Class IoU]  C1: 0.4442 | C2: 0.7554 | C3: 0.5279
Epoch 114/400 | Train Loss: 29.3806
 Avg Train Loss: 29.3806 | Seg Loss: 0.2938 | Recon Loss: 0.0048
  Val mIoU: 0.5394 (Best: 0.8102)
  [Class IoU]  C1: 0.3793 | C2: 0.7429 | C3: 0.4961
Epoch 115/400 | Train Loss: 29.4204
 Avg Train Loss: 29.4204 | Seg Loss: 0.2942 | Recon Loss: 0.0046
  Val mIoU: 0.5534 (Best: 0.8102)
  [Class IoU]  C1: 0.3909 | C2: 0.7613 | C3: 0.5080
Epoch 116/400 | Train Loss: 29.7866
 Avg Train Loss: 29.7866 | Seg Loss: 0.2978 | Recon Loss: 0.0048
  Val mIoU: 0.5081 (Best: 0.8102)
  [Class IoU]  C1: 0.2980 | C2: 0.7473 | C3: 0.4789
Epoch 117/400 | Train Loss: 29.5470
 Avg Train Loss: 29.5470 | Seg Loss: 0.2954 | Recon Loss: 0.0047
  Val mIoU: 0.5240 (Best: 0.8102)
  [Class IoU]  C1: 0.3340 | C2: 0.7468 | C3: 0.4912
Epoch 118/400 | Train Loss: 29.3892
 Avg Train Loss: 29.3892 | Seg Loss: 0.2938 | Recon Loss: 0.0047
  Val mIoU: 0.5371 (Best: 0.8102)
  [Class IoU]  C1: 0.3527 | C2: 0.7509 | C3: 0.5077
Epoch 119/400 | Train Loss: 29.1000
 Avg Train Loss: 29.1000 | Seg Loss: 0.2910 | Recon Loss: 0.0047
  Val mIoU: 0.5389 (Best: 0.8102)
  [Class IoU]  C1: 0.3787 | C2: 0.7412 | C3: 0.4967
Epoch 120/400 | Train Loss: 29.2107
 Avg Train Loss: 29.2107 | Seg Loss: 0.2921 | Recon Loss: 0.0047
  Val mIoU: 0.5317 (Best: 0.8102)
  [Class IoU]  C1: 0.4110 | C2: 0.7231 | C3: 0.4609
  Saving visuals for Epoch 120...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0120_predictions.png
Epoch 121/400 | Train Loss: 29.2945
 Avg Train Loss: 29.2945 | Seg Loss: 0.2929 | Recon Loss: 0.0047
  Val mIoU: 0.5239 (Best: 0.8102)
  [Class IoU]  C1: 0.2929 | C2: 0.7668 | C3: 0.5122
Epoch 122/400 | Train Loss: 29.3318
 Avg Train Loss: 29.3318 | Seg Loss: 0.2933 | Recon Loss: 0.0047
  Val mIoU: 0.5616 (Best: 0.8102)
  [Class IoU]  C1: 0.4321 | C2: 0.7427 | C3: 0.5101
Epoch 123/400 | Train Loss: 29.9826
 Avg Train Loss: 29.9826 | Seg Loss: 0.2998 | Recon Loss: 0.0047
  Val mIoU: 0.5795 (Best: 0.8102)
  [Class IoU]  C1: 0.4193 | C2: 0.7822 | C3: 0.5369
Epoch 124/400 | Train Loss: 28.5742
 Avg Train Loss: 28.5742 | Seg Loss: 0.2857 | Recon Loss: 0.0047
  Val mIoU: 0.5887 (Best: 0.8102)
  [Class IoU]  C1: 0.4844 | C2: 0.7676 | C3: 0.5142
Epoch 125/400 | Train Loss: 29.2031
 Avg Train Loss: 29.2031 | Seg Loss: 0.2920 | Recon Loss: 0.0046
  Val mIoU: 0.5693 (Best: 0.8102)
  [Class IoU]  C1: 0.3907 | C2: 0.7706 | C3: 0.5467
Epoch 126/400 | Train Loss: 30.0934
 Avg Train Loss: 30.0934 | Seg Loss: 0.3009 | Recon Loss: 0.0047
  Val mIoU: 0.5599 (Best: 0.8102)
  [Class IoU]  C1: 0.4193 | C2: 0.7537 | C3: 0.5068
Epoch 127/400 | Train Loss: 29.3980
 Avg Train Loss: 29.3980 | Seg Loss: 0.2939 | Recon Loss: 0.0048
  Val mIoU: 0.6876 (Best: 0.8102)
  [Class IoU]  C1: 0.8180 | C2: 0.7533 | C3: 0.4914
Epoch 128/400 | Train Loss: 28.9797
 Avg Train Loss: 28.9797 | Seg Loss: 0.2897 | Recon Loss: 0.0047
  Val mIoU: 0.5486 (Best: 0.8102)
  [Class IoU]  C1: 0.3760 | C2: 0.7511 | C3: 0.5186
Epoch 129/400 | Train Loss: 29.1836
 Avg Train Loss: 29.1836 | Seg Loss: 0.2918 | Recon Loss: 0.0047
  Val mIoU: 0.5726 (Best: 0.8102)
  [Class IoU]  C1: 0.5080 | C2: 0.7332 | C3: 0.4767
Epoch 130/400 | Train Loss: 29.4716
 Avg Train Loss: 29.4716 | Seg Loss: 0.2947 | Recon Loss: 0.0046
  Val mIoU: 0.6618 (Best: 0.8102)
  [Class IoU]  C1: 0.5937 | C2: 0.8001 | C3: 0.5917
Epoch 131/400 | Train Loss: 28.9825
 Avg Train Loss: 28.9825 | Seg Loss: 0.2898 | Recon Loss: 0.0046
  Val mIoU: 0.5352 (Best: 0.8102)
  [Class IoU]  C1: 0.3156 | C2: 0.7580 | C3: 0.5319
Epoch 132/400 | Train Loss: 29.3494
 Avg Train Loss: 29.3494 | Seg Loss: 0.2934 | Recon Loss: 0.0046
  Val mIoU: 0.5380 (Best: 0.8102)
  [Class IoU]  C1: 0.3188 | C2: 0.7744 | C3: 0.5209
Epoch 133/400 | Train Loss: 29.6050
 Avg Train Loss: 29.6050 | Seg Loss: 0.2960 | Recon Loss: 0.0047
  Val mIoU: 0.5118 (Best: 0.8102)
  [Class IoU]  C1: 0.3666 | C2: 0.7213 | C3: 0.4475
Epoch 134/400 | Train Loss: 29.5830
 Avg Train Loss: 29.5830 | Seg Loss: 0.2958 | Recon Loss: 0.0048
  Val mIoU: 0.7042 (Best: 0.8102)
  [Class IoU]  C1: 0.7616 | C2: 0.8028 | C3: 0.5483
Epoch 135/400 | Train Loss: 29.1307
 Avg Train Loss: 29.1307 | Seg Loss: 0.2913 | Recon Loss: 0.0047
  Val mIoU: 0.5518 (Best: 0.8102)
  [Class IoU]  C1: 0.3490 | C2: 0.7673 | C3: 0.5393
Epoch 136/400 | Train Loss: 29.1491
 Avg Train Loss: 29.1491 | Seg Loss: 0.2914 | Recon Loss: 0.0046
  Val mIoU: 0.5393 (Best: 0.8102)
  [Class IoU]  C1: 0.3478 | C2: 0.7601 | C3: 0.5102
Epoch 137/400 | Train Loss: 29.1944
 Avg Train Loss: 29.1944 | Seg Loss: 0.2919 | Recon Loss: 0.0048
  Val mIoU: 0.5361 (Best: 0.8102)
  [Class IoU]  C1: 0.3267 | C2: 0.7691 | C3: 0.5124
Epoch 138/400 | Train Loss: 29.5067
 Avg Train Loss: 29.5067 | Seg Loss: 0.2950 | Recon Loss: 0.0047
  Val mIoU: 0.5573 (Best: 0.8102)
  [Class IoU]  C1: 0.3375 | C2: 0.7812 | C3: 0.5530
Epoch 139/400 | Train Loss: 29.6220
 Avg Train Loss: 29.6220 | Seg Loss: 0.2962 | Recon Loss: 0.0046
  Val mIoU: 0.5976 (Best: 0.8102)
  [Class IoU]  C1: 0.5546 | C2: 0.7548 | C3: 0.4833
Epoch 140/400 | Train Loss: 29.5923
 Avg Train Loss: 29.5923 | Seg Loss: 0.2959 | Recon Loss: 0.0048
  Val mIoU: 0.6183 (Best: 0.8102)
  [Class IoU]  C1: 0.6021 | C2: 0.7556 | C3: 0.4973
  Saving visuals for Epoch 140...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0140_predictions.png
Epoch 141/400 | Train Loss: 29.1597
 Avg Train Loss: 29.1597 | Seg Loss: 0.2916 | Recon Loss: 0.0046
  Val mIoU: 0.6653 (Best: 0.8102)
  [Class IoU]  C1: 0.6680 | C2: 0.7883 | C3: 0.5395
Epoch 142/400 | Train Loss: 29.4407
 Avg Train Loss: 29.4407 | Seg Loss: 0.2944 | Recon Loss: 0.0046
  Val mIoU: 0.7495 (Best: 0.8102)
  [Class IoU]  C1: 0.9104 | C2: 0.8008 | C3: 0.5371
Epoch 143/400 | Train Loss: 29.7977
 Avg Train Loss: 29.7977 | Seg Loss: 0.2979 | Recon Loss: 0.0048
  Val mIoU: 0.6426 (Best: 0.8102)
  [Class IoU]  C1: 0.5982 | C2: 0.7915 | C3: 0.5380
Epoch 144/400 | Train Loss: 28.9560
 Avg Train Loss: 28.9560 | Seg Loss: 0.2895 | Recon Loss: 0.0045
  Val mIoU: 0.5426 (Best: 0.8102)
  [Class IoU]  C1: 0.3981 | C2: 0.7446 | C3: 0.4850
Epoch 145/400 | Train Loss: 29.1467
 Avg Train Loss: 29.1467 | Seg Loss: 0.2914 | Recon Loss: 0.0046
  Val mIoU: 0.5404 (Best: 0.8102)
  [Class IoU]  C1: 0.3988 | C2: 0.7423 | C3: 0.4803
Epoch 146/400 | Train Loss: 29.3857
 Avg Train Loss: 29.3857 | Seg Loss: 0.2938 | Recon Loss: 0.0046
  Val mIoU: 0.5776 (Best: 0.8102)
  [Class IoU]  C1: 0.3963 | C2: 0.7843 | C3: 0.5521
Epoch 147/400 | Train Loss: 29.7276
 Avg Train Loss: 29.7276 | Seg Loss: 0.2972 | Recon Loss: 0.0047
  Val mIoU: 0.7591 (Best: 0.8102)
  [Class IoU]  C1: 0.8557 | C2: 0.8252 | C3: 0.5965
Epoch 148/400 | Train Loss: 29.9079
 Avg Train Loss: 29.9079 | Seg Loss: 0.2990 | Recon Loss: 0.0046
  Val mIoU: 0.5679 (Best: 0.8102)
  [Class IoU]  C1: 0.4331 | C2: 0.7707 | C3: 0.5000
Epoch 149/400 | Train Loss: 29.1640
 Avg Train Loss: 29.1640 | Seg Loss: 0.2916 | Recon Loss: 0.0047
  Val mIoU: 0.6141 (Best: 0.8102)
  [Class IoU]  C1: 0.5502 | C2: 0.7736 | C3: 0.5186
Epoch 150/400 | Train Loss: 29.3391
 Avg Train Loss: 29.3391 | Seg Loss: 0.2933 | Recon Loss: 0.0046
  Val mIoU: 0.5494 (Best: 0.8102)
  [Class IoU]  C1: 0.4157 | C2: 0.7484 | C3: 0.4842
Epoch 151/400 | Train Loss: 28.8091
 Avg Train Loss: 28.8091 | Seg Loss: 0.2880 | Recon Loss: 0.0045
  Val mIoU: 0.5669 (Best: 0.8102)
  [Class IoU]  C1: 0.4452 | C2: 0.7574 | C3: 0.4981
Epoch 152/400 | Train Loss: 29.4258
 Avg Train Loss: 29.4258 | Seg Loss: 0.2942 | Recon Loss: 0.0047
  Val mIoU: 0.5584 (Best: 0.8102)
  [Class IoU]  C1: 0.4328 | C2: 0.7567 | C3: 0.4856
Epoch 153/400 | Train Loss: 29.1551
 Avg Train Loss: 29.1551 | Seg Loss: 0.2915 | Recon Loss: 0.0046
  Val mIoU: 0.5415 (Best: 0.8102)
  [Class IoU]  C1: 0.4032 | C2: 0.7498 | C3: 0.4717
Epoch 154/400 | Train Loss: 29.5190
 Avg Train Loss: 29.5190 | Seg Loss: 0.2951 | Recon Loss: 0.0047
  Val mIoU: 0.6980 (Best: 0.8102)
  [Class IoU]  C1: 0.7787 | C2: 0.7754 | C3: 0.5400
Epoch 155/400 | Train Loss: 29.2567
 Avg Train Loss: 29.2567 | Seg Loss: 0.2925 | Recon Loss: 0.0045
  Val mIoU: 0.5568 (Best: 0.8102)
  [Class IoU]  C1: 0.4385 | C2: 0.7522 | C3: 0.4797
Epoch 156/400 | Train Loss: 28.7648
 Avg Train Loss: 28.7648 | Seg Loss: 0.2876 | Recon Loss: 0.0047
  Val mIoU: 0.5614 (Best: 0.8102)
  [Class IoU]  C1: 0.4062 | C2: 0.7641 | C3: 0.5141
Epoch 157/400 | Train Loss: 29.1738
 Avg Train Loss: 29.1738 | Seg Loss: 0.2917 | Recon Loss: 0.0046
  Val mIoU: 0.5276 (Best: 0.8102)
  [Class IoU]  C1: 0.3446 | C2: 0.7584 | C3: 0.4800
Epoch 158/400 | Train Loss: 29.0527
 Avg Train Loss: 29.0527 | Seg Loss: 0.2905 | Recon Loss: 0.0048
  Val mIoU: 0.5488 (Best: 0.8102)
  [Class IoU]  C1: 0.3499 | C2: 0.7717 | C3: 0.5247
Epoch 159/400 | Train Loss: 29.2891
 Avg Train Loss: 29.2891 | Seg Loss: 0.2928 | Recon Loss: 0.0048
  Val mIoU: 0.5652 (Best: 0.8102)
  [Class IoU]  C1: 0.3945 | C2: 0.7647 | C3: 0.5366
Epoch 160/400 | Train Loss: 29.0109
 Avg Train Loss: 29.0109 | Seg Loss: 0.2901 | Recon Loss: 0.0046
  Val mIoU: 0.5384 (Best: 0.8102)
  [Class IoU]  C1: 0.4501 | C2: 0.7155 | C3: 0.4495
  Saving visuals for Epoch 160...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0160_predictions.png
Epoch 161/400 | Train Loss: 29.0696
 Avg Train Loss: 29.0696 | Seg Loss: 0.2906 | Recon Loss: 0.0047
  Val mIoU: 0.6135 (Best: 0.8102)
  [Class IoU]  C1: 0.5987 | C2: 0.7511 | C3: 0.4908
Epoch 162/400 | Train Loss: 29.2568
 Avg Train Loss: 29.2568 | Seg Loss: 0.2925 | Recon Loss: 0.0045
  Val mIoU: 0.5244 (Best: 0.8102)
  [Class IoU]  C1: 0.2924 | C2: 0.7584 | C3: 0.5225
Epoch 163/400 | Train Loss: 29.7568
 Avg Train Loss: 29.7568 | Seg Loss: 0.2975 | Recon Loss: 0.0046
  Val mIoU: 0.6017 (Best: 0.8102)
  [Class IoU]  C1: 0.4680 | C2: 0.7816 | C3: 0.5554
Epoch 164/400 | Train Loss: 29.4975
 Avg Train Loss: 29.4975 | Seg Loss: 0.2949 | Recon Loss: 0.0045
  Val mIoU: 0.5449 (Best: 0.8102)
  [Class IoU]  C1: 0.3508 | C2: 0.7493 | C3: 0.5347
Epoch 165/400 | Train Loss: 29.1347
 Avg Train Loss: 29.1347 | Seg Loss: 0.2913 | Recon Loss: 0.0046
  Val mIoU: 0.5758 (Best: 0.8102)
  [Class IoU]  C1: 0.3914 | C2: 0.7801 | C3: 0.5559
Epoch 166/400 | Train Loss: 29.7250
 Avg Train Loss: 29.7250 | Seg Loss: 0.2972 | Recon Loss: 0.0047
  Val mIoU: 0.5918 (Best: 0.8102)
  [Class IoU]  C1: 0.4423 | C2: 0.7820 | C3: 0.5512
Epoch 167/400 | Train Loss: 29.1983
 Avg Train Loss: 29.1983 | Seg Loss: 0.2919 | Recon Loss: 0.0048
  Val mIoU: 0.5214 (Best: 0.8102)
  [Class IoU]  C1: 0.3268 | C2: 0.7434 | C3: 0.4939
Epoch 168/400 | Train Loss: 29.6357
 Avg Train Loss: 29.6357 | Seg Loss: 0.2963 | Recon Loss: 0.0048
  Val mIoU: 0.7371 (Best: 0.8102)
  [Class IoU]  C1: 0.8944 | C2: 0.7807 | C3: 0.5363
Epoch 169/400 | Train Loss: 29.2212
 Avg Train Loss: 29.2212 | Seg Loss: 0.2922 | Recon Loss: 0.0048
  Val mIoU: 0.5578 (Best: 0.8102)
  [Class IoU]  C1: 0.3890 | C2: 0.7659 | C3: 0.5184
Epoch 170/400 | Train Loss: 28.7356
 Avg Train Loss: 28.7356 | Seg Loss: 0.2873 | Recon Loss: 0.0047
  Val mIoU: 0.5993 (Best: 0.8102)
  [Class IoU]  C1: 0.4551 | C2: 0.7869 | C3: 0.5558
Epoch 171/400 | Train Loss: 29.1426
 Avg Train Loss: 29.1426 | Seg Loss: 0.2914 | Recon Loss: 0.0046
  Val mIoU: 0.6328 (Best: 0.8102)
  [Class IoU]  C1: 0.5321 | C2: 0.7939 | C3: 0.5724
Epoch 172/400 | Train Loss: 29.2847
 Avg Train Loss: 29.2847 | Seg Loss: 0.2928 | Recon Loss: 0.0045
  Val mIoU: 0.6143 (Best: 0.8102)
  [Class IoU]  C1: 0.5684 | C2: 0.7707 | C3: 0.5039
Epoch 173/400 | Train Loss: 29.6874
 Avg Train Loss: 29.6874 | Seg Loss: 0.2968 | Recon Loss: 0.0046
  Val mIoU: 0.5555 (Best: 0.8102)
  [Class IoU]  C1: 0.3847 | C2: 0.7594 | C3: 0.5224
Epoch 174/400 | Train Loss: 28.8541
 Avg Train Loss: 28.8541 | Seg Loss: 0.2885 | Recon Loss: 0.0046
  Val mIoU: 0.5315 (Best: 0.8102)
  [Class IoU]  C1: 0.3329 | C2: 0.7633 | C3: 0.4981
Epoch 175/400 | Train Loss: 29.4497
 Avg Train Loss: 29.4497 | Seg Loss: 0.2945 | Recon Loss: 0.0046
  Val mIoU: 0.6207 (Best: 0.8102)
  [Class IoU]  C1: 0.5654 | C2: 0.7664 | C3: 0.5303
Epoch 176/400 | Train Loss: 29.1101
 Avg Train Loss: 29.1101 | Seg Loss: 0.2911 | Recon Loss: 0.0047
  Val mIoU: 0.5292 (Best: 0.8102)
  [Class IoU]  C1: 0.3349 | C2: 0.7560 | C3: 0.4969
Epoch 177/400 | Train Loss: 29.5308
 Avg Train Loss: 29.5308 | Seg Loss: 0.2953 | Recon Loss: 0.0046
  Val mIoU: 0.6317 (Best: 0.8102)
  [Class IoU]  C1: 0.6083 | C2: 0.7708 | C3: 0.5161
Epoch 178/400 | Train Loss: 29.1356
 Avg Train Loss: 29.1356 | Seg Loss: 0.2913 | Recon Loss: 0.0047
  Val mIoU: 0.6305 (Best: 0.8102)
  [Class IoU]  C1: 0.6224 | C2: 0.7671 | C3: 0.5021
Epoch 179/400 | Train Loss: 28.9418
 Avg Train Loss: 28.9418 | Seg Loss: 0.2894 | Recon Loss: 0.0047
  Val mIoU: 0.6160 (Best: 0.8102)
  [Class IoU]  C1: 0.5621 | C2: 0.7770 | C3: 0.5089
Epoch 180/400 | Train Loss: 29.8227
 Avg Train Loss: 29.8227 | Seg Loss: 0.2982 | Recon Loss: 0.0046
  Val mIoU: 0.5463 (Best: 0.8102)
  [Class IoU]  C1: 0.4028 | C2: 0.7558 | C3: 0.4802
  Saving visuals for Epoch 180...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0180_predictions.png
Epoch 181/400 | Train Loss: 29.3990
 Avg Train Loss: 29.3990 | Seg Loss: 0.2939 | Recon Loss: 0.0046
  Val mIoU: 0.6649 (Best: 0.8102)
  [Class IoU]  C1: 0.6312 | C2: 0.7987 | C3: 0.5649
Epoch 182/400 | Train Loss: 28.8041
 Avg Train Loss: 28.8041 | Seg Loss: 0.2880 | Recon Loss: 0.0046
  Val mIoU: 0.6447 (Best: 0.8102)
  [Class IoU]  C1: 0.5663 | C2: 0.7956 | C3: 0.5722
Epoch 183/400 | Train Loss: 28.8755
 Avg Train Loss: 28.8755 | Seg Loss: 0.2887 | Recon Loss: 0.0046
  Val mIoU: 0.5443 (Best: 0.8102)
  [Class IoU]  C1: 0.3345 | C2: 0.7746 | C3: 0.5239
Epoch 184/400 | Train Loss: 28.4810
 Avg Train Loss: 28.4810 | Seg Loss: 0.2848 | Recon Loss: 0.0047
  Val mIoU: 0.6828 (Best: 0.8102)
  [Class IoU]  C1: 0.6823 | C2: 0.7983 | C3: 0.5677
Epoch 185/400 | Train Loss: 29.7800
 Avg Train Loss: 29.7800 | Seg Loss: 0.2978 | Recon Loss: 0.0047
  Val mIoU: 0.5599 (Best: 0.8102)
  [Class IoU]  C1: 0.4142 | C2: 0.7594 | C3: 0.5061
Epoch 186/400 | Train Loss: 29.1732
 Avg Train Loss: 29.1732 | Seg Loss: 0.2917 | Recon Loss: 0.0047
  Val mIoU: 0.6642 (Best: 0.8102)
  [Class IoU]  C1: 0.6033 | C2: 0.8090 | C3: 0.5803
Epoch 187/400 | Train Loss: 29.1324
 Avg Train Loss: 29.1324 | Seg Loss: 0.2913 | Recon Loss: 0.0046
  Val mIoU: 0.5882 (Best: 0.8102)
  [Class IoU]  C1: 0.4976 | C2: 0.7633 | C3: 0.5038
Epoch 188/400 | Train Loss: 29.0684
 Avg Train Loss: 29.0684 | Seg Loss: 0.2906 | Recon Loss: 0.0046
  Val mIoU: 0.7088 (Best: 0.8102)
  [Class IoU]  C1: 0.8134 | C2: 0.7866 | C3: 0.5263
Epoch 189/400 | Train Loss: 29.1188
 Avg Train Loss: 29.1188 | Seg Loss: 0.2911 | Recon Loss: 0.0046
  Val mIoU: 0.5820 (Best: 0.8102)
  [Class IoU]  C1: 0.4857 | C2: 0.7487 | C3: 0.5116
Epoch 190/400 | Train Loss: 29.2315
 Avg Train Loss: 29.2315 | Seg Loss: 0.2923 | Recon Loss: 0.0046
  Val mIoU: 0.5248 (Best: 0.8102)
  [Class IoU]  C1: 0.3205 | C2: 0.7482 | C3: 0.5057
Epoch 191/400 | Train Loss: 29.3626
 Avg Train Loss: 29.3626 | Seg Loss: 0.2936 | Recon Loss: 0.0046
  Val mIoU: 0.6417 (Best: 0.8102)
  [Class IoU]  C1: 0.6383 | C2: 0.7751 | C3: 0.5116
Epoch 192/400 | Train Loss: 28.7650
 Avg Train Loss: 28.7650 | Seg Loss: 0.2876 | Recon Loss: 0.0046
  Val mIoU: 0.5312 (Best: 0.8102)
  [Class IoU]  C1: 0.3120 | C2: 0.7731 | C3: 0.5085
Epoch 193/400 | Train Loss: 29.5315
 Avg Train Loss: 29.5315 | Seg Loss: 0.2953 | Recon Loss: 0.0046
  Val mIoU: 0.5469 (Best: 0.8102)
  [Class IoU]  C1: 0.3361 | C2: 0.7726 | C3: 0.5319
Epoch 194/400 | Train Loss: 29.4093
 Avg Train Loss: 29.4093 | Seg Loss: 0.2940 | Recon Loss: 0.0045
  Val mIoU: 0.5773 (Best: 0.8102)
  [Class IoU]  C1: 0.4235 | C2: 0.7743 | C3: 0.5341
Epoch 195/400 | Train Loss: 29.1606
 Avg Train Loss: 29.1606 | Seg Loss: 0.2916 | Recon Loss: 0.0046
  Val mIoU: 0.5802 (Best: 0.8102)
  [Class IoU]  C1: 0.4255 | C2: 0.7791 | C3: 0.5361
Epoch 196/400 | Train Loss: 29.7517
 Avg Train Loss: 29.7517 | Seg Loss: 0.2975 | Recon Loss: 0.0047
  Val mIoU: 0.5625 (Best: 0.8102)
  [Class IoU]  C1: 0.4487 | C2: 0.7543 | C3: 0.4846
Epoch 197/400 | Train Loss: 29.7145
 Avg Train Loss: 29.7145 | Seg Loss: 0.2971 | Recon Loss: 0.0046
  Val mIoU: 0.5692 (Best: 0.8102)
  [Class IoU]  C1: 0.3549 | C2: 0.7867 | C3: 0.5659
Epoch 198/400 | Train Loss: 29.3459
 Avg Train Loss: 29.3459 | Seg Loss: 0.2934 | Recon Loss: 0.0046
  Val mIoU: 0.5709 (Best: 0.8102)
  [Class IoU]  C1: 0.4153 | C2: 0.7705 | C3: 0.5270
Epoch 199/400 | Train Loss: 29.2024
 Avg Train Loss: 29.2024 | Seg Loss: 0.2920 | Recon Loss: 0.0045
  Val mIoU: 0.5565 (Best: 0.8102)
  [Class IoU]  C1: 0.4173 | C2: 0.7522 | C3: 0.5001
Epoch 200/400 | Train Loss: 29.0326
 Avg Train Loss: 29.0326 | Seg Loss: 0.2903 | Recon Loss: 0.0045
  Val mIoU: 0.5243 (Best: 0.8102)
  [Class IoU]  C1: 0.3033 | C2: 0.7594 | C3: 0.5103
  Saving visuals for Epoch 200...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0200_predictions.png
Epoch 201/400 | Train Loss: 29.6014
 Avg Train Loss: 29.6014 | Seg Loss: 0.2960 | Recon Loss: 0.0047
  Val mIoU: 0.6802 (Best: 0.8102)
  [Class IoU]  C1: 0.6747 | C2: 0.7991 | C3: 0.5667
Epoch 202/400 | Train Loss: 29.2402
 Avg Train Loss: 29.2402 | Seg Loss: 0.2924 | Recon Loss: 0.0046
  Val mIoU: 0.5773 (Best: 0.8102)
  [Class IoU]  C1: 0.4868 | C2: 0.7448 | C3: 0.5001
Epoch 203/400 | Train Loss: 28.6403
 Avg Train Loss: 28.6403 | Seg Loss: 0.2864 | Recon Loss: 0.0046
  Val mIoU: 0.5909 (Best: 0.8102)
  [Class IoU]  C1: 0.4390 | C2: 0.7819 | C3: 0.5517
Epoch 204/400 | Train Loss: 29.4668
 Avg Train Loss: 29.4668 | Seg Loss: 0.2946 | Recon Loss: 0.0046
  Val mIoU: 0.6212 (Best: 0.8102)
  [Class IoU]  C1: 0.5286 | C2: 0.7908 | C3: 0.5442
Epoch 205/400 | Train Loss: 29.2418
 Avg Train Loss: 29.2418 | Seg Loss: 0.2924 | Recon Loss: 0.0046
  Val mIoU: 0.5645 (Best: 0.8102)
  [Class IoU]  C1: 0.4258 | C2: 0.7711 | C3: 0.4966
Epoch 206/400 | Train Loss: 29.8503
 Avg Train Loss: 29.8503 | Seg Loss: 0.2985 | Recon Loss: 0.0046
  Val mIoU: 0.5575 (Best: 0.8102)
  [Class IoU]  C1: 0.3635 | C2: 0.7779 | C3: 0.5309
Epoch 207/400 | Train Loss: 28.8033
 Avg Train Loss: 28.8033 | Seg Loss: 0.2880 | Recon Loss: 0.0047
  Val mIoU: 0.5160 (Best: 0.8102)
  [Class IoU]  C1: 0.3033 | C2: 0.7578 | C3: 0.4869
Epoch 208/400 | Train Loss: 29.0342
 Avg Train Loss: 29.0342 | Seg Loss: 0.2903 | Recon Loss: 0.0046
  Val mIoU: 0.5599 (Best: 0.8102)
  [Class IoU]  C1: 0.3806 | C2: 0.7644 | C3: 0.5347
Epoch 209/400 | Train Loss: 29.4233
 Avg Train Loss: 29.4233 | Seg Loss: 0.2942 | Recon Loss: 0.0046
  Val mIoU: 0.5873 (Best: 0.8102)
  [Class IoU]  C1: 0.3986 | C2: 0.7900 | C3: 0.5734
Epoch 210/400 | Train Loss: 29.0795
 Avg Train Loss: 29.0795 | Seg Loss: 0.2907 | Recon Loss: 0.0047
  Val mIoU: 0.6114 (Best: 0.8102)
  [Class IoU]  C1: 0.5179 | C2: 0.7881 | C3: 0.5283
Epoch 211/400 | Train Loss: 28.9594
 Avg Train Loss: 28.9594 | Seg Loss: 0.2895 | Recon Loss: 0.0045
  Val mIoU: 0.6669 (Best: 0.8102)
  [Class IoU]  C1: 0.6928 | C2: 0.7837 | C3: 0.5243
Epoch 212/400 | Train Loss: 29.2484
 Avg Train Loss: 29.2484 | Seg Loss: 0.2924 | Recon Loss: 0.0046
  Val mIoU: 0.5869 (Best: 0.8102)
  [Class IoU]  C1: 0.4390 | C2: 0.7875 | C3: 0.5343
Epoch 213/400 | Train Loss: 28.6580
 Avg Train Loss: 28.6580 | Seg Loss: 0.2865 | Recon Loss: 0.0046
  Val mIoU: 0.5720 (Best: 0.8102)
  [Class IoU]  C1: 0.3955 | C2: 0.7816 | C3: 0.5388
Epoch 214/400 | Train Loss: 28.7783
 Avg Train Loss: 28.7783 | Seg Loss: 0.2877 | Recon Loss: 0.0047
  Val mIoU: 0.5750 (Best: 0.8102)
  [Class IoU]  C1: 0.4217 | C2: 0.7794 | C3: 0.5241
Epoch 215/400 | Train Loss: 29.3815
 Avg Train Loss: 29.3815 | Seg Loss: 0.2938 | Recon Loss: 0.0048
  Val mIoU: 0.5349 (Best: 0.8102)
  [Class IoU]  C1: 0.3061 | C2: 0.7683 | C3: 0.5302
Epoch 216/400 | Train Loss: 28.7390
 Avg Train Loss: 28.7390 | Seg Loss: 0.2873 | Recon Loss: 0.0046
  Val mIoU: 0.5587 (Best: 0.8102)
  [Class IoU]  C1: 0.3667 | C2: 0.7725 | C3: 0.5371
Epoch 217/400 | Train Loss: 29.6003
 Avg Train Loss: 29.6003 | Seg Loss: 0.2960 | Recon Loss: 0.0046
  Val mIoU: 0.7162 (Best: 0.8102)
  [Class IoU]  C1: 0.8068 | C2: 0.8022 | C3: 0.5395
Epoch 218/400 | Train Loss: 28.8890
 Avg Train Loss: 28.8890 | Seg Loss: 0.2888 | Recon Loss: 0.0046
  Val mIoU: 0.5218 (Best: 0.8102)
  [Class IoU]  C1: 0.3255 | C2: 0.7568 | C3: 0.4831
Epoch 219/400 | Train Loss: 29.4663
 Avg Train Loss: 29.4663 | Seg Loss: 0.2946 | Recon Loss: 0.0047
  Val mIoU: 0.5203 (Best: 0.8102)
  [Class IoU]  C1: 0.3978 | C2: 0.7154 | C3: 0.4478
Epoch 220/400 | Train Loss: 28.7503
 Avg Train Loss: 28.7503 | Seg Loss: 0.2875 | Recon Loss: 0.0046
  Val mIoU: 0.5997 (Best: 0.8102)
  [Class IoU]  C1: 0.4243 | C2: 0.8041 | C3: 0.5706
  Saving visuals for Epoch 220...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0220_predictions.png
Epoch 221/400 | Train Loss: 29.2038
 Avg Train Loss: 29.2038 | Seg Loss: 0.2920 | Recon Loss: 0.0047
  Val mIoU: 0.6225 (Best: 0.8102)
  [Class IoU]  C1: 0.5519 | C2: 0.7723 | C3: 0.5433
Epoch 222/400 | Train Loss: 29.2506
 Avg Train Loss: 29.2506 | Seg Loss: 0.2925 | Recon Loss: 0.0045
  Val mIoU: 0.6704 (Best: 0.8102)
  [Class IoU]  C1: 0.6337 | C2: 0.7996 | C3: 0.5779
Epoch 223/400 | Train Loss: 29.5202
 Avg Train Loss: 29.5202 | Seg Loss: 0.2952 | Recon Loss: 0.0046
  Val mIoU: 0.5537 (Best: 0.8102)
  [Class IoU]  C1: 0.3635 | C2: 0.7702 | C3: 0.5272
Epoch 224/400 | Train Loss: 28.5749
 Avg Train Loss: 28.5749 | Seg Loss: 0.2857 | Recon Loss: 0.0046
  Val mIoU: 0.5627 (Best: 0.8102)
  [Class IoU]  C1: 0.4615 | C2: 0.7479 | C3: 0.4788
Epoch 225/400 | Train Loss: 29.1898
 Avg Train Loss: 29.1898 | Seg Loss: 0.2919 | Recon Loss: 0.0047
  Val mIoU: 0.6892 (Best: 0.8102)
  [Class IoU]  C1: 0.7320 | C2: 0.7946 | C3: 0.5411
Epoch 226/400 | Train Loss: 29.0740
 Avg Train Loss: 29.0740 | Seg Loss: 0.2907 | Recon Loss: 0.0047
  Val mIoU: 0.5836 (Best: 0.8102)
  [Class IoU]  C1: 0.4846 | C2: 0.7618 | C3: 0.5045
Epoch 227/400 | Train Loss: 29.0737
 Avg Train Loss: 29.0737 | Seg Loss: 0.2907 | Recon Loss: 0.0046
  Val mIoU: 0.5213 (Best: 0.8102)
  [Class IoU]  C1: 0.3627 | C2: 0.7422 | C3: 0.4590
Epoch 228/400 | Train Loss: 29.9669
 Avg Train Loss: 29.9669 | Seg Loss: 0.2996 | Recon Loss: 0.0047
  Val mIoU: 0.5431 (Best: 0.8102)
  [Class IoU]  C1: 0.3780 | C2: 0.7532 | C3: 0.4980
Epoch 229/400 | Train Loss: 29.6325
 Avg Train Loss: 29.6325 | Seg Loss: 0.2963 | Recon Loss: 0.0045
  Val mIoU: 0.5855 (Best: 0.8102)
  [Class IoU]  C1: 0.5314 | C2: 0.7474 | C3: 0.4777
Epoch 230/400 | Train Loss: 28.9629
 Avg Train Loss: 28.9629 | Seg Loss: 0.2896 | Recon Loss: 0.0046
  Val mIoU: 0.6208 (Best: 0.8102)
  [Class IoU]  C1: 0.5767 | C2: 0.7693 | C3: 0.5164
Epoch 231/400 | Train Loss: 29.3106
 Avg Train Loss: 29.3106 | Seg Loss: 0.2931 | Recon Loss: 0.0047
  Val mIoU: 0.5828 (Best: 0.8102)
  [Class IoU]  C1: 0.4404 | C2: 0.7691 | C3: 0.5388
Epoch 232/400 | Train Loss: 29.0457
 Avg Train Loss: 29.0457 | Seg Loss: 0.2904 | Recon Loss: 0.0046
  Val mIoU: 0.5428 (Best: 0.8102)
  [Class IoU]  C1: 0.3416 | C2: 0.7721 | C3: 0.5147
Epoch 233/400 | Train Loss: 29.3772
 Avg Train Loss: 29.3772 | Seg Loss: 0.2937 | Recon Loss: 0.0046
  Val mIoU: 0.5237 (Best: 0.8102)
  [Class IoU]  C1: 0.3331 | C2: 0.7480 | C3: 0.4901
Epoch 234/400 | Train Loss: 29.2781
 Avg Train Loss: 29.2781 | Seg Loss: 0.2927 | Recon Loss: 0.0046
  Val mIoU: 0.5682 (Best: 0.8102)
  [Class IoU]  C1: 0.3552 | C2: 0.7800 | C3: 0.5695
Epoch 235/400 | Train Loss: 28.8444
 Avg Train Loss: 28.8444 | Seg Loss: 0.2884 | Recon Loss: 0.0047
  Val mIoU: 0.6625 (Best: 0.8102)
  [Class IoU]  C1: 0.6756 | C2: 0.7790 | C3: 0.5329
Epoch 236/400 | Train Loss: 29.0306
 Avg Train Loss: 29.0306 | Seg Loss: 0.2903 | Recon Loss: 0.0046
  Val mIoU: 0.5630 (Best: 0.8102)
  [Class IoU]  C1: 0.4468 | C2: 0.7559 | C3: 0.4862
Epoch 237/400 | Train Loss: 29.1668
 Avg Train Loss: 29.1668 | Seg Loss: 0.2916 | Recon Loss: 0.0046
  Val mIoU: 0.7001 (Best: 0.8102)
  [Class IoU]  C1: 0.7841 | C2: 0.7867 | C3: 0.5296
Epoch 238/400 | Train Loss: 29.1063
 Avg Train Loss: 29.1063 | Seg Loss: 0.2910 | Recon Loss: 0.0047
  Val mIoU: 0.5807 (Best: 0.8102)
  [Class IoU]  C1: 0.4393 | C2: 0.7677 | C3: 0.5351
Epoch 239/400 | Train Loss: 28.8450
 Avg Train Loss: 28.8450 | Seg Loss: 0.2884 | Recon Loss: 0.0046
  Val mIoU: 0.5124 (Best: 0.8102)
  [Class IoU]  C1: 0.3289 | C2: 0.7382 | C3: 0.4702
Epoch 240/400 | Train Loss: 29.1628
 Avg Train Loss: 29.1628 | Seg Loss: 0.2916 | Recon Loss: 0.0047
  Val mIoU: 0.6094 (Best: 0.8102)
  [Class IoU]  C1: 0.4356 | C2: 0.8090 | C3: 0.5834
  Saving visuals for Epoch 240...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0240_predictions.png
Epoch 241/400 | Train Loss: 28.5806
 Avg Train Loss: 28.5806 | Seg Loss: 0.2858 | Recon Loss: 0.0046
  Val mIoU: 0.7270 (Best: 0.8102)
  [Class IoU]  C1: 0.8580 | C2: 0.7883 | C3: 0.5347
Epoch 242/400 | Train Loss: 29.8741
 Avg Train Loss: 29.8741 | Seg Loss: 0.2987 | Recon Loss: 0.0047
  Val mIoU: 0.6019 (Best: 0.8102)
  [Class IoU]  C1: 0.5333 | C2: 0.7687 | C3: 0.5036
Epoch 243/400 | Train Loss: 29.6902
 Avg Train Loss: 29.6902 | Seg Loss: 0.2969 | Recon Loss: 0.0045
  Val mIoU: 0.5247 (Best: 0.8102)
  [Class IoU]  C1: 0.2965 | C2: 0.7678 | C3: 0.5098
Epoch 244/400 | Train Loss: 29.1911
 Avg Train Loss: 29.1911 | Seg Loss: 0.2919 | Recon Loss: 0.0044
  Val mIoU: 0.5837 (Best: 0.8102)
  [Class IoU]  C1: 0.3975 | C2: 0.7896 | C3: 0.5640
Epoch 245/400 | Train Loss: 28.9441
 Avg Train Loss: 28.9441 | Seg Loss: 0.2894 | Recon Loss: 0.0046
  Val mIoU: 0.5281 (Best: 0.8102)
  [Class IoU]  C1: 0.3154 | C2: 0.7612 | C3: 0.5076
Epoch 246/400 | Train Loss: 29.6930
 Avg Train Loss: 29.6930 | Seg Loss: 0.2969 | Recon Loss: 0.0046
  Val mIoU: 0.5230 (Best: 0.8102)
  [Class IoU]  C1: 0.3196 | C2: 0.7489 | C3: 0.5004
Epoch 247/400 | Train Loss: 29.3832
 Avg Train Loss: 29.3832 | Seg Loss: 0.2938 | Recon Loss: 0.0046
  Val mIoU: 0.5818 (Best: 0.8102)
  [Class IoU]  C1: 0.4482 | C2: 0.7800 | C3: 0.5171
Epoch 248/400 | Train Loss: 29.6182
 Avg Train Loss: 29.6182 | Seg Loss: 0.2961 | Recon Loss: 0.0047
  Val mIoU: 0.5618 (Best: 0.8102)
  [Class IoU]  C1: 0.4273 | C2: 0.7595 | C3: 0.4985
Epoch 249/400 | Train Loss: 29.0531
 Avg Train Loss: 29.0531 | Seg Loss: 0.2905 | Recon Loss: 0.0046
  Val mIoU: 0.6114 (Best: 0.8102)
  [Class IoU]  C1: 0.5113 | C2: 0.7861 | C3: 0.5369
Epoch 250/400 | Train Loss: 28.8876
 Avg Train Loss: 28.8876 | Seg Loss: 0.2888 | Recon Loss: 0.0045
  Val mIoU: 0.7370 (Best: 0.8102)
  [Class IoU]  C1: 0.8350 | C2: 0.8088 | C3: 0.5671
Epoch 251/400 | Train Loss: 28.9774
 Avg Train Loss: 28.9774 | Seg Loss: 0.2897 | Recon Loss: 0.0046
  Val mIoU: 0.5496 (Best: 0.8102)
  [Class IoU]  C1: 0.3927 | C2: 0.7556 | C3: 0.5004
Epoch 252/400 | Train Loss: 29.3049
 Avg Train Loss: 29.3049 | Seg Loss: 0.2930 | Recon Loss: 0.0047
  Val mIoU: 0.6333 (Best: 0.8102)
  [Class IoU]  C1: 0.6402 | C2: 0.7623 | C3: 0.4975
Epoch 253/400 | Train Loss: 29.0156
 Avg Train Loss: 29.0156 | Seg Loss: 0.2901 | Recon Loss: 0.0046
  Val mIoU: 0.5517 (Best: 0.8102)
  [Class IoU]  C1: 0.3364 | C2: 0.7849 | C3: 0.5338
Epoch 254/400 | Train Loss: 29.5476
 Avg Train Loss: 29.5476 | Seg Loss: 0.2954 | Recon Loss: 0.0046
  Val mIoU: 0.4977 (Best: 0.8102)
  [Class IoU]  C1: 0.3395 | C2: 0.7196 | C3: 0.4341
Epoch 255/400 | Train Loss: 28.7576
 Avg Train Loss: 28.7576 | Seg Loss: 0.2875 | Recon Loss: 0.0047
  Val mIoU: 0.4975 (Best: 0.8102)
  [Class IoU]  C1: 0.3223 | C2: 0.7212 | C3: 0.4490
Epoch 256/400 | Train Loss: 29.3492
 Avg Train Loss: 29.3492 | Seg Loss: 0.2934 | Recon Loss: 0.0045
  Val mIoU: 0.5509 (Best: 0.8102)
  [Class IoU]  C1: 0.3873 | C2: 0.7654 | C3: 0.5001
Epoch 257/400 | Train Loss: 29.3288
 Avg Train Loss: 29.3288 | Seg Loss: 0.2932 | Recon Loss: 0.0047
  Val mIoU: 0.5582 (Best: 0.8102)
  [Class IoU]  C1: 0.3514 | C2: 0.7789 | C3: 0.5444
Epoch 258/400 | Train Loss: 29.2574
 Avg Train Loss: 29.2574 | Seg Loss: 0.2925 | Recon Loss: 0.0047
  Val mIoU: 0.6019 (Best: 0.8102)
  [Class IoU]  C1: 0.5261 | C2: 0.7621 | C3: 0.5174
Epoch 259/400 | Train Loss: 29.4247
 Avg Train Loss: 29.4247 | Seg Loss: 0.2942 | Recon Loss: 0.0048
  Val mIoU: 0.7270 (Best: 0.8102)
  [Class IoU]  C1: 0.8122 | C2: 0.7998 | C3: 0.5688
Epoch 260/400 | Train Loss: 28.8124
 Avg Train Loss: 28.8124 | Seg Loss: 0.2881 | Recon Loss: 0.0049
  Val mIoU: 0.5880 (Best: 0.8102)
  [Class IoU]  C1: 0.3894 | C2: 0.7898 | C3: 0.5849
  Saving visuals for Epoch 260...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0260_predictions.png
Epoch 261/400 | Train Loss: 29.0773
 Avg Train Loss: 29.0773 | Seg Loss: 0.2907 | Recon Loss: 0.0048
  Val mIoU: 0.5655 (Best: 0.8102)
  [Class IoU]  C1: 0.4835 | C2: 0.7492 | C3: 0.4639
Epoch 262/400 | Train Loss: 28.8008
 Avg Train Loss: 28.8008 | Seg Loss: 0.2880 | Recon Loss: 0.0046
  Val mIoU: 0.5933 (Best: 0.8102)
  [Class IoU]  C1: 0.4623 | C2: 0.7726 | C3: 0.5450
Epoch 263/400 | Train Loss: 29.3266
 Avg Train Loss: 29.3266 | Seg Loss: 0.2932 | Recon Loss: 0.0047
  Val mIoU: 0.6069 (Best: 0.8102)
  [Class IoU]  C1: 0.4975 | C2: 0.7818 | C3: 0.5415
Epoch 264/400 | Train Loss: 29.7772
 Avg Train Loss: 29.7772 | Seg Loss: 0.2977 | Recon Loss: 0.0045
  Val mIoU: 0.7284 (Best: 0.8102)
  [Class IoU]  C1: 0.8161 | C2: 0.8056 | C3: 0.5635
Epoch 265/400 | Train Loss: 28.8446
 Avg Train Loss: 28.8446 | Seg Loss: 0.2884 | Recon Loss: 0.0045
  Val mIoU: 0.5497 (Best: 0.8102)
  [Class IoU]  C1: 0.3794 | C2: 0.7597 | C3: 0.5099
Epoch 266/400 | Train Loss: 28.8562
 Avg Train Loss: 28.8562 | Seg Loss: 0.2885 | Recon Loss: 0.0046
  Val mIoU: 0.6881 (Best: 0.8102)
  [Class IoU]  C1: 0.7224 | C2: 0.7936 | C3: 0.5483
Epoch 267/400 | Train Loss: 29.2765
 Avg Train Loss: 29.2765 | Seg Loss: 0.2927 | Recon Loss: 0.0048
  Val mIoU: 0.6107 (Best: 0.8102)
  [Class IoU]  C1: 0.4984 | C2: 0.7883 | C3: 0.5454
Epoch 268/400 | Train Loss: 29.6201
 Avg Train Loss: 29.6201 | Seg Loss: 0.2962 | Recon Loss: 0.0046
  Val mIoU: 0.5840 (Best: 0.8102)
  [Class IoU]  C1: 0.5117 | C2: 0.7525 | C3: 0.4879
Epoch 269/400 | Train Loss: 29.0373
 Avg Train Loss: 29.0373 | Seg Loss: 0.2903 | Recon Loss: 0.0046
  Val mIoU: 0.5691 (Best: 0.8102)
  [Class IoU]  C1: 0.3873 | C2: 0.7761 | C3: 0.5440
Epoch 270/400 | Train Loss: 29.6687
 Avg Train Loss: 29.6687 | Seg Loss: 0.2966 | Recon Loss: 0.0047
  Val mIoU: 0.5437 (Best: 0.8102)
  [Class IoU]  C1: 0.4219 | C2: 0.7361 | C3: 0.4731
Epoch 271/400 | Train Loss: 28.6689
 Avg Train Loss: 28.6689 | Seg Loss: 0.2866 | Recon Loss: 0.0046
  Val mIoU: 0.5778 (Best: 0.8102)
  [Class IoU]  C1: 0.4405 | C2: 0.7678 | C3: 0.5252
Epoch 272/400 | Train Loss: 28.3898
 Avg Train Loss: 28.3898 | Seg Loss: 0.2839 | Recon Loss: 0.0046
  Val mIoU: 0.6938 (Best: 0.8102)
  [Class IoU]  C1: 0.7009 | C2: 0.7953 | C3: 0.5852
Epoch 273/400 | Train Loss: 29.2074
 Avg Train Loss: 29.2074 | Seg Loss: 0.2920 | Recon Loss: 0.0046
  Val mIoU: 0.5597 (Best: 0.8102)
  [Class IoU]  C1: 0.4019 | C2: 0.7722 | C3: 0.5051
Epoch 274/400 | Train Loss: 29.0420
 Avg Train Loss: 29.0420 | Seg Loss: 0.2904 | Recon Loss: 0.0045
  Val mIoU: 0.6934 (Best: 0.8102)
  [Class IoU]  C1: 0.8037 | C2: 0.7660 | C3: 0.5107
Epoch 275/400 | Train Loss: 29.2203
 Avg Train Loss: 29.2203 | Seg Loss: 0.2922 | Recon Loss: 0.0048
  Val mIoU: 0.6586 (Best: 0.8102)
  [Class IoU]  C1: 0.7034 | C2: 0.7630 | C3: 0.5095
Epoch 276/400 | Train Loss: 28.8563
 Avg Train Loss: 28.8563 | Seg Loss: 0.2885 | Recon Loss: 0.0047
  Val mIoU: 0.5620 (Best: 0.8102)
  [Class IoU]  C1: 0.3756 | C2: 0.7780 | C3: 0.5323
Epoch 277/400 | Train Loss: 28.6919
 Avg Train Loss: 28.6919 | Seg Loss: 0.2869 | Recon Loss: 0.0046
  Val mIoU: 0.5988 (Best: 0.8102)
  [Class IoU]  C1: 0.5006 | C2: 0.7794 | C3: 0.5163
Epoch 278/400 | Train Loss: 28.8981
 Avg Train Loss: 28.8981 | Seg Loss: 0.2889 | Recon Loss: 0.0046
  Val mIoU: 0.5997 (Best: 0.8102)
  [Class IoU]  C1: 0.4672 | C2: 0.7749 | C3: 0.5569
Epoch 279/400 | Train Loss: 29.3315
 Avg Train Loss: 29.3315 | Seg Loss: 0.2933 | Recon Loss: 0.0047
  Val mIoU: 0.7397 (Best: 0.8102)
  [Class IoU]  C1: 0.8761 | C2: 0.8021 | C3: 0.5408
Epoch 280/400 | Train Loss: 29.0786
 Avg Train Loss: 29.0786 | Seg Loss: 0.2907 | Recon Loss: 0.0046
  Val mIoU: 0.6805 (Best: 0.8102)
  [Class IoU]  C1: 0.7124 | C2: 0.7917 | C3: 0.5374
  Saving visuals for Epoch 280...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0280_predictions.png
Epoch 281/400 | Train Loss: 29.1087
 Avg Train Loss: 29.1087 | Seg Loss: 0.2910 | Recon Loss: 0.0048
  Val mIoU: 0.6755 (Best: 0.8102)
  [Class IoU]  C1: 0.7656 | C2: 0.7626 | C3: 0.4985
Epoch 282/400 | Train Loss: 29.6367
 Avg Train Loss: 29.6367 | Seg Loss: 0.2963 | Recon Loss: 0.0046
  Val mIoU: 0.5506 (Best: 0.8102)
  [Class IoU]  C1: 0.3545 | C2: 0.7770 | C3: 0.5204
Epoch 283/400 | Train Loss: 28.4157
 Avg Train Loss: 28.4157 | Seg Loss: 0.2841 | Recon Loss: 0.0045
  Val mIoU: 0.5915 (Best: 0.8102)
  [Class IoU]  C1: 0.4336 | C2: 0.7844 | C3: 0.5566
Epoch 284/400 | Train Loss: 28.8464
 Avg Train Loss: 28.8464 | Seg Loss: 0.2884 | Recon Loss: 0.0047
  Val mIoU: 0.5247 (Best: 0.8102)
  [Class IoU]  C1: 0.3622 | C2: 0.7371 | C3: 0.4747
Epoch 285/400 | Train Loss: 29.1135
 Avg Train Loss: 29.1135 | Seg Loss: 0.2911 | Recon Loss: 0.0047
  Val mIoU: 0.5306 (Best: 0.8102)
  [Class IoU]  C1: 0.3219 | C2: 0.7605 | C3: 0.5095
Epoch 286/400 | Train Loss: 29.0048
 Avg Train Loss: 29.0048 | Seg Loss: 0.2900 | Recon Loss: 0.0046
  Val mIoU: 0.6722 (Best: 0.8102)
  [Class IoU]  C1: 0.7688 | C2: 0.7588 | C3: 0.4890
Epoch 287/400 | Train Loss: 29.1366
 Avg Train Loss: 29.1366 | Seg Loss: 0.2913 | Recon Loss: 0.0046
  Val mIoU: 0.7070 (Best: 0.8102)
  [Class IoU]  C1: 0.7759 | C2: 0.7931 | C3: 0.5522
Epoch 288/400 | Train Loss: 28.5293
 Avg Train Loss: 28.5293 | Seg Loss: 0.2852 | Recon Loss: 0.0046
  Val mIoU: 0.5693 (Best: 0.8102)
  [Class IoU]  C1: 0.4183 | C2: 0.7775 | C3: 0.5120
Epoch 289/400 | Train Loss: 28.8797
 Avg Train Loss: 28.8797 | Seg Loss: 0.2888 | Recon Loss: 0.0046
  Val mIoU: 0.6607 (Best: 0.8102)
  [Class IoU]  C1: 0.7031 | C2: 0.7680 | C3: 0.5110
Epoch 290/400 | Train Loss: 29.1541
 Avg Train Loss: 29.1541 | Seg Loss: 0.2915 | Recon Loss: 0.0046
  Val mIoU: 0.5678 (Best: 0.8102)
  [Class IoU]  C1: 0.4356 | C2: 0.7686 | C3: 0.4991
Epoch 291/400 | Train Loss: 29.5488
 Avg Train Loss: 29.5488 | Seg Loss: 0.2954 | Recon Loss: 0.0046
  Val mIoU: 0.6649 (Best: 0.8102)
  [Class IoU]  C1: 0.6689 | C2: 0.7863 | C3: 0.5395
Epoch 292/400 | Train Loss: 29.1780
 Avg Train Loss: 29.1780 | Seg Loss: 0.2917 | Recon Loss: 0.0046
  Val mIoU: 0.6337 (Best: 0.8102)
  [Class IoU]  C1: 0.5807 | C2: 0.7864 | C3: 0.5341
Epoch 293/400 | Train Loss: 28.7020
 Avg Train Loss: 28.7020 | Seg Loss: 0.2870 | Recon Loss: 0.0046
  Val mIoU: 0.5471 (Best: 0.8102)
  [Class IoU]  C1: 0.4036 | C2: 0.7477 | C3: 0.4901
Epoch 294/400 | Train Loss: 29.0361
 Avg Train Loss: 29.0361 | Seg Loss: 0.2903 | Recon Loss: 0.0047
  Val mIoU: 0.7219 (Best: 0.8102)
  [Class IoU]  C1: 0.8157 | C2: 0.8011 | C3: 0.5489
Epoch 295/400 | Train Loss: 28.8935
 Avg Train Loss: 28.8935 | Seg Loss: 0.2889 | Recon Loss: 0.0047
  Val mIoU: 0.6266 (Best: 0.8102)
  [Class IoU]  C1: 0.5364 | C2: 0.7873 | C3: 0.5560
Epoch 296/400 | Train Loss: 28.6058
 Avg Train Loss: 28.6058 | Seg Loss: 0.2860 | Recon Loss: 0.0045
  Val mIoU: 0.5162 (Best: 0.8102)
  [Class IoU]  C1: 0.3543 | C2: 0.7319 | C3: 0.4622
Epoch 297/400 | Train Loss: 28.9776
 Avg Train Loss: 28.9776 | Seg Loss: 0.2897 | Recon Loss: 0.0047
  Val mIoU: 0.5636 (Best: 0.8102)
  [Class IoU]  C1: 0.3683 | C2: 0.7841 | C3: 0.5385
Epoch 298/400 | Train Loss: 29.5672
 Avg Train Loss: 29.5672 | Seg Loss: 0.2956 | Recon Loss: 0.0046
  Val mIoU: 0.6608 (Best: 0.8102)
  [Class IoU]  C1: 0.6269 | C2: 0.7950 | C3: 0.5605
Epoch 299/400 | Train Loss: 29.7005
 Avg Train Loss: 29.7005 | Seg Loss: 0.2970 | Recon Loss: 0.0047
  Val mIoU: 0.5314 (Best: 0.8102)
  [Class IoU]  C1: 0.3576 | C2: 0.7517 | C3: 0.4849
Epoch 300/400 | Train Loss: 29.1487
 Avg Train Loss: 29.1487 | Seg Loss: 0.2914 | Recon Loss: 0.0044
  Val mIoU: 0.6160 (Best: 0.8102)
  [Class IoU]  C1: 0.5025 | C2: 0.8017 | C3: 0.5439
  Saving visuals for Epoch 300...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0300_predictions.png
Epoch 301/400 | Train Loss: 28.5876
 Avg Train Loss: 28.5876 | Seg Loss: 0.2858 | Recon Loss: 0.0046
  Val mIoU: 0.5600 (Best: 0.8102)
  [Class IoU]  C1: 0.3804 | C2: 0.7698 | C3: 0.5298
Epoch 302/400 | Train Loss: 29.2704
 Avg Train Loss: 29.2704 | Seg Loss: 0.2927 | Recon Loss: 0.0047
  Val mIoU: 0.7436 (Best: 0.8102)
  [Class IoU]  C1: 0.8776 | C2: 0.8071 | C3: 0.5462
Epoch 303/400 | Train Loss: 28.9652
 Avg Train Loss: 28.9652 | Seg Loss: 0.2896 | Recon Loss: 0.0046
  Val mIoU: 0.6384 (Best: 0.8102)
  [Class IoU]  C1: 0.6328 | C2: 0.7768 | C3: 0.5058
Epoch 304/400 | Train Loss: 28.6640
 Avg Train Loss: 28.6640 | Seg Loss: 0.2866 | Recon Loss: 0.0045
  Val mIoU: 0.5813 (Best: 0.8102)
  [Class IoU]  C1: 0.4474 | C2: 0.7761 | C3: 0.5205
Epoch 305/400 | Train Loss: 28.9910
 Avg Train Loss: 28.9910 | Seg Loss: 0.2899 | Recon Loss: 0.0048
  Val mIoU: 0.6360 (Best: 0.8102)
  [Class IoU]  C1: 0.6184 | C2: 0.7675 | C3: 0.5220
Epoch 306/400 | Train Loss: 28.9470
 Avg Train Loss: 28.9470 | Seg Loss: 0.2894 | Recon Loss: 0.0047
  Val mIoU: 0.5902 (Best: 0.8102)
  [Class IoU]  C1: 0.4085 | C2: 0.7960 | C3: 0.5661
Epoch 307/400 | Train Loss: 29.6986
 Avg Train Loss: 29.6986 | Seg Loss: 0.2969 | Recon Loss: 0.0045
  Val mIoU: 0.6214 (Best: 0.8102)
  [Class IoU]  C1: 0.5662 | C2: 0.7799 | C3: 0.5180
Epoch 308/400 | Train Loss: 28.9157
 Avg Train Loss: 28.9157 | Seg Loss: 0.2891 | Recon Loss: 0.0047
  Val mIoU: 0.5541 (Best: 0.8102)
  [Class IoU]  C1: 0.3652 | C2: 0.7659 | C3: 0.5312
Epoch 309/400 | Train Loss: 28.9089
 Avg Train Loss: 28.9089 | Seg Loss: 0.2890 | Recon Loss: 0.0046
  Val mIoU: 0.7261 (Best: 0.8102)
  [Class IoU]  C1: 0.9028 | C2: 0.7740 | C3: 0.5016
Epoch 310/400 | Train Loss: 29.3240
 Avg Train Loss: 29.3240 | Seg Loss: 0.2932 | Recon Loss: 0.0046
  Val mIoU: 0.5725 (Best: 0.8102)
  [Class IoU]  C1: 0.3975 | C2: 0.7852 | C3: 0.5346
Epoch 311/400 | Train Loss: 28.8964
 Avg Train Loss: 28.8964 | Seg Loss: 0.2889 | Recon Loss: 0.0044
  Val mIoU: 0.5677 (Best: 0.8102)
  [Class IoU]  C1: 0.4707 | C2: 0.7325 | C3: 0.4998
Epoch 312/400 | Train Loss: 29.4557
 Avg Train Loss: 29.4557 | Seg Loss: 0.2945 | Recon Loss: 0.0046
  Val mIoU: 0.7424 (Best: 0.8102)
  [Class IoU]  C1: 0.9013 | C2: 0.7847 | C3: 0.5410
Epoch 313/400 | Train Loss: 28.9687
 Avg Train Loss: 28.9687 | Seg Loss: 0.2896 | Recon Loss: 0.0047
  Val mIoU: 0.5380 (Best: 0.8102)
  [Class IoU]  C1: 0.3804 | C2: 0.7538 | C3: 0.4797
Epoch 314/400 | Train Loss: 29.4762
 Avg Train Loss: 29.4762 | Seg Loss: 0.2947 | Recon Loss: 0.0047
  Val mIoU: 0.6056 (Best: 0.8102)
  [Class IoU]  C1: 0.5144 | C2: 0.7780 | C3: 0.5245
Epoch 315/400 | Train Loss: 28.1423
 Avg Train Loss: 28.1423 | Seg Loss: 0.2814 | Recon Loss: 0.0045
  Val mIoU: 0.5853 (Best: 0.8102)
  [Class IoU]  C1: 0.4339 | C2: 0.7757 | C3: 0.5462
Epoch 316/400 | Train Loss: 29.1699
 Avg Train Loss: 29.1699 | Seg Loss: 0.2917 | Recon Loss: 0.0045
  Val mIoU: 0.6083 (Best: 0.8102)
  [Class IoU]  C1: 0.5411 | C2: 0.7677 | C3: 0.5162
Epoch 317/400 | Train Loss: 29.1016
 Avg Train Loss: 29.1016 | Seg Loss: 0.2910 | Recon Loss: 0.0045
  Val mIoU: 0.5569 (Best: 0.8102)
  [Class IoU]  C1: 0.3568 | C2: 0.7733 | C3: 0.5407
Epoch 318/400 | Train Loss: 29.3257
 Avg Train Loss: 29.3257 | Seg Loss: 0.2932 | Recon Loss: 0.0046
  Val mIoU: 0.7363 (Best: 0.8102)
  [Class IoU]  C1: 0.8945 | C2: 0.7818 | C3: 0.5325
Epoch 319/400 | Train Loss: 29.0913
 Avg Train Loss: 29.0913 | Seg Loss: 0.2909 | Recon Loss: 0.0047
  Val mIoU: 0.5255 (Best: 0.8102)
  [Class IoU]  C1: 0.3509 | C2: 0.7448 | C3: 0.4809
Epoch 320/400 | Train Loss: 28.5327
 Avg Train Loss: 28.5327 | Seg Loss: 0.2853 | Recon Loss: 0.0048
  Val mIoU: 0.6252 (Best: 0.8102)
  [Class IoU]  C1: 0.5299 | C2: 0.7901 | C3: 0.5554
  Saving visuals for Epoch 320...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0320_predictions.png
Epoch 321/400 | Train Loss: 29.6774
 Avg Train Loss: 29.6774 | Seg Loss: 0.2967 | Recon Loss: 0.0044
  Val mIoU: 0.5126 (Best: 0.8102)
  [Class IoU]  C1: 0.3214 | C2: 0.7397 | C3: 0.4768
Epoch 322/400 | Train Loss: 28.9591
 Avg Train Loss: 28.9591 | Seg Loss: 0.2895 | Recon Loss: 0.0047
  Val mIoU: 0.5833 (Best: 0.8102)
  [Class IoU]  C1: 0.3828 | C2: 0.7926 | C3: 0.5745
Epoch 323/400 | Train Loss: 28.7946
 Avg Train Loss: 28.7946 | Seg Loss: 0.2879 | Recon Loss: 0.0046
  Val mIoU: 0.5443 (Best: 0.8102)
  [Class IoU]  C1: 0.3807 | C2: 0.7545 | C3: 0.4976
Epoch 324/400 | Train Loss: 29.0270
 Avg Train Loss: 29.0270 | Seg Loss: 0.2902 | Recon Loss: 0.0046
  Val mIoU: 0.6214 (Best: 0.8102)
  [Class IoU]  C1: 0.5352 | C2: 0.7778 | C3: 0.5513
Epoch 325/400 | Train Loss: 29.2649
 Avg Train Loss: 29.2649 | Seg Loss: 0.2926 | Recon Loss: 0.0047
  Val mIoU: 0.5349 (Best: 0.8102)
  [Class IoU]  C1: 0.3902 | C2: 0.7400 | C3: 0.4745
Epoch 326/400 | Train Loss: 29.3885
 Avg Train Loss: 29.3885 | Seg Loss: 0.2938 | Recon Loss: 0.0047
  Val mIoU: 0.5671 (Best: 0.8102)
  [Class IoU]  C1: 0.4246 | C2: 0.7680 | C3: 0.5087
Epoch 327/400 | Train Loss: 28.8355
 Avg Train Loss: 28.8355 | Seg Loss: 0.2883 | Recon Loss: 0.0046
  Val mIoU: 0.5505 (Best: 0.8102)
  [Class IoU]  C1: 0.3632 | C2: 0.7570 | C3: 0.5315
Epoch 328/400 | Train Loss: 29.2819
 Avg Train Loss: 29.2819 | Seg Loss: 0.2928 | Recon Loss: 0.0047
  Val mIoU: 0.5454 (Best: 0.8102)
  [Class IoU]  C1: 0.3219 | C2: 0.7721 | C3: 0.5423
Epoch 329/400 | Train Loss: 28.4862
 Avg Train Loss: 28.4862 | Seg Loss: 0.2848 | Recon Loss: 0.0046
  Val mIoU: 0.6647 (Best: 0.8102)
  [Class IoU]  C1: 0.6421 | C2: 0.7975 | C3: 0.5544
Epoch 330/400 | Train Loss: 29.1417
 Avg Train Loss: 29.1417 | Seg Loss: 0.2914 | Recon Loss: 0.0046
  Val mIoU: 0.5410 (Best: 0.8102)
  [Class IoU]  C1: 0.4074 | C2: 0.7403 | C3: 0.4754
Epoch 331/400 | Train Loss: 28.9499
 Avg Train Loss: 28.9499 | Seg Loss: 0.2895 | Recon Loss: 0.0044
  Val mIoU: 0.5731 (Best: 0.8102)
  [Class IoU]  C1: 0.4436 | C2: 0.7698 | C3: 0.5060
Epoch 332/400 | Train Loss: 29.4688
 Avg Train Loss: 29.4688 | Seg Loss: 0.2946 | Recon Loss: 0.0046
  Val mIoU: 0.6266 (Best: 0.8102)
  [Class IoU]  C1: 0.5906 | C2: 0.7662 | C3: 0.5229
Epoch 333/400 | Train Loss: 29.5004
 Avg Train Loss: 29.5004 | Seg Loss: 0.2950 | Recon Loss: 0.0046
  Val mIoU: 0.5385 (Best: 0.8102)
  [Class IoU]  C1: 0.3235 | C2: 0.7652 | C3: 0.5268
Epoch 334/400 | Train Loss: 28.9890
 Avg Train Loss: 28.9890 | Seg Loss: 0.2898 | Recon Loss: 0.0046
  Val mIoU: 0.6891 (Best: 0.8102)
  [Class IoU]  C1: 0.7379 | C2: 0.7813 | C3: 0.5482
Epoch 335/400 | Train Loss: 28.9665
 Avg Train Loss: 28.9665 | Seg Loss: 0.2896 | Recon Loss: 0.0046
  Val mIoU: 0.7804 (Best: 0.8102)
  [Class IoU]  C1: 0.9106 | C2: 0.8313 | C3: 0.5993
Epoch 336/400 | Train Loss: 28.6991
 Avg Train Loss: 28.6991 | Seg Loss: 0.2869 | Recon Loss: 0.0046
  Val mIoU: 0.6668 (Best: 0.8102)
  [Class IoU]  C1: 0.6994 | C2: 0.7768 | C3: 0.5242
Epoch 337/400 | Train Loss: 29.1248
 Avg Train Loss: 29.1248 | Seg Loss: 0.2912 | Recon Loss: 0.0047
  Val mIoU: 0.6008 (Best: 0.8102)
  [Class IoU]  C1: 0.4682 | C2: 0.7856 | C3: 0.5486
Epoch 338/400 | Train Loss: 29.1348
 Avg Train Loss: 29.1348 | Seg Loss: 0.2913 | Recon Loss: 0.0047
  Val mIoU: 0.5736 (Best: 0.8102)
  [Class IoU]  C1: 0.4026 | C2: 0.7773 | C3: 0.5408
Epoch 339/400 | Train Loss: 29.4393
 Avg Train Loss: 29.4393 | Seg Loss: 0.2943 | Recon Loss: 0.0046
  Val mIoU: 0.6080 (Best: 0.8102)
  [Class IoU]  C1: 0.4581 | C2: 0.8064 | C3: 0.5596
Epoch 340/400 | Train Loss: 29.3637
 Avg Train Loss: 29.3637 | Seg Loss: 0.2936 | Recon Loss: 0.0046
  Val mIoU: 0.5560 (Best: 0.8102)
  [Class IoU]  C1: 0.3711 | C2: 0.7634 | C3: 0.5334
  Saving visuals for Epoch 340...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0340_predictions.png
Epoch 341/400 | Train Loss: 29.4045
 Avg Train Loss: 29.4045 | Seg Loss: 0.2940 | Recon Loss: 0.0046
  Val mIoU: 0.6384 (Best: 0.8102)
  [Class IoU]  C1: 0.5341 | C2: 0.7979 | C3: 0.5831
Epoch 342/400 | Train Loss: 28.9160
 Avg Train Loss: 28.9160 | Seg Loss: 0.2891 | Recon Loss: 0.0046
  Val mIoU: 0.5698 (Best: 0.8102)
  [Class IoU]  C1: 0.4096 | C2: 0.7716 | C3: 0.5283
Epoch 343/400 | Train Loss: 28.9953
 Avg Train Loss: 28.9953 | Seg Loss: 0.2899 | Recon Loss: 0.0045
  Val mIoU: 0.5804 (Best: 0.8102)
  [Class IoU]  C1: 0.4788 | C2: 0.7443 | C3: 0.5180
Epoch 344/400 | Train Loss: 29.1878
 Avg Train Loss: 29.1878 | Seg Loss: 0.2918 | Recon Loss: 0.0046
  Val mIoU: 0.6271 (Best: 0.8102)
  [Class IoU]  C1: 0.6116 | C2: 0.7646 | C3: 0.5052
Epoch 345/400 | Train Loss: 29.5460
 Avg Train Loss: 29.5460 | Seg Loss: 0.2954 | Recon Loss: 0.0046
  Val mIoU: 0.6292 (Best: 0.8102)
  [Class IoU]  C1: 0.5287 | C2: 0.7908 | C3: 0.5680
Epoch 346/400 | Train Loss: 28.4231
 Avg Train Loss: 28.4231 | Seg Loss: 0.2842 | Recon Loss: 0.0047
  Val mIoU: 0.7309 (Best: 0.8102)
  [Class IoU]  C1: 0.8235 | C2: 0.8045 | C3: 0.5647
Epoch 347/400 | Train Loss: 29.1990
 Avg Train Loss: 29.1990 | Seg Loss: 0.2919 | Recon Loss: 0.0047
  Val mIoU: 0.5406 (Best: 0.8102)
  [Class IoU]  C1: 0.3566 | C2: 0.7598 | C3: 0.5056
Epoch 348/400 | Train Loss: 28.7577
 Avg Train Loss: 28.7577 | Seg Loss: 0.2875 | Recon Loss: 0.0045
  Val mIoU: 0.6528 (Best: 0.8102)
  [Class IoU]  C1: 0.6950 | C2: 0.7634 | C3: 0.5001
Epoch 349/400 | Train Loss: 29.4915
 Avg Train Loss: 29.4915 | Seg Loss: 0.2949 | Recon Loss: 0.0047
  Val mIoU: 0.5676 (Best: 0.8102)
  [Class IoU]  C1: 0.4448 | C2: 0.7599 | C3: 0.4982
Epoch 350/400 | Train Loss: 28.9810
 Avg Train Loss: 28.9810 | Seg Loss: 0.2898 | Recon Loss: 0.0046
  Val mIoU: 0.5820 (Best: 0.8102)
  [Class IoU]  C1: 0.4223 | C2: 0.7824 | C3: 0.5411
Epoch 351/400 | Train Loss: 29.0435
 Avg Train Loss: 29.0435 | Seg Loss: 0.2904 | Recon Loss: 0.0047
  Val mIoU: 0.6289 (Best: 0.8102)
  [Class IoU]  C1: 0.5555 | C2: 0.7924 | C3: 0.5388
Epoch 352/400 | Train Loss: 28.5977
 Avg Train Loss: 28.5977 | Seg Loss: 0.2859 | Recon Loss: 0.0047
  Val mIoU: 0.5619 (Best: 0.8102)
  [Class IoU]  C1: 0.3832 | C2: 0.7770 | C3: 0.5256
Epoch 353/400 | Train Loss: 29.4460
 Avg Train Loss: 29.4460 | Seg Loss: 0.2944 | Recon Loss: 0.0047
  Val mIoU: 0.5411 (Best: 0.8102)
  [Class IoU]  C1: 0.3432 | C2: 0.7611 | C3: 0.5190
Epoch 354/400 | Train Loss: 29.0785
 Avg Train Loss: 29.0785 | Seg Loss: 0.2907 | Recon Loss: 0.0047
  Val mIoU: 0.5311 (Best: 0.8102)
  [Class IoU]  C1: 0.3784 | C2: 0.7386 | C3: 0.4763
Epoch 355/400 | Train Loss: 28.5091
 Avg Train Loss: 28.5091 | Seg Loss: 0.2850 | Recon Loss: 0.0045
  Val mIoU: 0.5256 (Best: 0.8102)
  [Class IoU]  C1: 0.3302 | C2: 0.7543 | C3: 0.4924
Epoch 356/400 | Train Loss: 29.1659
 Avg Train Loss: 29.1659 | Seg Loss: 0.2916 | Recon Loss: 0.0045
  Val mIoU: 0.6556 (Best: 0.8102)
  [Class IoU]  C1: 0.5519 | C2: 0.8141 | C3: 0.6008
Epoch 357/400 | Train Loss: 29.1814
 Avg Train Loss: 29.1814 | Seg Loss: 0.2918 | Recon Loss: 0.0046
  Val mIoU: 0.5487 (Best: 0.8102)
  [Class IoU]  C1: 0.3666 | C2: 0.7650 | C3: 0.5144
Epoch 358/400 | Train Loss: 28.9979
 Avg Train Loss: 28.9979 | Seg Loss: 0.2899 | Recon Loss: 0.0047
  Val mIoU: 0.6152 (Best: 0.8102)
  [Class IoU]  C1: 0.4706 | C2: 0.7952 | C3: 0.5800
Epoch 359/400 | Train Loss: 29.0932
 Avg Train Loss: 29.0932 | Seg Loss: 0.2909 | Recon Loss: 0.0046
  Val mIoU: 0.5487 (Best: 0.8102)
  [Class IoU]  C1: 0.3669 | C2: 0.7647 | C3: 0.5146
Epoch 360/400 | Train Loss: 29.1028
 Avg Train Loss: 29.1028 | Seg Loss: 0.2910 | Recon Loss: 0.0045
  Val mIoU: 0.5487 (Best: 0.8102)
  [Class IoU]  C1: 0.3644 | C2: 0.7608 | C3: 0.5208
  Saving visuals for Epoch 360...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0360_predictions.png
Epoch 361/400 | Train Loss: 28.8783
 Avg Train Loss: 28.8783 | Seg Loss: 0.2887 | Recon Loss: 0.0046
  Val mIoU: 0.6824 (Best: 0.8102)
  [Class IoU]  C1: 0.6272 | C2: 0.8185 | C3: 0.6014
Epoch 362/400 | Train Loss: 28.7190
 Avg Train Loss: 28.7190 | Seg Loss: 0.2871 | Recon Loss: 0.0045
  Val mIoU: 0.5322 (Best: 0.8102)
  [Class IoU]  C1: 0.3182 | C2: 0.7667 | C3: 0.5118
Epoch 363/400 | Train Loss: 29.0627
 Avg Train Loss: 29.0627 | Seg Loss: 0.2906 | Recon Loss: 0.0047
  Val mIoU: 0.6028 (Best: 0.8102)
  [Class IoU]  C1: 0.5295 | C2: 0.7635 | C3: 0.5155
Epoch 364/400 | Train Loss: 29.1960
 Avg Train Loss: 29.1960 | Seg Loss: 0.2919 | Recon Loss: 0.0047
  Val mIoU: 0.5965 (Best: 0.8102)
  [Class IoU]  C1: 0.4799 | C2: 0.7819 | C3: 0.5277
Epoch 365/400 | Train Loss: 28.9123
 Avg Train Loss: 28.9123 | Seg Loss: 0.2891 | Recon Loss: 0.0047
  Val mIoU: 0.6345 (Best: 0.8102)
  [Class IoU]  C1: 0.6401 | C2: 0.7618 | C3: 0.5017
Epoch 366/400 | Train Loss: 28.6606
 Avg Train Loss: 28.6606 | Seg Loss: 0.2866 | Recon Loss: 0.0048
  Val mIoU: 0.6195 (Best: 0.8102)
  [Class IoU]  C1: 0.5195 | C2: 0.7932 | C3: 0.5457
Epoch 367/400 | Train Loss: 29.2845
 Avg Train Loss: 29.2845 | Seg Loss: 0.2928 | Recon Loss: 0.0046
  Val mIoU: 0.5439 (Best: 0.8102)
  [Class IoU]  C1: 0.3517 | C2: 0.7694 | C3: 0.5106
Epoch 368/400 | Train Loss: 29.9300
 Avg Train Loss: 29.9300 | Seg Loss: 0.2993 | Recon Loss: 0.0045
  Val mIoU: 0.7152 (Best: 0.8102)
  [Class IoU]  C1: 0.8409 | C2: 0.7859 | C3: 0.5188
Epoch 369/400 | Train Loss: 29.1353
 Avg Train Loss: 29.1353 | Seg Loss: 0.2913 | Recon Loss: 0.0047
  Val mIoU: 0.6373 (Best: 0.8102)
  [Class IoU]  C1: 0.6437 | C2: 0.7648 | C3: 0.5035
Epoch 370/400 | Train Loss: 29.5578
 Avg Train Loss: 29.5578 | Seg Loss: 0.2955 | Recon Loss: 0.0047
  Val mIoU: 0.5460 (Best: 0.8102)
  [Class IoU]  C1: 0.3605 | C2: 0.7589 | C3: 0.5186
Epoch 371/400 | Train Loss: 29.4076
 Avg Train Loss: 29.4076 | Seg Loss: 0.2940 | Recon Loss: 0.0046
  Val mIoU: 0.6257 (Best: 0.8102)
  [Class IoU]  C1: 0.6328 | C2: 0.7630 | C3: 0.4814
Epoch 372/400 | Train Loss: 29.0530
 Avg Train Loss: 29.0530 | Seg Loss: 0.2905 | Recon Loss: 0.0047
  Val mIoU: 0.6086 (Best: 0.8102)
  [Class IoU]  C1: 0.5001 | C2: 0.7883 | C3: 0.5375
Epoch 373/400 | Train Loss: 29.2090
 Avg Train Loss: 29.2090 | Seg Loss: 0.2920 | Recon Loss: 0.0046
  Val mIoU: 0.6271 (Best: 0.8102)
  [Class IoU]  C1: 0.4687 | C2: 0.8090 | C3: 0.6035
Epoch 374/400 | Train Loss: 28.7721
 Avg Train Loss: 28.7721 | Seg Loss: 0.2877 | Recon Loss: 0.0047
  Val mIoU: 0.7152 (Best: 0.8102)
  [Class IoU]  C1: 0.8004 | C2: 0.7973 | C3: 0.5480
Epoch 375/400 | Train Loss: 29.3322
 Avg Train Loss: 29.3322 | Seg Loss: 0.2933 | Recon Loss: 0.0047
  Val mIoU: 0.5036 (Best: 0.8102)
  [Class IoU]  C1: 0.2827 | C2: 0.7472 | C3: 0.4810
Epoch 376/400 | Train Loss: 29.4653
 Avg Train Loss: 29.4653 | Seg Loss: 0.2946 | Recon Loss: 0.0044
  Val mIoU: 0.4820 (Best: 0.8102)
  [Class IoU]  C1: 0.3134 | C2: 0.7043 | C3: 0.4284
Epoch 377/400 | Train Loss: 28.9296
 Avg Train Loss: 28.9296 | Seg Loss: 0.2893 | Recon Loss: 0.0046
  Val mIoU: 0.5667 (Best: 0.8102)
  [Class IoU]  C1: 0.3516 | C2: 0.7885 | C3: 0.5600
Epoch 378/400 | Train Loss: 28.9203
 Avg Train Loss: 28.9203 | Seg Loss: 0.2892 | Recon Loss: 0.0047
  Val mIoU: 0.5115 (Best: 0.8102)
  [Class IoU]  C1: 0.3123 | C2: 0.7454 | C3: 0.4768
Epoch 379/400 | Train Loss: 29.1416
 Avg Train Loss: 29.1416 | Seg Loss: 0.2914 | Recon Loss: 0.0045
  Val mIoU: 0.5363 (Best: 0.8102)
  [Class IoU]  C1: 0.3217 | C2: 0.7699 | C3: 0.5173
Epoch 380/400 | Train Loss: 28.3759
 Avg Train Loss: 28.3759 | Seg Loss: 0.2837 | Recon Loss: 0.0045
  Val mIoU: 0.5887 (Best: 0.8102)
  [Class IoU]  C1: 0.4537 | C2: 0.7777 | C3: 0.5347
  Saving visuals for Epoch 380...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0380_predictions.png
Epoch 381/400 | Train Loss: 28.8625
 Avg Train Loss: 28.8625 | Seg Loss: 0.2886 | Recon Loss: 0.0046
  Val mIoU: 0.5234 (Best: 0.8102)
  [Class IoU]  C1: 0.3539 | C2: 0.7407 | C3: 0.4756
Epoch 382/400 | Train Loss: 29.1493
 Avg Train Loss: 29.1493 | Seg Loss: 0.2914 | Recon Loss: 0.0046
  Val mIoU: 0.5223 (Best: 0.8102)
  [Class IoU]  C1: 0.3667 | C2: 0.7335 | C3: 0.4668
Epoch 383/400 | Train Loss: 29.3906
 Avg Train Loss: 29.3906 | Seg Loss: 0.2939 | Recon Loss: 0.0047
  Val mIoU: 0.7162 (Best: 0.8102)
  [Class IoU]  C1: 0.8114 | C2: 0.7904 | C3: 0.5468
Epoch 384/400 | Train Loss: 29.0091
 Avg Train Loss: 29.0091 | Seg Loss: 0.2900 | Recon Loss: 0.0046
  Val mIoU: 0.5875 (Best: 0.8102)
  [Class IoU]  C1: 0.4510 | C2: 0.7734 | C3: 0.5382
Epoch 385/400 | Train Loss: 28.7660
 Avg Train Loss: 28.7660 | Seg Loss: 0.2876 | Recon Loss: 0.0045
  Val mIoU: 0.6600 (Best: 0.8102)
  [Class IoU]  C1: 0.6281 | C2: 0.7958 | C3: 0.5562
Epoch 386/400 | Train Loss: 29.0567
 Avg Train Loss: 29.0567 | Seg Loss: 0.2905 | Recon Loss: 0.0047
  Val mIoU: 0.6553 (Best: 0.8102)
  [Class IoU]  C1: 0.6040 | C2: 0.7983 | C3: 0.5636
Epoch 387/400 | Train Loss: 28.5142
 Avg Train Loss: 28.5142 | Seg Loss: 0.2851 | Recon Loss: 0.0046
  Val mIoU: 0.5713 (Best: 0.8102)
  [Class IoU]  C1: 0.4180 | C2: 0.7719 | C3: 0.5240
Epoch 388/400 | Train Loss: 29.2121
 Avg Train Loss: 29.2121 | Seg Loss: 0.2921 | Recon Loss: 0.0046
  Val mIoU: 0.7601 (Best: 0.8102)
  [Class IoU]  C1: 0.8865 | C2: 0.8124 | C3: 0.5814
Epoch 389/400 | Train Loss: 29.6880
 Avg Train Loss: 29.6880 | Seg Loss: 0.2968 | Recon Loss: 0.0046
  Val mIoU: 0.5463 (Best: 0.8102)
  [Class IoU]  C1: 0.3381 | C2: 0.7717 | C3: 0.5291
Epoch 390/400 | Train Loss: 29.6070
 Avg Train Loss: 29.6070 | Seg Loss: 0.2960 | Recon Loss: 0.0046
  Val mIoU: 0.7416 (Best: 0.8102)
  [Class IoU]  C1: 0.8969 | C2: 0.7901 | C3: 0.5379
Epoch 391/400 | Train Loss: 29.4292
 Avg Train Loss: 29.4292 | Seg Loss: 0.2942 | Recon Loss: 0.0046
  Val mIoU: 0.7435 (Best: 0.8102)
  [Class IoU]  C1: 0.8795 | C2: 0.8041 | C3: 0.5469
Epoch 392/400 | Train Loss: 28.9112
 Avg Train Loss: 28.9112 | Seg Loss: 0.2891 | Recon Loss: 0.0046
  Val mIoU: 0.7326 (Best: 0.8102)
  [Class IoU]  C1: 0.8500 | C2: 0.8025 | C3: 0.5453
Epoch 393/400 | Train Loss: 29.0291
 Avg Train Loss: 29.0291 | Seg Loss: 0.2902 | Recon Loss: 0.0046
  Val mIoU: 0.5421 (Best: 0.8102)
  [Class IoU]  C1: 0.3540 | C2: 0.7645 | C3: 0.5079
Epoch 394/400 | Train Loss: 28.8223
 Avg Train Loss: 28.8223 | Seg Loss: 0.2882 | Recon Loss: 0.0046
  Val mIoU: 0.5547 (Best: 0.8102)
  [Class IoU]  C1: 0.3863 | C2: 0.7629 | C3: 0.5150
Epoch 395/400 | Train Loss: 28.9687
 Avg Train Loss: 28.9687 | Seg Loss: 0.2896 | Recon Loss: 0.0047
  Val mIoU: 0.5502 (Best: 0.8102)
  [Class IoU]  C1: 0.3745 | C2: 0.7568 | C3: 0.5192
Epoch 396/400 | Train Loss: 29.3920
 Avg Train Loss: 29.3920 | Seg Loss: 0.2939 | Recon Loss: 0.0046
  Val mIoU: 0.5392 (Best: 0.8102)
  [Class IoU]  C1: 0.3485 | C2: 0.7599 | C3: 0.5092
Epoch 397/400 | Train Loss: 29.1738
 Avg Train Loss: 29.1738 | Seg Loss: 0.2917 | Recon Loss: 0.0046
  Val mIoU: 0.5575 (Best: 0.8102)
  [Class IoU]  C1: 0.4285 | C2: 0.7396 | C3: 0.5044
Epoch 398/400 | Train Loss: 29.2759
 Avg Train Loss: 29.2759 | Seg Loss: 0.2927 | Recon Loss: 0.0046
  Val mIoU: 0.5886 (Best: 0.8102)
  [Class IoU]  C1: 0.4885 | C2: 0.7753 | C3: 0.5020
Epoch 399/400 | Train Loss: 28.7888
 Avg Train Loss: 28.7888 | Seg Loss: 0.2878 | Recon Loss: 0.0046
  Val mIoU: 0.5980 (Best: 0.8102)
  [Class IoU]  C1: 0.4800 | C2: 0.7841 | C3: 0.5300
Epoch 400/400 | Train Loss: 29.0143
 Avg Train Loss: 29.0143 | Seg Loss: 0.2901 | Recon Loss: 0.0047
  Val mIoU: 0.5537 (Best: 0.8102)
  [Class IoU]  C1: 0.3455 | C2: 0.7811 | C3: 0.5346
  Saving visuals for Epoch 400...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Output_AG_vali/epoch_0400_predictions.png
--- Training Finished ---
Saving model weights...
Job Finished.

------------------------------------------------------------
Sender: LSF System <lsfadmin@hpc.dtu.dk>
Subject: Job 27221985: <AG_job> in cluster <dcc> Done

Job <AG_job> was submitted from host <gbarlogin1> by user <s214776> in cluster <dcc> at Sun Nov 30 21:56:09 2025
Job was executed on host(s) <8*n-62-13-16>, in queue <gpul40s>, as user <s214776> in cluster <dcc> at Sun Nov 30 21:56:19 2025
</zhome/d2/4/167803> was used as the home directory.
</zhome/d2/4/167803/Desktop/Deep_project/02456-final-project> was used as the working directory.
Started at Sun Nov 30 21:56:19 2025
Terminated at Mon Dec  1 03:34:15 2025
Results reported at Mon Dec  1 03:34:15 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/sh
### --- Job Name ---
#BSUB -J AG_job

### --- Log files ---
#BSUB -o /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_job_%J.out
#BSUB -e /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_%J.err

### --- Resource Requests ---
#BSUB -q gpul40s           # Request GPU queue
#BSUB -gpu "num=1:mode=exclusive_process" # Request 1 GPU, all to myself
#BSUB -n 8                    # Request 4 CPU cores
#BSUB -R "rusage[mem=64GB]"   # Request 16GB memory
#BSUB -W 25:00                # 4 hour runtime limit


### --- Setup Environment ---
echo "Loading CUDA module..."
module load cuda/11.6         # Load CUDA module

echo "Loading Conda..."

source /zhome/d2/4/167803/miniforge3/bin/activate MBML
echo "Environment 'MBML' activated."

echo "Starting Python script..."
python /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/Model/AG_vali.py

echo "Job Finished."
------------------------------------------------------------

Successfully completed.

Resource usage summary:

    CPU time :                                   93435.00 sec.
    Max Memory :                                 2765 MB
    Average Memory :                             2049.06 MB
    Total Requested Memory :                     524288.00 MB
    Delta Memory :                               521523.00 MB
    Max Swap :                                   -
    Max Processes :                              12
    Max Threads :                                149
    Run time :                                   20276 sec.
    Turnaround time :                            20286 sec.

The output (if any) is above this job summary.



PS:

Read file </zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/logs/AG_err_27221985.err> for stderr output of this job.

