Loading CUDA module...
Loading Conda...
Environment 'MBML' activated.
Starting Python script...
Using device: cuda
Using device: cuda
Using Class Weights: tensor([1.0000, 1.5000, 1.0000, 4.0000], device='cuda:0')
--- Data Splits ---
Test (Reserved): [1, 2, 33, 34]
Validation: [27, 28, 29, 30]
Labeled Train: [3, 4, 5, 6, 7, 8, 35, 36, 36, 37, 38]
Unlabeled Train: [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26]
--- Loaders Ready ---
Train Batches: 59
Val Batches: 16
--- Starting Training ---
Epoch 1/400 | Train Loss: 70.8859
 Avg Train Loss: 70.8859 | Seg Loss: 0.7084 | Recon Loss: 0.0450
  Val mIoU: 0.5823 (Best: 0.0000)
  [Class IoU] C0: 0.6988942156933098 | C1: 0.8600 | C2: 0.6971 | C3: 0.0732
  --> New Best Model Saved!
Epoch 2/400 | Train Loss: 74.2281
 Avg Train Loss: 74.2281 | Seg Loss: 0.5591 | Recon Loss: 0.0280
  Val mIoU: 0.5325 (Best: 0.5823)
  [Class IoU] C0: 0.585866910454702 | C1: 0.8831 | C2: 0.5841 | C3: 0.0771
Epoch 3/400 | Train Loss: 58.8772
 Avg Train Loss: 58.8772 | Seg Loss: 0.5254 | Recon Loss: 0.0161
  Val mIoU: 0.5299 (Best: 0.5823)
  [Class IoU] C0: 0.5799064362171031 | C1: 0.8863 | C2: 0.5732 | C3: 0.0800
Epoch 4/400 | Train Loss: 55.1006
 Avg Train Loss: 55.1006 | Seg Loss: 0.4950 | Recon Loss: 0.0120
  Val mIoU: 0.5780 (Best: 0.5823)
  [Class IoU] C0: 0.6593026842839643 | C1: 0.8686 | C2: 0.6689 | C3: 0.1151
Epoch 5/400 | Train Loss: 52.5927
 Avg Train Loss: 52.5927 | Seg Loss: 0.4785 | Recon Loss: 0.0103
  Val mIoU: 0.5942 (Best: 0.5823)
  [Class IoU] C0: 0.6892843818072729 | C1: 0.8654 | C2: 0.6994 | C3: 0.1229
  --> New Best Model Saved!
Epoch 6/400 | Train Loss: 50.5862
 Avg Train Loss: 50.5862 | Seg Loss: 0.4659 | Recon Loss: 0.0098
  Val mIoU: 0.5672 (Best: 0.5942)
  [Class IoU] C0: 0.6298170673710246 | C1: 0.8703 | C2: 0.6398 | C3: 0.1290
Epoch 7/400 | Train Loss: 49.4685
 Avg Train Loss: 49.4685 | Seg Loss: 0.4607 | Recon Loss: 0.0097
  Val mIoU: 0.6758 (Best: 0.5942)
  [Class IoU] C0: 0.7468998373597884 | C1: 0.9139 | C2: 0.7563 | C3: 0.2861
  --> New Best Model Saved!
Epoch 8/400 | Train Loss: 47.0078
 Avg Train Loss: 47.0078 | Seg Loss: 0.4419 | Recon Loss: 0.0092
  Val mIoU: 0.6386 (Best: 0.6758)
  [Class IoU] C0: 0.7377033087982741 | C1: 0.8506 | C2: 0.7559 | C3: 0.2104
Epoch 9/400 | Train Loss: 45.1875
 Avg Train Loss: 45.1875 | Seg Loss: 0.4292 | Recon Loss: 0.0091
  Val mIoU: 0.6329 (Best: 0.6758)
  [Class IoU] C0: 0.7147869086818454 | C1: 0.8915 | C2: 0.7257 | C3: 0.1995
Epoch 10/400 | Train Loss: 45.0431
 Avg Train Loss: 45.0431 | Seg Loss: 0.4302 | Recon Loss: 0.0083
  Val mIoU: 0.6160 (Best: 0.6758)
  [Class IoU] C0: 0.6917254490480581 | C1: 0.9090 | C2: 0.6980 | C3: 0.1654
Epoch 11/400 | Train Loss: 42.9518
 Avg Train Loss: 42.9518 | Seg Loss: 0.4126 | Recon Loss: 0.0086
  Val mIoU: 0.6227 (Best: 0.6758)
  [Class IoU] C0: 0.68895295760551 | C1: 0.9150 | C2: 0.6970 | C3: 0.1899
Epoch 12/400 | Train Loss: 42.1367
 Avg Train Loss: 42.1367 | Seg Loss: 0.4070 | Recon Loss: 0.0082
  Val mIoU: 0.5069 (Best: 0.6758)
  [Class IoU] C0: 0.5249470435501117 | C1: 0.8965 | C2: 0.4897 | C3: 0.1164
Epoch 13/400 | Train Loss: 42.2518
 Avg Train Loss: 42.2518 | Seg Loss: 0.4102 | Recon Loss: 0.0081
  Val mIoU: 0.6363 (Best: 0.6758)
  [Class IoU] C0: 0.732249574633918 | C1: 0.9056 | C2: 0.7362 | C3: 0.1710
Epoch 14/400 | Train Loss: 41.0085
 Avg Train Loss: 41.0085 | Seg Loss: 0.3984 | Recon Loss: 0.0082
  Val mIoU: 0.6496 (Best: 0.6758)
  [Class IoU] C0: 0.7430760096136335 | C1: 0.9170 | C2: 0.7461 | C3: 0.1920
Epoch 15/400 | Train Loss: 41.0807
 Avg Train Loss: 41.0807 | Seg Loss: 0.4002 | Recon Loss: 0.0080
  Val mIoU: 0.6347 (Best: 0.6758)
  [Class IoU] C0: 0.7041530884037127 | C1: 0.9214 | C2: 0.7104 | C3: 0.2030
Epoch 16/400 | Train Loss: 39.8653
 Avg Train Loss: 39.8653 | Seg Loss: 0.3895 | Recon Loss: 0.0077
  Val mIoU: 0.6631 (Best: 0.6758)
  [Class IoU] C0: 0.7385575220528164 | C1: 0.9196 | C2: 0.7447 | C3: 0.2494
Epoch 17/400 | Train Loss: 40.3712
 Avg Train Loss: 40.3712 | Seg Loss: 0.3946 | Recon Loss: 0.0080
  Val mIoU: 0.6843 (Best: 0.6758)
  [Class IoU] C0: 0.7616847979262007 | C1: 0.9222 | C2: 0.7648 | C3: 0.2883
  --> New Best Model Saved!
Epoch 18/400 | Train Loss: 38.9612
 Avg Train Loss: 38.9612 | Seg Loss: 0.3818 | Recon Loss: 0.0074
  Val mIoU: 0.6670 (Best: 0.6843)
  [Class IoU] C0: 0.7594174850245404 | C1: 0.9146 | C2: 0.7615 | C3: 0.2324
Epoch 19/400 | Train Loss: 38.4836
 Avg Train Loss: 38.4836 | Seg Loss: 0.3783 | Recon Loss: 0.0073
  Val mIoU: 0.7138 (Best: 0.6843)
  [Class IoU] C0: 0.7561436200314053 | C1: 0.8795 | C2: 0.7876 | C3: 0.4320
  --> New Best Model Saved!
Epoch 20/400 | Train Loss: 38.5425
 Avg Train Loss: 38.5425 | Seg Loss: 0.3789 | Recon Loss: 0.0077
  Val mIoU: 0.6670 (Best: 0.7138)
  [Class IoU] C0: 0.7659995163315956 | C1: 0.9175 | C2: 0.7638 | C3: 0.2208
  Saving visuals for Epoch 20...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0020_predictions.png
Epoch 21/400 | Train Loss: 38.2875
 Avg Train Loss: 38.2875 | Seg Loss: 0.3767 | Recon Loss: 0.0070
  Val mIoU: 0.7102 (Best: 0.7138)
  [Class IoU] C0: 0.7630061752703398 | C1: 0.9135 | C2: 0.7802 | C3: 0.3840
Epoch 22/400 | Train Loss: 37.2474
 Avg Train Loss: 37.2474 | Seg Loss: 0.3666 | Recon Loss: 0.0072
  Val mIoU: 0.7078 (Best: 0.7138)
  [Class IoU] C0: 0.7748176426245348 | C1: 0.8912 | C2: 0.7964 | C3: 0.3687
Epoch 23/400 | Train Loss: 37.8946
 Avg Train Loss: 37.8946 | Seg Loss: 0.3736 | Recon Loss: 0.0068
  Val mIoU: 0.6388 (Best: 0.7138)
  [Class IoU] C0: 0.73893717281539 | C1: 0.9127 | C2: 0.7376 | C3: 0.1659
Epoch 24/400 | Train Loss: 37.3868
 Avg Train Loss: 37.3868 | Seg Loss: 0.3690 | Recon Loss: 0.0071
  Val mIoU: 0.6782 (Best: 0.7138)
  [Class IoU] C0: 0.7501756663580263 | C1: 0.9260 | C2: 0.7537 | C3: 0.2830
Epoch 25/400 | Train Loss: 36.7106
 Avg Train Loss: 36.7106 | Seg Loss: 0.3629 | Recon Loss: 0.0067
  Val mIoU: 0.6593 (Best: 0.7138)
  [Class IoU] C0: 0.7662784615588116 | C1: 0.9211 | C2: 0.7590 | C3: 0.1906
Epoch 26/400 | Train Loss: 36.6275
 Avg Train Loss: 36.6275 | Seg Loss: 0.3626 | Recon Loss: 0.0066
  Val mIoU: 0.6677 (Best: 0.7138)
  [Class IoU] C0: 0.7814216385639758 | C1: 0.9075 | C2: 0.7770 | C3: 0.2049
Epoch 27/400 | Train Loss: 36.5560
 Avg Train Loss: 36.5560 | Seg Loss: 0.3616 | Recon Loss: 0.0068
  Val mIoU: 0.6716 (Best: 0.7138)
  [Class IoU] C0: 0.7938308639892527 | C1: 0.9205 | C2: 0.7827 | C3: 0.1895
Epoch 28/400 | Train Loss: 36.1450
 Avg Train Loss: 36.1450 | Seg Loss: 0.3578 | Recon Loss: 0.0069
  Val mIoU: 0.6823 (Best: 0.7138)
  [Class IoU] C0: 0.7846091728087051 | C1: 0.9246 | C2: 0.7737 | C3: 0.2460
Epoch 29/400 | Train Loss: 35.9743
 Avg Train Loss: 35.9743 | Seg Loss: 0.3570 | Recon Loss: 0.0069
  Val mIoU: 0.7474 (Best: 0.7138)
  [Class IoU] C0: 0.7988377476469989 | C1: 0.9220 | C2: 0.8081 | C3: 0.4606
  --> New Best Model Saved!
Epoch 30/400 | Train Loss: 36.4908
 Avg Train Loss: 36.4908 | Seg Loss: 0.3618 | Recon Loss: 0.0066
  Val mIoU: 0.6860 (Best: 0.7474)
  [Class IoU] C0: 0.7857816327751092 | C1: 0.9164 | C2: 0.7820 | C3: 0.2598
Epoch 31/400 | Train Loss: 35.2722
 Avg Train Loss: 35.2722 | Seg Loss: 0.3500 | Recon Loss: 0.0065
  Val mIoU: 0.6906 (Best: 0.7474)
  [Class IoU] C0: 0.7658374970579374 | C1: 0.8979 | C2: 0.7770 | C3: 0.3217
Epoch 32/400 | Train Loss: 35.7234
 Avg Train Loss: 35.7234 | Seg Loss: 0.3542 | Recon Loss: 0.0067
  Val mIoU: 0.7160 (Best: 0.7474)
  [Class IoU] C0: 0.7827353974974258 | C1: 0.9062 | C2: 0.7962 | C3: 0.3790
Epoch 33/400 | Train Loss: 36.0880
 Avg Train Loss: 36.0880 | Seg Loss: 0.3582 | Recon Loss: 0.0064
  Val mIoU: 0.7046 (Best: 0.7474)
  [Class IoU] C0: 0.7855581115983958 | C1: 0.9217 | C2: 0.7866 | C3: 0.3245
Epoch 34/400 | Train Loss: 35.0317
 Avg Train Loss: 35.0317 | Seg Loss: 0.3477 | Recon Loss: 0.0063
  Val mIoU: 0.6972 (Best: 0.7474)
  [Class IoU] C0: 0.8013960928622628 | C1: 0.9225 | C2: 0.7907 | C3: 0.2741
Epoch 35/400 | Train Loss: 35.1152
 Avg Train Loss: 35.1152 | Seg Loss: 0.3486 | Recon Loss: 0.0062
  Val mIoU: 0.6560 (Best: 0.7474)
  [Class IoU] C0: 0.7743803436235961 | C1: 0.9180 | C2: 0.7628 | C3: 0.1690
Epoch 36/400 | Train Loss: 35.1395
 Avg Train Loss: 35.1395 | Seg Loss: 0.3489 | Recon Loss: 0.0063
  Val mIoU: 0.6953 (Best: 0.7474)
  [Class IoU] C0: 0.7712868287084105 | C1: 0.9210 | C2: 0.7749 | C3: 0.3141
Epoch 37/400 | Train Loss: 35.0862
 Avg Train Loss: 35.0862 | Seg Loss: 0.3486 | Recon Loss: 0.0061
  Val mIoU: 0.6833 (Best: 0.7474)
  [Class IoU] C0: 0.7733431763265066 | C1: 0.9212 | C2: 0.7717 | C3: 0.2670
Epoch 38/400 | Train Loss: 35.0795
 Avg Train Loss: 35.0795 | Seg Loss: 0.3486 | Recon Loss: 0.0063
  Val mIoU: 0.6958 (Best: 0.7474)
  [Class IoU] C0: 0.7798328737199008 | C1: 0.9204 | C2: 0.7751 | C3: 0.3077
Epoch 39/400 | Train Loss: 35.3407
 Avg Train Loss: 35.3407 | Seg Loss: 0.3511 | Recon Loss: 0.0061
  Val mIoU: 0.6895 (Best: 0.7474)
  [Class IoU] C0: 0.7874797723834261 | C1: 0.9239 | C2: 0.7778 | C3: 0.2687
Epoch 40/400 | Train Loss: 34.9539
 Avg Train Loss: 34.9539 | Seg Loss: 0.3476 | Recon Loss: 0.0061
  Val mIoU: 0.6930 (Best: 0.7474)
  [Class IoU] C0: 0.7930491283750274 | C1: 0.9087 | C2: 0.7919 | C3: 0.2783
  Saving visuals for Epoch 40...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0040_predictions.png
Epoch 41/400 | Train Loss: 35.1833
 Avg Train Loss: 35.1833 | Seg Loss: 0.3496 | Recon Loss: 0.0061
  Val mIoU: 0.6840 (Best: 0.7474)
  [Class IoU] C0: 0.798777511214561 | C1: 0.9227 | C2: 0.7884 | C3: 0.2263
Epoch 42/400 | Train Loss: 34.0897
 Avg Train Loss: 34.0897 | Seg Loss: 0.3390 | Recon Loss: 0.0060
  Val mIoU: 0.6905 (Best: 0.7474)
  [Class IoU] C0: 0.8029974666172464 | C1: 0.9246 | C2: 0.7888 | C3: 0.2456
Epoch 43/400 | Train Loss: 34.2428
 Avg Train Loss: 34.2428 | Seg Loss: 0.3406 | Recon Loss: 0.0059
  Val mIoU: 0.6980 (Best: 0.7474)
  [Class IoU] C0: 0.8017595976843589 | C1: 0.9210 | C2: 0.7936 | C3: 0.2757
Epoch 44/400 | Train Loss: 34.6047
 Avg Train Loss: 34.6047 | Seg Loss: 0.3439 | Recon Loss: 0.0058
  Val mIoU: 0.7078 (Best: 0.7474)
  [Class IoU] C0: 0.8077717321752329 | C1: 0.9249 | C2: 0.7986 | C3: 0.2997
Epoch 45/400 | Train Loss: 33.9191
 Avg Train Loss: 33.9191 | Seg Loss: 0.3374 | Recon Loss: 0.0061
  Val mIoU: 0.6810 (Best: 0.7474)
  [Class IoU] C0: 0.8008210643673548 | C1: 0.9241 | C2: 0.7831 | C3: 0.2161
Epoch 46/400 | Train Loss: 33.8006
 Avg Train Loss: 33.8006 | Seg Loss: 0.3364 | Recon Loss: 0.0058
  Val mIoU: 0.6998 (Best: 0.7474)
  [Class IoU] C0: 0.8063677245696911 | C1: 0.9126 | C2: 0.7922 | C3: 0.2881
Epoch 47/400 | Train Loss: 34.9321
 Avg Train Loss: 34.9321 | Seg Loss: 0.3476 | Recon Loss: 0.0059
  Val mIoU: 0.6725 (Best: 0.7474)
  [Class IoU] C0: 0.7817689758257086 | C1: 0.8820 | C2: 0.7876 | C3: 0.2387
Epoch 48/400 | Train Loss: 32.7438
 Avg Train Loss: 32.7438 | Seg Loss: 0.3258 | Recon Loss: 0.0059
  Val mIoU: 0.6773 (Best: 0.7474)
  [Class IoU] C0: 0.7915522200768343 | C1: 0.9071 | C2: 0.7844 | C3: 0.2259
Epoch 49/400 | Train Loss: 33.7219
 Avg Train Loss: 33.7219 | Seg Loss: 0.3357 | Recon Loss: 0.0057
  Val mIoU: 0.7062 (Best: 0.7474)
  [Class IoU] C0: 0.7928890759124568 | C1: 0.8836 | C2: 0.8040 | C3: 0.3443
Epoch 50/400 | Train Loss: 33.5680
 Avg Train Loss: 33.5680 | Seg Loss: 0.3343 | Recon Loss: 0.0058
  Val mIoU: 0.6807 (Best: 0.7474)
  [Class IoU] C0: 0.7931715930919566 | C1: 0.9182 | C2: 0.7899 | C3: 0.2215
Epoch 51/400 | Train Loss: 33.4828
 Avg Train Loss: 33.4828 | Seg Loss: 0.3335 | Recon Loss: 0.0057
  Val mIoU: 0.7514 (Best: 0.7474)
  [Class IoU] C0: 0.8028265821396064 | C1: 0.9238 | C2: 0.8208 | C3: 0.4583
  --> New Best Model Saved!
Epoch 52/400 | Train Loss: 33.0830
 Avg Train Loss: 33.0830 | Seg Loss: 0.3295 | Recon Loss: 0.0058
  Val mIoU: 0.6871 (Best: 0.7514)
  [Class IoU] C0: 0.8000407813743367 | C1: 0.9248 | C2: 0.7841 | C3: 0.2395
Epoch 53/400 | Train Loss: 34.1186
 Avg Train Loss: 34.1186 | Seg Loss: 0.3401 | Recon Loss: 0.0056
  Val mIoU: 0.7217 (Best: 0.7514)
  [Class IoU] C0: 0.8092160934579771 | C1: 0.9247 | C2: 0.8056 | C3: 0.3473
Epoch 54/400 | Train Loss: 32.8982
 Avg Train Loss: 32.8982 | Seg Loss: 0.3278 | Recon Loss: 0.0056
  Val mIoU: 0.7039 (Best: 0.7514)
  [Class IoU] C0: 0.8005768936103222 | C1: 0.9142 | C2: 0.8005 | C3: 0.3002
Epoch 55/400 | Train Loss: 32.8013
 Avg Train Loss: 32.8013 | Seg Loss: 0.3269 | Recon Loss: 0.0057
  Val mIoU: 0.7139 (Best: 0.7514)
  [Class IoU] C0: 0.8048753270103964 | C1: 0.9241 | C2: 0.8037 | C3: 0.3230
Epoch 56/400 | Train Loss: 33.0995
 Avg Train Loss: 33.0995 | Seg Loss: 0.3298 | Recon Loss: 0.0057
  Val mIoU: 0.6948 (Best: 0.7514)
  [Class IoU] C0: 0.7982776722888297 | C1: 0.9117 | C2: 0.7958 | C3: 0.2735
Epoch 57/400 | Train Loss: 33.7222
 Avg Train Loss: 33.7222 | Seg Loss: 0.3364 | Recon Loss: 0.0056
  Val mIoU: 0.7092 (Best: 0.7514)
  [Class IoU] C0: 0.8051112939226676 | C1: 0.9221 | C2: 0.8022 | C3: 0.3075
Epoch 58/400 | Train Loss: 32.1235
 Avg Train Loss: 32.1235 | Seg Loss: 0.3204 | Recon Loss: 0.0054
  Val mIoU: 0.7300 (Best: 0.7514)
  [Class IoU] C0: 0.8068063779682411 | C1: 0.9219 | C2: 0.8108 | C3: 0.3803
Epoch 59/400 | Train Loss: 33.8364
 Avg Train Loss: 33.8364 | Seg Loss: 0.3373 | Recon Loss: 0.0054
  Val mIoU: 0.7200 (Best: 0.7514)
  [Class IoU] C0: 0.8002691073685888 | C1: 0.9118 | C2: 0.8077 | C3: 0.3604
Epoch 60/400 | Train Loss: 32.9214
 Avg Train Loss: 32.9214 | Seg Loss: 0.3282 | Recon Loss: 0.0055
  Val mIoU: 0.7224 (Best: 0.7514)
  [Class IoU] C0: 0.7952746157448899 | C1: 0.9093 | C2: 0.8097 | C3: 0.3753
  Saving visuals for Epoch 60...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0060_predictions.png
Epoch 61/400 | Train Loss: 33.3460
 Avg Train Loss: 33.3460 | Seg Loss: 0.3325 | Recon Loss: 0.0054
  Val mIoU: 0.7299 (Best: 0.7514)
  [Class IoU] C0: 0.8082382863789196 | C1: 0.9230 | C2: 0.8105 | C3: 0.3779
Epoch 62/400 | Train Loss: 33.0809
 Avg Train Loss: 33.0809 | Seg Loss: 0.3300 | Recon Loss: 0.0055
  Val mIoU: 0.7109 (Best: 0.7514)
  [Class IoU] C0: 0.8038450988671652 | C1: 0.9253 | C2: 0.8018 | C3: 0.3129
Epoch 63/400 | Train Loss: 32.5622
 Avg Train Loss: 32.5622 | Seg Loss: 0.3248 | Recon Loss: 0.0054
  Val mIoU: 0.7108 (Best: 0.7514)
  [Class IoU] C0: 0.7853506981474236 | C1: 0.8968 | C2: 0.8043 | C3: 0.3567
Epoch 64/400 | Train Loss: 32.8348
 Avg Train Loss: 32.8348 | Seg Loss: 0.3276 | Recon Loss: 0.0055
  Val mIoU: 0.7597 (Best: 0.7514)
  [Class IoU] C0: 0.7921871774226932 | C1: 0.9257 | C2: 0.8221 | C3: 0.4987
  --> New Best Model Saved!
Epoch 65/400 | Train Loss: 33.1479
 Avg Train Loss: 33.1479 | Seg Loss: 0.3308 | Recon Loss: 0.0055
  Val mIoU: 0.6972 (Best: 0.7597)
  [Class IoU] C0: 0.8029144408986761 | C1: 0.9231 | C2: 0.7960 | C3: 0.2670
Epoch 66/400 | Train Loss: 32.2086
 Avg Train Loss: 32.2086 | Seg Loss: 0.3214 | Recon Loss: 0.0053
  Val mIoU: 0.7218 (Best: 0.7597)
  [Class IoU] C0: 0.7989993001246241 | C1: 0.9128 | C2: 0.8055 | C3: 0.3700
Epoch 67/400 | Train Loss: 32.7835
 Avg Train Loss: 32.7835 | Seg Loss: 0.3271 | Recon Loss: 0.0053
  Val mIoU: 0.7122 (Best: 0.7597)
  [Class IoU] C0: 0.7994750995540264 | C1: 0.9120 | C2: 0.8036 | C3: 0.3338
Epoch 68/400 | Train Loss: 32.7649
 Avg Train Loss: 32.7649 | Seg Loss: 0.3272 | Recon Loss: 0.0054
  Val mIoU: 0.7247 (Best: 0.7597)
  [Class IoU] C0: 0.812425779312292 | C1: 0.9255 | C2: 0.8054 | C3: 0.3554
Epoch 69/400 | Train Loss: 32.7700
 Avg Train Loss: 32.7700 | Seg Loss: 0.3275 | Recon Loss: 0.0054
  Val mIoU: 0.7000 (Best: 0.7597)
  [Class IoU] C0: 0.7999489194484037 | C1: 0.9123 | C2: 0.7987 | C3: 0.2891
Epoch 70/400 | Train Loss: 32.9236
 Avg Train Loss: 32.9236 | Seg Loss: 0.3290 | Recon Loss: 0.0056
  Val mIoU: 0.7368 (Best: 0.7597)
  [Class IoU] C0: 0.8076360012963546 | C1: 0.9237 | C2: 0.8145 | C3: 0.4013
Epoch 71/400 | Train Loss: 32.7325
 Avg Train Loss: 32.7325 | Seg Loss: 0.3271 | Recon Loss: 0.0054
  Val mIoU: 0.7233 (Best: 0.7597)
  [Class IoU] C0: 0.810974280128941 | C1: 0.9242 | C2: 0.8066 | C3: 0.3516
Epoch 72/400 | Train Loss: 32.9273
 Avg Train Loss: 32.9273 | Seg Loss: 0.3291 | Recon Loss: 0.0053
  Val mIoU: 0.7289 (Best: 0.7597)
  [Class IoU] C0: 0.8086603033741926 | C1: 0.9226 | C2: 0.8100 | C3: 0.3744
Epoch 73/400 | Train Loss: 32.6816
 Avg Train Loss: 32.6816 | Seg Loss: 0.3267 | Recon Loss: 0.0055
  Val mIoU: 0.7277 (Best: 0.7597)
  [Class IoU] C0: 0.8012676362154498 | C1: 0.9250 | C2: 0.8038 | C3: 0.3806
Epoch 74/400 | Train Loss: 31.9775
 Avg Train Loss: 31.9775 | Seg Loss: 0.3196 | Recon Loss: 0.0054
  Val mIoU: 0.7375 (Best: 0.7597)
  [Class IoU] C0: 0.8015698295144754 | C1: 0.9154 | C2: 0.8141 | C3: 0.4188
Epoch 75/400 | Train Loss: 32.3905
 Avg Train Loss: 32.3905 | Seg Loss: 0.3238 | Recon Loss: 0.0054
  Val mIoU: 0.7456 (Best: 0.7597)
  [Class IoU] C0: 0.8038429556221941 | C1: 0.9174 | C2: 0.8200 | C3: 0.4412
Epoch 76/400 | Train Loss: 32.6483
 Avg Train Loss: 32.6483 | Seg Loss: 0.3264 | Recon Loss: 0.0054
  Val mIoU: 0.7324 (Best: 0.7597)
  [Class IoU] C0: 0.8054284608471638 | C1: 0.9216 | C2: 0.8095 | C3: 0.3930
Epoch 77/400 | Train Loss: 31.1162
 Avg Train Loss: 31.1162 | Seg Loss: 0.3110 | Recon Loss: 0.0055
  Val mIoU: 0.7400 (Best: 0.7597)
  [Class IoU] C0: 0.8036438354050551 | C1: 0.9240 | C2: 0.8094 | C3: 0.4230
Epoch 78/400 | Train Loss: 31.6009
 Avg Train Loss: 31.6009 | Seg Loss: 0.3159 | Recon Loss: 0.0053
  Val mIoU: 0.6766 (Best: 0.7597)
  [Class IoU] C0: 0.7943517353288249 | C1: 0.9019 | C2: 0.7874 | C3: 0.2228
Epoch 79/400 | Train Loss: 32.7204
 Avg Train Loss: 32.7204 | Seg Loss: 0.3271 | Recon Loss: 0.0052
  Val mIoU: 0.6951 (Best: 0.7597)
  [Class IoU] C0: 0.787257577522768 | C1: 0.8768 | C2: 0.8001 | C3: 0.3162
Epoch 80/400 | Train Loss: 31.9535
 Avg Train Loss: 31.9535 | Seg Loss: 0.3194 | Recon Loss: 0.0054
  Val mIoU: 0.7286 (Best: 0.7597)
  [Class IoU] C0: 0.8023986789091069 | C1: 0.9219 | C2: 0.8048 | C3: 0.3851
  Saving visuals for Epoch 80...
  Visuals saved to: /zhome/d2/4/167803/Desktop/Deep_project/02456-final-project/output_VAE_vali/epoch_0080_predictions.png
Epoch 81/400 | Train Loss: 32.4546
 Avg Train Loss: 32.4546 | Seg Loss: 0.3245 | Recon Loss: 0.0052
  Val mIoU: 0.7228 (Best: 0.7597)
  [Class IoU] C0: 0.7893140480948883 | C1: 0.8983 | C2: 0.8041 | C3: 0.3994
Epoch 82/400 | Train Loss: 32.2293
 Avg Train Loss: 32.2293 | Seg Loss: 0.3222 | Recon Loss: 0.0053
  Val mIoU: 0.7320 (Best: 0.7597)
  [Class IoU] C0: 0.8069056077303878 | C1: 0.9239 | C2: 0.8127 | C3: 0.3843
Epoch 83/400 | Train Loss: 31.7689
 Avg Train Loss: 31.7689 | Seg Loss: 0.3176 | Recon Loss: 0.0054
  Val mIoU: 0.7116 (Best: 0.7597)
  [Class IoU] C0: 0.7972863803559986 | C1: 0.9020 | C2: 0.8048 | C3: 0.3423
Epoch 84/400 | Train Loss: 31.7344
 Avg Train Loss: 31.7344 | Seg Loss: 0.3173 | Recon Loss: 0.0053
  Val mIoU: 0.7574 (Best: 0.7597)
  [Class IoU] C0: 0.8111254991170588 | C1: 0.9244 | C2: 0.8238 | C3: 0.4703
Epoch 85/400 | Train Loss: 32.2382
 Avg Train Loss: 32.2382 | Seg Loss: 0.3223 | Recon Loss: 0.0052
  Val mIoU: 0.7784 (Best: 0.7597)
  [Class IoU] C0: 0.810347067029194 | C1: 0.9179 | C2: 0.8320 | C3: 0.5534
  --> New Best Model Saved!
Epoch 86/400 | Train Loss: 32.2020
 Avg Train Loss: 32.2020 | Seg Loss: 0.3219 | Recon Loss: 0.0051
  Val mIoU: 0.7343 (Best: 0.7784)
  [Class IoU] C0: 0.7919715777804688 | C1: 0.8702 | C2: 0.8182 | C3: 0.4567
Epoch 87/400 | Train Loss: 32.5040
 Avg Train Loss: 32.5040 | Seg Loss: 0.3249 | Recon Loss: 0.0055
  Val mIoU: 0.7516 (Best: 0.7784)
  [Class IoU] C0: 0.8028300531261463 | C1: 0.9109 | C2: 0.8210 | C3: 0.4718
Epoch 88/400 | Train Loss: 32.7591
 Avg Train Loss: 32.7591 | Seg Loss: 0.3275 | Recon Loss: 0.0052
  Val mIoU: 0.7320 (Best: 0.7784)
  [Class IoU] C0: 0.7996226893404982 | C1: 0.9176 | C2: 0.8060 | C3: 0.4049
Epoch 89/400 | Train Loss: 32.2595
 Avg Train Loss: 32.2595 | Seg Loss: 0.3225 | Recon Loss: 0.0052
  Val mIoU: 0.7324 (Best: 0.7784)
  [Class IoU] C0: 0.7975758259544017 | C1: 0.9048 | C2: 0.8128 | C3: 0.4144
Epoch 90/400 | Train Loss: 32.6895
 Avg Train Loss: 32.6895 | Seg Loss: 0.3268 | Recon Loss: 0.0053
  Val mIoU: 0.7690 (Best: 0.7784)
  [Class IoU] C0: 0.7966961163441331 | C1: 0.8884 | C2: 0.8334 | C3: 0.5573
Epoch 91/400 | Train Loss: 31.8184
 Avg Train Loss: 31.8184 | Seg Loss: 0.3181 | Recon Loss: 0.0051
  Val mIoU: 0.7404 (Best: 0.7784)
  [Class IoU] C0: 0.8062726344709038 | C1: 0.9192 | C2: 0.8155 | C3: 0.4207
Epoch 92/400 | Train Loss: 31.4389
 Avg Train Loss: 31.4389 | Seg Loss: 0.3142 | Recon Loss: 0.0051
  Val mIoU: 0.7370 (Best: 0.7784)
  [Class IoU] C0: 0.8008886151800324 | C1: 0.9147 | C2: 0.8099 | C3: 0.4226
Epoch 93/400 | Train Loss: 32.0981
 Avg Train Loss: 32.0981 | Seg Loss: 0.3209 | Recon Loss: 0.0051
  Val mIoU: 0.6860 (Best: 0.7784)
  [Class IoU] C0: 0.7832912139117884 | C1: 0.8440 | C2: 0.7996 | C3: 0.3170
Epoch 94/400 | Train Loss: 32.1782
 Avg Train Loss: 32.1782 | Seg Loss: 0.3217 | Recon Loss: 0.0050
  Val mIoU: 0.7017 (Best: 0.7784)
  [Class IoU] C0: 0.78165946227367 | C1: 0.8857 | C2: 0.7926 | C3: 0.3467
Epoch 95/400 | Train Loss: 31.3935
 Avg Train Loss: 31.3935 | Seg Loss: 0.3138 | Recon Loss: 0.0053
  Val mIoU: 0.6979 (Best: 0.7784)
  [Class IoU] C0: 0.7841819658085466 | C1: 0.8555 | C2: 0.8012 | C3: 0.3509
Epoch 96/400 | Train Loss: 32.2005
 Avg Train Loss: 32.2005 | Seg Loss: 0.3219 | Recon Loss: 0.0052
  Val mIoU: 0.7078 (Best: 0.7784)
  [Class IoU] C0: 0.8037047984355402 | C1: 0.9222 | C2: 0.7967 | C3: 0.3084
